(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    529761,      13058]
NotebookOptionsPosition[    520584,      12793]
NotebookOutlinePosition[    521150,      12814]
CellTagsIndexPosition[    521107,      12811]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[StyleBox["Age-dependent nongenetic effects",
 FontSize->24]], "Title",
 CellChangeTimes->{{3.593494666799176*^9, 3.593494707374599*^9}, {
  3.5937783195816603`*^9, 3.5937783301250973`*^9}, {3.624564671217421*^9, 
  3.624564677431067*^9}, {3.6338397280318413`*^9, 3.63383973740674*^9}}],

Cell[TextData[StyleBox["Bram Kuijper & Rufus A. Johnstone",
 FontSize->16]], "Text",
 CellChangeTimes->{{3.593778276437594*^9, 3.5937782840517187`*^9}}],

Cell[CellGroupData[{

Cell["Parameters and initialization", "Section",
 CellChangeTimes->{{3.5925369193881607`*^9, 3.592536949051231*^9}}],

Cell["Clear memory:", "Text",
 CellChangeTimes->{{3.59344239283613*^9, 3.593442395379766*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.500128427684636*^9, 3.500128451258902*^9}, 
   3.50073299731535*^9, {3.5018611272843018`*^9, 3.501861128504798*^9}, 
   3.501861166978281*^9, {3.505125110823873*^9, 3.505125111480598*^9}, {
   3.509288972748003*^9, 3.509288973397145*^9}, {3.509608637730192*^9, 
   3.509608638396096*^9}}],

Cell[TextData[{
 StyleBox["- Patch frequncies ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", 
    RowBox[{"x", ",", "i", ",", "j"}]], TraditionalForm]],
  FontWeight->"Bold"],
 StyleBox["\n",
  FontWeight->"Bold"],
 StyleBox["x",
  FontSlant->"Italic"],
 ": environment ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "1"], TraditionalForm]]],
 " or ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "2"], TraditionalForm]]],
 " (here annotated as ",
 StyleBox["a",
  FontSlant->"Italic"],
 ", ",
 StyleBox["b",
  FontSlant->"Italic"],
 ")\n",
 StyleBox["i",
  FontSlant->"Italic"],
 ": state of juvenile breeder (0=maladapted,1=adapted)\n",
 StyleBox["j",
  FontSlant->"Italic"],
 ": state of senior breeder"
}], "Text",
 CellChangeTimes->{{3.500116732616866*^9, 3.5001167713959846`*^9}, {
  3.592536638246684*^9, 3.592536709381946*^9}, {3.5925368332856894`*^9, 
  3.5925368556518803`*^9}, {3.5934424013557873`*^9, 3.59344240478764*^9}, {
  3.5934435772716312`*^9, 3.5934435786830397`*^9}, {3.607685242639638*^9, 
  3.607685289006283*^9}, {3.618922101159214*^9, 3.618922178073358*^9}, {
  3.633839681318166*^9, 3.6338397130640287`*^9}, {3.633839754831201*^9, 
  3.633839764461565*^9}}],

Cell[TextData[{
 StyleBox["- Environmental switching rates\n",
  FontWeight->"Bold"],
 Cell[BoxData[{
  FormBox[
   RowBox[{
    SubscriptBox["s", "1"], "=", 
    SubscriptBox["s", 
     RowBox[{
      SubscriptBox["e", "1"], "\[Rule]", 
      SubscriptBox["e", "2"]}]]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    SubscriptBox["s", "2"], "=", 
    SubscriptBox["s", 
     RowBox[{
      SubscriptBox["e", "2"], "\[Rule]", 
      SubscriptBox["e", "1"]}]]}], TraditionalForm]}]]
}], "Text",
 CellChangeTimes->{{3.500116778255621*^9, 3.500116786939053*^9}, {
  3.5925373284084177`*^9, 3.5925373751662283`*^9}, {3.593443566867229*^9, 
  3.5934435669632*^9}, {3.63383976818117*^9, 3.633839770540491*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"st", "=", 
   RowBox[{"{", 
    RowBox[{"s1", ",", "s2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "[", "es_", "]"}], ":=", 
  RowBox[{"st", "[", 
   RowBox[{"[", "es", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5925373087718763`*^9, 3.5925373233792*^9}}],

Cell["Specification of the evolutionary variables", "Text",
 CellChangeTimes->{{3.592537654940291*^9, 3.592537660676259*^9}}],

Cell[TextData[{
 StyleBox["- Dispersal locus",
  FontWeight->"Bold"],
 "\nmx: resident dispersal rates\ndmx: \[Delta], slight difference between \
mutant and resident dispersal rates"
}], "Text",
 CellChangeTimes->{{3.5925374540299177`*^9, 3.592537454998452*^9}, {
  3.592537662916122*^9, 3.5925376632683887`*^9}, {3.592537720779931*^9, 
  3.592537797507066*^9}, {3.5934435603070107`*^9, 3.593443589964015*^9}, {
  3.593443687619841*^9, 3.593443689099412*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mx", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mt", ",", "mt"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mt", ",", "mt"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mt", ",", "mt"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mt", ",", "mt"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dmx", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dmt", ",", "dmt"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dmt", ",", "dmt"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dmt", ",", "dmt"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dmt", ",", "dmt"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m", "[", 
    RowBox[{"es_", ",", "state_", ",", "age_"}], "]"}], ":=", 
   RowBox[{"mx", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"age", "+", "1"}], ",", "es", ",", 
      RowBox[{"1", "+", "state"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dm", "[", 
    RowBox[{"es_", ",", "state_", ",", "age_"}], "]"}], ":=", 
   RowBox[{"dmx", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"age", "+", "1"}], ",", "es", ",", 
      RowBox[{"1", "+", "state"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"varlistM", ":=", 
    RowBox[{"{", "mt", "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "definitions", " ", "needed", " ", "later", " ", "for", " ", "function", 
    " ", "specification"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varlistdM", ":=", 
   RowBox[{"{", "dmt", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arglistM", ":=", "ms__Real"}], ";"}]}], "Input",
 CellChangeTimes->{{3.500118773163447*^9, 3.500118910263569*^9}, {
   3.500119087597973*^9, 3.500119090980617*^9}, {3.5001195528530283`*^9, 
   3.500119593468643*^9}, {3.500120092623599*^9, 3.500120092748851*^9}, {
   3.500136368745949*^9, 3.500136374906622*^9}, {3.5001423795874243`*^9, 
   3.500142397835494*^9}, {3.5001910544408283`*^9, 3.5001910707255917`*^9}, {
   3.505128236491838*^9, 3.505128288704921*^9}, {3.505133288973331*^9, 
   3.505133296177403*^9}, {3.505133522438445*^9, 3.505133549659513*^9}, {
   3.505134014352137*^9, 3.50513403905585*^9}, {3.505134240579132*^9, 
   3.505134241767873*^9}, {3.505139351314415*^9, 3.505139372086256*^9}, {
   3.5051558273320293`*^9, 3.505155855600602*^9}, {3.50539467615995*^9, 
   3.505394676982449*^9}, {3.505463244026674*^9, 3.505463257417686*^9}, {
   3.505463307333784*^9, 3.505463321253703*^9}, {3.50546575267028*^9, 
   3.505465768233089*^9}, {3.505484976325813*^9, 3.505484983948823*^9}, {
   3.50548503239085*^9, 3.505485033454481*^9}, {3.505558270883147*^9, 
   3.505558284187843*^9}, {3.505571015107941*^9, 3.505571047863003*^9}, {
   3.505581160740476*^9, 3.50558117287267*^9}, {3.505583355345198*^9, 
   3.505583361715997*^9}, {3.505583682927802*^9, 3.505583683359265*^9}, 
   3.50558371668095*^9, {3.505654692054782*^9, 3.505654715998914*^9}, {
   3.505654759113348*^9, 3.505654761139649*^9}, {3.50565724255633*^9, 
   3.505657273309394*^9}, {3.505661781217031*^9, 3.505661845410152*^9}, {
   3.505661877847231*^9, 3.505661889520056*^9}, {3.505751661144566*^9, 
   3.505751681752979*^9}, {3.505751745355992*^9, 3.505751753278463*^9}, {
   3.507884037673462*^9, 3.507884044308074*^9}, {3.515223764045479*^9, 
   3.515223766960201*^9}, {3.59344329997761*^9, 3.5934433141234093`*^9}, {
   3.6240488182675467`*^9, 3.624048882538862*^9}, 3.6240491606050177`*^9, 
   3.624082038492394*^9}],

Cell[TextData[{
 StyleBox["- Phenotype-dependent switching",
  FontWeight->"Bold"],
 "\npx: table of probabilities that females with a particular phenotype \
produce offspring of a different phenotype than their own. \ndpx: same, but \
now as a function of a slight mutant difference relative to resident\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["p", "1"], ",", 
    SubscriptBox["p", "2"]}], TraditionalForm]]],
 ": probability of producing ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "1"], TraditionalForm]]],
 "-offspring  for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "1"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "2"], TraditionalForm]]],
 " parents respectively\nQ: `trembling hand\[CloseCurlyQuote] error to avoid \
local maxima (sensu Selten 1975 Int J Game Theor 4: 25-55)\n\np[es,ad]: \
lookup function connecting a female\[CloseCurlyQuote]s environment ",
 StyleBox["es",
  FontSlant->"Italic"],
 " and her adapted/maladapted state ",
 StyleBox["ad",
  FontSlant->"Italic"],
 " to values of px \nFor example, p[1,0] reflects a female living in \
environment ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "1"], TraditionalForm]]],
 " with \[OpenCurlyQuote]adaptedness\[CloseCurlyQuote]=0 (i.e., maladapted). \
In other words, this is a ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", 
    RowBox[{"2", " "}]], TraditionalForm]]],
 "-female (which is adapted to environment ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "2"], TraditionalForm]]],
 "). See main text."
}], "Text",
 CellChangeTimes->{{3.592537529829274*^9, 3.592537608764773*^9}, {
  3.592537665787866*^9, 3.592537666036079*^9}, {3.592537805202849*^9, 
  3.592537830338646*^9}, {3.592543662226894*^9, 3.592543678923498*^9}, {
  3.593442422212388*^9, 3.593442485691265*^9}, {3.593443236238962*^9, 
  3.5934432559978437`*^9}, {3.593443341806076*^9, 3.5934435210194693`*^9}, {
  3.593443562188596*^9, 3.593443683563737*^9}, {3.607685567541914*^9, 
  3.607685570004575*^9}, {3.607685652396105*^9, 3.607685680059689*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"px", "=", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], "p21"}], "+", 
           RowBox[{"Q", 
            RowBox[{"(", 
             RowBox[{"1", "-", "p21"}], ")"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "p11"}], ")"}]}], "+", 
           RowBox[{"Q", " ", "p11"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "p11"}], ")"}]}], "+", 
           RowBox[{"Q", " ", "p11"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], "p21"}], "+", 
           RowBox[{"Q", 
            RowBox[{"(", 
             RowBox[{"1", "-", "p21"}], ")"}]}]}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], "p21"}], "+", 
           RowBox[{"Q", 
            RowBox[{"(", 
             RowBox[{"1", "-", "p21"}], ")"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "p11"}], ")"}]}], "+", 
           RowBox[{"Q", " ", "p11"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "p11"}], ")"}]}], "+", 
           RowBox[{"Q", " ", "p11"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], "p21"}], "+", 
           RowBox[{"Q", 
            RowBox[{"(", 
             RowBox[{"1", "-", "p21"}], ")"}]}]}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"dpx", "=", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], "dp21"}], "-", 
           RowBox[{"Q", " ", "dp21"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"1", "-", "Q"}], ")"}]}], "dp11"}], "+", 
           RowBox[{"Q", " ", "dp11"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"1", "-", "Q"}], ")"}]}], "dp11"}], "+", 
           RowBox[{"Q", " ", "dp11"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], "dp21"}], "+", 
           RowBox[{
            RowBox[{"-", "dp21"}], " ", "Q"}]}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], "dp21"}], "+", 
           RowBox[{
            RowBox[{"-", "dp21"}], " ", "Q"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "dp11"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}]}], "+", 
           RowBox[{"Q", " ", "dp11"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"1", "-", "Q"}], ")"}]}], "dp11"}], "+", 
           RowBox[{"Q", " ", "dp11"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], "dp21"}], "+", 
           RowBox[{
            RowBox[{"-", "dp21"}], " ", "Q"}]}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.635411974483287*^9, 3.635412015277128*^9}, {
  3.6354121042853727`*^9, 3.635412116225359*^9}, {3.63548871788299*^9, 
  3.6354887206469707`*^9}, {3.63672430843069*^9, 3.636724312543107*^9}, {
  3.636792191338087*^9, 3.636792194889799*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"px", "=", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], "p10"}], "+", 
           RowBox[{"Q", 
            RowBox[{"(", 
             RowBox[{"1", "-", "p10"}], ")"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "p10"}], ")"}]}], "+", 
           RowBox[{"Q", " ", "p10"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "p10"}], ")"}]}], "+", 
           RowBox[{"Q", " ", "p10"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], "p10"}], "+", 
           RowBox[{"Q", 
            RowBox[{"(", 
             RowBox[{"1", "-", "p10"}], ")"}]}]}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], "p11"}], "+", 
           RowBox[{"Q", 
            RowBox[{"(", 
             RowBox[{"1", "-", "p11"}], ")"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "p11"}], ")"}]}], "+", 
           RowBox[{"Q", " ", "p11"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "p11"}], ")"}]}], "+", 
           RowBox[{"Q", " ", "p11"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], "p11"}], "+", 
           RowBox[{"Q", 
            RowBox[{"(", 
             RowBox[{"1", "-", "p11"}], ")"}]}]}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"dpx", "=", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], "dp10"}], "-", 
           RowBox[{"Q", " ", "dp10"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"1", "-", "Q"}], ")"}]}], "dp10"}], "+", 
           RowBox[{"Q", " ", "dp10"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"1", "-", "Q"}], ")"}]}], "dp10"}], "+", 
           RowBox[{"Q", " ", "dp10"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], "dp10"}], "+", 
           RowBox[{
            RowBox[{"-", "dp10"}], " ", "Q"}]}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], "dp11"}], "+", 
           RowBox[{
            RowBox[{"-", "dp11"}], " ", "Q"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "dp11"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}]}], "+", 
           RowBox[{"Q", " ", "dp11"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"1", "-", "Q"}], ")"}]}], "dp11"}], "+", 
           RowBox[{"Q", " ", "dp11"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}], "dp11"}], "+", 
           RowBox[{
            RowBox[{"-", "dp11"}], " ", "Q"}]}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.63686006783396*^9, 3.6368600947013807`*^9}, {
  3.636863036094953*^9, 3.6368630557221518`*^9}, {3.639394645940703*^9, 
  3.639394648528536*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"px", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "p20"}], "+", 
          RowBox[{"Q", 
           RowBox[{"(", 
            RowBox[{"1", "-", "p20"}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "p10"}], ")"}]}], "+", 
          RowBox[{"Q", " ", "p10"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "p10"}], ")"}]}], "+", 
          RowBox[{"Q", " ", "p10"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "p20"}], "+", 
          RowBox[{"Q", 
           RowBox[{"(", 
            RowBox[{"1", "-", "p20"}], ")"}]}]}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "p21"}], "+", 
          RowBox[{"Q", 
           RowBox[{"(", 
            RowBox[{"1", "-", "p21"}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "p11"}], ")"}]}], "+", 
          RowBox[{"Q", " ", "p11"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "p11"}], ")"}]}], "+", 
          RowBox[{"Q", " ", "p11"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "p21"}], "+", 
          RowBox[{"Q", 
           RowBox[{"(", 
            RowBox[{"1", "-", "p21"}], ")"}]}]}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dpx", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "dp20"}], "-", 
          RowBox[{"Q", " ", "dp20"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}]}], "dp10"}], "+", 
          RowBox[{"Q", " ", "dp10"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}]}], "dp10"}], "+", 
          RowBox[{"Q", " ", "dp10"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "dp20"}], "+", 
          RowBox[{
           RowBox[{"-", "dp20"}], " ", "Q"}]}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "dp21"}], "+", 
          RowBox[{
           RowBox[{"-", "dp21"}], " ", "Q"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "dp11"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}]}], "+", 
          RowBox[{"Q", " ", "dp11"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}]}], "dp11"}], "+", 
          RowBox[{"Q", " ", "dp11"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "dp21"}], "+", 
          RowBox[{
           RowBox[{"-", "dp21"}], " ", "Q"}]}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", 
    RowBox[{"es_", ",", "ad_", ",", "age_"}], "]"}], ":=", 
   RowBox[{"px", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"age", "+", "1"}], ",", "es", ",", 
      RowBox[{"1", "+", "ad"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dp", "[", 
   RowBox[{"es_", ",", "ad_", ",", "age_"}], "]"}], ":=", 
  RowBox[{"dpx", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"age", "+", "1"}], ",", "es", ",", 
     RowBox[{"1", "+", "ad"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.517038062927934*^9, 3.51703816854226*^9}, {
   3.51905182898097*^9, 3.519051833116747*^9}, {3.520238431048418*^9, 
   3.520238433809459*^9}, {3.520241987657432*^9, 3.520242003026947*^9}, {
   3.520242820378682*^9, 3.520242825954704*^9}, {3.520243764786285*^9, 
   3.520243764836133*^9}, 3.52024391190013*^9, {3.520244311149429*^9, 
   3.520244311961317*^9}, {3.52024449388923*^9, 3.520244495018912*^9}, {
   3.520244741108325*^9, 3.520244741844243*^9}, {3.520244856084298*^9, 
   3.520244860756021*^9}, {3.520253380519802*^9, 3.520253380863543*^9}, {
   3.520414422134022*^9, 3.520414425613311*^9}, {3.520414525684128*^9, 
   3.520414527662351*^9}, {3.520434069244433*^9, 3.520434072029148*^9}, {
   3.520586789091575*^9, 3.52058679184248*^9}, {3.521874430981219*^9, 
   3.521874431323632*^9}, {3.52257859226308*^9, 3.52257859675019*^9}, {
   3.524043568339653*^9, 3.52404359269764*^9}, {3.524553556495103*^9, 
   3.524553606251944*^9}, {3.524553918507112*^9, 3.5245539506721*^9}, {
   3.525850588866333*^9, 3.525850590761015*^9}, {3.525850874608904*^9, 
   3.52585088449899*^9}, {3.525850951689707*^9, 3.525850953593128*^9}, {
   3.526018821964699*^9, 3.526018825526871*^9}, {3.529061426773059*^9, 
   3.529061432864193*^9}, {3.531769959557863*^9, 3.531769961986011*^9}, {
   3.531813417393294*^9, 3.531813426256126*^9}, {3.532112898613368*^9, 
   3.532112901190764*^9}, {3.591254623425433*^9, 3.591254674241444*^9}, {
   3.591254782320562*^9, 3.591254807306346*^9}, {3.591255456850945*^9, 
   3.591255467228277*^9}, {3.59253752077489*^9, 3.592537526295137*^9}, {
   3.593443320155177*^9, 3.593443320604072*^9}, {3.6240280850117617`*^9, 
   3.6240280882261267`*^9}, {3.62402812107955*^9, 3.624028237540576*^9}, {
   3.624028271040254*^9, 3.6240283051777687`*^9}, {3.6240283471418543`*^9, 
   3.624028446581362*^9}, {3.624028481492853*^9, 3.624028507960659*^9}, 
   3.635074453613371*^9, {3.635412017583097*^9, 3.635412023241233*^9}, {
   3.6354887223169813`*^9, 3.635488724630621*^9}, 3.635564256627577*^9, {
   3.636724316323763*^9, 3.636724321237731*^9}, {3.63679219955344*^9, 
   3.636792201604714*^9}, {3.636860017027814*^9, 3.636860024455737*^9}, {
   3.639394660732395*^9, 3.639394662666098*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dp", "[", 
  RowBox[{"2", ",", "0", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.6338397847630053`*^9, 3.633839823303379*^9}, {
  3.633839874588303*^9, 3.63383987481067*^9}, {3.6349027611044283`*^9, 
  3.634902781870613*^9}, {3.634903567983423*^9, 3.634903580968314*^9}, {
  3.6350720358443336`*^9, 3.635072037850883*^9}, {3.6350760023471527`*^9, 
  3.635076007692211*^9}, {3.6350761166550207`*^9, 3.635076118366825*^9}, {
  3.635412191596759*^9, 3.635412199292042*^9}, {3.639124468987089*^9, 
  3.639124483297223*^9}, {3.6391245899692574`*^9, 3.63912459008211*^9}, {
  3.639130755893614*^9, 3.639130755980905*^9}, {3.639131220579382*^9, 
  3.6391312418967123`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dp10", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "Q"}], ")"}]}], "+", 
  RowBox[{"dp10", " ", "Q"}]}]], "Output",
 CellChangeTimes->{
  3.63383982387146*^9, 3.633839875397352*^9, 3.633839954452257*^9, 
   3.633841463389544*^9, 3.6338947215796013`*^9, 3.633895575343158*^9, 
   3.633896356112092*^9, 3.633948249695587*^9, 3.6339524953173113`*^9, 
   3.6339525765205183`*^9, 3.633954950082539*^9, 3.633955229596546*^9, 
   3.6339555881141567`*^9, 3.633957072187522*^9, 3.633959160141253*^9, 
   3.6339592403551893`*^9, 3.633960434850709*^9, 3.6339646917964983`*^9, 
   3.633964782752486*^9, 3.633965056795068*^9, {3.6349027571064262`*^9, 
   3.634902782304916*^9}, 3.634903522842277*^9, {3.63490356862644*^9, 
   3.634903581850198*^9}, 3.6349036560030937`*^9, 3.634976871628565*^9, 
   3.635071863583474*^9, 3.635072038500835*^9, 3.635072840968264*^9, 
   3.63507448250399*^9, 3.635074804554579*^9, 3.6350753350173388`*^9, {
   3.63507600359028*^9, 3.6350760083051167`*^9}, 3.63507611936828*^9, {
   3.635412182996957*^9, 3.635412199822637*^9}, 3.635414714299716*^9, 
   3.635415264117141*^9, 3.635489412394084*^9, {3.635564107559106*^9, 
   3.6355641126502943`*^9}, 3.6355643037700863`*^9, 3.635564421435302*^9, 
   3.6355816543139668`*^9, 3.635581926118431*^9, 3.635582410260384*^9, 
   3.635582514842805*^9, 3.635582585876711*^9, 3.635582619769183*^9, 
   3.635582844473521*^9, 3.635582934941607*^9, 3.635583039143993*^9, 
   3.635587076489971*^9, 3.635587618156734*^9, 3.636702905913834*^9, 
   3.6367051566034946`*^9, 3.6367079658402576`*^9, 3.636724335774206*^9, 
   3.636724858725898*^9, 3.6367263008946*^9, 3.636726746904867*^9, 
   3.6367281624655952`*^9, 3.636728402701643*^9, 3.636728484290429*^9, 
   3.6367923789143353`*^9, 3.6368665571381702`*^9, 3.63691195721058*^9, 
   3.639124230598179*^9, {3.639124465716268*^9, 3.639124484651552*^9}, 
   3.639124590909212*^9, 3.639130756531506*^9, {3.639131221471095*^9, 
   3.639131242534061*^9}, 3.639394567280061*^9, 3.63939468902984*^9, 
   3.6398188513974733`*^9, 3.639819405331807*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p", "[", 
  RowBox[{"1", ",", "1", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.636911958750729*^9, 3.636911970468658*^9}, {
  3.636912047033757*^9, 3.636912047409128*^9}, {3.636912186610923*^9, 
  3.636912191220028*^9}, {3.6391307698132143`*^9, 3.6391307734353743`*^9}, {
  3.639131245565765*^9, 3.639131245786901*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "p10"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "Q"}], ")"}]}], "+", 
  RowBox[{"p10", " ", "Q"}]}]], "Output",
 CellChangeTimes->{{3.636911961714856*^9, 3.6369119710139227`*^9}, 
   3.6369120482585573`*^9, {3.636912187275249*^9, 3.636912191995903*^9}, 
   3.639124230603917*^9, {3.639130768050953*^9, 3.63913077392505*^9}, 
   3.639131117179892*^9, 3.639131246253996*^9, 3.639394567325698*^9, 
   3.639394689073244*^9, 3.639818851401713*^9, 3.639819405381707*^9}]
}, Open  ]],

Cell[TextData[{
 StyleBox["- Mortality selection parameters",
  FontWeight->"Bold"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["c", "1"], ",", 
    SubscriptBox["c", "2"]}], TraditionalForm]]],
 ": mortality parameters for maladapted individuals (mortality for adapted \
individuals = 1)"
}], "Text",
 CellChangeTimes->{{3.592537851082424*^9, 3.592537857386005*^9}, {
  3.59253793334632*^9, 3.592537965257461*^9}, {3.593443533412225*^9, 
  3.5934435640436087`*^9}, {3.634908304035359*^9, 3.634908306555489*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dx", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"1", "-", "c1"}]], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"1", "-", "c2"}]], ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"1", "-", "c3"}]], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"1", "-", "c4"}]], ",", "1"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "[", 
   RowBox[{"es_", ",", "state_", ",", "age_"}], "]"}], ":=", 
  RowBox[{"dx", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"age", "+", "1"}], ",", "es", ",", 
     RowBox[{"1", "+", "state"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5001332396173964`*^9, 3.500133281520371*^9}, {
   3.500136200146578*^9, 3.500136210329666*^9}, {3.50019263291833*^9, 
   3.500192634364931*^9}, {3.501930681155058*^9, 3.501930688304488*^9}, {
   3.529063162916232*^9, 3.529063180835222*^9}, {3.531745922364476*^9, 
   3.531745923930574*^9}, {3.531753845404137*^9, 3.531753847069844*^9}, 
   3.592537868033029*^9, {3.624027670912199*^9, 3.624027672199456*^9}, {
   3.624027776542458*^9, 3.624027777806684*^9}, {3.624027817031006*^9, 
   3.624027909607691*^9}, {3.624027945293303*^9, 3.624027949438402*^9}}],

Cell[TextData[StyleBox["- Fecundity selection,",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.592537996952724*^9, 3.592538031208852*^9}, 
   3.5925381100882196`*^9, {3.592542916506803*^9, 3.59254293150633*^9}, {
   3.593443695890839*^9, 3.5934437229465857`*^9}, {3.6240276653933*^9, 
   3.6240276679135942`*^9}, 3.624027773542657*^9, {3.634908259326168*^9, 
   3.6349082598935413`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gx", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         FractionBox["1", 
          RowBox[{"1", "-", "q1"}]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         FractionBox["1", 
          RowBox[{"1", "-", "q2"}]]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         FractionBox["1", 
          RowBox[{"1", "-", "q1"}]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         FractionBox["1", 
          RowBox[{"1", "-", "q2"}]]}], "}"}]}], "}"}]}], "}"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "[", 
   RowBox[{"es_", ",", "state_", ",", "age_"}], "]"}], ":=", 
  RowBox[{"gx", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"age", "+", "1"}], ",", "es", ",", 
     RowBox[{"1", "+", "state"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.5001362469952993`*^9, {3.5001363089459*^9, 3.500136374034523*^9}, {
   3.500137044277297*^9, 3.500137056632866*^9}, {3.500192628905581*^9, 
   3.50019263010264*^9}, {3.515223772880254*^9, 3.515223784680871*^9}, 
   3.515223924473187*^9, {3.515224082129158*^9, 3.515224083857226*^9}, {
   3.515657870386673*^9, 3.515657873587348*^9}, {3.522140274375248*^9, 
   3.522140279087269*^9}, {3.522140310086524*^9, 3.522140341051928*^9}, {
   3.522578386308506*^9, 3.522578410393209*^9}, {3.526018481416929*^9, 
   3.526018487167841*^9}, {3.526018802116892*^9, 3.526018803063705*^9}, {
   3.52664437543906*^9, 3.526644382349394*^9}, {3.529063122319402*^9, 
   3.529063155149573*^9}, {3.53175382627929*^9, 3.531753836680533*^9}, {
   3.532110552853554*^9, 3.532110558952022*^9}, {3.591583551770855*^9, 
   3.591583556601612*^9}, {3.592537975488604*^9, 3.592537995359036*^9}, {
   3.592538034198379*^9, 3.592538044079611*^9}, {3.592538094340519*^9, 
   3.592538105045054*^9}, {3.592542908180541*^9, 3.592542912944188*^9}, {
   3.6240950822297*^9, 3.624095100838315*^9}}],

Cell[TextData[StyleBox["- Number of breeders per patch",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.593443728066662*^9, 3.5934437360340567`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"n", "=", "2"}]], "Input",
 CellChangeTimes->{{3.6240951692045107`*^9, 3.624095170528673*^9}, {
  3.624280986194656*^9, 3.624280986660377*^9}}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->CompressedData["
1:eJwVzmtIUwEYBuAzy5yxdDpTWducipI6xeaykhUcrea8p2Z6vE1BNB1ZaVmo
sST1RxeVJZpZoNYwk4wuXsiudGrU0EiZFrpqTLCddN4Skcq+78fL8+P9+Hi9
80uTC1gEQRRBBLxiw3GCIR/03G1Qg4FRpdfLwa709i+3QXPQgPoteGm5vwyd
DM+OoUF1rEYzAq751yZYwMoirXUObB39MGzD3mtwG5fFkBy/Nl+01TpVzQON
Qm+VAizIS69HNSKOIRGU3gtwXeQy5B3F+0YnV4aMvuw45gz6m2uneOC4xN6M
sg3PVtCQwN92bqByYikYNeltSpQj6C5BdWHGRTRak0e7g4nUwE4PkK8+bUJ1
MyGenmCWmd4jAN1E82moNM4rG21p39IlAavrIrtRcyqfG4x7jLt8ULG0lwkB
Q/mKGgqsr2zhZIJlmw2heeBStQuVj7uc7WxFYE5zknUDXGPP6wgeQxI3Zd18
sDzX5roD/ORYV46uPo74KANv3f81HQ76MC6zKN+D5u4FhbFDYahsuVaFHrrG
5u8DVRWOXhFgDMspAL1Rk/0CHdRWfZaDcurrNMpe4RP7weeluXKH7Qw5zLKL
R99I/3CCQP1T8c8McGvDkX4KNEVoTaiH3izOBIt3W9o2QO2V2AnCHe6s9gIW
+E99NckPVFn+/lCCcv2jBTS6c4RKBiNP0lUoh1IOoQnCrHeoRHhgFP3efn4M
9c9ptKFE77d11Dg545ACrqc0EUdB2nL4ICohIifOeDLkq4fNC2fBJyXDiedA
mWI9XgPqGtMb0MC+jqiL4KaWnEq0/1iypAascMmIQQtPXUtFOy+o6jvA2Qrd
Sxr/9YyL3YQMWaWbE7eCg6u+oWia6ERcoYghRa/7mtD/AFNp8A==
  "]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Patch frequencies", "Section"]], "Section"],

Cell[TextData[{
 StyleBox["- Philopatric juveniles that are locally adapted (localad) or \
locally maladapted (localmad)\n",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["a", "n"], 
    RowBox[{"g", "(", 
     RowBox[{
      SubscriptBox["e", "i"], ",", "a"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"p", "(", 
         RowBox[{
          SubscriptBox["e", "i"], ",", "a"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"m", "(", 
           RowBox[{
            SubscriptBox["e", "i"], ",", "a"}], ")"}]}], ")"}]}]}], ":"}]}]}],
    TraditionalForm]]],
 " production of locally adapted juveniles by ",
 Cell[BoxData[
  FormBox[
   FractionBox["a", "n"], TraditionalForm]]],
 " locally adapted parents, who have fecundity ",
 Cell[BoxData[
  FormBox[
   RowBox[{"g", "(", 
    RowBox[{
     SubscriptBox["e", "i"], ",", "a"}], ")"}], TraditionalForm]]],
 " and produce offspring of the same phenotype with probability ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"p", "(", 
      RowBox[{
       SubscriptBox["e", "i"], ",", "a"}], ")"}]}], ")"}], 
   TraditionalForm]]],
 ", who remain at the local patch with probability ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"m", "(", 
      RowBox[{
       SubscriptBox["e", "i"], "a"}], ")"}]}]}], TraditionalForm]]],
 ".\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"n", "-", "a"}], "n"], 
    RowBox[{"g", "(", 
     RowBox[{
      SubscriptBox["e", "i"], ",", "b"}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"p", "(", 
         RowBox[{
          SubscriptBox["e", "i"], ",", "b"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"m", "(", 
           RowBox[{
            SubscriptBox["e", "i"], ",", "b"}], ")"}]}], ")"}]}]}], ":"}]}]}],
    TraditionalForm]]],
 " production of locally adapted juveniles by ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"n", "-", "a"}], "n"], TraditionalForm]]],
 " locally maladapted parents,s\n"
}], "Text",
 CellChangeTimes->{{3.592538148039744*^9, 3.5925384996827507`*^9}, {
  3.593443760867096*^9, 3.5934437609870863`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"localad", "[", 
   RowBox[{"es_", ",", "ay_", ",", "ao_"}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     FractionBox["ay", "2"], 
     RowBox[{"g", "[", 
      RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"p", "[", 
        RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", "ay"}], "2"], 
     RowBox[{"g", "[", 
      RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
     RowBox[{"p", "[", 
      RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["ao", "2"], 
     RowBox[{"g", "[", 
      RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"p", "[", 
        RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", "ao"}], "2"], 
     RowBox[{"g", "[", 
      RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
     RowBox[{"p", "[", 
      RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localmad", "[", 
   RowBox[{"es_", ",", "ay_", ",", "ao_"}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     FractionBox["ay", "2"], 
     RowBox[{"g", "[", 
      RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
     RowBox[{"p", "[", 
      RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", "ay"}], "2"], 
     RowBox[{"g", "[", 
      RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"p", "[", 
        RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox["ao", "2"], 
     RowBox[{"g", "[", 
      RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
     RowBox[{"p", "[", 
      RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", "ao"}], "2"], 
     RowBox[{"g", "[", 
      RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"p", "[", 
        RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.500120873674243*^9, 3.5001210355847692`*^9}, {
   3.500121143974712*^9, 3.5001211891721582`*^9}, {3.5001254507449503`*^9, 
   3.5001254895331507`*^9}, {3.5001255395065823`*^9, 3.50012556780807*^9}, {
   3.50012559895665*^9, 3.500125609305683*^9}, 3.500125734437594*^9, {
   3.500125795420335*^9, 3.500125838193928*^9}, {3.5001260925815897`*^9, 
   3.50012619653481*^9}, {3.500126318936735*^9, 3.500126490780538*^9}, {
   3.500126522241294*^9, 3.500126614249658*^9}, {3.5001266560703173`*^9, 
   3.500126692145039*^9}, {3.50012679804455*^9, 3.500126865625854*^9}, {
   3.5001269598438177`*^9, 3.500127010728797*^9}, {3.500127066746924*^9, 
   3.500127075242776*^9}, 3.500127168349073*^9, {3.500127799012751*^9, 
   3.50012794447775*^9}, {3.500127989244396*^9, 3.500128053011385*^9}, {
   3.500128120681616*^9, 3.5001281869125023`*^9}, {3.500128273678108*^9, 
   3.500128282830265*^9}, {3.500128331005128*^9, 3.500128412672514*^9}, {
   3.500128485970336*^9, 3.5001285037885857`*^9}, {3.500128604416666*^9, 
   3.500128654695407*^9}, {3.500128793134313*^9, 3.500128821190743*^9}, {
   3.500128924224536*^9, 3.500128962612554*^9}, {3.500129044296741*^9, 
   3.500129059197551*^9}, {3.500189795589278*^9, 3.500189809037795*^9}, {
   3.500191120480218*^9, 3.500191135144388*^9}, {3.500192700247055*^9, 
   3.5001927267342463`*^9}, {3.5007274959643087`*^9, 
   3.5007274971650257`*^9}, {3.500727569917247*^9, 3.5007275729396*^9}, {
   3.500728699556571*^9, 3.500728740477393*^9}, {3.500728835717046*^9, 
   3.500728850269268*^9}, {3.5007290429903793`*^9, 3.50072910127816*^9}, {
   3.5007291775293827`*^9, 3.5007291977631283`*^9}, {3.500732760953953*^9, 
   3.5007327631378593`*^9}, {3.5007330148648577`*^9, 3.500733037851882*^9}, {
   3.5018653388124866`*^9, 3.501865368880773*^9}, {3.502634529232007*^9, 
   3.502634563110133*^9}, {3.5026347197756767`*^9, 3.5026348117526073`*^9}, {
   3.502634899986861*^9, 3.5026349004268627`*^9}, {3.503042079156918*^9, 
   3.50304208574548*^9}, {3.503042184532455*^9, 3.503042189260453*^9}, {
   3.505128467356586*^9, 3.505128474487809*^9}, {3.505128506618724*^9, 
   3.505128554696378*^9}, {3.505815927928623*^9, 3.505815929681814*^9}, {
   3.507037958421404*^9, 3.507038012491966*^9}, {3.507218416099026*^9, 
   3.507218426680966*^9}, {3.507218486766817*^9, 3.507218528077397*^9}, 
   3.592538400160944*^9, 3.592538470702742*^9, 3.592538512268461*^9, {
   3.592538604446601*^9, 3.592538607212532*^9}, {3.592543613859783*^9, 
   3.592543624398034*^9}, {3.624543328358165*^9, 3.62454336189924*^9}, {
   3.62454342104311*^9, 3.624543573158557*^9}, {3.624544118105871*^9, 
   3.62454412732051*^9}, {3.6245441946769123`*^9, 3.6245441982389*^9}, {
   3.624545358091016*^9, 3.624545378362708*^9}}],

Cell[TextData[{
 StyleBox["- Migrant juveniles arriving in an environment to which they are \
adapted (dispad) or maladapted (dispmad)\n",
  FontWeight->"Bold"],
 StyleBox["k",
  FontSlant->"Italic"],
 ": cost of dispersal. Calculations below are  derived in the same fashion as \
calculations involving philopatric juveniles. See also in-line comments"
}], "Text",
 CellChangeTimes->{{3.592538529147274*^9, 3.5925385842660847`*^9}, {
  3.593443761786683*^9, 3.593443844378488*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dispad", "[", "es_", "]"}], ":=", 
   RowBox[{"(*", " ", 
    RowBox[{
    "probability", " ", "that", " ", "a", " ", "migrant", " ", "migrates", 
     " ", "into", " ", "environment", " ", "es", " ", "where", " ", "it", " ",
      "is", " ", "adapted"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "k"}], ")"}], "*", 
     RowBox[{"Sum", "[", 
      RowBox[{"(*", " ", 
       RowBox[{"sum", " ", "over", " ", "environments"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{"(*", " ", 
         RowBox[{
         "sum", " ", "over", " ", "number", " ", "of", " ", "adapted", " ", 
          "breeders"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"es", "\[Equal]", "esSum"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"esSum", ",", "ay", ",", "ao"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["ay", "2"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "1", ",", "0"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"1", "-", "ay"}], "2"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["ao", "2"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "1", ",", "1"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"1", "-", "ao"}], "2"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}]}]}], ")"}]}], 
           ",", 
           RowBox[{"(*", " ", 
            RowBox[{"environment", " ", "same", " ", "as", " ", "target"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"esSum", ",", "ay", ",", "ao"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["ay", "2"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"1", "-", "ay"}], "2"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "0", ",", "0"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["ao", "2"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"1", "-", "ao"}], "2"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "0", ",", "1"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}]}]}], ")"}]}]}], 
          RowBox[{"(*", " ", 
           RowBox[{
           "environment", " ", "different", " ", "from", " ", "target"}], " ",
            "*)"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"{", 
          RowBox[{"ay", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ao", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"esSum", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dispmad", "[", "es_", "]"}], ":=", 
   RowBox[{"(*", " ", 
    RowBox[{
    "probability", " ", "that", " ", "a", " ", "migrant", " ", "migrates", 
     " ", "into", " ", "environment", " ", "es", " ", "where", " ", "it", " ",
      "is", " ", "adapted"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "k"}], ")"}], "*", 
     RowBox[{"Sum", "[", 
      RowBox[{"(*", " ", 
       RowBox[{"sum", " ", "over", " ", "environments"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{"(*", " ", 
         RowBox[{
         "sum", " ", "over", " ", "number", " ", "of", " ", "adapted", " ", 
          "breeders"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"es", "\[Equal]", "esSum"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"esSum", ",", "ay", ",", "ao"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["ay", "2"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"1", "-", "ay"}], "2"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "0", ",", "0"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["ao", "2"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"1", "-", "ao"}], "2"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "0", ",", "1"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}]}]}], ")"}]}], 
           ",", 
           RowBox[{"(*", " ", 
            RowBox[{"environment", " ", "same", " ", "as", " ", "target"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"esSum", ",", "ay", ",", "ao"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["ay", "2"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "1", ",", "0"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"1", "-", "ay"}], "2"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["ao", "2"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "1", ",", "1"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"1", "-", "ao"}], "2"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}]}]}], ")"}]}]}], 
          RowBox[{"(*", " ", 
           RowBox[{
           "environment", " ", "different", " ", "from", " ", "target"}], " ",
            "*)"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"{", 
          RowBox[{"ay", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ao", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"esSum", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6245442130095787`*^9, 3.624544219176771*^9}, {
  3.624545384244918*^9, 3.624545489275362*^9}, {3.6245461954571466`*^9, 
  3.6245463024017763`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dispad", "[", "1", "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Q", "\[Rule]", "0"}], ",", 
    RowBox[{"q1", "\[Rule]", "0"}], ",", 
    RowBox[{"q2", "\[Rule]", "0"}], ",", 
    RowBox[{"c1", "\[Rule]", "c"}], ",", 
    RowBox[{"c2", "\[Rule]", "c"}], ",", 
    RowBox[{"c3", "\[Rule]", "c"}], ",", 
    RowBox[{"c4", "\[Rule]", "c"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.635489827788793*^9, 3.6354898384878817`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", "k"}], ")"}], " ", "mt", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "p20"}], "-", "p21"}], ")"}]}], " ", 
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "p11"}], "-", "p20"}], ")"}], " ", 
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "p10"}], "-", "p21"}], ")"}], " ", 
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "p10"}], "-", "p11"}], ")"}], " ", 
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "p10"}], "-", "p11"}], ")"}], " ", 
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p10", "+", "p21"}], ")"}], " ", 
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "0", ",", "1"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p11", "+", "p20"}], ")"}], " ", 
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "p20"}], "-", "p21"}], ")"}], " ", 
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.635489830650711*^9, 3.635489838984474*^9}, 
   3.635564304255808*^9, 3.635564433958948*^9, 3.63558165471712*^9, 
   3.635581926366363*^9, 3.635582410472969*^9, 3.635582515068368*^9, 
   3.635582586146678*^9, 3.635582619978655*^9, 3.635582844702277*^9, 
   3.635582935230694*^9, 3.635583039345724*^9, 3.6355870767537813`*^9, 
   3.635587618444203*^9, 3.6367029063335037`*^9, 3.6367051568957767`*^9, 
   3.636707966041915*^9, 3.6367243360113277`*^9, 3.636724858898746*^9, 
   3.636726301255743*^9, 3.636726747102914*^9, 3.636728162738372*^9, 
   3.6367284029418592`*^9, 3.636728484667575*^9, 3.636792379256682*^9, 
   3.636866557421742*^9, 3.639394567630271*^9, 3.639394689344091*^9, 
   3.639818858030732*^9, 3.6398194056959667`*^9}]
}, Open  ]],

Cell[TextData[StyleBox["- Total number of locally competing juveniles:",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.59253861564257*^9, 3.592538624986649*^9}, 
   3.592542341792898*^9, {3.59344384898559*^9, 3.59344384910559*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"localcomptotal", "[", 
   RowBox[{"es_", ",", "ay_", ",", "ao_"}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"localad", "[", 
     RowBox[{"es", ",", "ay", ",", "ao"}], "]"}], "+", 
    RowBox[{"localmad", "[", 
     RowBox[{"es", ",", "ay", ",", "ao"}], "]"}], "+", 
    RowBox[{"dispad", "[", "es", "]"}], "+", 
    RowBox[{"dispmad", "[", "es", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6245463173736467`*^9, 3.624546326765691*^9}}],

Cell[TextData[{
 "ap[es,a]: Probability that any adapted juvenile will win competition over \
breeding spots in an environment of type ",
 StyleBox["es",
  FontSlant->"Italic"],
 " with ",
 StyleBox["a",
  FontSlant->"Italic"],
 " adapted adult breeders."
}], "Text",
 CellChangeTimes->{{3.5925423472402363`*^9, 3.592542367063136*^9}, {
  3.5934439214345818`*^9, 3.59344395112869*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ap", "[", 
   RowBox[{"es_", ",", "ay_", ",", "ao_"}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   FractionBox[
    RowBox[{
     RowBox[{"localad", "[", 
      RowBox[{"es", ",", "ay", ",", "ao"}], "]"}], "+", 
     RowBox[{"dispad", "[", "es", "]"}]}], 
    RowBox[{"localcomptotal", "[", 
     RowBox[{"es", ",", "ay", ",", "ao"}], "]"}]], "]"}]}]], "Input",
 CellChangeTimes->{{3.50011871566383*^9, 3.5001187192399063`*^9}, {
  3.500118749446988*^9, 3.5001187498715553`*^9}, {3.50011898132974*^9, 
  3.500119107117433*^9}, {3.500120259137155*^9, 3.5001202933416452`*^9}, {
  3.500120354606805*^9, 3.500120418327129*^9}, {3.500126699926446*^9, 
  3.500126706681553*^9}, {3.500126764548074*^9, 3.500126768982004*^9}, {
  3.500126872493771*^9, 3.500126901933896*^9}, {3.5001280981944838`*^9, 
  3.5001280987513313`*^9}, {3.507218430517244*^9, 3.507218462584997*^9}, {
  3.507218821963867*^9, 3.507218824172164*^9}, {3.6245463303813953`*^9, 
  3.624546337421152*^9}}],

Cell[TextData[{
 StyleBox["- Differential equations for the patch frequencies\n",
  FontWeight->"Bold"],
 "Each event (switching, mortality of different types of breeders) is \
highlighted by an in-line comment. Table contains right hand side of \
differential equations:"
}], "Text",
 CellChangeTimes->{{3.592538865120399*^9, 3.592538880359948*^9}, {
  3.593443853610029*^9, 3.593443888705567*^9}, {3.5934439714013977`*^9, 
  3.593443992009426*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tablerecPlain", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"3", "-", "es"}], "]"}], " ", 
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"3", "-", "es"}], ",", 
         RowBox[{"1", "-", "ay"}], ",", 
         RowBox[{"1", "-", "ao"}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"s", "[", "es", "]"}], " ", 
       RowBox[{"f", "[", 
        RowBox[{"es", ",", "ay", ",", "ao"}], "]"}]}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "change", " ", "due", " ", "to", " ", "environmental", " ", 
        "switching"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ay", "+", "1"}], "<=", "1"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ay", "+", "1"}], ")"}], 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"(", 
              RowBox[{"ay", "+", "1"}], ")"}], ",", "ao"}], "]"}]}], ")"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", 
           RowBox[{"(", 
            RowBox[{"ay", "+", "1"}], ")"}], ",", "ao"}], "]"}]}], ",", "0"}],
        "]"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"mortality", " ", "adapted", " ", "juv"}], ",", " ", 
        RowBox[{
         RowBox[{
         "replaced", " ", "by", " ", "maladapted", " ", "juv", " ", "on", " ",
           "a", " ", "ay"}], "+", 
         RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ay", "-", "1"}], "\[GreaterEqual]", "0"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{"ay", "-", "1"}], ")"}]}], ")"}], 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", 
           RowBox[{"ay", "-", "1"}], ",", "ao"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", 
           RowBox[{"ay", "-", "1"}], ",", "ao"}], "]"}]}], ",", "0"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"mortality", " ", "maladapted", " ", "juv"}], ",", " ", 
        RowBox[{
         RowBox[{
         "replaced", " ", "by", " ", "adapted", " ", "juv", " ", "on", " ", 
          "a", " ", "ay"}], "-", 
         RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "-", 
      RowBox[{"ay", " ", 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "ay", ",", "ao"}], "]"}]}], ")"}], 
       RowBox[{"f", "[", 
        RowBox[{"es", ",", "ay", ",", "ao"}], "]"}]}], "\[IndentingNewLine]", 
      
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"mortality", " ", "adapted", " ", "juv"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "juv", " ", "on", " ", 
         "a", " ", "ay", " ", "patch"}]}], " ", "*)"}], "\[IndentingNewLine]",
       "-", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ay", "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "ay", ",", "ao"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "ay", ",", "ao"}], "]"}]}], ",", "0"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"mortality", " ", "maladapted", " ", "juv"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "adapted", " ", "juv", " ", "on", " ", 
         "a", " ", "ay", " ", "patch"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", 
         RowBox[{"seniors", "--"}]}], ">"}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ay", "<", "1"}], ",", 
        RowBox[{"ao", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", 
           RowBox[{"ay", "+", "1"}], ",", "ao"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"ay", "+", "1"}], ",", "ao"}], "]"}]}], ")"}]}], ",", 
        "0"}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "1.", " ", "death", " ", "adapted", " ", "senior", " ", "on", " ", 
         "a", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ay", "+", "1"}], ",", "ao"}], ")"}], " ", "patch"}], ",", 
        " ", 
        RowBox[{
        "replaced", " ", "by", " ", "an", " ", "adapted", " ", "juv", " ", 
         "and", " ", "a", " ", "maladapted", " ", "juv", " ", "is", " ", 
         "recruited", " ", "to", " ", "the", " ", "patch"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ao", "<", "1"}], "&&", 
         RowBox[{"ay", "<", "1"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ao", "+", "1"}], ")"}], " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "ay", ",", 
           RowBox[{"ao", "+", "1"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", "ay", ",", 
             RowBox[{"ao", "+", "1"}]}], "]"}]}], ")"}]}], ",", "0"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"2.", " ", "death", " ", "adapted", " ", "senior"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", "maladapted", " ", "juv"}], ",", 
        " ", 
        RowBox[{
         RowBox[{
         "replaced", " ", "by", " ", "maladapted", " ", "recruit", " ", "on", 
          " ", "a", " ", "ay"}], "-", "1"}], ",", 
        RowBox[{"a0", "+", 
         RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "-", 
      RowBox[{"ao", " ", 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
       RowBox[{"f", "[", 
        RowBox[{"es", ",", "ay", ",", "ao"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "ay", ",", "ao"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"1", "b"}], ",", 
        RowBox[{"2", 
         RowBox[{"b", ".", " ", "death"}], " ", "adapted", " ", "senior"}], 
        ",", " ", 
        RowBox[{"replaced", " ", "by", " ", "any", " ", "juv"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "recruit", " ", "on", 
         " ", "a", " ", "ay"}], ",", 
        RowBox[{"a0", " ", "patch"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ao", "<", "1"}], "&&", 
         RowBox[{"ay", ">", "0"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ao", "+", "1"}], ")"}], 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", 
           RowBox[{"ay", "-", "1"}], ",", 
           RowBox[{"ao", "+", "1"}]}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", 
           RowBox[{"ay", "-", "1"}], ",", 
           RowBox[{"ao", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "3.", " ", "death", " ", "adapted", " ", "senior", " ", "on", " ", 
         "a", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ao", "+", "1"}], ",", 
           RowBox[{"ay", "+", "1"}]}], ")"}], " ", "patch"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", "maladapted", " ", "juv"}], ",", 
        " ", 
        RowBox[{
        "who", " ", "itself", " ", "is", " ", "replaced", " ", "by", " ", 
         "adapted", " ", "recruit"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"4.", " ", "death", " ", "adapted", " ", "senior"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", "adapted", " ", "juv"}], ",", " ", 
        RowBox[{
        "who", " ", "itself", " ", "is", " ", "replaced", " ", "by", " ", 
         "adapted", " ", "recruit"}], ",", " ", 
        RowBox[{
         RowBox[{"no", " ", "change"}], "..."}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "-", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ay", "<", "1"}], ",", 
        RowBox[{"ao", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "ay", ",", "ao"}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "ay", ",", "ao"}], "]"}]}], ",", "0"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"3", 
         RowBox[{"b", ".", " ", "death"}], " ", "adapted", " ", "senior", " ",
          "on", " ", "a", " ", 
         RowBox[{"(", 
          RowBox[{"ao", ",", "ay"}], ")"}], " ", "patch"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", "maladapted", " ", "juv"}], ",", 
        " ", 
        RowBox[{
        "who", " ", "itself", " ", "is", " ", "replaced", " ", "by", " ", 
         "adapted", " ", "recruit"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ao", ">", "0"}], "&&", 
         RowBox[{"ay", ">", "0"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{"ao", "-", "1"}], ")"}]}], ")"}], 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "ay", ",", 
           RowBox[{"ao", "-", "1"}]}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "ay", ",", 
           RowBox[{"ao", "-", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "5.", " ", "death", " ", "maladapted", " ", "senior", " ", "on", " ", 
         "a", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ao", "-", "1"}], ",", "ay"}], ")"}], " ", "patch"}], ",", 
        " ", 
        RowBox[{"replaced", " ", "by", " ", "adapted", " ", "juv"}], ",", " ", 
        RowBox[{"adapted", " ", "juv", " ", "is", " ", "recruited"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ao", ">", "0"}], "&&", 
         RowBox[{"ay", "<", "1"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{"ao", "-", "1"}], ")"}]}], ")"}], 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", 
           RowBox[{"ay", "+", "1"}], ",", 
           RowBox[{"ao", "-", "1"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"ay", "+", "1"}], ",", 
             RowBox[{"ao", "-", "1"}]}], "]"}]}], ")"}]}], ",", "0"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "6.", " ", "death", " ", "maladapted", " ", "senior", " ", "on", " ", 
         "a", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ao", "-", "1"}], ",", 
           RowBox[{"ay", "+", "1"}]}], ")"}], " ", "patch"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", "adapted", " ", "juv"}], ",", " ", 
        RowBox[{"maladapted", " ", "juv", " ", "is", " ", "recruited"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ao", "\[Equal]", "0"}], "&&", 
         RowBox[{
          RowBox[{"ay", "-", "1"}], "\[Equal]", "0"}]}], ",", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", 
           RowBox[{"ay", "-", "1"}], ",", "ao"}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", 
           RowBox[{"ay", "-", "1"}], ",", "ao"}], "]"}]}], ",", "0"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "7.", " ", "death", " ", "maladapted", " ", "senior", " ", "on", " ", 
         "a", " ", 
         RowBox[{"(", 
          RowBox[{"ao", ",", 
           RowBox[{"ay", "-", "1"}]}], ")"}], " ", "patch"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", "maladapted", " ", "juv"}], ",", 
        " ", 
        RowBox[{"adapted", " ", "juv", " ", "is", " ", "recruited"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "-", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ao", "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "ay", ",", "ao"}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "ay", ",", "ao"}], "]"}]}], ",", "0"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"5", "b"}], ",", " ", 
        RowBox[{"7", 
         RowBox[{"b", ".", " ", "death"}], " ", "maladapted", " ", "senior"}],
         ",", " ", 
        RowBox[{"replaced", " ", "by", " ", "any", " ", 
         RowBox[{"juv", ".", " ", "adapted"}], " ", "juv", " ", "is", " ", 
         "recruited"}]}], " ", "*)"}], "\[IndentingNewLine]", "-", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ay", ">", "0"}], "&&", 
         RowBox[{"ao", "\[Equal]", "0"}]}], ",", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "ay", ",", "ao"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", "ay", ",", "ao"}], "]"}]}], ")"}]}], ",", 
        "0"}], "]"}]}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"6", 
        RowBox[{"b", ".", " ", "death"}], " ", "maladapted", " ", "senior"}], 
       ",", " ", 
       RowBox[{"replaced", " ", "by", " ", "adapted", " ", 
        RowBox[{"juv", ".", " ", "maladapted"}], " ", "juv", " ", "is", " ", 
        "recruited"}]}], " ", "*)"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ay", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ao", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.497725665398181*^9, 3.49772567455873*^9}, {
   3.500117613263631*^9, 3.500117643761853*^9}, {3.5001177516223183`*^9, 
   3.500117752501072*^9}, {3.500117857030566*^9, 3.5001178583488903`*^9}, {
   3.500118014156376*^9, 3.500118014555167*^9}, {3.500130682127385*^9, 
   3.500130682910915*^9}, {3.500130968751739*^9, 3.500130981782063*^9}, {
   3.5001310118326597`*^9, 3.5001310308665447`*^9}, {3.500132758531279*^9, 
   3.500132775509473*^9}, {3.500132946361661*^9, 3.5001329748220167`*^9}, {
   3.500133041546383*^9, 3.5001330657380753`*^9}, {3.500133148259763*^9, 
   3.500133160687606*^9}, {3.5001331990639763`*^9, 3.5001332041244717`*^9}, {
   3.500133307447483*^9, 3.5001333237167377`*^9}, {3.5001333725271587`*^9, 
   3.500133372617695*^9}, {3.500133404973748*^9, 3.50013341486411*^9}, {
   3.500133481452409*^9, 3.500133576453206*^9}, {3.500133771813458*^9, 
   3.500133812116024*^9}, 3.5001338580403643`*^9, {3.500137409431617*^9, 
   3.500137429291832*^9}, {3.500192977665819*^9, 3.500192977715926*^9}, {
   3.500732820820187*^9, 3.500732826027463*^9}, {3.5007330519650593`*^9, 
   3.500733052006358*^9}, {3.501861096205023*^9, 3.501861098564929*^9}, {
   3.5018611968794737`*^9, 3.501861214539522*^9}, {3.503234220521749*^9, 
   3.5032342488826036`*^9}, {3.520244802903954*^9, 3.520244815359407*^9}, {
   3.59253889449739*^9, 3.592538895255055*^9}, {3.592542374414714*^9, 
   3.592542378840889*^9}, {3.6245463504918337`*^9, 3.6245464498498783`*^9}, {
   3.624546486589506*^9, 3.624546715593821*^9}, {3.624546754295277*^9, 
   3.624546789414509*^9}, {3.624546937555111*^9, 3.624547001003759*^9}, {
   3.6245471123311443`*^9, 3.624547204240971*^9}, {3.6245472561462793`*^9, 
   3.62454744638103*^9}, {3.6245475241294603`*^9, 3.6245480382306967`*^9}, {
   3.624548102249157*^9, 3.624548160174118*^9}, {3.6245482171243258`*^9, 
   3.624548335245611*^9}, {3.624548618580517*^9, 3.624548619162788*^9}, {
   3.624548804691573*^9, 3.624548827410243*^9}, {3.6245488710396347`*^9, 
   3.6245490756012373`*^9}, {3.624563598057946*^9, 3.6245635994757853`*^9}, {
   3.624563644230484*^9, 3.624563790441902*^9}, {3.6245638594883003`*^9, 
   3.624563956695161*^9}, {3.624564020282696*^9, 3.624564043138713*^9}, {
   3.624564079597198*^9, 3.624564112556456*^9}, {3.6245648772000017`*^9, 
   3.624564877671496*^9}, {3.6327601909253883`*^9, 3.6327602105992002`*^9}, {
   3.6327603967975607`*^9, 3.632760495841814*^9}, {3.632760530853065*^9, 
   3.6327605500266933`*^9}, {3.632760636794973*^9, 3.6327607602142982`*^9}, {
   3.63276088898582*^9, 3.6327609353951187`*^9}, {3.632760989457102*^9, 
   3.6327609995336647`*^9}, {3.6327610332380447`*^9, 3.632761176776244*^9}, {
   3.632761300760806*^9, 3.632761324763276*^9}, {3.6333455995760717`*^9, 
   3.633345636240859*^9}, {3.633346401201919*^9, 3.6333464166681137`*^9}, {
   3.633346544222745*^9, 3.6333465856324577`*^9}, {3.633346660764536*^9, 
   3.633346669725545*^9}, {3.633346874704748*^9, 3.633346969846156*^9}, {
   3.633347145939023*^9, 3.633347214940797*^9}, {3.6333473988862257`*^9, 
   3.633347437302497*^9}, {3.6333474696784286`*^9, 3.633347549459969*^9}, {
   3.633347601040627*^9, 3.633347746808681*^9}, {3.6333480343560677`*^9, 
   3.633348035407269*^9}, {3.633348113703785*^9, 3.6333481314926643`*^9}, {
   3.633348996478868*^9, 3.633349039883244*^9}, {3.6333491074416656`*^9, 
   3.6333492877323723`*^9}, {3.6333516411575727`*^9, 3.633351648828557*^9}, {
   3.6333519232042913`*^9, 3.633351943903289*^9}, {3.633352183728294*^9, 
   3.6333521983484497`*^9}, {3.633352284537024*^9, 3.633352308801445*^9}, {
   3.633352368449888*^9, 3.633352423656213*^9}, {3.6333524860542507`*^9, 
   3.6333525582999077`*^9}, {3.6333529252940083`*^9, 3.633352960200245*^9}, {
   3.633353158779869*^9, 3.6333531915246487`*^9}, {3.633353509917461*^9, 
   3.633353514830534*^9}, {3.6333538062034283`*^9, 3.6333538177290583`*^9}, {
   3.633353866671953*^9, 3.633353877589164*^9}, {3.633354091906773*^9, 
   3.63335412883222*^9}, {3.633354202431897*^9, 3.633354254790245*^9}, {
   3.6333543309637527`*^9, 3.633354336150237*^9}, {3.633354494041259*^9, 
   3.633354584873611*^9}, {3.6333546273579073`*^9, 3.633354646570107*^9}, {
   3.63335477967208*^9, 3.633354780376522*^9}, {3.633354852555421*^9, 
   3.633354965374461*^9}, {3.633355108361554*^9, 3.633355109780862*^9}, {
   3.633355148477622*^9, 3.633355210720169*^9}, {3.633355676782661*^9, 
   3.633355708605076*^9}, {3.633355884529076*^9, 3.6333559143181*^9}, {
   3.633356697790409*^9, 3.633356698792695*^9}, {3.6333573655400867`*^9, 
   3.633357365667131*^9}, {3.6333581846364202`*^9, 3.633358196175681*^9}, {
   3.633362457923934*^9, 3.633362459625742*^9}, {3.6333634042294903`*^9, 
   3.633363430553783*^9}, {3.6333636052774887`*^9, 3.633363646134687*^9}, {
   3.6333638214731913`*^9, 3.633363849406864*^9}, {3.633364076193315*^9, 
   3.6333640880352087`*^9}, {3.6333641266000633`*^9, 3.633364142668633*^9}, {
   3.633373842576868*^9, 3.633373862444551*^9}, {3.633408104677956*^9, 
   3.633408148071944*^9}, 3.633408906683113*^9}],

Cell["\<\
Table specification for numerical solving:\
\>", "Text",
 CellChangeTimes->{{3.593443894024782*^9, 3.593443905705183*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"freqs", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"es", ",", "ay", ",", "ao"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ay", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ao", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.624566022494656*^9, 3.624566032992477*^9}, {
  3.6245660837364683`*^9, 3.6245660848200397`*^9}, {3.633356725056692*^9, 
  3.633356725272377*^9}, {3.633357385689083*^9, 3.633357386433269*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.624566377915707*^9, 3.62456640484254*^9}, 
   3.633356522125409*^9, 3.633356713568221*^9, 3.633356750925523*^9, 
   3.6333568268147383`*^9, {3.633357143087748*^9, 3.6333571707759523`*^9}, 
   3.633357397497179*^9, 3.633358738307631*^9, 3.633362478902813*^9, 
   3.633364727617895*^9, 3.633373883006713*^9, 3.6334072663055153`*^9, 
   3.633408276935535*^9, 3.633411944628881*^9, 3.6335012105929947`*^9, 
   3.6335023120775557`*^9, 3.633514889904808*^9, 3.6335172786254883`*^9, 
   3.633530747487797*^9, 3.633839962319256*^9, 3.633841466751667*^9, 
   3.633894729847809*^9, 3.633895578676937*^9, 3.633896359312992*^9, 
   3.6339482577965937`*^9, 3.633952498351194*^9, 3.633952579602009*^9, 
   3.633954809229621*^9, 3.633954953125231*^9, 3.6339552329681883`*^9, 
   3.633955591430678*^9, 3.6339570752970343`*^9, 3.633959163326357*^9, 
   3.633959243338642*^9, 3.633960438148445*^9, 3.633964694872342*^9, 
   3.633964785788954*^9, 3.633965060227849*^9, 3.63490353122194*^9, 
   3.6349036590840893`*^9, 3.634976880021796*^9, 3.635072848662421*^9, 
   3.6350744855922613`*^9, 3.635074807834166*^9, 3.6350753381212187`*^9, 
   3.6354147185081577`*^9, 3.635415266473997*^9, 3.6354894228414497`*^9, 
   3.635582938589542*^9, 3.6355830423206587`*^9, 3.6355870807104483`*^9, 
   3.6355876216748133`*^9, 3.6367029139549*^9, 3.636705160469049*^9, 
   3.636707969008628*^9, 3.636724339701313*^9, 3.63672486085892*^9, 
   3.6367263050493*^9, 3.636726749406497*^9, 3.636728164732337*^9, 
   3.6367284050132027`*^9, 3.636728486643112*^9, 3.636792386785972*^9, 
   3.6368665624118958`*^9, 3.639394570229022*^9, 3.639394697681387*^9, 
   3.639818865640039*^9, 3.639819408560824*^9}],

Cell["For testing only:", "Text",
 CellChangeTimes->{{3.633408750679596*^9, 3.633408779798976*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"freqsubs", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", "\[Rule]", 
        RowBox[{"1", "/", 
         RowBox[{"Length", "[", "freqs", "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "freqs"}], "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.624566321481435*^9, 3.624566343187818*^9}, {
   3.624566399412343*^9, 3.624566400579773*^9}, 3.6334087336065903`*^9}]
}, Open  ]],

Cell["\<\
Generate recursions for iterations\
\>", "Text",
 CellChangeTimes->{{3.633954821138031*^9, 3.633954824578179*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tablerec", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"H", "\[Equal]", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"H", ",", 
        RowBox[{"Flatten", "[", "tablerecPlain", "]"}]}], "}"}]}], "]"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5032342341741734`*^9, 3.503234266926181*^9}, {
  3.503247680722105*^9, 3.503247687323996*^9}, {3.503247759915304*^9, 
  3.503247762951304*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"feqtab", "=", 
   RowBox[{"Flatten", "[", "tablerec", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.633357202807633*^9, 3.633357216478709*^9}}],

Cell["\<\
Add the constraint sum(f(i,j,k))=1 at different positions in the table of \
differential equations (different positions faciliates error checking)\
\>", "Text",
 CellChangeTimes->{{3.6334088244283323`*^9, 3.633408880634452*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"feqtab", "=", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", "tablerec", "]"}], ",", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "ay", ",", "ao"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ay", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"ao", ",", "0", ",", "1"}], "}"}]}], "]"}], "\[Equal]", 
       "1"}], ",", "1"}], "]"}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"feqtabalt", "=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "tablerec", "]"}], ",", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"es", ",", "ay", ",", "ao"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ay", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"ao", ",", "0", ",", "1"}], "}"}]}], "]"}], "\[Equal]", 
      "1"}], ",", "3"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.500137431453726*^9, 3.500137463701515*^9}, {
  3.590817338397416*^9, 3.590817338508321*^9}, {3.624565951476514*^9, 
  3.624565972839903*^9}, {3.633356733457114*^9, 3.6333567349381742`*^9}, {
  3.633357133720495*^9, 3.633357136429587*^9}, {3.633357370509858*^9, 
  3.6333573800359783`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"feqtabPlain", "=", 
   RowBox[{
    RowBox[{"Flatten", "[", "tablerecPlain", "]"}], "/.", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
     RowBox[{"1", "-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"freqs", "[", 
         RowBox[{"[", "xi", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"xi", ",", "2", ",", 
          RowBox[{"Length", "[", "freqs", "]"}]}], "}"}]}], "]"}]}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.503234279738905*^9, 3.5032343436360292`*^9}, {
   3.51938949377985*^9, 3.519389511821157*^9}, {3.519389622676245*^9, 
   3.519389655947711*^9}, {3.520253572315612*^9, 3.520253574751763*^9}, 
   3.62456597838509*^9, {3.633356736168994*^9, 3.6333567363601007`*^9}, {
   3.633357372209879*^9, 3.633357372377946*^9}, {3.633954765492325*^9, 
   3.6339547841470327`*^9}, {3.6339548393031*^9, 3.633954869126199*^9}}],

Cell["\<\
For numerical solving, make a table with the starting values of all the \
frequencies:\
\>", "Text",
 CellChangeTimes->{{3.633408761704187*^9, 3.633408776183326*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frootstartvals", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"1.0", "/", 
        RowBox[{"Length", "[", "freqs", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "freqs"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.501861533592969*^9, 3.501861653264894*^9}, {
   3.5018617247356167`*^9, 3.501861876017569*^9}, {3.501861977500671*^9, 
   3.501862034852276*^9}, {3.501862081796956*^9, 3.5018620886297607`*^9}, {
   3.624565983043993*^9, 3.62456601249848*^9}, {3.624566090215023*^9, 
   3.624566095591732*^9}, 3.6334087267506227`*^9}],

Cell[TextData[StyleBox["- Numerically solve for the equilibrium patch \
frequencies",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.592543108024868*^9, 3.592543126136325*^9}, {
  3.593443910410306*^9, 3.593443910521289*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ans1", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
     RowBox[{"{", "m_", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p10s_", ",", "p20s_", ",", "p11s_", ",", "p21s_"}], "}"}], ",",
      "ks_", ",", "Qs_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{"feqtab", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
        RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
        RowBox[{"k", "\[Rule]", "ks"}], ",", 
        RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
        RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
        RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
        RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
        RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
        RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
        RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
        RowBox[{"mt", "\[Rule]", "m"}], ",", 
        RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
        RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
        RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
        RowBox[{"p21", "\[Rule]", "p21s"}]}], "}"}]}], ",", 
     "frootstartvals"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.497727309947049*^9, {3.4977274499343033`*^9, 3.4977274554810753`*^9}, {
   3.497727542910244*^9, 3.497727564845056*^9}, 3.497731404139268*^9, {
   3.500136022461656*^9, 3.5001360651617203`*^9}, {3.500136107964839*^9, 
   3.5001361178544693`*^9}, {3.500136168298623*^9, 3.500136171192801*^9}, {
   3.500136226922933*^9, 3.500136236150736*^9}, {3.500136382914144*^9, 
   3.5001363834540253`*^9}, 3.5001365520437107`*^9, {3.5001366530355577`*^9, 
   3.500136672281103*^9}, {3.500136703690104*^9, 3.5001367436671047`*^9}, {
   3.500137064431172*^9, 3.500137084372213*^9}, {3.500137506604393*^9, 
   3.500137521481576*^9}, {3.500137577253257*^9, 3.500137620562414*^9}, {
   3.500138253541423*^9, 3.500138292548037*^9}, {3.5001383371273537`*^9, 
   3.5001383946806183`*^9}, {3.5001385957662697`*^9, 3.50013875313482*^9}, {
   3.500139018540197*^9, 3.500139046280306*^9}, {3.501862116832633*^9, 
   3.5018621477327423`*^9}, {3.505129786476176*^9, 3.50512979545977*^9}, {
   3.505130396736271*^9, 3.505130403469315*^9}, {3.505133566876094*^9, 
   3.5051337047295*^9}, {3.505133939247291*^9, 3.505133966224418*^9}, {
   3.505134048274804*^9, 3.505134112717098*^9}, {3.505134277245621*^9, 
   3.505134289377655*^9}, {3.505134391490318*^9, 3.505134403065894*^9}, {
   3.508161024692579*^9, 3.508161040735461*^9}, {3.520242615818755*^9, 
   3.520242618482863*^9}, {3.520242802887409*^9, 3.520242810353731*^9}, {
   3.52455396640682*^9, 3.524553988441077*^9}, {3.592542961010631*^9, 
   3.5925429876260843`*^9}, 3.592543052726901*^9, {3.592543085831949*^9, 
   3.59254308655621*^9}, {3.624566106569483*^9, 3.624566196405426*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ans1alt", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
     RowBox[{"{", "m_", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p10s_", ",", "p20s_", ",", "p11s_", ",", "p21s_"}], "}"}], ",",
      "ks_", ",", "Qs_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{"feqtabalt", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
        RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
        RowBox[{"k", "\[Rule]", "ks"}], ",", 
        RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
        RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
        RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
        RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
        RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
        RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
        RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
        RowBox[{"mt", "\[Rule]", "m"}], ",", 
        RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
        RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
        RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
        RowBox[{"p21", "\[Rule]", "p21s"}]}], "}"}]}], ",", 
     "frootstartvals"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.497727309947049*^9, {3.4977274499343033`*^9, 3.4977274554810753`*^9}, {
   3.497727542910244*^9, 3.497727564845056*^9}, 3.497731404139268*^9, {
   3.500136022461656*^9, 3.5001360651617203`*^9}, {3.500136107964839*^9, 
   3.5001361178544693`*^9}, {3.500136168298623*^9, 3.500136171192801*^9}, {
   3.500136226922933*^9, 3.500136236150736*^9}, {3.500136382914144*^9, 
   3.5001363834540253`*^9}, 3.5001365520437107`*^9, {3.5001366530355577`*^9, 
   3.500136672281103*^9}, {3.500136703690104*^9, 3.5001367436671047`*^9}, {
   3.500137064431172*^9, 3.500137084372213*^9}, {3.500137506604393*^9, 
   3.500137521481576*^9}, {3.500137577253257*^9, 3.500137620562414*^9}, {
   3.500138253541423*^9, 3.500138292548037*^9}, {3.5001383371273537`*^9, 
   3.5001383946806183`*^9}, {3.5001385957662697`*^9, 3.50013875313482*^9}, {
   3.500139018540197*^9, 3.500139046280306*^9}, {3.501862116832633*^9, 
   3.5018621477327423`*^9}, {3.505129786476176*^9, 3.50512979545977*^9}, {
   3.505130396736271*^9, 3.505130403469315*^9}, {3.505133566876094*^9, 
   3.5051337047295*^9}, {3.505133939247291*^9, 3.505133966224418*^9}, {
   3.505134048274804*^9, 3.505134112717098*^9}, {3.505134277245621*^9, 
   3.505134289377655*^9}, {3.505134391490318*^9, 3.505134403065894*^9}, {
   3.508161024692579*^9, 3.508161040735461*^9}, {3.520242615818755*^9, 
   3.520242618482863*^9}, {3.520242802887409*^9, 3.520242810353731*^9}, {
   3.52455396640682*^9, 3.524553988441077*^9}, {3.592542961010631*^9, 
   3.5925429876260843`*^9}, 3.592543052726901*^9, {3.592543085831949*^9, 
   3.59254308655621*^9}, {3.624566106569483*^9, 3.624566196405426*^9}, {
   3.6245664227362833`*^9, 3.624566426135213*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans1test", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "m_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p10s_", ",", "p20s_", ",", "p11s_", ",", "p21s_"}], "}"}], ",", 
    "ks_", ",", "Qs_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"feqtab", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
      RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
      RowBox[{"k", "\[Rule]", "ks"}], ",", 
      RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
      RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
      RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
      RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
      RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
      RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
      RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
      RowBox[{"mt", "\[Rule]", "m"}], ",", 
      RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
      RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
      RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
      RowBox[{"p21", "\[Rule]", "p21s"}]}], "}"}]}], "/.", 
   "freqsubs"}]}]], "Input",
 CellChangeTimes->{
  3.497727309947049*^9, {3.4977274499343033`*^9, 3.4977274554810753`*^9}, {
   3.497727542910244*^9, 3.497727564845056*^9}, 3.497731404139268*^9, {
   3.500136022461656*^9, 3.5001360651617203`*^9}, {3.500136107964839*^9, 
   3.5001361178544693`*^9}, {3.500136168298623*^9, 3.500136171192801*^9}, {
   3.500136226922933*^9, 3.500136236150736*^9}, {3.500136382914144*^9, 
   3.5001363834540253`*^9}, 3.5001365520437107`*^9, {3.5001366530355577`*^9, 
   3.500136672281103*^9}, {3.500136703690104*^9, 3.5001367436671047`*^9}, {
   3.500137064431172*^9, 3.500137084372213*^9}, {3.500137506604393*^9, 
   3.500137521481576*^9}, {3.500137577253257*^9, 3.500137620562414*^9}, {
   3.500138253541423*^9, 3.500138292548037*^9}, {3.5001383371273537`*^9, 
   3.5001383946806183`*^9}, {3.5001385957662697`*^9, 3.50013875313482*^9}, {
   3.500139018540197*^9, 3.500139046280306*^9}, {3.501862116832633*^9, 
   3.5018621477327423`*^9}, {3.505129786476176*^9, 3.50512979545977*^9}, {
   3.505130396736271*^9, 3.505130403469315*^9}, {3.505133566876094*^9, 
   3.5051337047295*^9}, {3.505133939247291*^9, 3.505133966224418*^9}, {
   3.505134048274804*^9, 3.505134112717098*^9}, {3.505134277245621*^9, 
   3.505134289377655*^9}, {3.505134391490318*^9, 3.505134403065894*^9}, {
   3.508161024692579*^9, 3.508161040735461*^9}, {3.520242615818755*^9, 
   3.520242618482863*^9}, {3.520242802887409*^9, 3.520242810353731*^9}, {
   3.52455396640682*^9, 3.524553988441077*^9}, {3.592542961010631*^9, 
   3.5925429876260843`*^9}, 3.592543052726901*^9, {3.592543085831949*^9, 
   3.59254308655621*^9}, {3.624566106569483*^9, 3.624566196405426*^9}, {
   3.6245663049273033`*^9, 3.6245663157991343`*^9}, {3.633357025624111*^9, 
   3.6333570271555147`*^9}, {3.6333572339794893`*^9, 3.633357234509203*^9}, {
   3.633357277434085*^9, 3.633357280681394*^9}, {3.633357406501759*^9, 
   3.633357408505312*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ans1test", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.1", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.1", ",", "0.2", ",", "0.9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3", ",", "0.5", ",", "0.4", ",", "0.8"}], "}"}], ",", "0.1", 
   ",", "0.005"}], "]"}]], "Input",
 CellChangeTimes->{{3.508161640641067*^9, 3.508161641073309*^9}, {
   3.508161752322453*^9, 3.508161765951121*^9}, {3.508161799901812*^9, 
   3.508161800462989*^9}, {3.514211189150174*^9, 3.514211207453239*^9}, {
   3.524554160262734*^9, 3.524554164750863*^9}, {3.5908173106268053`*^9, 
   3.5908173275139637`*^9}, {3.590823477424436*^9, 3.5908235383263607`*^9}, {
   3.590823850204959*^9, 3.590823871661927*^9}, {3.59125483045569*^9, 
   3.591254834448448*^9}, {3.592543063033259*^9, 3.59254307403925*^9}, {
   3.608820230181753*^9, 3.60882023041466*^9}, {3.624566280173896*^9, 
   3.6245662924574623`*^9}, {3.624566350014112*^9, 3.6245663511404057`*^9}, {
   3.624566413301125*^9, 3.62456641370152*^9}, {3.6333568372755623`*^9, 
   3.633356838466564*^9}, {3.633356929184057*^9, 3.63335693074203*^9}, {
   3.633356965421351*^9, 3.6333570097303677`*^9}, {3.6333570414180183`*^9, 
   3.633357045697485*^9}, {3.6333571005266533`*^9, 3.6333571090861597`*^9}, 
   3.633357153052079*^9, {3.633357237616396*^9, 3.6333572978678017`*^9}, 
   3.633357414375671*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "True", ",", "False", ",", "False", ",", "False", ",", "False", ",", 
   "False", ",", "False", ",", "False"}], "}"}]], "Output",
 CellChangeTimes->{{3.608820225915379*^9, 3.608820234124021*^9}, 
   3.608820321494277*^9, 3.6088205280135927`*^9, {3.624566275478856*^9, 
   3.624566297093624*^9}, {3.6245663520456123`*^9, 3.624566414868355*^9}, 
   3.633356522439898*^9, 3.633356714237911*^9, 3.6333567512429867`*^9, {
   3.633356827122617*^9, 3.633356838977797*^9}, 3.633356931234977*^9, {
   3.633356967953965*^9, 3.633357046170803*^9}, {3.633357102995459*^9, 
   3.6333571094855423`*^9}, {3.633357143323189*^9, 3.63335717115199*^9}, {
   3.633357220681237*^9, 3.6333572983029423`*^9}, {3.633357397985079*^9, 
   3.633357414721691*^9}, 3.6333587385877953`*^9, 3.6333624791886587`*^9, 
   3.63336472789504*^9, 3.6333738833244543`*^9, 3.633407266488043*^9, {
   3.6334082656503696`*^9, 3.6334082771803913`*^9}, 3.633411944770691*^9, 
   3.633501210771783*^9, 3.63350231215099*^9, 3.633514890081403*^9, 
   3.633517278820489*^9, 3.633530747588039*^9, 3.633839962370387*^9, 
   3.6338414668412867`*^9, 3.633894729926079*^9, 3.633895578758144*^9, 
   3.63389635937958*^9, 3.6339482578671618`*^9, 3.633952498418766*^9, 
   3.633952579698701*^9, 3.633954953289915*^9, 3.633955233132275*^9, 
   3.633955591580524*^9, 3.633957075451124*^9, 3.633959163503313*^9, 
   3.6339592434624166`*^9, 3.633960438250657*^9, 3.6339646949779387`*^9, 
   3.6339647859008617`*^9, 3.633965060315456*^9, 3.6349035313231297`*^9, 
   3.634903659164123*^9, 3.6349768801930933`*^9, 3.635072848793394*^9, 
   3.635074485676744*^9, 3.6350748079114656`*^9, 3.635075338265267*^9, 
   3.635414718612035*^9, 3.635415266584056*^9, 3.635489422973316*^9, 
   3.635582938695664*^9, 3.635583042430614*^9, 3.63558708079939*^9, 
   3.635587621760706*^9, 3.636702914024858*^9, 3.6367051605538797`*^9, 
   3.636707969197899*^9, 3.636724339776671*^9, 3.63672486094862*^9, 
   3.636726305245225*^9, 3.63672674972781*^9, 3.636728164899879*^9, 
   3.636728405109777*^9, 3.6367284867597103`*^9, 3.636792386940283*^9, 
   3.636866562533434*^9, 3.639394570388603*^9, 3.639394697784617*^9, 
   3.639818865765889*^9, 3.639819408680606*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ans1", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.00317", ",", "0.3146"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.5", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", "0.10", 
   ",", ".05"}], "]"}]], "Input",
 CellChangeTimes->{{3.633357428118154*^9, 3.633357428397154*^9}, {
  3.633364738270323*^9, 3.633364791399805*^9}, {3.633408288957891*^9, 
  3.6334083783293877`*^9}, {3.633952735925929*^9, 3.633952802899127*^9}, {
  3.636705971641831*^9, 3.636705973227478*^9}, {3.636706055286376*^9, 
  3.636706061619761*^9}, {3.639818873468268*^9, 3.639818876050308*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.11047327180807083`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.2930772985112896`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.14714331098026956`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.43933035006267607`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.0015970050248431122`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.00266855967798775`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.001938941563618582`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.0037712623712444354`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6339527468482313`*^9, 3.633952803401552*^9}, 
   3.633954953395426*^9, 3.633955233196557*^9, 3.633955591706065*^9, 
   3.633957075524078*^9, 3.633959163657691*^9, 3.633959243578403*^9, 
   3.633960438340467*^9, 3.633964695059414*^9, 3.633964785998795*^9, 
   3.63396506039686*^9, 3.634903531434355*^9, 3.634903659246484*^9, 
   3.634976880333062*^9, 3.635072848885028*^9, 3.635074485754931*^9, 
   3.635074807986115*^9, 3.635075338356771*^9, 3.635414718697218*^9, 
   3.635415266661888*^9, 3.635489423077305*^9, 3.635582938737583*^9, 
   3.635583042500847*^9, 3.635587080861451*^9, 3.6355876218311853`*^9, 
   3.63670291411196*^9, 3.636705160629362*^9, 3.6367059802333593`*^9, {
   3.636706055891824*^9, 3.636706062397479*^9}, 3.636707969267685*^9, 
   3.636724339835237*^9, 3.63672486099973*^9, 3.6367263053574*^9, 
   3.63672674984756*^9, 3.636728164998814*^9, 3.636728405181733*^9, 
   3.6367284868620987`*^9, 3.636792387042954*^9, 3.636866562644149*^9, 
   3.63939457047578*^9, 3.639394697861053*^9, {3.6398188658540983`*^9, 
   3.639818876579862*^9}, 3.639819408759817*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ans1alt", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.00317", ",", "0.3146"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.5", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", "0.10", 
   ",", ".05"}], "]"}]], "Input",
 CellChangeTimes->{{3.624566432259706*^9, 3.624566432538784*^9}, {
  3.633364748618478*^9, 3.633364787464581*^9}, {3.633408291430279*^9, 
  3.633408319668769*^9}, {3.633408353755727*^9, 3.633408380328986*^9}, {
  3.635489397804418*^9, 3.6354894000506268`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.11047327180807073`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.29307729851128955`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.14714331098026948`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.43933035006267596`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.0015970050248431261`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.002668559677987861`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.0019389415636186236`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.0037712623712445603`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.624566433107733*^9, 3.6333565312914133`*^9, 3.633356714313772*^9, 
   3.633356827258854*^9, {3.633357147767859*^9, 3.633357171323167*^9}, 
   3.633357420777894*^9, 3.633358738743458*^9, 3.633362484811409*^9, {
   3.633364728058962*^9, 3.63336478796841*^9}, 3.633373883520163*^9, 
   3.633407273872444*^9, {3.63340826577818*^9, 3.633408320211246*^9}, {
   3.633408354554685*^9, 3.633408381009892*^9}, 3.633411944926586*^9, 
   3.633501211041664*^9, 3.633502312274685*^9, 3.6335148902306833`*^9, 
   3.6335172792753067`*^9, 3.633530747734037*^9, 3.6338399625466747`*^9, 
   3.633841467035836*^9, 3.633894730071151*^9, 3.633895578944901*^9, 
   3.633896359543211*^9, 3.633948258070133*^9, 3.633952498598536*^9, 
   3.633952579908063*^9, 3.6339549535275373`*^9, 3.6339552332545433`*^9, 
   3.633955591774105*^9, 3.63395707556488*^9, 3.633959163821006*^9, 
   3.63395924363839*^9, 3.633960438405077*^9, 3.633964695167152*^9, 
   3.633964786048378*^9, 3.63396506051099*^9, 3.634903531477365*^9, 
   3.634903659339591*^9, 3.634976880389792*^9, 3.6350728489399347`*^9, 
   3.6350744858077*^9, 3.6350748080679207`*^9, 3.6350753384620447`*^9, 
   3.635414718755025*^9, 3.635415266721222*^9, 3.635489423120756*^9, 
   3.6355829388042593`*^9, 3.635583042543714*^9, 3.63558708092432*^9, 
   3.635587621873444*^9, 3.636702914182293*^9, 3.63670516072252*^9, 
   3.636707969331916*^9, 3.636724339886798*^9, 3.636724861053261*^9, 
   3.636726305443227*^9, 3.636726749929055*^9, 3.6367281650935087`*^9, 
   3.636728405220808*^9, 3.636728486909401*^9, 3.636792387090354*^9, 
   3.636866562706407*^9, 3.639394570546426*^9, 3.639394697915753*^9, 
   3.6398188659192457`*^9, 3.63981940880346*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reproductive values", "Section"],

Cell["\<\
Offspring production (adapted, or maladapted) by breeders other than focal:\
\>", "Text",
 CellChangeTimes->{{3.633502006323659*^9, 3.633502023368882*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"adotherjuv", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"dispad", "[", "es", "]"}], 
   RowBox[{"localcomptotal", "[", 
    RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"madotherjuv", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"dispmad", "[", "es", "]"}], 
   RowBox[{"localcomptotal", "[", 
    RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}]]}]}], "Input",
 CellChangeTimes->{{3.633501670161281*^9, 3.633501678106861*^9}, {
  3.633501801679626*^9, 3.6335018165560217`*^9}, {3.6335018530246983`*^9, 
  3.633501899427931*^9}, {3.633501960039475*^9, 3.63350199643281*^9}, {
  3.63350203302719*^9, 3.633502046065723*^9}, {3.633502116617215*^9, 
  3.633502121965958*^9}, {3.639817652522341*^9, 3.6398176580872602`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"adothersen", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"dispad", "[", "es", "]"}], 
   RowBox[{"localcomptotal", "[", 
    RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"madothersen", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"dispmad", "[", "es", "]"}], 
   RowBox[{"localcomptotal", "[", 
    RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}]]}]}], "Input",
 CellChangeTimes->{{3.633501670161281*^9, 3.633501678106861*^9}, {
  3.633501801679626*^9, 3.6335018165560217`*^9}, {3.6335018530246983`*^9, 
  3.633501899427931*^9}, {3.633501960039475*^9, 3.63350199643281*^9}, {
  3.63350203302719*^9, 3.633502046065723*^9}, {3.633502106686488*^9, 
  3.6335021327235947`*^9}, {3.63350223193182*^9, 3.633502269623418*^9}, {
  3.635075134826212*^9, 3.6350751397714853`*^9}, {3.639817661100219*^9, 
  3.639817664336442*^9}}],

Cell["Reproductive values for juveniles:", "Text",
 CellChangeTimes->{{3.633408799390526*^9, 3.633408803925744*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvjdt", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", "es", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vj", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", 
           RowBox[{"1", "-", "aself"}], ",", 
           RowBox[{"1", "-", "asenior"}]}], "]"}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"environmental", " ", "change"}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", 
            RowBox[{"1", "-", "aself"}], ",", "asenior"}], "]"}]}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "juvenile"}], ",", " ", 
        RowBox[{
        "focal", " ", "junior", " ", "is", " ", "the", " ", "mother", " ", 
         "of", " ", "the", " ", "successful", " ", "offspring"}], ",", " ", 
        RowBox[{
        "who", " ", "is", " ", "of", " ", "a", " ", "different", " ", 
         "type"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "juvenile"}], ",", " ", 
        RowBox[{
        "focal", " ", "junior", " ", "is", " ", "the", " ", "mother", " ", 
         "of", " ", "the", " ", "successful", " ", "offspring"}], ",", " ", 
        RowBox[{
        "who", " ", "is", " ", "of", " ", "the", " ", "same", " ", "type"}]}],
        " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"aself", "\[Equal]", "asenior"}], ",", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], ",", 
           RowBox[{"1", "-", 
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}]}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", 
            RowBox[{"1", "-", "aself"}], ",", "asenior"}], "]"}]}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "juvenile"}], ",", " ", 
        RowBox[{
        "focal", " ", "junior", " ", "is", " ", "the", " ", "father", " ", 
         "of", " ", "the", " ", "successful", " ", "offspring"}], ",", " ", 
        RowBox[{
        "the", " ", "new", " ", "offspring", " ", "is", " ", "of", " ", "a", 
         " ", "different", " ", "type", " ", "than", " ", "the", " ", 
         "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"aself", "\[Equal]", "asenior"}], ",", 
           RowBox[{"1", "-", 
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}], ",", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "juvenile"}], ",", " ", 
        RowBox[{
        "focal", " ", "junior", " ", "is", " ", "the", " ", "father", " ", 
         "of", " ", "the", " ", "successful", " ", "offspring"}], ",", " ", 
        RowBox[{
        "the", " ", "new", " ", "offspring", " ", "is", " ", "of", " ", "the",
          " ", "same", " ", "type", " ", "as", " ", "the", " ", "focal"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dispad", "[", "es", "]"}], "+", 
           RowBox[{"dispmad", "[", "es", "]"}]}], ")"}], "/", 
         RowBox[{"localcomptotal", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "juvenile"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", "nonfocal", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"i", ".", "e", "."}], ",", " ", 
           RowBox[{"immigrant", " ", "offspring"}]}], " "}]}]}], "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "aself"}], "]"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", "aself", ",", "aself"}], "]"}]}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"senior", " ", "dies"}], ",", " ", 
        RowBox[{"focal", " ", "takes", " ", "over"}], ",", " ", 
        RowBox[{
         RowBox[{"focal", "'"}], "s", " ", "place", " ", "is", " ", "taken", 
         " ", "by", " ", "offspring", " ", "mothered", " ", "by", " ", 
         "focal"}], ",", " ", 
        RowBox[{
        "of", " ", "the", " ", "same", " ", "type", " ", "as", " ", 
         "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"aself", "\[Equal]", "asenior"}], ",", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}], ")"}], ",", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "aself"}], "]"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", "aself", ",", "aself"}], "]"}]}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"senior", " ", "dies"}], ",", " ", 
        RowBox[{"focal", " ", "takes", " ", "over"}], ",", " ", 
        RowBox[{
         RowBox[{"focal", "'"}], "s", " ", "place", " ", "is", " ", "taken", 
         " ", "by", " ", "offspring", " ", "mothered", " ", "by", " ", 
         "senior"}], ",", " ", 
        RowBox[{
        "of", " ", "the", " ", "same", " ", "type", " ", "as", " ", 
         "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", 
           RowBox[{"1", "-", "aself"}]}], "]"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", 
            RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}]}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"senior", " ", "dies"}], ",", " ", 
        RowBox[{"focal", " ", "takes", " ", "over"}], ",", " ", 
        RowBox[{
         RowBox[{"focal", "'"}], "s", " ", "place", " ", "is", " ", "taken", 
         " ", "by", " ", "focal", " ", "offspring", " ", "mothered", " ", 
         "by", " ", "focal", " ", "of", " ", "different", " ", "type", " ", 
         "as", " ", "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"asenior", "\[Equal]", "aself"}], ",", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], ",", 
           RowBox[{"1", "-", 
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}]}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", 
           RowBox[{"1", "-", "aself"}]}], "]"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", 
            RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}]}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"senior", " ", "dies"}], ",", " ", 
        RowBox[{"focal", " ", "takes", " ", "over"}], ",", " ", 
        RowBox[{
         RowBox[{"focal", "'"}], "s", " ", "place", " ", "is", " ", "taken", 
         " ", "by", " ", "focal", " ", "offspring", " ", "fathered", " ", 
         "by", " ", "focal", " ", "of", " ", "different", " ", "type", " ", 
         "as", " ", "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
       RowBox[{"madotherjuv", "[", 
        RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"senior", " ", "dies"}], ",", " ", 
        RowBox[{"focal", " ", "takes", " ", "over"}], ",", " ", 
        RowBox[{
         RowBox[{"focal", "'"}], "s", " ", "place", " ", "is", " ", "taken", 
         " ", "by", " ", "immigrant"}], ",", " ", 
        RowBox[{"maladapted", " ", "offspring"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
       RowBox[{"adotherjuv", "[", 
        RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"senior", " ", "dies"}], ",", " ", 
        RowBox[{"focal", " ", "takes", " ", "over"}], ",", " ", 
        RowBox[{
         RowBox[{"focal", "'"}], "s", " ", "place", " ", "is", " ", "taken", 
         " ", "by", " ", "nonfocal"}], ",", " ", 
        RowBox[{"adapted", " ", "offspring"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "k"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         RowBox[{"g", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "aju", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "asen"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "asen"}], "]"}]}]}], ")"}]}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "on", " ", "other", " ", "patch", " ", "juv", " ", "dies"}], " ",
              "*)"}], "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "asen", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "aju"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "aju"}], "]"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "on", " ", "other", " ", "patch", " ", "senior", " ", "dies"}], 
            " ", "*)"}], "\[IndentingNewLine]", ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"nes", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"aju", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"asen", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "k"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
         RowBox[{"g", "[", 
          RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}], ")"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "aju", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "asenior", ",", 
                    RowBox[{"1", "-", "asenior"}]}], "]"}], ",", "asen"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "asenior"}], ",", "asenior"}], "]"}], 
                  ",", "asen"}], "]"}]}]}], ")"}]}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "on", " ", "other", " ", "patch", " ", "juv", " ", "dies"}], " ",
              "*)"}], "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "asen", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "asenior", ",", 
                    RowBox[{"1", "-", "asenior"}]}], "]"}], ",", "aju"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "asenior"}], ",", "asenior"}], "]"}], 
                  ",", "aju"}], "]"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "on", " ", "other", " ", "patch", " ", "senior", " ", "dies"}], 
            " ", "*)"}], "\[IndentingNewLine]", ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"nes", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"aju", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"asen", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"asenior", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6334084080101213`*^9, 3.633408621437086*^9}, {
   3.6334086672433157`*^9, 3.633408715858348*^9}, {3.633408910762005*^9, 
   3.633409004305276*^9}, {3.633409079984435*^9, 3.6334091436039467`*^9}, {
   3.633409234220334*^9, 3.6334093376593933`*^9}, {3.63340946258109*^9, 
   3.63340955582442*^9}, {3.633409591100646*^9, 3.6334096722567387`*^9}, {
   3.633409801247815*^9, 3.6334098590954533`*^9}, {3.633409968851397*^9, 
   3.6334099743284073`*^9}, {3.6334120000365953`*^9, 
   3.6334120036565847`*^9}, {3.633412120988165*^9, 3.633412313351788*^9}, {
   3.6334123969233217`*^9, 3.633412616820354*^9}, {3.6334986115316343`*^9, 
   3.63349863506009*^9}, {3.633501181927599*^9, 3.63350118523438*^9}, {
   3.633502342169443*^9, 3.633502353983124*^9}, 3.6335027594929647`*^9, {
   3.633502799345827*^9, 3.633502800366242*^9}, {3.6350726994989653`*^9, 
   3.635072724600594*^9}, {3.639816607596588*^9, 3.639816636426712*^9}, {
   3.639816794528438*^9, 3.639816847099381*^9}, {3.6398168851308117`*^9, 
   3.639817066040555*^9}, {3.639817104144808*^9, 3.639817206507987*^9}, {
   3.639817243482286*^9, 3.639817342084363*^9}, {3.63981739389883*^9, 
   3.639817526698237*^9}, {3.639817560967409*^9, 3.639817571883737*^9}, {
   3.639817750371789*^9, 3.63981789909881*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvsdt", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", "es", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", 
           RowBox[{"1", "-", "aself"}], ",", 
           RowBox[{"1", "-", "ajuv"}]}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", 
            RowBox[{"1", "-", "aself"}], ",", "ajuv"}], "]"}]}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "senior"}], ",", " ", 
        RowBox[{
         RowBox[{"replaced", " ", "by", " ", "juvenile"}], ";", " ", 
         RowBox[{
         "focal", " ", "is", " ", "mother", " ", "of", " ", "the", " ", 
          "successful", " ", "offspring", " ", "recruited", " ", "of", " ", 
          "different", " ", "type", " ", "as", " ", "focal"}]}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "senior"}], ",", " ", 
        RowBox[{
         RowBox[{"replaced", " ", "by", " ", "juvenile"}], ";", " ", 
         RowBox[{
          RowBox[{"focal", "'"}], "s", " ", "is", " ", "mother", " ", "of", 
          " ", "the", " ", "successful", " ", "offspring", " ", "recruited", 
          " ", "of", " ", "same", " ", "type", " ", "as", " ", "focal"}]}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ajuv", "\[Equal]", "aself"}], ",", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], ",", 
           RowBox[{"1", "-", 
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}]}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", 
            RowBox[{"1", "-", "aself"}], ",", "ajuv"}], "]"}]}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "senior"}], ",", " ", 
        RowBox[{
         RowBox[{"replaced", " ", "by", " ", "juvenile"}], ";", " ", 
         RowBox[{
         "focal", " ", "is", " ", "father", " ", "of", " ", "the", " ", 
          "successful", " ", "offspring", " ", "recruited", " ", "of", " ", 
          "different", " ", "type", " ", "as", " ", "focal"}]}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ajuv", "\[Equal]", "aself"}], ",", 
           RowBox[{"1", "-", 
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}], ",", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "senior"}], ",", " ", 
        RowBox[{
         RowBox[{"replaced", " ", "by", " ", "juvenile"}], ";", " ", 
         RowBox[{
          RowBox[{"focal", "'"}], "s", " ", "is", " ", "father", " ", "of", 
          " ", "the", " ", "successful", " ", "offspring", " ", "recruited", 
          " ", "of", " ", "same", " ", "type", " ", "as", " ", "focal"}]}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dispad", "[", "es", "]"}], "+", 
           RowBox[{"dispmad", "[", "es", "]"}]}], ")"}], "/", 
         RowBox[{"localcomptotal", "[", 
          RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "senior"}], ",", " ", 
        RowBox[{
         RowBox[{"replaced", " ", "by", " ", "juvenile"}], ";", " ", 
         RowBox[{"replaced", " ", "by", " ", "nonfocal"}]}], ",", " ", 
        RowBox[{"i", ".", "e", "."}], ",", " ", 
        RowBox[{"immigrant", " ", "offspring"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", 
            RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}]}], "+", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", 
           RowBox[{"1", "-", "aself"}]}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "juvenile"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", 
         RowBox[{"focal", "'"}], "s", " ", "offspring", " ", 
         RowBox[{"(", 
          RowBox[{"focal", " ", "is", " ", "mother"}], ")"}]}], ",", " ", 
        RowBox[{"different", " ", "type", " ", "as", " ", "senior"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", "aself", ",", "aself"}], "]"}]}], "+", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "aself"}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "juvenile"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", 
         RowBox[{"focal", "'"}], "s", " ", "offspring", " ", 
         RowBox[{"(", 
          RowBox[{"focal", " ", "is", " ", "mother"}], ")"}]}], ",", " ", 
        RowBox[{"same", " ", "type", " ", "as", " ", "senior"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ajuv", "\[Equal]", "aself"}], ",", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], ",", 
           RowBox[{"1", "-", 
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}]}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", 
            RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}]}], "+", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", 
           RowBox[{"1", "-", "aself"}]}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "juvenile"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", 
         RowBox[{"focal", "'"}], "s", " ", "offspring", " ", 
         RowBox[{"(", 
          RowBox[{"focal", " ", "is", " ", "father"}], ")"}]}], ",", " ", 
        RowBox[{"different", " ", "type", " ", "as", " ", "senior"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ajuv", "\[Equal]", "aself"}], ",", 
           RowBox[{"1", "-", 
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}], ",", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", "aself", ",", "aself"}], "]"}]}], "+", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "aself"}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "juvenile"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", 
         RowBox[{"focal", "'"}], "s", " ", "offspring", " ", 
         RowBox[{"(", 
          RowBox[{"focal", " ", "is", " ", "father"}], ")"}]}], ",", " ", 
        RowBox[{"same", " ", "type", " ", "as", " ", "senior"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"madothersen", "[", 
        RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "juvenile"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "nonfocal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"adothersen", "[", 
        RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "juvenile"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "nonfocal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "k"}], ")"}], 
       FractionBox["1", "2"], 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "aju", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "asen"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "asen"}], "]"}]}]}], ")"}]}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "on", " ", "other", " ", "patch", " ", "juv", " ", "dies"}], " ",
              "*)"}], "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "asen", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "aju"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "aju"}], "]"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "on", " ", "other", " ", "patch", " ", "senior", " ", "dies"}], 
            " ", "*)"}], "\[IndentingNewLine]", ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"nes", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"aju", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"asen", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "k"}], ")"}], 
       FractionBox["1", "2"], 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "aju", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "ajuv", ",", 
                    RowBox[{"1", "-", "ajuv"}]}], "]"}], ",", "asen"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "ajuv"}], ",", "ajuv"}], "]"}], ",", 
                  "asen"}], "]"}]}]}], ")"}]}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "on", " ", "other", " ", "patch", " ", "juv", " ", "dies"}], " ",
              "*)"}], "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "asen", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "ajuv", ",", 
                    RowBox[{"1", "-", "ajuv"}]}], "]"}], ",", "aju"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "ajuv"}], ",", "ajuv"}], "]"}], ",", 
                  "aju"}], "]"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "on", " ", "other", " ", "patch", " ", "senior", " ", "dies"}], 
            " ", "*)"}], "\[IndentingNewLine]", ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"nes", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"aju", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"asen", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ajuv", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6334126304959583`*^9, 3.633412646375149*^9}, {
   3.633412841374126*^9, 3.633412902626623*^9}, {3.633413015169194*^9, 
   3.633413034229413*^9}, {3.633413072369688*^9, 3.633413146905407*^9}, {
   3.6334132155743237`*^9, 3.633413244855592*^9}, {3.6334132949687023`*^9, 
   3.633413295297819*^9}, {3.633498161372232*^9, 3.633498192698634*^9}, {
   3.633498489639135*^9, 3.633498601038528*^9}, {3.633498644577499*^9, 
   3.633498650518743*^9}, {3.633498759700585*^9, 3.633498795183405*^9}, {
   3.633498841351445*^9, 3.633498899014537*^9}, {3.633498941318145*^9, 
   3.633498946027717*^9}, {3.6335005757881536`*^9, 3.633500609820137*^9}, {
   3.633500885640175*^9, 3.6335009290853977`*^9}, {3.6335009961960363`*^9, 
   3.633501023091476*^9}, {3.633501053242216*^9, 3.633501177595662*^9}, {
   3.633501325720121*^9, 3.633501331043683*^9}, {3.633502371351656*^9, 
   3.633502389163336*^9}, 3.633502829308981*^9, {3.633514873952476*^9, 
   3.633514877240644*^9}, {3.6350727335007668`*^9, 3.635072765887948*^9}, {
   3.635072817703754*^9, 3.63507281822663*^9}, {3.63981804709446*^9, 
   3.639818062854319*^9}, {3.6398181212008266`*^9, 3.6398182743213787`*^9}, {
   3.639818396020569*^9, 3.6398184546258097`*^9}, {3.639818595555304*^9, 
   3.639818602944368*^9}, {3.639818670202694*^9, 3.6398188185567017`*^9}, {
   3.63981895819553*^9, 3.639818959566551*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"veqtabPlain", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "dvjdt", "]"}], ",", 
     RowBox[{"Flatten", "[", "dvsdt", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6335030422546186`*^9, 3.633503116179738*^9}, 
   3.6335045830007687`*^9}],

Cell["Specify ingredients for numerical solving:", "Text",
 CellChangeTimes->{3.593444110336153*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"identity", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "0", ",", "0"}], "]"}], 
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"vj", "[", 
        RowBox[{"1", ",", "0", ",", "0"}], "]"}], "+", 
       RowBox[{"vs", "[", 
        RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}], 
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"vj", "[", 
        RowBox[{"2", ",", "0", ",", "0"}], "]"}], "+", 
       RowBox[{"vs", "[", 
        RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "1", ",", "0"}], "]"}], 
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"vj", "[", 
        RowBox[{"1", ",", "1", ",", "0"}], "]"}], "+", 
       RowBox[{"vs", "[", 
        RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "1", ",", "0"}], "]"}], 
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"vj", "[", 
        RowBox[{"2", ",", "1", ",", "0"}], "]"}], "+", 
       RowBox[{"vs", "[", 
        RowBox[{"2", ",", "0", ",", "1"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "0", ",", "1"}], "]"}], 
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"vj", "[", 
        RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"vs", "[", 
        RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "0", ",", "1"}], "]"}], 
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"vj", "[", 
        RowBox[{"2", ",", "0", ",", "1"}], "]"}], "+", 
       RowBox[{"vs", "[", 
        RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "1", ",", "1"}], "]"}], 
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"vj", "[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
       RowBox[{"vs", "[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "1", ",", "1"}], "]"}], 
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"vj", "[", 
        RowBox[{"2", ",", "1", ",", "1"}], "]"}], "+", 
       RowBox[{"vs", "[", 
        RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], ")"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.633503130634528*^9, 3.633503187756529*^9}, {
  3.633504021716344*^9, 3.6335040664764967`*^9}, {3.6335041125778313`*^9, 
  3.633504243019823*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"veqtab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"x", "\[Equal]", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Flatten", "[", "veqtabPlain", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"veqtabPlain1", "=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "veqtabPlain", "]"}], ",", 
     RowBox[{"identity", "-", "1"}], ",", "1"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.505135127820217*^9, 3.505135205993911*^9}, {
   3.50513611034762*^9, 3.505136113075313*^9}, {3.507217456958711*^9, 
   3.5072174574988*^9}, {3.520430829666444*^9, 3.520430831170349*^9}, 
   3.520431566258815*^9, {3.525507803122896*^9, 3.525507813769655*^9}, 
   3.633503129211546*^9, {3.6335042515975*^9, 3.633504263214167*^9}, {
   3.6339552184157267`*^9, 3.6339552185982513`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rvals", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"vj", "[", 
         RowBox[{"es", ",", "aself", ",", "aother"}], "]"}], ",", 
        RowBox[{"vs", "[", 
         RowBox[{"es", ",", "aself", ",", "aother"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"aother", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.633504437370079*^9, 3.633504458779578*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"veqtab1", "=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "veqtab", "]"}], ",", 
     RowBox[{"identity", "\[Equal]", "1"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"veqtabalt", "=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "veqtab", "]"}], ",", 
     RowBox[{"identity", "\[Equal]", "1"}], ",", "8"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.500191454064715*^9, 3.5001915301548977`*^9}, {
   3.503248155435731*^9, 3.503248184014865*^9}, {3.503248404174206*^9, 
   3.503248408037532*^9}, {3.5032484879944773`*^9, 3.503248564736147*^9}, {
   3.503248606455018*^9, 3.5032486443739347`*^9}, {3.503248907107168*^9, 
   3.503248941554319*^9}, {3.503248990797192*^9, 3.5032490177031803`*^9}, {
   3.503249052989256*^9, 3.503249058397912*^9}, {3.503249225456058*^9, 
   3.503249232572372*^9}, {3.52041981573889*^9, 3.520419815807377*^9}, {
   3.520419929199638*^9, 3.520419960348857*^9}, {3.520420386583107*^9, 
   3.52042039467243*^9}, {3.52042052102429*^9, 3.520420530710544*^9}, {
   3.520427661952775*^9, 3.520427687777916*^9}, {3.520428052792645*^9, 
   3.520428052841705*^9}, {3.520429085313047*^9, 3.520429135675322*^9}, {
   3.520429182985737*^9, 3.520429193252388*^9}, {3.524043766176027*^9, 
   3.524043808428645*^9}, {3.524043914020914*^9, 3.524043922558467*^9}, {
   3.524044206048073*^9, 3.524044207302169*^9}, {3.524044305100863*^9, 
   3.524044307940649*^9}, 3.524044728908094*^9, 3.52404481629412*^9, 
   3.524555029728461*^9, {3.531829251631015*^9, 3.531829276142815*^9}, {
   3.548672344448597*^9, 3.5486723446003237`*^9}, {3.633504268297427*^9, 
   3.633504280786254*^9}, {3.633504381945697*^9, 3.633504412494095*^9}, 
   3.6335045989402723`*^9, {3.633523700411088*^9, 3.633523711648034*^9}, {
   3.635583020611801*^9, 3.6355830207688007`*^9}, {3.639819017420354*^9, 
   3.6398190176428957`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rvstartvals", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"vs", "[", 
             RowBox[{"es", ",", "as", ",", "ao"}], "]"}], ",", 
            RowBox[{"vj", "[", 
             RowBox[{"es", ",", "as", ",", "ao"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"as", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ao", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"frootstartvals2", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"frootstartvals", ",", "rvstartvals"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5018622698079367`*^9, 3.501862289606407*^9}, {
  3.5018623307386227`*^9, 3.501862365664167*^9}, {3.5018624304785347`*^9, 
  3.501862533405551*^9}, {3.520429173721002*^9, 3.520429174705935*^9}, {
  3.633512810470483*^9, 3.633512833293653*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", "0.125`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "0", ",", "1"}], "]"}], ",", "0.125`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", "0.125`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", "0.125`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}], ",", "0.125`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "0", ",", "1"}], "]"}], ",", "0.125`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "1", ",", "0"}], "]"}], ",", "0.125`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"2", ",", "1", ",", "1"}], "]"}], ",", "0.125`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vs", "[", 
      RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vj", "[", 
      RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vs", "[", 
      RowBox[{"1", ",", "0", ",", "1"}], "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vj", "[", 
      RowBox[{"1", ",", "0", ",", "1"}], "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vs", "[", 
      RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vj", "[", 
      RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vs", "[", 
      RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vj", "[", 
      RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vs", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vj", "[", 
      RowBox[{"2", ",", "0", ",", "0"}], "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vs", "[", 
      RowBox[{"2", ",", "0", ",", "1"}], "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vj", "[", 
      RowBox[{"2", ",", "0", ",", "1"}], "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vs", "[", 
      RowBox[{"2", ",", "1", ",", "0"}], "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vj", "[", 
      RowBox[{"2", ",", "1", ",", "0"}], "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vs", "[", 
      RowBox[{"2", ",", "1", ",", "1"}], "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vj", "[", 
      RowBox[{"2", ",", "1", ",", "1"}], "]"}], ",", "0.1`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6088203241493273`*^9, 3.608820529511283*^9, 3.633512835029052*^9, 
   3.633514915099966*^9, 3.633517282338603*^9, {3.633523706148499*^9, 
   3.633523716195504*^9}, 3.633530749530089*^9, 3.633839964306573*^9, 
   3.633841468771276*^9, 3.633894731948546*^9, 3.633895580755395*^9, 
   3.63389636122443*^9, 3.633948259787538*^9, 3.633952500313143*^9, 
   3.633952581621072*^9, 3.633954955449484*^9, 3.633955235044608*^9, 
   3.63395559349233*^9, 3.6339570772321568`*^9, 3.63395916551845*^9, 
   3.633959245318308*^9, 3.633960440125169*^9, 3.633964696877865*^9, 
   3.633964787633802*^9, 3.633965062148396*^9, 3.6349035332432823`*^9, 
   3.63490366099608*^9, 3.63497688249743*^9, 3.635072850550954*^9, 
   3.6350744874972982`*^9, 3.635074809752323*^9, 3.635075340069037*^9, 
   3.635414720232531*^9, 3.635415268397785*^9, 3.635582940650584*^9, 
   3.635583044354546*^9, 3.635587082751815*^9, 3.63558762368229*^9, 
   3.6367029159767714`*^9, 3.636705162418646*^9, 3.636707970933167*^9, 
   3.636724341390171*^9, 3.6367248625334578`*^9, 3.636726307051536*^9, 
   3.636726751703854*^9, 3.636728166639035*^9, 3.636728406806527*^9, 
   3.636728488574872*^9, 3.6367923888687067`*^9, 3.6368665645305853`*^9, 
   3.6393945721771183`*^9, 3.639394699766794*^9, 3.639818991252143*^9, {
   3.6398190224281063`*^9, 3.6398190450354233`*^9}, 3.6398194108629513`*^9}]
}, Open  ]],

Cell[TextData[StyleBox["Functions to solve for reproductive values \
numerically:",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.593444115376205*^9, 3.593444123951432*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans2", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "m_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p10s_", ",", "p20s_", ",", "p11s_", ",", "p21s_"}], "}"}], ",", 
    "ks_", ",", "Qs_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"feqtab", ",", "veqtab1"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
       RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
       RowBox[{"k", "\[Rule]", "ks"}], ",", 
       RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
       RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
       RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
       RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
       RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
       RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
       RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
       RowBox[{"mt", "\[Rule]", "m"}], ",", 
       RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
       RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
       RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
       RowBox[{"p21", "\[Rule]", "p21s"}]}], "}"}]}], ",", 
    "frootstartvals2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5001916798996162`*^9, 3.500191697184021*^9}, {
  3.500191746661626*^9, 3.500191829605167*^9}, {3.5018625449943523`*^9, 
  3.501862553243379*^9}, {3.505134989076899*^9, 3.505135020740206*^9}, {
  3.505135294068394*^9, 3.505135298071993*^9}, {3.505135349357525*^9, 
  3.505135353720825*^9}, {3.505135717667018*^9, 3.505135718094597*^9}, {
  3.505135768611511*^9, 3.505135774783208*^9}, {3.505135830753673*^9, 
  3.505135873580983*^9}, {3.505135964949779*^9, 3.505136036881705*^9}, {
  3.505136141097201*^9, 3.505136150378752*^9}, {3.508161078184225*^9, 
  3.508161091740897*^9}, {3.520419842079061*^9, 3.520419844240124*^9}, {
  3.52455494510407*^9, 3.524554954808517*^9}, {3.5908239835408707`*^9, 
  3.590824013411441*^9}, {3.590824186979704*^9, 3.590824205987976*^9}, {
  3.5925440708761597`*^9, 3.5925440957750673`*^9}, {3.6335143196711903`*^9, 
  3.633514354774764*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans2alt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "m_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p10s_", ",", "p20s_", ",", "p11s_", ",", "p21s_"}], "}"}], ",", 
    "ks_", ",", "Qs_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"feqtab", ",", "veqtabalt"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
       RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
       RowBox[{"k", "\[Rule]", "ks"}], ",", 
       RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
       RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
       RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
       RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
       RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
       RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
       RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
       RowBox[{"mt", "\[Rule]", "m"}], ",", 
       RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
       RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
       RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
       RowBox[{"p21", "\[Rule]", "p21s"}]}], "}"}]}], ",", 
    "frootstartvals2"}], "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQveLkn++iIq8cGx6r/gLRXDqhDGJAuj12MxeI3nNR
/pKr+CvHwyfVL4Por6WLNjbLvnI8sn76VhDtaXDoOpjv63QDRN8oWH0PRDMI
mt8H0WYRW3lagPQHtsNgumGisDCI5hK4CabF5W5Igeis6UYKIHp6yjxtEP3W
bI4JiHaVWewIovfKnXEC0TpPj7p5Kr9yzNta7gGiV7c7May2euUoub4dTHeH
KEv0Ob1yjL8fKQmiL/h9ZP1y4JVjm9ZaThC9JzJeHkQ3zN2vCKY577ywPvLK
Mersj9cgOqXq68sEodeOFiqP34Fo+5AT7IlAuuLVPTANACmOkF4=
  "]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ans2", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.8", ",", "0.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1", ",", "0.9", ",", "0.4", ",", "0.3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1", ",", "0.8", ",", "0.9", ",", "0.5"}], "}"}], ",", "0.1", 
   ",", "0.05"}], "]"}]], "Input",
 CellChangeTimes->{{3.500192029842957*^9, 3.500192032446335*^9}, {
   3.501923482525814*^9, 3.501923510215691*^9}, 3.5019239348204813`*^9, {
   3.50193133558246*^9, 3.501931358478292*^9}, {3.5032540622901*^9, 
   3.503254067378688*^9}, {3.505135027019304*^9, 3.505135031903424*^9}, {
   3.50513578285544*^9, 3.505135784285997*^9}, {3.505135894350724*^9, 
   3.505135895026915*^9}, {3.507217302061491*^9, 3.507217316708229*^9}, {
   3.508161095277032*^9, 3.508161096760681*^9}, {3.508161237183029*^9, 
   3.508161239674842*^9}, {3.508161319583596*^9, 3.508161323949635*^9}, {
   3.51566001997472*^9, 3.515660071679375*^9}, {3.520419450927335*^9, 
   3.520419468632097*^9}, {3.520419567807807*^9, 3.520419570324196*^9}, {
   3.520419750326867*^9, 3.520419756677986*^9}, {3.520420937695824*^9, 
   3.520420953180814*^9}, {3.520427627254544*^9, 3.520427638687585*^9}, {
   3.520429208593634*^9, 3.520429231674042*^9}, {3.524554969421171*^9, 
   3.524554973766278*^9}, {3.524555006868618*^9, 3.524555007460496*^9}, {
   3.524555062494341*^9, 3.524555063917426*^9}, {3.590823966331852*^9, 
   3.590823968139655*^9}, {3.590824274713768*^9, 3.590824276960957*^9}, {
   3.5925441110935087`*^9, 3.592544125601429*^9}, {3.5925442568585777`*^9, 
   3.59254426919372*^9}, {3.633514370529613*^9, 3.6335143777164917`*^9}, {
   3.633514516945455*^9, 3.6335145346246567`*^9}, {3.6335149300023727`*^9, 
   3.633514942984395*^9}, {3.635582953855464*^9, 3.635582963605096*^9}, {
   3.6355830813021793`*^9, 3.635583084653256*^9}, {3.639819006055025*^9, 
   3.639819034299879*^9}, {3.639819067008779*^9, 3.639819077018086*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.03436496940913637`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.024261624357512834`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.029485737321478293`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.02299878002298353`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.02522860714308372`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.12375003756177867`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.10404191611804406`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.6358683280659825`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.9154145581905506`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "1.0665839849389613`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.990955093400945`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.9859811162982453`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.9811409353798042`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.9886110899366217`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "1.095096555365225`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.8643296096848073`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "1.3289507954148727`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.5212664855334107`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"2", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.8289430477527215`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"2", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.4980624584617056`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"2", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "1.4574320475185316`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"2", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "1.115789324244872`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"2", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "1.0105455295050425`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"2", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "1.0177440736359191`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.608820324347061*^9, 3.6088205298081427`*^9, 3.6335143677286587`*^9, 
   3.633514535529338*^9, 3.633514915508111*^9, 3.633514955967052*^9, 
   3.633517282839816*^9, {3.63352370648696*^9, 3.633523716540538*^9}, 
   3.633530749879203*^9, 3.6338399647281923`*^9, 3.6338414691627483`*^9, 
   3.633894732378167*^9, 3.633895581162108*^9, 3.633896361617407*^9, 
   3.63394826018814*^9, 3.6339525006994743`*^9, 3.6339525819934807`*^9, 
   3.633954955855773*^9, 3.633955235484673*^9, 3.6339555938765078`*^9, 
   3.6339570776287613`*^9, 3.633959165957657*^9, 3.633959245711959*^9, 
   3.63396044052976*^9, 3.633964697270851*^9, 3.633964788023925*^9, 
   3.63396506252892*^9, 3.634903533636443*^9, 3.6349036613714657`*^9, 
   3.634976882924432*^9, 3.635072850963964*^9, 3.635074487865925*^9, 
   3.635074810141451*^9, 3.6350753405266333`*^9, 3.635414720605111*^9, 
   3.6354152688124037`*^9, 3.635582941059553*^9, {3.635582974086041*^9, 
   3.635582989799425*^9}, 3.635583044730665*^9, 3.635583091546988*^9, 
   3.6355870832221613`*^9, 3.635587624063406*^9, 3.636702916348959*^9, 
   3.636705162792054*^9, 3.636707971297031*^9, 3.636724341753769*^9, 
   3.636724862880335*^9, 3.636726309140024*^9, 3.636726752186183*^9, 
   3.636728167079545*^9, 3.636728407201167*^9, 3.6367284889958982`*^9, 
   3.636792389282022*^9, 3.636866565022435*^9, 3.6393945725819902`*^9, 
   3.639394700220623*^9, {3.639818991837019*^9, 3.639819078046918*^9}, 
   3.639819411503667*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ans2alt", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.8", ",", "0.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1", ",", "0.9", ",", "0.4", ",", "0.3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1", ",", "0.8", ",", "0.9", ",", "0.5"}], "}"}], ",", "0.1", 
   ",", "0.05"}], "]"}]], "Input",
 CellChangeTimes->{{3.500192029842957*^9, 3.500192032446335*^9}, {
   3.501923482525814*^9, 3.501923510215691*^9}, 3.5019239348204813`*^9, {
   3.50193133558246*^9, 3.501931358478292*^9}, {3.5032540622901*^9, 
   3.503254067378688*^9}, {3.505135027019304*^9, 3.505135031903424*^9}, {
   3.50513578285544*^9, 3.505135784285997*^9}, {3.505135894350724*^9, 
   3.505135895026915*^9}, {3.507217302061491*^9, 3.507217316708229*^9}, {
   3.508161095277032*^9, 3.508161096760681*^9}, {3.508161237183029*^9, 
   3.508161239674842*^9}, {3.508161319583596*^9, 3.508161323949635*^9}, {
   3.51566001997472*^9, 3.515660071679375*^9}, {3.520419450927335*^9, 
   3.520419468632097*^9}, {3.520419567807807*^9, 3.520419570324196*^9}, {
   3.520419750326867*^9, 3.520419756677986*^9}, {3.520420937695824*^9, 
   3.520420953180814*^9}, {3.520427627254544*^9, 3.520427638687585*^9}, {
   3.520429208593634*^9, 3.520429231674042*^9}, {3.524554969421171*^9, 
   3.524554973766278*^9}, {3.524555006868618*^9, 3.524555007460496*^9}, {
   3.524555062494341*^9, 3.524555063917426*^9}, {3.590823966331852*^9, 
   3.590823968139655*^9}, {3.590824274713768*^9, 3.590824276960957*^9}, {
   3.5925441110935087`*^9, 3.592544125601429*^9}, {3.5925442568585777`*^9, 
   3.59254426919372*^9}, {3.633514370529613*^9, 3.6335143777164917`*^9}, {
   3.633514516945455*^9, 3.6335145491926126`*^9}, {3.633514947236693*^9, 
   3.633514952333398*^9}, {3.635582965539392*^9, 3.6355829999681673`*^9}, {
   3.63558308639867*^9, 3.635583088759597*^9}, {3.636726512416329*^9, 
   3.636726514879347*^9}, {3.639819003950914*^9, 3.639819074785845*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.03436496940913637`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.024261624357512834`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.029485737321478293`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.02299878002298353`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.02522860714308372`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.12375003756177867`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.10404191611804406`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.6358683280659825`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.9154145581905508`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "1.0665839849389624`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.9909550934009451`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.9859811162982454`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.9811409353798042`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.9886110899366218`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "1.095096555365225`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.8643296096848073`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "1.328950795414873`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.5212664855334106`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"2", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.8289430477527215`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"2", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.4980624584617056`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"2", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "1.4574320475185316`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"2", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "1.115789324244872`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"2", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "1.0105455295050425`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"2", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "1.0177440736359193`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.608820324347061*^9, 3.6088205298081427`*^9, 3.6335143677286587`*^9, {
   3.633514535529338*^9, 3.633514561898377*^9}, 3.6335149158693438`*^9, 
   3.6335149533266287`*^9, 3.633517283389391*^9, {3.633523706770524*^9, 
   3.633523716823366*^9}, 3.633530750191906*^9, 3.6338399651153708`*^9, 
   3.633841469517214*^9, 3.633894732745592*^9, 3.6338955815481043`*^9, 
   3.633896361971672*^9, 3.633948260519972*^9, 3.633952501035411*^9, 
   3.633952582326942*^9, 3.633954956191032*^9, 3.633955235831435*^9, 
   3.633955594215678*^9, 3.633957077967003*^9, 3.63395916630655*^9, 
   3.633959246044978*^9, 3.633960440894236*^9, 3.6339646976359262`*^9, 
   3.633964788375536*^9, 3.633965062876602*^9, 3.6349035339754333`*^9, 
   3.6349036617106657`*^9, 3.634976883263835*^9, 3.635072851344404*^9, 
   3.635074488199037*^9, 3.635074810482926*^9, 3.635075340865099*^9, 
   3.6354147209336023`*^9, 3.6354152691694603`*^9, 3.635582941420176*^9, {
   3.6355829718403378`*^9, 3.6355830011087027`*^9}, 3.63558304507172*^9, 
   3.635583094892797*^9, 3.635587083664804*^9, 3.6355876244049053`*^9, 
   3.636702916687648*^9, 3.636705163145212*^9, 3.636707971660166*^9, 
   3.636724342079578*^9, 3.636724863339036*^9, 3.6367263097746572`*^9, 
   3.636726752651329*^9, 3.636728167424965*^9, 3.636728407544766*^9, 
   3.636728489345443*^9, 3.636792389617846*^9, 3.6368665653893633`*^9, 
   3.639394572937366*^9, 3.639394700575333*^9, {3.6398189924595947`*^9, 
   3.639819080086697*^9}, 3.639819412216135*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Relatedness", "Section",
 CellChangeTimes->{{3.497731804687118*^9, 3.497731811045567*^9}}],

Cell["\<\
Relatedness between adapted senior and adapted juvenile\
\>", "Text",
 CellChangeTimes->{{3.633515404751154*^9, 3.633515436357553*^9}, {
  3.6335172812153263`*^9, 3.6335172820957317`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"afromJ", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", 
     RowBox[{"localcomptotal", "[", 
      RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}]}]], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ajuv", "\[Equal]", "0"}], ",", 
     RowBox[{"p", "[", 
      RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}]}], "]"}], 
   RowBox[{"g", "[", 
    RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}], ")"}], "/", 
    RowBox[{"ap", "[", 
     RowBox[{"es", ",", "ajuv", ",", "asen"}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mfromJ", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", 
     RowBox[{"localcomptotal", "[", 
      RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}]}]], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"ajuv", "\[Equal]", "0"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}], ",", 
     RowBox[{"p", "[", 
      RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}], "]"}], 
   RowBox[{"g", "[", 
    RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ap", "[", 
       RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}]}], 
     ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afromS", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", 
     RowBox[{"localcomptotal", "[", 
      RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}]}]], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"asen", "==", "0"}], ",", 
     RowBox[{"p", "[", 
      RowBox[{"es", ",", "asen", ",", "1"}], "]"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "asen", ",", "1"}], "]"}]}]}], "]"}], 
   RowBox[{"g", "[", 
    RowBox[{"es", ",", "asen", ",", "1"}], "]"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "asen", ",", "1"}], "]"}]}], ")"}], "/", 
    RowBox[{"ap", "[", 
     RowBox[{"es", ",", "ajuv", ",", "asen"}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mfromS", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", 
     RowBox[{"localcomptotal", "[", 
      RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}]}]], 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"asen", "\[Equal]", "0"}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "asen", ",", "1"}], "]"}]}], ",", 
     RowBox[{"p", "[", 
      RowBox[{"es", ",", "asen", ",", "1"}], "]"}]}], "]"}], 
   RowBox[{"g", "[", 
    RowBox[{"es", ",", "asen", ",", "1"}], "]"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "asen", ",", "1"}], "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"ap", "[", 
       RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}]}], 
     ")"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.6335183951965322`*^9, 3.633518402621434*^9}, {
  3.633518488793445*^9, 3.6335185419861917`*^9}, {3.6335205917297564`*^9, 
  3.633520703054801*^9}, {3.6335208360725946`*^9, 3.633520841433029*^9}, {
  3.633522914512002*^9, 3.6335229165367823`*^9}, {3.6335232852264843`*^9, 
  3.633523360529153*^9}, {3.633894695541882*^9, 3.633894707356717*^9}, {
  3.636706900724903*^9, 3.636706919649082*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"raSaJtab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"raSaJ", "[", "es", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "0", ",", "0"}], "]"}], 
          RowBox[{"rmSmJ", "[", 
           RowBox[{"3", "-", "es"}], "]"}]}], 
         RowBox[{"(*", " ", 
          RowBox[{"environment", " ", "switches"}], " ", "*)"}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"afromJ", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], "+", 
            RowBox[{
             RowBox[{"afromS", "[", 
              RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
             RowBox[{"rmSaJ", "[", "es", "]"}]}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"mortality", " ", "of", " ", "maladapted", " ", "senior"}],
            ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"afromJ", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], "+", 
            RowBox[{
             RowBox[{"afromS", "[", 
              RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
             RowBox[{"raSaJ", "[", "es", "]"}]}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"mortality", " ", "of", " ", "adapted", " ", "senior"}], 
           ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"afromJ", "[", 
              RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
             RowBox[{"raSmJ", "[", "es", "]"}]}], "+", 
            RowBox[{"afromS", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "mortality", " ", "of", " ", "maladapted", " ", "juvenile"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"afromJ", "[", 
              RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
             RowBox[{"raSaJ", "[", "es", "]"}]}], "+", 
            RowBox[{"afromS", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}]}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"mortality", " ", "of", " ", "adapted", " ", "juvenile"}], 
          ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "0", ",", "0"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6335172740322733`*^9, 3.633517319959469*^9}, {
  3.633517651195138*^9, 3.633517669531398*^9}, {3.633517753166295*^9, 
  3.6335177875257607`*^9}, {3.6335178563777742`*^9, 3.633517878475803*^9}, {
  3.6335179476876287`*^9, 3.633517962535026*^9}, {3.633518384490552*^9, 
  3.6335183856032257`*^9}, {3.6335230257206917`*^9, 3.6335230533885736`*^9}, {
  3.633523197317383*^9, 3.633523272760634*^9}, {3.633523551670142*^9, 
  3.633523663643793*^9}, {3.6335237394635477`*^9, 3.633523751213293*^9}, {
  3.633523837667458*^9, 3.63352385958608*^9}, {3.6335239358212557`*^9, 
  3.6335239751103687`*^9}, {3.6335240369350557`*^9, 3.633524058054846*^9}, {
  3.633524099790289*^9, 3.63352412517785*^9}, {3.633524160632285*^9, 
  3.63352422064651*^9}, {3.6335242627302427`*^9, 3.633524353865656*^9}, {
  3.633525851163431*^9, 3.633525863883856*^9}, {3.635587717000629*^9, 
  3.635587718802682*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rmSaJtab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"rmSaJ", "[", "es", "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "0", ",", "1"}], "]"}], 
          RowBox[{"raSmJ", "[", 
           RowBox[{"3", "-", "es"}], "]"}]}], 
         RowBox[{"(*", " ", 
          RowBox[{"environment", " ", "switches"}], " ", "*)"}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"afromJ", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], "+", 
            RowBox[{
             RowBox[{"afromS", "[", 
              RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
             RowBox[{"rmSmJ", "[", "es", "]"}]}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"mortality", " ", "of", " ", "maladapted", " ", "senior"}],
            ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"afromJ", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], "+", 
            RowBox[{
             RowBox[{"afromS", "[", 
              RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
             RowBox[{"raSmJ", "[", "es", "]"}]}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"mortality", " ", "of", " ", "adapted", " ", "senior"}], 
           ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"afromJ", "[", 
              RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
             RowBox[{"rmSmJ", "[", "es", "]"}]}], "+", 
            RowBox[{"afromS", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "mortality", " ", "of", " ", "maladapted", " ", "juvenile"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"afromJ", "[", 
              RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
             RowBox[{"rmSaJ", "[", "es", "]"}]}], "+", 
            RowBox[{"afromS", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}]}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"mortality", " ", "of", " ", "adapted", " ", "juvenile"}], 
          ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "0", ",", "1"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}]}]}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdy08oQwEAx/E3K+0wVv73ZKVmLcvFn+EJvZC2SOaww7T0sjmIsZBltzks
rNVL/mypqVmL5b15Kd5FK+Egm9ZyIqWWmhJNaQfZb4dfn8vv28jYjdYSgiDI
wiAjo81MRZb+Ff6mINtn24A6SWwLGoxNu1CWWghAsUYegrfdiTAsl6xw8FM5
HoP+M0UGBkfbir4rOputBVvt0RZIaI77YYOpTg8fFn9mYW4/54RMet4NR1KZ
dfhoPvdBbdzBQnE4H4Aqz1sQ5rMHkeI/Tp9AucHJw2/+SICnPVUXUMdvX0G1
5ekamoTpRFFPetOGbpliIaVP7sAhd+0eZKu5EPzKKCLwhfBeQlXZkggHtMp7
6NOISeivX32GLu/YKzyUCu0zBS1SqgP2puUTUE2WWmCXY5IjK7P0YFjJw4+1
6A10zcXv4D+6D7mz
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"raSmJtab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"raSmJ", "[", "es", "]"}], "==", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "1", ",", "0"}], "]"}], 
          RowBox[{"rmSaJ", "[", 
           RowBox[{"3", "-", "es"}], "]"}]}], 
         RowBox[{"(*", " ", 
          RowBox[{"environment", " ", "switches"}], " ", "*)"}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"mfromJ", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], "+", 
            RowBox[{
             RowBox[{"mfromS", "[", 
              RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
             RowBox[{"rmSaJ", "[", "es", "]"}]}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"mortality", " ", "of", " ", "maladapted", " ", "senior"}],
            ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"mfromJ", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], "+", 
            RowBox[{
             RowBox[{"mfromS", "[", 
              RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
             RowBox[{"raSaJ", "[", "es", "]"}]}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"mortality", " ", "of", " ", "adapted", " ", "senior"}], 
           ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"mfromJ", "[", 
              RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
             RowBox[{"raSmJ", "[", "es", "]"}]}], "+", 
            RowBox[{"mfromS", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "mortality", " ", "of", " ", "maladapted", " ", "juvenile"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"mfromJ", "[", 
              RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
             RowBox[{"raSaJ", "[", "es", "]"}]}], "+", 
            RowBox[{"mfromS", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}]}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"mortality", " ", "of", " ", "adapted", " ", "juvenile"}], 
          ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "1", ",", "0"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.633528182766017*^9, 3.633528198799988*^9}, {
  3.633528560008718*^9, 3.6335286219446383`*^9}, {3.633529251950666*^9, 
  3.633529299026094*^9}, {3.633529380417653*^9, 3.633529454071266*^9}, {
  3.633529510539749*^9, 3.633529587342616*^9}, {3.6335298497744226`*^9, 
  3.633529856592602*^9}, {3.63507422290711*^9, 3.635074223591324*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rmSmJtab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"rmSmJ", "[", "es", "]"}], "==", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "1", ",", "1"}], "]"}], 
          RowBox[{"raSaJ", "[", 
           RowBox[{"3", "-", "es"}], "]"}]}], 
         RowBox[{"(*", " ", 
          RowBox[{"environment", " ", "switches"}], " ", "*)"}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"mfromJ", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], "+", 
            RowBox[{
             RowBox[{"mfromS", "[", 
              RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
             RowBox[{"rmSmJ", "[", "es", "]"}]}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"mortality", " ", "of", " ", "maladapted", " ", "senior"}],
            ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"mfromJ", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], "+", 
            RowBox[{
             RowBox[{"mfromS", "[", 
              RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
             RowBox[{"raSmJ", "[", "es", "]"}]}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"mortality", " ", "of", " ", "adapted", " ", "senior"}], 
           ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"mfromJ", "[", 
              RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
             RowBox[{"rmSmJ", "[", "es", "]"}]}], "+", 
            RowBox[{"mfromS", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "mortality", " ", "of", " ", "maladapted", " ", "juvenile"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"mfromJ", "[", 
              RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
             RowBox[{"rmSaJ", "[", "es", "]"}]}], "+", 
            RowBox[{"mfromS", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}]}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"mortality", " ", "of", " ", "adapted", " ", "juvenile"}], 
          ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "1", ",", "1"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}]}]}], ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.633529634357769*^9, 3.633529713521783*^9}, {
  3.633529744240481*^9, 3.633529763031724*^9}, {3.633529794626315*^9, 
  3.633529906055965*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"outcome", "=", 
   RowBox[{"raa12", "\[Equal]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rmm20", " ", "s2", " ", 
        RowBox[{"f", "[", 
         RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "mt"}], ")"}], " ", "p11", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", "2"], "+", 
           FractionBox["raa12", "2"]}], ")"}], " ", 
         RowBox[{"f", "[", 
          RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], 
        RowBox[{"1", "+", 
         RowBox[{"mt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"f", "[", 
             RowBox[{"1", ",", "0", ",", "0"}], "]"}], "+", 
            RowBox[{"f", "[", 
             RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
            RowBox[{"f", "[", 
             RowBox[{"1", ",", "1", ",", "0"}], "]"}], "+", 
            RowBox[{"f", "[", 
             RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
            RowBox[{"f", "[", 
             RowBox[{"2", ",", "0", ",", "0"}], "]"}], "+", 
            RowBox[{"f", "[", 
             RowBox[{"2", ",", "0", ",", "1"}], "]"}], "+", 
            RowBox[{"f", "[", 
             RowBox[{"2", ",", "1", ",", "0"}], "]"}], "+", 
            RowBox[{"f", "[", 
             RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], ")"}]}]}]], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
            RowBox[{"f", "[", 
             RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "mt"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "p11"}], "-", "p21"}], ")"}]}], "-", 
            RowBox[{"mt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "p21", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"f", "[", 
                   RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
                  RowBox[{"f", "[", 
                   RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "-", 
               RowBox[{"2", " ", "p11", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "-", 
               RowBox[{"2", " ", "p11", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "-", 
               RowBox[{"p11", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"f", "[", 
                   RowBox[{"2", ",", "0", ",", "1"}], "]"}], "+", 
                  RowBox[{"f", "[", 
                   RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "-", 
               RowBox[{"p21", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"f", "[", 
                   RowBox[{"2", ",", "0", ",", "1"}], "]"}], "+", 
                  RowBox[{"f", "[", 
                   RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "-", 
               RowBox[{"2", " ", "p21", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}], 
           ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "mt"}], ")"}], " ", "p11"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "mt"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "p11"}], "-", "p21"}], ")"}]}], "-", 
               RowBox[{"mt", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "p21", " ", 
                   RowBox[{"f", "[", 
                    RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
                    RowBox[{"f", "[", 
                    RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "-", 
                  
                  RowBox[{"2", " ", "p11", " ", 
                   RowBox[{"f", "[", 
                    RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "-", 
                  RowBox[{"2", " ", "p11", " ", 
                   RowBox[{"f", "[", 
                    RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "-", 
                  RowBox[{"p11", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"2", ",", "0", ",", "1"}], "]"}], "+", 
                    RowBox[{"f", "[", 
                    RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "-", 
                  
                  RowBox[{"p21", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"2", ",", "0", ",", "1"}], "]"}], "+", 
                    RowBox[{"f", "[", 
                    RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "-", 
                  
                  RowBox[{"2", " ", "p21", " ", 
                   RowBox[{"f", "[", 
                    RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}], 
              ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "mt"}], ")"}], " ", "p21", " ", "ram11"}], 
              ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "mt"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "p11"}], "-", "p21"}], ")"}]}], "-", 
               RowBox[{"mt", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "p21", " ", 
                   RowBox[{"f", "[", 
                    RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
                    RowBox[{"f", "[", 
                    RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "-", 
                  
                  RowBox[{"2", " ", "p11", " ", 
                   RowBox[{"f", "[", 
                    RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "-", 
                  RowBox[{"2", " ", "p11", " ", 
                   RowBox[{"f", "[", 
                    RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "-", 
                  RowBox[{"p11", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"2", ",", "0", ",", "1"}], "]"}], "+", 
                    RowBox[{"f", "[", 
                    RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "-", 
                  
                  RowBox[{"p21", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"2", ",", "0", ",", "1"}], "]"}], "+", 
                    RowBox[{"f", "[", 
                    RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "-", 
                  
                  RowBox[{"2", " ", "p21", " ", 
                   RowBox[{"f", "[", 
                    RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}], 
              ")"}]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "c"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"mt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"f", "[", 
                RowBox[{"1", ",", "0", ",", "0"}], "]"}], "+", 
               RowBox[{"f", "[", 
                RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
               RowBox[{"f", "[", 
                RowBox[{"1", ",", "1", ",", "0"}], "]"}], "+", 
               RowBox[{"f", "[", 
                RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
               RowBox[{"f", "[", 
                RowBox[{"2", ",", "0", ",", "0"}], "]"}], "+", 
               RowBox[{"f", "[", 
                RowBox[{"2", ",", "0", ",", "1"}], "]"}], "+", 
               RowBox[{"f", "[", 
                RowBox[{"2", ",", "1", ",", "0"}], "]"}], "+", 
               RowBox[{"f", "[", 
                RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], ")"}]}]}], 
           ")"}]}], ")"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"s2", " ", 
        RowBox[{"f", "[", 
         RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
            RowBox[{"f", "[", 
             RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "mt"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "p11"}], "-", "p21"}], ")"}]}], "-", 
            RowBox[{"mt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "p21", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"f", "[", 
                   RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
                  RowBox[{"f", "[", 
                   RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "-", 
               RowBox[{"2", " ", "p11", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "-", 
               RowBox[{"2", " ", "p11", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "-", 
               RowBox[{"p11", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"f", "[", 
                   RowBox[{"2", ",", "0", ",", "1"}], "]"}], "+", 
                  RowBox[{"f", "[", 
                   RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "-", 
               RowBox[{"p21", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"f", "[", 
                   RowBox[{"2", ",", "0", ",", "1"}], "]"}], "+", 
                  RowBox[{"f", "[", 
                   RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "-", 
               RowBox[{"2", " ", "p21", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}], 
           ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "c"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"mt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"f", "[", 
                RowBox[{"1", ",", "0", ",", "0"}], "]"}], "+", 
               RowBox[{"f", "[", 
                RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
               RowBox[{"f", "[", 
                RowBox[{"1", ",", "1", ",", "0"}], "]"}], "+", 
               RowBox[{"f", "[", 
                RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
               RowBox[{"f", "[", 
                RowBox[{"2", ",", "0", ",", "0"}], "]"}], "+", 
               RowBox[{"f", "[", 
                RowBox[{"2", ",", "0", ",", "1"}], "]"}], "+", 
               RowBox[{"f", "[", 
                RowBox[{"2", ",", "1", ",", "0"}], "]"}], "+", 
               RowBox[{"f", "[", 
                RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], ")"}]}]}], 
           ")"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", " ", 
          RowBox[{"f", "[", 
           RowBox[{"1", ",", "1", ",", "1"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "mt"}], ")"}]}], " ", "p11"}], "-", 
            RowBox[{
             FractionBox["1", "2"], " ", "mt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "p21", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"f", "[", 
                   RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
                  RowBox[{"f", "[", 
                   RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "-", 
               RowBox[{"2", " ", "p11", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "-", 
               RowBox[{"2", " ", "p11", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "-", 
               RowBox[{"p11", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"f", "[", 
                   RowBox[{"2", ",", "0", ",", "1"}], "]"}], "+", 
                  RowBox[{"f", "[", 
                   RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "-", 
               RowBox[{"p21", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"f", "[", 
                   RowBox[{"2", ",", "0", ",", "1"}], "]"}], "+", 
                  RowBox[{"f", "[", 
                   RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "-", 
               RowBox[{"2", " ", "p21", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}], 
           ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"mt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "0", ",", "0"}], "]"}], "+", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "0", ",", "1"}], "]"}], "+", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "1", ",", "0"}], "]"}], "+", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "1", ",", "1"}], "]"}], "+", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "0", ",", "0"}], "]"}], "+", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "0", ",", "1"}], "]"}], "+", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "1", ",", "0"}], "]"}], "+", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], ")"}]}]}], 
         ")"}]}]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.635587601184538*^9, 3.635587607417033*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"raSaJtab", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"q1", "\[Rule]", "0"}], ",", 
    RowBox[{"q2", "\[Rule]", "0"}], ",", 
    RowBox[{"k", "\[Rule]", "0"}], ",", 
    RowBox[{"Q", "\[Rule]", "0"}], ",", 
    RowBox[{"p10", "\[Rule]", "p11"}], ",", 
    RowBox[{"p20", "\[Rule]", "p21"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.635587731620006*^9, 3.635587794976222*^9}, 
   3.6367038560420732`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"raSaJ", "[", "1", "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"f", "[", 
         RowBox[{"1", ",", "1", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "mt"}], ")"}], " ", "p11"}], "+", 
          RowBox[{"mt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "p21", " ", 
              RowBox[{"f", "[", 
               RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "+", 
             RowBox[{"2", " ", "p11", " ", 
              RowBox[{"f", "[", 
               RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "+", 
             RowBox[{"2", " ", "p11", " ", 
              RowBox[{"f", "[", 
               RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p11", "+", "p21"}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"2", ",", "0", ",", "1"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p11", "+", "p21"}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], "+", 
             RowBox[{"2", " ", "p21", " ", 
              RowBox[{"f", "[", 
               RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}], ")"}],
         " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "mt"}], ")"}], " ", "p11"}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "mt"}], ")"}], " ", "p11"}], "+", 
            RowBox[{"mt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "p21", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "+", 
               RowBox[{"2", " ", "p11", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "+", 
               RowBox[{"2", " ", "p11", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p11", "+", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "0", ",", "1"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p11", "+", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], "+", 
               RowBox[{"2", " ", "p21", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}]], 
          "+", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "mt"}], ")"}], " ", "p11", " ", 
            RowBox[{"raSaJ", "[", "1", "]"}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "mt"}], ")"}], " ", "p11"}], "+", 
            RowBox[{"mt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "p21", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "+", 
               RowBox[{"2", " ", "p11", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "+", 
               RowBox[{"2", " ", "p11", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p11", "+", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "0", ",", "1"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p11", "+", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], "+", 
               RowBox[{"2", " ", "p21", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}]]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", "+", 
        RowBox[{"mt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"f", "[", 
             RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"f", "[", 
             RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"f", "[", 
             RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"f", "[", 
             RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"f", "[", 
             RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"f", "[", 
             RowBox[{"2", ",", "0", ",", "1"}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"f", "[", 
             RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"f", "[", 
             RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}], ")"}]}],
      "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"1", ",", "0", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "mt"}], ")"}]}], " ", 
           RowBox[{"(", 
            RowBox[{"p11", "+", "p21"}], ")"}]}], "+", 
          RowBox[{"mt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "p21", " ", 
              RowBox[{"f", "[", 
               RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "+", 
             RowBox[{"2", " ", "p11", " ", 
              RowBox[{"f", "[", 
               RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "+", 
             RowBox[{"2", " ", "p11", " ", 
              RowBox[{"f", "[", 
               RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p11", "+", "p21"}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"2", ",", "0", ",", "1"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p11", "+", "p21"}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], "+", 
             RowBox[{"2", " ", "p21", " ", 
              RowBox[{"f", "[", 
               RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}], ")"}],
         " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "mt"}], ")"}], " ", "p11"}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "mt"}], ")"}]}], " ", 
             RowBox[{"(", 
              RowBox[{"p11", "+", "p21"}], ")"}]}], "+", 
            RowBox[{"mt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "p21", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "+", 
               RowBox[{"2", " ", "p11", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "+", 
               RowBox[{"2", " ", "p11", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p11", "+", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "0", ",", "1"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p11", "+", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], "+", 
               RowBox[{"2", " ", "p21", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}]], 
          "+", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "mt"}], ")"}], " ", "p21", " ", 
            RowBox[{"raSmJ", "[", "1", "]"}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "mt"}], ")"}]}], " ", 
             RowBox[{"(", 
              RowBox[{"p11", "+", "p21"}], ")"}]}], "+", 
            RowBox[{"mt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "p21", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "+", 
               RowBox[{"2", " ", "p11", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "+", 
               RowBox[{"2", " ", "p11", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p11", "+", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "0", ",", "1"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p11", "+", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], "+", 
               RowBox[{"2", " ", "p21", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}]]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "c1"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"2", " ", "mt", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "0", ",", "1"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "1", ",", "1"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "0", ",", "0"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "0", ",", "1"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "1", ",", "0"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], ")"}]}]}], ")"}]}], 
       ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"1", ",", "1", ",", "0"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "mt"}], ")"}]}], " ", 
           RowBox[{"(", 
            RowBox[{"p11", "+", "p21"}], ")"}]}], "+", 
          RowBox[{"mt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "p21", " ", 
              RowBox[{"f", "[", 
               RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "+", 
             RowBox[{"2", " ", "p11", " ", 
              RowBox[{"f", "[", 
               RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "+", 
             RowBox[{"2", " ", "p11", " ", 
              RowBox[{"f", "[", 
               RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p11", "+", "p21"}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"2", ",", "0", ",", "1"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p11", "+", "p21"}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], "+", 
             RowBox[{"2", " ", "p21", " ", 
              RowBox[{"f", "[", 
               RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}], ")"}],
         " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "mt"}], ")"}], " ", "p11"}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "mt"}], ")"}]}], " ", 
             RowBox[{"(", 
              RowBox[{"p11", "+", "p21"}], ")"}]}], "+", 
            RowBox[{"mt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "p21", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "+", 
               RowBox[{"2", " ", "p11", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "+", 
               RowBox[{"2", " ", "p11", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p11", "+", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "0", ",", "1"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p11", "+", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], "+", 
               RowBox[{"2", " ", "p21", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}]], 
          "+", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "mt"}], ")"}], " ", "p21", " ", 
            RowBox[{"rmSaJ", "[", "1", "]"}]}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "mt"}], ")"}]}], " ", 
             RowBox[{"(", 
              RowBox[{"p11", "+", "p21"}], ")"}]}], "+", 
            RowBox[{"mt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "p21", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "+", 
               RowBox[{"2", " ", "p11", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "+", 
               RowBox[{"2", " ", "p11", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p11", "+", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "0", ",", "1"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p11", "+", "p21"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], "+", 
               RowBox[{"2", " ", "p21", " ", 
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}]]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "c3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"2", " ", "mt", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "0", ",", "1"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "1", ",", "1"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "0", ",", "0"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "0", ",", "1"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "1", ",", "0"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], ")"}]}]}], ")"}]}], 
       ")"}]}], "+", 
     RowBox[{"s2", " ", 
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "0", ",", "0"}], "]"}], " ", 
      RowBox[{"rmSmJ", "[", "2", "]"}]}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"s2", " ", 
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "+", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"f", "[", 
        RowBox[{"1", ",", "1", ",", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "mt"}], ")"}], " ", "p11"}], "+", 
         RowBox[{"mt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "p21", " ", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "+", 
            RowBox[{"2", " ", "p11", " ", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "+", 
            RowBox[{"2", " ", "p11", " ", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p11", "+", "p21"}], ")"}], " ", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "0", ",", "1"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p11", "+", "p21"}], ")"}], " ", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], "+", 
            RowBox[{"2", " ", "p21", " ", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}], 
        ")"}]}], 
      RowBox[{"2", "+", 
       RowBox[{"mt", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"f", "[", 
            RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"f", "[", 
            RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"f", "[", 
            RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"f", "[", 
            RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"f", "[", 
            RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"f", "[", 
            RowBox[{"2", ",", "0", ",", "1"}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"f", "[", 
            RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"f", "[", 
            RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}]], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"1", ",", "0", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "mt"}], ")"}]}], " ", 
           RowBox[{"(", 
            RowBox[{"p11", "+", "p21"}], ")"}]}], "+", 
          RowBox[{"mt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "p21", " ", 
              RowBox[{"f", "[", 
               RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "+", 
             RowBox[{"2", " ", "p11", " ", 
              RowBox[{"f", "[", 
               RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "+", 
             RowBox[{"2", " ", "p11", " ", 
              RowBox[{"f", "[", 
               RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p11", "+", "p21"}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"2", ",", "0", ",", "1"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p11", "+", "p21"}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], "+", 
             RowBox[{"2", " ", "p21", " ", 
              RowBox[{"f", "[", 
               RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "c1"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"2", " ", "mt", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "0", ",", "1"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "1", ",", "1"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "0", ",", "0"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "0", ",", "1"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "1", ",", "0"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], ")"}]}]}], ")"}]}], 
       ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"1", ",", "1", ",", "0"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "mt"}], ")"}]}], " ", 
           RowBox[{"(", 
            RowBox[{"p11", "+", "p21"}], ")"}]}], "+", 
          RowBox[{"mt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "p21", " ", 
              RowBox[{"f", "[", 
               RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"1", ",", "0", ",", "1"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "p11"}], "-", "p21"}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"1", ",", "1", ",", "0"}], "]"}]}], "+", 
             RowBox[{"2", " ", "p11", " ", 
              RowBox[{"f", "[", 
               RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], "+", 
             RowBox[{"2", " ", "p11", " ", 
              RowBox[{"f", "[", 
               RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p11", "+", "p21"}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"2", ",", "0", ",", "1"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p11", "+", "p21"}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"2", ",", "1", ",", "0"}], "]"}]}], "+", 
             RowBox[{"2", " ", "p21", " ", 
              RowBox[{"f", "[", 
               RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "c3"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"2", "-", 
          RowBox[{"2", " ", "mt", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "0", ",", "0"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "0", ",", "1"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "1", ",", "0"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"1", ",", "1", ",", "1"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "0", ",", "0"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "0", ",", "1"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "1", ",", "0"}], "]"}], "-", 
             RowBox[{"f", "[", 
              RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], ")"}]}]}], ")"}]}], 
       ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.635587732540638*^9, 3.635587800003723*^9}, 
   3.6367037492330217`*^9, 3.636703856470125*^9, 3.6367051674068117`*^9, 
   3.6367069319403*^9, 3.63670797562265*^9, 3.636724344302742*^9, 
   3.636724866007969*^9, 3.6367263120869017`*^9, 3.636726754975718*^9, 
   3.636728169736692*^9, 3.636728409914547*^9, 3.6367284917881413`*^9, 
   3.636792393670701*^9, 3.636866568607514*^9, 3.639394576039887*^9, 
   3.639394704875533*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"reltab", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Join", "[", 
     RowBox[{"raSaJtab", ",", "rmSaJtab", ",", "raSmJtab", ",", "rmSmJtab"}], 
     "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reqtab", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Join", "[", 
     RowBox[{"reltab", ",", "veqtab1", ",", "feqtab"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reltab0", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "-", 
      RowBox[{"x", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "reltab"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"relvars", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"raSaJ", "[", "1", "]"}], ",", 
     RowBox[{"raSaJ", "[", "2", "]"}], ",", 
     RowBox[{"rmSaJ", "[", "1", "]"}], ",", 
     RowBox[{"rmSaJ", "[", "2", "]"}], ",", 
     RowBox[{"raSmJ", "[", "1", "]"}], ",", 
     RowBox[{"raSmJ", "[", "2", "]"}], ",", 
     RowBox[{"rmSmJ", "[", "1", "]"}], ",", 
     RowBox[{"rmSmJ", "[", "2", "]"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.501836992729465*^9, 3.501836995095668*^9}, {
   3.501837797482402*^9, 3.501837821375182*^9}, {3.5051971853745937`*^9, 
   3.505197201715537*^9}, {3.505197232487157*^9, 3.505197243327004*^9}, {
   3.505211434509547*^9, 3.505211521752357*^9}, {3.505211556992576*^9, 
   3.505211568382031*^9}, {3.505211620703909*^9, 3.505211623282103*^9}, {
   3.505211706901904*^9, 3.505211718029876*^9}, 3.505302284780422*^9, {
   3.520421215472803*^9, 3.520421228578953*^9}, {3.520421328940182*^9, 
   3.52042133038615*^9}, {3.520421436390558*^9, 3.520421459204155*^9}, {
   3.633530093106083*^9, 3.6335301547264957`*^9}, {3.633530309674049*^9, 
   3.633530350434635*^9}, {3.63353053671518*^9, 3.633530537097549*^9}, {
   3.633960163459532*^9, 3.6339602337108793`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frootstartvals3", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"frootstartvals2", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "0.1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "relvars"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.505137730742549*^9, 3.505137753535753*^9}, {
  3.505138239000499*^9, 3.505138282387862*^9}, {3.505138313192811*^9, 
  3.505138353035645*^9}, {3.633530527998971*^9, 3.63353056442082*^9}, {
  3.6339578593200283`*^9, 3.6339578610228662`*^9}}],

Cell[TextData[StyleBox["Numerical solving of relatedness equations",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.593445660381074*^9, 3.593445670548917*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans3", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "m_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p10s_", ",", "p20s_", ",", "p11s_", ",", "p21s_"}], "}"}], ",", 
    "ks_", ",", "Qs_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{"reqtab", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
       RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
       RowBox[{"k", "\[Rule]", "ks"}], ",", 
       RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
       RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
       RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
       RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
       RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
       RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
       RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
       RowBox[{"mt", "\[Rule]", "m"}], ",", 
       RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
       RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
       RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
       RowBox[{"p21", "\[Rule]", "p21s"}]}], "}"}]}], ",", 
    "frootstartvals3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.633530670643664*^9, 3.6335306820240297`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"recursion", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "m_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p10s_", ",", "p20s_", ",", "p11s_", ",", "p21s_"}], "}"}], ",", 
    "ks_", ",", "Qs_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Data", ",", "fitplus1", ",", "iter", ",", "fi", ",", "reptable"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Data", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "0.333327", "}"}], ",", 
        RowBox[{"{", "0.33173", "}"}], ",", 
        RowBox[{"{", "0.333293", "}"}], ",", 
        RowBox[{"{", "0.332225", "}"}], ",", 
        RowBox[{"{", "0.333239", "}"}], ",", 
        RowBox[{"{", "0.31535", "}"}], ",", 
        RowBox[{"{", "0.333323", "}"}], ",", 
        RowBox[{"{", "0.332312", "}"}]}], "}"}]}], ";", "\n", "\n", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "2"}], ",", 
       RowBox[{"iter", "<", "100"}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"reptable", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"raSaJ", "[", "1", "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"Data", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"iter", "-", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"raSaJ", "[", "2", "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"Data", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"iter", "-", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rmSaJ", "[", "1", "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"Data", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"iter", "-", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rmSaJ", "[", "2", "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"Data", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"iter", "-", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"raSmJ", "[", "1", "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"Data", "[", 
              RowBox[{"[", "5", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"iter", "-", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"raSmJ", "[", "2", "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"Data", "[", 
              RowBox[{"[", "6", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"iter", "-", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rmSmJ", "[", "1", "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"Data", "[", 
              RowBox[{"[", "7", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"iter", "-", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rmSmJ", "[", "2", "]"}], "\[Rule]", 
            RowBox[{
             RowBox[{"Data", "[", 
              RowBox[{"[", "8", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"iter", "-", "1"}], "]"}], "]"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"fi", "=", "1"}], ",", 
          RowBox[{"fi", "<=", 
           RowBox[{"Length", "[", "reltab0", "]"}]}], ",", 
          RowBox[{"fi", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"fitplus1", "=", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"relvars", "[", 
                 RowBox[{"[", "fi", "]"}], "]"}], "+", 
                RowBox[{"0.01", "*", 
                 RowBox[{"reltab0", "[", 
                  RowBox[{"[", "fi", "]"}], "]"}]}]}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
                 RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
                 RowBox[{"k", "\[Rule]", "ks"}], ",", 
                 RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
                 RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
                 RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
                 RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
                 RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
                 RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
                 RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
                 RowBox[{"mt", "\[Rule]", "m"}], ",", 
                 RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
                 RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
                 RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
                 RowBox[{"p21", "\[Rule]", "p21s"}]}], "}"}]}], "/.", 
              "reptable"}], "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "0", ",", "0"}], "]"}], "->", "0.109865"}],
                ",", 
               RowBox[{
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "0", ",", "1"}], "]"}], "->", "0.292577"}],
                ",", 
               RowBox[{
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "1", ",", "0"}], "]"}], "->", "0.146901"}],
                ",", 
               RowBox[{
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "1", ",", "1"}], "]"}], "->", "0.44064"}], 
               ",", 
               RowBox[{
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "0", ",", "0"}], "]"}], "->", 
                "0.00161133"}], ",", 
               RowBox[{
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "0", ",", "1"}], "]"}], "->", 
                "0.0026826"}], ",", 
               RowBox[{
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "1", ",", "0"}], "]"}], "->", 
                "0.00194728"}], ",", 
               RowBox[{
                RowBox[{"f", "[", 
                 RowBox[{"2", ",", "1", ",", "1"}], "]"}], "->", 
                "0.00377611"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Data", "[", 
             RowBox[{"[", "fi", "]"}], "]"}], "=", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Data", "[", 
               RowBox[{"[", "fi", "]"}], "]"}], ",", "fitplus1"}], "]"}]}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "Data", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.633953057934597*^9, 3.6339530708768177`*^9}, {
   3.633953154844256*^9, 3.633953278590911*^9}, {3.633953311053967*^9, 
   3.633953517809237*^9}, {3.633953754949416*^9, 3.633953972940585*^9}, {
   3.633954003553029*^9, 3.633954097960052*^9}, {3.6339541404005947`*^9, 
   3.633954264525957*^9}, {3.633954332337667*^9, 3.633954360290299*^9}, {
   3.6339544626029577`*^9, 3.633954515744809*^9}, {3.633954893507534*^9, 
   3.633954893988542*^9}, {3.633957952011561*^9, 3.6339581043789387`*^9}, {
   3.633958156867735*^9, 3.633958190656343*^9}, {3.63395823559032*^9, 
   3.63395823641007*^9}, {3.633958938288815*^9, 3.633958952874299*^9}, {
   3.633959511184765*^9, 3.633959514639648*^9}, 3.633959608303594*^9, {
   3.63395993223001*^9, 3.6339599398021297`*^9}, {3.633960884835579*^9, 
   3.6339609286688957`*^9}, {3.63396154738349*^9, 3.633961548275865*^9}, {
   3.633962717833908*^9, 3.633962722310403*^9}, {3.633962956822117*^9, 
   3.633962958056026*^9}, {3.633962992003652*^9, 3.633962992678965*^9}, {
   3.633963189809287*^9, 3.6339632520887623`*^9}, {3.6339640074306393`*^9, 
   3.6339640612049313`*^9}, {3.633964152795774*^9, 3.6339641612531652`*^9}, {
   3.6339642228353643`*^9, 3.633964235123485*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"recursion", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.00317", ",", "0.3146"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", "0.5", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.501644", ",", "0.500733", ",", "0.501266", ",", "0.501266"}],
       "}"}], ",", "0.10", ",", ".05"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6339596172995443`*^9, 3.6339596223553877`*^9}, {
  3.633960218718637*^9, 3.633960221965825*^9}, {3.633960878645289*^9, 
  3.633960880598172*^9}, {3.633964520575598*^9, 3.633964554323535*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"0.8546018543091871`", "+", "0.8489263934521826`"}], ")"}], "/", 
  "2"}]], "Input",
 CellChangeTimes->{
  3.6367268318106623`*^9, {3.636726863818074*^9, 3.636726917382923*^9}, {
   3.636726950174756*^9, 3.636726986347909*^9}}],

Cell[BoxData["0.8517641238806848`"], "Output",
 CellChangeTimes->{{3.6367268963830957`*^9, 3.636726917776857*^9}, 
   3.636726950886965*^9, 3.636726987197254*^9, 3.6367281735735693`*^9, 
   3.636728413432021*^9, 3.6367284953044977`*^9, 3.636792397684744*^9, 
   3.6368665740681562`*^9, 3.6393945802477694`*^9, 3.639394709252627*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ans3", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.88", ",", "0.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1", ",", "0.5", ",", "0.1", ",", "0.5"}], "}"}], ",", "0.10", 
   ",", ".05"}], "]"}]], "Input",
 CellChangeTimes->{{3.500192029842957*^9, 3.500192032446335*^9}, {
   3.501923482525814*^9, 3.501923510215691*^9}, 3.5019239348204813`*^9, {
   3.50193133558246*^9, 3.501931358478292*^9}, {3.5032540622901*^9, 
   3.503254067378688*^9}, {3.505135027019304*^9, 3.505135031903424*^9}, {
   3.50513578285544*^9, 3.505135784285997*^9}, {3.505135894350724*^9, 
   3.505135895026915*^9}, {3.507217302061491*^9, 3.507217316708229*^9}, {
   3.508161095277032*^9, 3.508161096760681*^9}, {3.508161237183029*^9, 
   3.508161239674842*^9}, {3.508161319583596*^9, 3.508161323949635*^9}, {
   3.51566001997472*^9, 3.515660071679375*^9}, {3.520419450927335*^9, 
   3.520419468632097*^9}, {3.520419567807807*^9, 3.520419570324196*^9}, {
   3.520419750326867*^9, 3.520419756677986*^9}, {3.520420937695824*^9, 
   3.520420953180814*^9}, {3.520427627254544*^9, 3.520427638687585*^9}, {
   3.520429208593634*^9, 3.520429231674042*^9}, {3.524554969421171*^9, 
   3.524554973766278*^9}, {3.524555006868618*^9, 3.524555007460496*^9}, {
   3.524555062494341*^9, 3.524555063917426*^9}, {3.590823966331852*^9, 
   3.590823968139655*^9}, {3.590824274713768*^9, 3.590824276960957*^9}, {
   3.5925441110935087`*^9, 3.592544125601429*^9}, {3.5925442568585777`*^9, 
   3.59254426919372*^9}, {3.633514370529613*^9, 3.6335143777164917`*^9}, {
   3.633514516945455*^9, 3.6335145491926126`*^9}, {3.633514947236693*^9, 
   3.633514952333398*^9}, {3.633530708173682*^9, 3.633530708717044*^9}, {
   3.633895643076476*^9, 3.633895654687756*^9}, {3.633895862251288*^9, 
   3.633895865173752*^9}, {3.633896184627439*^9, 3.633896215857162*^9}, 
   3.63395781281997*^9, {3.635587099301242*^9, 3.635587113214438*^9}, {
   3.6367052922186193`*^9, 3.63670529771371*^9}, {3.63670561122477*^9, 
   3.6367056148892803`*^9}, {3.636706615854217*^9, 3.636706619360526*^9}, {
   3.636707163677095*^9, 3.636707171702772*^9}, {3.636726321139001*^9, 
   3.636726322434565*^9}, {3.636726727524296*^9, 3.6367267289713783`*^9}, {
   3.6367267767304163`*^9, 3.636726779241045*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.030309888128680757`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.029594487569229774`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.026255745230019105`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.01588069539860102`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.0394207993516361`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.2402645608235725`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.13159078185719045`"}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"2", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.48668304164107035`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.9614267469745843`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.9614267469745825`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.8731353947588362`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.8731353947588362`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "1.0758388786238557`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "1.0758388786238557`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.98612865094526`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"1", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.98612865094526`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.9688468745073818`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.9688468745073818`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"2", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.8076393865896284`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"2", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.8076393865896284`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"2", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "1.1772072228611918`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"2", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "1.1772072228611918`"}], ",", 
   RowBox[{
    RowBox[{"vs", "[", 
     RowBox[{"2", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "1.0140951135507812`"}], ",", 
   RowBox[{
    RowBox[{"vj", "[", 
     RowBox[{"2", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "1.0140951135507812`"}], ",", 
   RowBox[{
    RowBox[{"raSaJ", "[", "1", "]"}], "\[Rule]", "0.7736850597674428`"}], ",", 
   RowBox[{
    RowBox[{"raSaJ", "[", "2", "]"}], "\[Rule]", "0.823614507326014`"}], ",", 
   
   RowBox[{
    RowBox[{"rmSaJ", "[", "1", "]"}], "\[Rule]", "0.8474717778117873`"}], ",", 
   RowBox[{
    RowBox[{"rmSaJ", "[", "2", "]"}], "\[Rule]", "0.8546018543091871`"}], ",", 
   RowBox[{
    RowBox[{"raSmJ", "[", "1", "]"}], "\[Rule]", "0.8586604980287208`"}], ",", 
   RowBox[{
    RowBox[{"raSmJ", "[", "2", "]"}], "\[Rule]", "0.8489263934521821`"}], ",", 
   RowBox[{
    RowBox[{"rmSmJ", "[", "1", "]"}], "\[Rule]", "0.8222428709632161`"}], ",", 
   RowBox[{
    RowBox[{"rmSmJ", "[", "2", "]"}], "\[Rule]", "0.7680201455632931`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.608820324347061*^9, 3.6088205298081427`*^9, 3.6335143677286587`*^9, {
   3.633514535529338*^9, 3.633514561898377*^9}, 3.6335149158693438`*^9, 
   3.6335149533266287`*^9, 3.633517283389391*^9, {3.633523706770524*^9, 
   3.633523716823366*^9}, {3.633530709879918*^9, 3.6335307138094254`*^9}, 
   3.633530796084662*^9, 3.633839969594513*^9, 3.633841474074772*^9, 
   3.633894737637259*^9, 3.63389558643629*^9, 3.633895656677347*^9, 
   3.633895869005435*^9, {3.6338961891389103`*^9, 3.6338962169179792`*^9}, 
   3.633896366611476*^9, 3.633948265061634*^9, 3.63395250574644*^9, 
   3.63395258686108*^9, 3.6339549608221207`*^9, 3.6339552407491827`*^9, 
   3.633955598848139*^9, 3.63395708254615*^9, 3.6339578160424423`*^9, 
   3.633957864753359*^9, 3.6339586634556437`*^9, 3.6339591723657207`*^9, 
   3.6339592505042343`*^9, 3.633960445556652*^9, 3.633964707403336*^9, 
   3.633964797083742*^9, 3.6339650713005447`*^9, 3.634903542560779*^9, 
   3.634903670542231*^9, 3.63497689225039*^9, 3.635072887320643*^9, 
   3.635074421429579*^9, 3.6350744973181477`*^9, 3.635074818993821*^9, 
   3.635075349439293*^9, 3.635414727494542*^9, 3.635415276229672*^9, {
   3.635587093753002*^9, 3.635587114427548*^9}, 3.6367051723468122`*^9, {
   3.636705289502636*^9, 3.636705298926703*^9}, {3.6367055939724693`*^9, 
   3.636705615996413*^9}, 3.6367066205172243`*^9, 3.63670693664629*^9, {
   3.636707164966229*^9, 3.636707172713173*^9}, 3.636707980361248*^9, 
   3.636724348377528*^9, 3.636724870234747*^9, {3.6367263161657352`*^9, 
   3.636726323963435*^9}, {3.636726759311605*^9, 3.636726786418644*^9}, 
   3.636727368188167*^9, 3.636728174200885*^9, 3.636728414042623*^9, 
   3.636728495976418*^9, 3.63679239840307*^9, 3.636866574705607*^9, 
   3.639394580904806*^9, 3.639394709903092*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Selection gradients on p1,p2", "Section",
 CellChangeTimes->{{3.6398194364432077`*^9, 3.639819442107037*^9}}],

Cell["\<\
Offspring production (adapted, or maladapted) by breeders other than focal:\
\>", "Text",
 CellChangeTimes->{{3.633502006323659*^9, 3.633502023368882*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"adotherjuv", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"dispad", "[", "es", "]"}], 
   RowBox[{"localcomptotal", "[", 
    RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"madotherjuv", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"dispmad", "[", "es", "]"}], 
   RowBox[{"localcomptotal", "[", 
    RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}]]}]}], "Input",
 CellChangeTimes->{{3.633501670161281*^9, 3.633501678106861*^9}, {
  3.633501801679626*^9, 3.6335018165560217`*^9}, {3.6335018530246983`*^9, 
  3.633501899427931*^9}, {3.633501960039475*^9, 3.63350199643281*^9}, {
  3.63350203302719*^9, 3.633502046065723*^9}, {3.633502116617215*^9, 
  3.633502121965958*^9}, {3.639817652522341*^9, 3.6398176580872602`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"adothersen", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"dispad", "[", "es", "]"}], 
   RowBox[{"localcomptotal", "[", 
    RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"madothersen", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{"dispmad", "[", "es", "]"}], 
   RowBox[{"localcomptotal", "[", 
    RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}]]}]}], "Input",
 CellChangeTimes->{{3.633501670161281*^9, 3.633501678106861*^9}, {
  3.633501801679626*^9, 3.6335018165560217`*^9}, {3.6335018530246983`*^9, 
  3.633501899427931*^9}, {3.633501960039475*^9, 3.63350199643281*^9}, {
  3.63350203302719*^9, 3.633502046065723*^9}, {3.633502106686488*^9, 
  3.6335021327235947`*^9}, {3.63350223193182*^9, 3.633502269623418*^9}, {
  3.635075134826212*^9, 3.6350751397714853`*^9}, {3.639817661100219*^9, 
  3.639817664336442*^9}}],

Cell["Reproductive values for juveniles:", "Text",
 CellChangeTimes->{{3.633408799390526*^9, 3.633408803925744*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvjdt", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", "es", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vj", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", 
           RowBox[{"1", "-", "aself"}], ",", 
           RowBox[{"1", "-", "asenior"}]}], "]"}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"environmental", " ", "change"}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
            RowBox[{"dp", "[", 
             RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", 
            RowBox[{"1", "-", "aself"}], ",", "asenior"}], "]"}]}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "juvenile"}], ",", " ", 
        RowBox[{
        "focal", " ", "junior", " ", "is", " ", "the", " ", "mother", " ", 
         "of", " ", "the", " ", "successful", " ", "offspring"}], ",", " ", 
        RowBox[{
        "who", " ", "is", " ", "of", " ", "a", " ", "different", " ", 
         "type"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
            RowBox[{"dp", "[", 
             RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"sho", " ", 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], "-", 
         RowBox[{"shm", " ", 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "juvenile"}], ",", " ", 
        RowBox[{
        "focal", " ", "junior", " ", "is", " ", "the", " ", "mother", " ", 
         "of", " ", "the", " ", "successful", " ", "offspring"}], ",", " ", 
        RowBox[{
        "who", " ", "is", " ", "of", " ", "the", " ", "same", " ", "type"}]}],
        " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"aself", "\[Equal]", "asenior"}], ",", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "+", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}]}], ",", 
           RowBox[{"1", "-", 
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "-", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}]}]}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"sho", " ", 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", 
            RowBox[{"1", "-", "aself"}], ",", "asenior"}], "]"}]}], "-", 
         RowBox[{"shm", " ", 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "juvenile"}], ",", " ", 
        RowBox[{
        "focal", " ", "junior", " ", "is", " ", "the", " ", "father", " ", 
         "of", " ", "the", " ", "successful", " ", "offspring"}], ",", " ", 
        RowBox[{
        "the", " ", "new", " ", "offspring", " ", "is", " ", "of", " ", "a", 
         " ", "different", " ", "type", " ", "than", " ", "the", " ", 
         "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"aself", "\[Equal]", "asenior"}], ",", 
           RowBox[{"1", "-", 
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "-", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "+", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}]}]}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"sho", " ", 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], "-", 
         RowBox[{"shm", " ", 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "juvenile"}], ",", " ", 
        RowBox[{
        "focal", " ", "junior", " ", "is", " ", "the", " ", "father", " ", 
         "of", " ", "the", " ", "successful", " ", "offspring"}], ",", " ", 
        RowBox[{
        "the", " ", "new", " ", "offspring", " ", "is", " ", "of", " ", "the",
          " ", "same", " ", "type", " ", "as", " ", "the", " ", "focal"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dispad", "[", "es", "]"}], "+", 
           RowBox[{"dispmad", "[", "es", "]"}]}], ")"}], "/", 
         RowBox[{"localcomptotal", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "shm"}], " ", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "juvenile"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", "nonfocal", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"i", ".", "e", "."}], ",", " ", 
           RowBox[{"immigrant", " ", "offspring"}]}], " "}]}]}], "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
            RowBox[{"dp", "[", 
             RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"shm", " ", 
          RowBox[{"vs", "[", 
           RowBox[{"es", ",", "aself", ",", "aself"}], "]"}]}], "+", 
         RowBox[{"sho", " ", 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", "aself", ",", "aself"}], "]"}]}], "-", 
         RowBox[{"shm", " ", 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], "-", 
         RowBox[{"shf", " ", 
          RowBox[{"vs", "[", 
           RowBox[{"es", ",", "asenior", ",", "aself"}], "]"}]}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"senior", " ", "dies"}], ",", " ", 
        RowBox[{"focal", " ", "takes", " ", "over"}], ",", " ", 
        RowBox[{
         RowBox[{"focal", "'"}], "s", " ", "place", " ", "is", " ", "taken", 
         " ", "by", " ", "offspring", " ", "mothered", " ", "by", " ", 
         "focal"}], ",", " ", 
        RowBox[{
        "of", " ", "the", " ", "same", " ", "type", " ", "as", " ", 
         "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"aself", "\[Equal]", "asenior"}], ",", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "-", 
             RowBox[{
              RowBox[{"R", "[", 
               RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
              RowBox[{"dp", "[", 
               RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}]}], ")"}], 
           ",", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "+", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}]}]}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "aself"}], "]"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", "aself", ",", "aself"}], "]"}]}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"senior", " ", "dies"}], ",", " ", 
        RowBox[{"focal", " ", "takes", " ", "over"}], ",", " ", 
        RowBox[{
         RowBox[{"focal", "'"}], "s", " ", "place", " ", "is", " ", "taken", 
         " ", "by", " ", "offspring", " ", "mothered", " ", "by", " ", 
         "senior"}], ",", " ", 
        RowBox[{
        "of", " ", "the", " ", "same", " ", "type", " ", "as", " ", 
         "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
            RowBox[{"dp", "[", 
             RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", 
           RowBox[{"1", "-", "aself"}]}], "]"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", 
            RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}]}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"senior", " ", "dies"}], ",", " ", 
        RowBox[{"focal", " ", "takes", " ", "over"}], ",", " ", 
        RowBox[{
         RowBox[{"focal", "'"}], "s", " ", "place", " ", "is", " ", "taken", 
         " ", "by", " ", "focal", " ", "offspring", " ", "mothered", " ", 
         "by", " ", "focal", " ", "of", " ", "different", " ", "type", " ", 
         "as", " ", "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"asenior", "\[Equal]", "aself"}], ",", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "+", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}]}], ",", 
           RowBox[{"1", "-", 
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "-", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}]}]}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", 
           RowBox[{"1", "-", "aself"}]}], "]"}], "+", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", 
            RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}]}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"senior", " ", "dies"}], ",", " ", 
        RowBox[{"focal", " ", "takes", " ", "over"}], ",", " ", 
        RowBox[{
         RowBox[{"focal", "'"}], "s", " ", "place", " ", "is", " ", "taken", 
         " ", "by", " ", "focal", " ", "offspring", " ", "fathered", " ", 
         "by", " ", "focal", " ", "of", " ", "different", " ", "type", " ", 
         "as", " ", "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
       RowBox[{"madotherjuv", "[", 
        RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"senior", " ", "dies"}], ",", " ", 
        RowBox[{"focal", " ", "takes", " ", "over"}], ",", " ", 
        RowBox[{
         RowBox[{"focal", "'"}], "s", " ", "place", " ", "is", " ", "taken", 
         " ", "by", " ", "immigrant"}], ",", " ", 
        RowBox[{"maladapted", " ", "offspring"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
       RowBox[{"adotherjuv", "[", 
        RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"senior", " ", "dies"}], ",", " ", 
        RowBox[{"focal", " ", "takes", " ", "over"}], ",", " ", 
        RowBox[{
         RowBox[{"focal", "'"}], "s", " ", "place", " ", "is", " ", "taken", 
         " ", "by", " ", "nonfocal"}], ",", " ", 
        RowBox[{"adapted", " ", "offspring"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "k"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         RowBox[{"g", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "aju", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "asen"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
                   RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "asen"}], "]"}]}]}], ")"}]}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "on", " ", "other", " ", "patch", " ", "juv", " ", "dies"}], " ",
              "*)"}], "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "asen", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "aju"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
                   RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "aju"}], "]"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "on", " ", "other", " ", "patch", " ", "senior", " ", "dies"}], 
            " ", "*)"}], "\[IndentingNewLine]", ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"nes", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"aju", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"asen", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "k"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
         RowBox[{"g", "[", 
          RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}], ")"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "aju", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}]}], 
                  ")"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "asenior", ",", 
                    RowBox[{"1", "-", "asenior"}]}], "]"}], ",", "asen"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "+", 
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}]}], 
                  ")"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "asenior"}], ",", "asenior"}], "]"}], 
                  ",", "asen"}], "]"}]}]}], ")"}]}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "on", " ", "other", " ", "patch", " ", "juv", " ", "dies"}], " ",
              "*)"}], "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "asen", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}]}], 
                  ")"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "asenior", ",", 
                    RowBox[{"1", "-", "asenior"}]}], "]"}], ",", "aju"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], "+", 
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "asenior", ",", "1"}], "]"}]}]}], 
                  ")"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "asenior"}], ",", "asenior"}], "]"}], 
                  ",", "aju"}], "]"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "on", " ", "other", " ", "patch", " ", "senior", " ", "dies"}], 
            " ", "*)"}], "\[IndentingNewLine]", ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"nes", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"aju", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"asen", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"asenior", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6334084080101213`*^9, 3.633408621437086*^9}, {
   3.6334086672433157`*^9, 3.633408715858348*^9}, {3.633408910762005*^9, 
   3.633409004305276*^9}, {3.633409079984435*^9, 3.6334091436039467`*^9}, {
   3.633409234220334*^9, 3.6334093376593933`*^9}, {3.63340946258109*^9, 
   3.63340955582442*^9}, {3.633409591100646*^9, 3.6334096722567387`*^9}, {
   3.633409801247815*^9, 3.6334098590954533`*^9}, {3.633409968851397*^9, 
   3.6334099743284073`*^9}, {3.6334120000365953`*^9, 
   3.6334120036565847`*^9}, {3.633412120988165*^9, 3.633412313351788*^9}, {
   3.6334123969233217`*^9, 3.633412616820354*^9}, {3.6334986115316343`*^9, 
   3.63349863506009*^9}, {3.633501181927599*^9, 3.63350118523438*^9}, {
   3.633502342169443*^9, 3.633502353983124*^9}, 3.6335027594929647`*^9, {
   3.633502799345827*^9, 3.633502800366242*^9}, {3.6350726994989653`*^9, 
   3.635072724600594*^9}, {3.639816607596588*^9, 3.639816636426712*^9}, {
   3.639816794528438*^9, 3.639816847099381*^9}, {3.6398168851308117`*^9, 
   3.639817066040555*^9}, {3.639817104144808*^9, 3.639817206507987*^9}, {
   3.639817243482286*^9, 3.639817342084363*^9}, {3.63981739389883*^9, 
   3.639817526698237*^9}, {3.639817560967409*^9, 3.639817571883737*^9}, {
   3.639817750371789*^9, 3.63981789909881*^9}, {3.639819530197644*^9, 
   3.639819573682558*^9}, {3.639819646229993*^9, 3.639819722262061*^9}, {
   3.6398197905957937`*^9, 3.639819884043232*^9}, {3.639819972239769*^9, 
   3.639819986690236*^9}, {3.6398201247942543`*^9, 3.6398203460811663`*^9}, {
   3.639821412893475*^9, 3.63982156892942*^9}, {3.6398237318224993`*^9, 
   3.639823748619179*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvsdt", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", "es", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", 
           RowBox[{"1", "-", "aself"}], ",", 
           RowBox[{"1", "-", "ajuv"}]}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
            RowBox[{"dp", "[", 
             RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", 
            RowBox[{"1", "-", "aself"}], ",", "ajuv"}], "]"}]}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "senior"}], ",", " ", 
        RowBox[{
         RowBox[{"replaced", " ", "by", " ", "juvenile"}], ";", " ", 
         RowBox[{
         "focal", " ", "is", " ", "mother", " ", "of", " ", "the", " ", 
          "successful", " ", "offspring", " ", "recruited", " ", "of", " ", 
          "different", " ", "type", " ", "as", " ", "focal"}]}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
            RowBox[{"dp", "[", 
             RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "senior"}], ",", " ", 
        RowBox[{
         RowBox[{"replaced", " ", "by", " ", "juvenile"}], ";", " ", 
         RowBox[{
          RowBox[{"focal", "'"}], "s", " ", "is", " ", "mother", " ", "of", 
          " ", "the", " ", "successful", " ", "offspring", " ", "recruited", 
          " ", "of", " ", "same", " ", "type", " ", "as", " ", "focal"}]}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ajuv", "\[Equal]", "aself"}], ",", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "+", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}]}], ",", 
           RowBox[{"1", "-", 
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "-", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}]}]}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", 
            RowBox[{"1", "-", "aself"}], ",", "ajuv"}], "]"}]}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "senior"}], ",", " ", 
        RowBox[{
         RowBox[{"replaced", " ", "by", " ", "juvenile"}], ";", " ", 
         RowBox[{
         "focal", " ", "is", " ", "father", " ", "of", " ", "the", " ", 
          "successful", " ", "offspring", " ", "recruited", " ", "of", " ", 
          "different", " ", "type", " ", "as", " ", "focal"}]}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ajuv", "\[Equal]", "aself"}], ",", 
           RowBox[{"1", "-", 
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "-", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "+", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}]}]}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "senior"}], ",", " ", 
        RowBox[{
         RowBox[{"replaced", " ", "by", " ", "juvenile"}], ";", " ", 
         RowBox[{
          RowBox[{"focal", "'"}], "s", " ", "is", " ", "father", " ", "of", 
          " ", "the", " ", "successful", " ", "offspring", " ", "recruited", 
          " ", "of", " ", "same", " ", "type", " ", "as", " ", "focal"}]}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dispad", "[", "es", "]"}], "+", 
           RowBox[{"dispmad", "[", "es", "]"}]}], ")"}], "/", 
         RowBox[{"localcomptotal", "[", 
          RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "senior"}], ",", " ", 
        RowBox[{
         RowBox[{"replaced", " ", "by", " ", "juvenile"}], ";", " ", 
         RowBox[{"replaced", " ", "by", " ", "nonfocal"}]}], ",", " ", 
        RowBox[{"i", ".", "e", "."}], ",", " ", 
        RowBox[{"immigrant", " ", "offspring"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
            RowBox[{"dp", "[", 
             RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", 
            RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}]}], "+", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", 
           RowBox[{"1", "-", "aself"}]}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "juvenile"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", 
         RowBox[{"focal", "'"}], "s", " ", "offspring", " ", 
         RowBox[{"(", 
          RowBox[{"focal", " ", "is", " ", "mother"}], ")"}]}], ",", " ", 
        RowBox[{"different", " ", "type", " ", "as", " ", "senior"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
            RowBox[{"dp", "[", 
             RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", "aself", ",", "aself"}], "]"}]}], "+", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "aself"}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "juvenile"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", 
         RowBox[{"focal", "'"}], "s", " ", "offspring", " ", 
         RowBox[{"(", 
          RowBox[{"focal", " ", "is", " ", "mother"}], ")"}]}], ",", " ", 
        RowBox[{"same", " ", "type", " ", "as", " ", "senior"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ajuv", "\[Equal]", "aself"}], ",", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "+", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}]}], ",", 
           RowBox[{"1", "-", 
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "-", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}]}]}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", 
            RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}]}], "+", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", 
           RowBox[{"1", "-", "aself"}]}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "juvenile"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", 
         RowBox[{"focal", "'"}], "s", " ", "offspring", " ", 
         RowBox[{"(", 
          RowBox[{"focal", " ", "is", " ", "father"}], ")"}]}], ",", " ", 
        RowBox[{"different", " ", "type", " ", "as", " ", "senior"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ajuv", "\[Equal]", "aself"}], ",", 
           RowBox[{"1", "-", 
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "-", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "+", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}]}]}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"vj", "[", 
           RowBox[{"es", ",", "aself", ",", "aself"}], "]"}]}], "+", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "aself"}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "juvenile"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", 
         RowBox[{"focal", "'"}], "s", " ", "offspring", " ", 
         RowBox[{"(", 
          RowBox[{"focal", " ", "is", " ", "father"}], ")"}]}], ",", " ", 
        RowBox[{"same", " ", "type", " ", "as", " ", "senior"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"madothersen", "[", 
        RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "juvenile"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "nonfocal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"adothersen", "[", 
        RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "juvenile"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "nonfocal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "k"}], ")"}], 
       FractionBox["1", "2"], 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "aju", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "asen"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
                   RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "asen"}], "]"}]}]}], ")"}]}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "on", " ", "other", " ", "patch", " ", "juv", " ", "dies"}], " ",
              "*)"}], "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "asen", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "aju"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
                   RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "aju"}], "]"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "on", " ", "other", " ", "patch", " ", "senior", " ", "dies"}], 
            " ", "*)"}], "\[IndentingNewLine]", ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"nes", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"aju", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"asen", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "k"}], ")"}], 
       FractionBox["1", "2"], 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "aju", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "ajuv", ",", 
                    RowBox[{"1", "-", "ajuv"}]}], "]"}], ",", "asen"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "+", 
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "ajuv"}], ",", "ajuv"}], "]"}], ",", 
                  "asen"}], "]"}]}]}], ")"}]}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "on", " ", "other", " ", "patch", " ", "juv", " ", "dies"}], " ",
              "*)"}], "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "asen", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "ajuv", ",", 
                    RowBox[{"1", "-", "ajuv"}]}], "]"}], ",", "aju"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "+", 
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "ajuv"}], ",", "ajuv"}], "]"}], ",", 
                  "aju"}], "]"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "on", " ", "other", " ", "patch", " ", "senior", " ", "dies"}], 
            " ", "*)"}], "\[IndentingNewLine]", ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"nes", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"aju", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"asen", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ajuv", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6334126304959583`*^9, 3.633412646375149*^9}, {
   3.633412841374126*^9, 3.633412902626623*^9}, {3.633413015169194*^9, 
   3.633413034229413*^9}, {3.633413072369688*^9, 3.633413146905407*^9}, {
   3.6334132155743237`*^9, 3.633413244855592*^9}, {3.6334132949687023`*^9, 
   3.633413295297819*^9}, {3.633498161372232*^9, 3.633498192698634*^9}, {
   3.633498489639135*^9, 3.633498601038528*^9}, {3.633498644577499*^9, 
   3.633498650518743*^9}, {3.633498759700585*^9, 3.633498795183405*^9}, {
   3.633498841351445*^9, 3.633498899014537*^9}, {3.633498941318145*^9, 
   3.633498946027717*^9}, {3.6335005757881536`*^9, 3.633500609820137*^9}, {
   3.633500885640175*^9, 3.6335009290853977`*^9}, {3.6335009961960363`*^9, 
   3.633501023091476*^9}, {3.633501053242216*^9, 3.633501177595662*^9}, {
   3.633501325720121*^9, 3.633501331043683*^9}, {3.633502371351656*^9, 
   3.633502389163336*^9}, 3.633502829308981*^9, {3.633514873952476*^9, 
   3.633514877240644*^9}, {3.6350727335007668`*^9, 3.635072765887948*^9}, {
   3.635072817703754*^9, 3.63507281822663*^9}, {3.63981804709446*^9, 
   3.639818062854319*^9}, {3.6398181212008266`*^9, 3.6398182743213787`*^9}, {
   3.639818396020569*^9, 3.6398184546258097`*^9}, {3.639818595555304*^9, 
   3.639818602944368*^9}, {3.639818670202694*^9, 3.6398188185567017`*^9}, {
   3.63981895819553*^9, 3.639818959566551*^9}, {3.6398203630260763`*^9, 
   3.639820612419454*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dpdt", "[", "dpval_", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"f", "[", 
       RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"dvsdtdp", "[", 
           RowBox[{"[", 
            RowBox[{"es", ",", 
             RowBox[{"1", "+", "asen"}], ",", 
             RowBox[{"1", "+", "ajuv"}]}], "]"}], "]"}], ",", "dpval"}], 
         "]"}], "+", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"dvjdtdp", "[", 
           RowBox[{"[", 
            RowBox[{"es", ",", 
             RowBox[{"1", "+", "ajuv"}], ",", 
             RowBox[{"1", "+", "asen"}]}], "]"}], "]"}], ",", "dpval"}], 
         "]"}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ajuv", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"asen", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[TextData[{
 "Selection gradients for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["p", "1"], ",", 
    SubscriptBox["p", "2"]}], TraditionalForm]]],
 ", proportion of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "1"], TraditionalForm]]],
 "-offspring produced by ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "1"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "2"], TraditionalForm]]],
 " parents"
}], "Section",
 CellChangeTimes->{{3.593494268186329*^9, 3.5934943131688232`*^9}, {
  3.59377825225355*^9, 3.593778254989624*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"adotherjuvdp", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"localcomptotal", "[", 
     RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        FractionBox["asen", "2"], 
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"p", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}], "-", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ajuv", "\[Equal]", "0"}], ",", 
             RowBox[{"raSmJ", "[", "es", "]"}], ",", 
             RowBox[{"raSaJ", "[", "es", "]"}]}], "]"}], 
           RowBox[{"dp", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}]}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"m", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"1", "-", "asen"}], "2"], " ", 
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}], "+", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ajuv", "\[Equal]", "0"}], ",", 
             RowBox[{"rmSmJ", "[", "es", "]"}], ",", 
             RowBox[{"rmSaJ", "[", "es", "]"}]}], "]"}], 
           RowBox[{"dp", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}]}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"m", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}]}]}], "]"}], "+", 
     RowBox[{"dispad", "[", "es", "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"madotherjuvdp", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"localcomptotal", "[", 
     RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        FractionBox["asen", "2"], 
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}], "+", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ajuv", "\[Equal]", "0"}], ",", 
             RowBox[{"raSmJ", "[", "es", "]"}], ",", 
             RowBox[{"raSaJ", "[", "es", "]"}]}], "]"}], 
           RowBox[{"dp", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}]}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"m", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"1", "-", "asen"}], "2"], 
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"p", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}], "-", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ajuv", "\[Equal]", "0"}], ",", 
             RowBox[{"rmSmJ", "[", "es", "]"}], ",", 
             RowBox[{"rmSaJ", "[", "es", "]"}]}], "]"}], 
           RowBox[{"dp", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}]}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"m", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}]}]}], "]"}], "+", 
     RowBox[{"dispmad", "[", "es", "]"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.633501670161281*^9, 3.633501678106861*^9}, {
   3.633501801679626*^9, 3.6335018165560217`*^9}, {3.6335018530246983`*^9, 
   3.633501899427931*^9}, {3.633501960039475*^9, 3.63350199643281*^9}, {
   3.63350203302719*^9, 3.633502046065723*^9}, {3.633502116617215*^9, 
   3.633502121965958*^9}, {3.633583890688052*^9, 3.633583893550962*^9}, {
   3.633584013327272*^9, 3.633584054513783*^9}, {3.633584091410894*^9, 
   3.633584115625005*^9}, {3.633584467103325*^9, 3.633584479381629*^9}, {
   3.6335845827560673`*^9, 3.633584593638768*^9}, {3.633584735071641*^9, 
   3.633584745471409*^9}, {3.633587934173267*^9, 3.63358793435923*^9}, {
   3.633841424145013*^9, 3.6338414250222683`*^9}, 3.6338415025242863`*^9, {
   3.63490318712271*^9, 3.6349031873512917`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"adothersendp", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"localcomptotal", "[", 
     RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        FractionBox["ajuv", "2"], 
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"p", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], "-", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"asen", "==", "0"}], ",", 
             RowBox[{"rmSaJ", "[", "es", "]"}], ",", 
             RowBox[{"raSaJ", "[", "es", "]"}]}], "]"}], 
           RowBox[{"dp", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}]}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"m", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"1", "-", "ajuv"}], "2"], " ", 
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], "+", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"asen", "==", "0"}], ",", 
             RowBox[{"rmSmJ", "[", "es", "]"}], ",", 
             RowBox[{"raSmJ", "[", "es", "]"}]}], "]"}], 
           RowBox[{"dp", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}]}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"m", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}]}]}], "]"}], "+", 
     RowBox[{"dispad", "[", "es", "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"madothersendp", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"localcomptotal", "[", 
     RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        FractionBox["ajuv", "2"], 
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], "+", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"asen", "\[Equal]", "0"}], ",", 
             RowBox[{"rmSaJ", "[", "es", "]"}], ",", 
             RowBox[{"raSaJ", "[", "es", "]"}]}], "]"}], 
           RowBox[{"dp", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}]}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"m", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"1", "-", "ajuv"}], "2"], " ", 
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"p", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], "-", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"asen", "\[Equal]", "0"}], ",", 
             RowBox[{"rmSmJ", "[", "es", "]"}], ",", 
             RowBox[{"raSmJ", "[", "es", "]"}]}], "]"}], 
           RowBox[{"dp", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}]}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"m", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}]}]}], "]"}], "+",
      
     RowBox[{"dispmad", "[", "es", "]"}]}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.633501670161281*^9, 3.633501678106861*^9}, {
  3.633501801679626*^9, 3.6335018165560217`*^9}, {3.6335018530246983`*^9, 
  3.633501899427931*^9}, {3.633501960039475*^9, 3.63350199643281*^9}, {
  3.63350203302719*^9, 3.633502046065723*^9}, {3.633502106686488*^9, 
  3.6335021327235947`*^9}, {3.63350223193182*^9, 3.633502269623418*^9}, {
  3.633583895423304*^9, 3.63358389758467*^9}, {3.633587642348591*^9, 
  3.633587653579566*^9}, {3.6335878938592033`*^9, 3.633587985262907*^9}, {
  3.6335886042082357`*^9, 3.6335886624742727`*^9}, {3.633594481007842*^9, 
  3.63359449173631*^9}, {3.634903355150806*^9, 3.6349033622621527`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvjdtdp", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", "es", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vj", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", 
           RowBox[{"1", "-", "aself"}], ",", 
           RowBox[{"1", "-", "asenior"}]}], "]"}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"environmental", " ", "change"}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
           RowBox[{"dp", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", 
           RowBox[{"1", "-", "aself"}], ",", "asenior"}], "]"}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "juvenile"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", " ",
          "a", " ", "different", " ", "type"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"m", "[", 
             RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
          FractionBox["1", "2"], 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}]}], ")"}], 
       
       RowBox[{"(", 
        RowBox[{"-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "juvenile"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", "nonfocal", " ", "offspring"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
           RowBox[{"dp", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "aself"}], "]"}], "+", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "aself"}], "]"}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"senior", " ", "dies"}], ",", " ", 
        RowBox[{"focal", " ", "takes", " ", "over"}], ",", " ", 
        RowBox[{
         RowBox[{"focal", "'"}], "s", " ", "place", " ", "is", " ", "taken", 
         " ", "by", " ", "focal", " ", "offspring", " ", "of", " ", "the", 
         " ", "same", " ", "type", " ", "as", " ", "focal"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
           RowBox[{"dp", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", 
           RowBox[{"1", "-", "aself"}]}], "]"}], "+", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", 
           RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"senior", " ", "dies"}], ",", " ", 
        RowBox[{"focal", " ", "takes", " ", "over"}], ",", " ", 
        RowBox[{
         RowBox[{"focal", "'"}], "s", " ", "place", " ", "is", " ", "taken", 
         " ", "by", " ", "focal", " ", "offspring", " ", "of", " ", 
         "different", " ", "type", " ", "as", " ", "focal"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
       RowBox[{"madotherjuvdp", "[", 
        RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"senior", " ", "dies"}], ",", " ", 
        RowBox[{"focal", " ", "takes", " ", "over"}], ",", " ", 
        RowBox[{
         RowBox[{"focal", "'"}], "s", " ", "place", " ", "is", " ", "taken", 
         " ", "by", " ", "nonfocal"}], ",", " ", 
        RowBox[{"maladapted", " ", "offspring"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
       RowBox[{"adotherjuvdp", "[", 
        RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"senior", " ", "dies"}], ",", " ", 
        RowBox[{"focal", " ", "takes", " ", "over"}], ",", " ", 
        RowBox[{
         RowBox[{"focal", "'"}], "s", " ", "place", " ", "is", " ", "taken", 
         " ", "by", " ", "nonfocal"}], ",", " ", 
        RowBox[{"adapted", " ", "offspring"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "k"}], ")"}], 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "aju", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}], 
                  ")"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "asen"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
                   RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "asen"}], "]"}]}]}], ")"}]}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "on", " ", "other", " ", "patch", " ", "juv", " ", "dies"}], " ",
              "*)"}], "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "asen", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}], 
                  ")"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "aju"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
                   RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "aju"}], "]"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "on", " ", "other", " ", "patch", " ", "senior", " ", "dies"}], 
            " ", "*)"}], "\[IndentingNewLine]", ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"nes", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"aju", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"asen", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"asenior", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6334084080101213`*^9, 3.633408621437086*^9}, {
   3.6334086672433157`*^9, 3.633408715858348*^9}, {3.633408910762005*^9, 
   3.633409004305276*^9}, {3.633409079984435*^9, 3.6334091436039467`*^9}, {
   3.633409234220334*^9, 3.6334093376593933`*^9}, {3.63340946258109*^9, 
   3.63340955582442*^9}, {3.633409591100646*^9, 3.6334096722567387`*^9}, {
   3.633409801247815*^9, 3.6334098590954533`*^9}, {3.633409968851397*^9, 
   3.6334099743284073`*^9}, {3.6334120000365953`*^9, 
   3.6334120036565847`*^9}, {3.633412120988165*^9, 3.633412313351788*^9}, {
   3.6334123969233217`*^9, 3.633412616820354*^9}, {3.6334986115316343`*^9, 
   3.63349863506009*^9}, {3.633501181927599*^9, 3.63350118523438*^9}, {
   3.633502342169443*^9, 3.633502353983124*^9}, 3.6335027594929647`*^9, {
   3.633502799345827*^9, 3.633502800366242*^9}, {3.6335354475863447`*^9, 
   3.633535447662668*^9}, {3.633582996927045*^9, 3.63358300330018*^9}, {
   3.633583095167798*^9, 3.633583125459671*^9}, {3.633583710723298*^9, 
   3.633583716227909*^9}, {3.633583786416174*^9, 3.633583847919689*^9}, {
   3.635072308101739*^9, 3.635072351478695*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvsdtdp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", "es", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", 
           RowBox[{"1", "-", "aself"}], ",", 
           RowBox[{"1", "-", "ajuv"}]}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
           RowBox[{"dp", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", 
           RowBox[{"1", "-", "aself"}], ",", "ajuv"}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "senior"}], ",", " ", 
        RowBox[{
         RowBox[{"replaced", " ", "by", " ", "juvenile"}], ";", " ", 
         RowBox[{
          RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "recruited", 
          " ", "of", " ", "different", " ", "type", " ", "as", " ", 
          "focal"}]}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
           RowBox[{"dp", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "senior"}], ",", " ", 
        RowBox[{
         RowBox[{"replaced", " ", "by", " ", "juvenile"}], ";", " ", 
         RowBox[{
          RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "recruited", 
          " ", "of", " ", "same", " ", "type", " ", "as", " ", "focal"}]}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"m", "[", 
             RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
          FractionBox["1", "2"], 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "senior"}], ",", " ", 
        RowBox[{
         RowBox[{"replaced", " ", "by", " ", "juvenile"}], ";", " ", 
         RowBox[{
         "replaced", " ", "by", " ", "nonfocal", " ", "offspring"}]}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
           RowBox[{"dp", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", 
           RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], "+", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", 
           RowBox[{"1", "-", "aself"}]}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "juvenile"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", 
         RowBox[{"focal", "'"}], "s", " ", "offspring"}], ",", " ", 
        RowBox[{"different", " ", "type", " ", "as", " ", "senior"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
           RowBox[{"dp", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "aself"}], "]"}], "+", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "aself"}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "juvenile"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", 
         RowBox[{"focal", "'"}], "s", " ", "offspring"}], ",", " ", 
        RowBox[{"same", " ", "type", " ", "as", " ", "senior"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"madothersendp", "[", 
        RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "juvenile"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "nonfocal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"adothersendp", "[", 
        RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "juvenile"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "nonfocal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "k"}], ")"}], 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "aju", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
                   RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "asen"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
                   RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "asen"}], "]"}]}]}], ")"}]}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "on", " ", "other", " ", "patch", " ", "juv", " ", "dies"}], " ",
              "*)"}], "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "asen", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
                   RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "aju"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
                   RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "aju"}], "]"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "on", " ", "other", " ", "patch", " ", "senior", " ", "dies"}], 
            " ", "*)"}], "\[IndentingNewLine]", ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"nes", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"aju", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"asen", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ajuv", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6334126304959583`*^9, 3.633412646375149*^9}, {
   3.633412841374126*^9, 3.633412902626623*^9}, {3.633413015169194*^9, 
   3.633413034229413*^9}, {3.633413072369688*^9, 3.633413146905407*^9}, {
   3.6334132155743237`*^9, 3.633413244855592*^9}, {3.6334132949687023`*^9, 
   3.633413295297819*^9}, {3.633498161372232*^9, 3.633498192698634*^9}, {
   3.633498489639135*^9, 3.633498601038528*^9}, {3.633498644577499*^9, 
   3.633498650518743*^9}, {3.633498759700585*^9, 3.633498795183405*^9}, {
   3.633498841351445*^9, 3.633498899014537*^9}, {3.633498941318145*^9, 
   3.633498946027717*^9}, {3.6335005757881536`*^9, 3.633500609820137*^9}, {
   3.633500885640175*^9, 3.6335009290853977`*^9}, {3.6335009961960363`*^9, 
   3.633501023091476*^9}, {3.633501053242216*^9, 3.633501177595662*^9}, {
   3.633501325720121*^9, 3.633501331043683*^9}, {3.633502371351656*^9, 
   3.633502389163336*^9}, 3.633502829308981*^9, {3.633514873952476*^9, 
   3.633514877240644*^9}, {3.633594942330408*^9, 3.633594967751877*^9}, {
   3.633595298361992*^9, 3.633595345232197*^9}, 3.6338396314265203`*^9, 
   3.633840009653009*^9, {3.633948198109207*^9, 3.633948198549362*^9}, {
   3.635072207184169*^9, 3.635072261148753*^9}}],

Cell["\<\
Probability nonfocal produces adapted or maladapted offspring\
\>", "Text",
 CellChangeTimes->{{3.5934456838213387`*^9, 3.59344568989388*^9}, {
  3.593445721973733*^9, 3.593445734493628*^9}, {3.593494246140113*^9, 
  3.593494261530838*^9}, {3.593494444481636*^9, 3.59349445421741*^9}, {
  3.593494493568993*^9, 3.593494497672474*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dpdt", "[", "dpval_", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"f", "[", 
       RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"dvsdtdp", "[", 
           RowBox[{"[", 
            RowBox[{"es", ",", 
             RowBox[{"1", "+", "asen"}], ",", 
             RowBox[{"1", "+", "ajuv"}]}], "]"}], "]"}], ",", "dpval"}], 
         "]"}], "+", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"dvjdtdp", "[", 
           RowBox[{"[", 
            RowBox[{"es", ",", 
             RowBox[{"1", "+", "ajuv"}], ",", 
             RowBox[{"1", "+", "asen"}]}], "]"}], "]"}], ",", "dpval"}], 
         "]"}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ajuv", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"asen", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.633840021108121*^9, 3.633840071538885*^9}, {
   3.6338401085046263`*^9, 3.6338402041106777`*^9}, {3.63384026431561*^9, 
   3.633840266906165*^9}, {3.6338403163532467`*^9, 3.633840437117086*^9}, {
   3.63384050456122*^9, 3.633840516735833*^9}, {3.633840596136141*^9, 
   3.63384062147458*^9}, 3.633841242195788*^9, 3.633841515230401*^9, {
   3.633948202644775*^9, 3.63394820508285*^9}}],

Cell["Numerical value of the selection gradient", "Text",
 CellChangeTimes->{{3.593494549744481*^9, 3.5934945648160954`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"selgradP", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
     RowBox[{"{", "m_", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p10s_", ",", "p20s_", ",", "p11s_", ",", "p21s_"}], "}"}], ",",
      "ks_", ",", "Qs_", ",", "trait_"}], "]"}], ":=", "\[IndentingNewLine]", 
   
   RowBox[{"Return", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dpdt", "[", "trait", "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
        RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
        RowBox[{"k", "\[Rule]", "ks"}], ",", 
        RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
        RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
        RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
        RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
        RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
        RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
        RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
        RowBox[{"mt", "\[Rule]", "m"}], ",", 
        RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
        RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
        RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
        RowBox[{"p21", "\[Rule]", "p21s"}]}], "}"}]}], "/.", 
     RowBox[{"ans3", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s1s", ",", "s2s"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c1s", ",", "c2s", ",", "c3s", ",", "c4s"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"q1s", ",", "q2s"}], "}"}], ",", 
       RowBox[{"{", "m", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p10s", ",", "p20s", ",", "p11s", ",", "p21s"}], "}"}], ",", 
       "ks", ",", "Qs"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"selgradP", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.85", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", "0.1", 
   ",", "0.05", ",", "dp20"}], "]"}]}], "Input",
 CellChangeTimes->{{3.505140560825174*^9, 3.50514064385368*^9}, {
   3.505140714222675*^9, 3.505140746631989*^9}, 3.505141681810299*^9, {
   3.505141739370999*^9, 3.505141741390123*^9}, {3.5051417786037*^9, 
   3.505141823518378*^9}, {3.505162181348971*^9, 3.50516229325249*^9}, {
   3.5051623715172*^9, 3.505162376920246*^9}, {3.505162433552815*^9, 
   3.505162434058462*^9}, {3.505657684657195*^9, 3.505657708798037*^9}, {
   3.505815579213955*^9, 3.505815579839667*^9}, {3.505815706057299*^9, 
   3.505815706748337*^9}, {3.505836524337347*^9, 3.50583653604466*^9}, {
   3.505900621331135*^9, 3.50590062168389*^9}, {3.505900681816407*^9, 
   3.505900681925982*^9}, {3.505903100412446*^9, 3.505903105178415*^9}, {
   3.505903306382735*^9, 3.505903306450782*^9}, {3.505903337466215*^9, 
   3.505903337554181*^9}, {3.505903376116904*^9, 3.505903414205284*^9}, {
   3.507215441586883*^9, 3.507215441864266*^9}, {3.507217233968476*^9, 
   3.507217235012242*^9}, {3.507219035704643*^9, 3.507219036006999*^9}, 
   3.5072271240964108`*^9, {3.507445896704231*^9, 3.507445928564635*^9}, 
   3.507883896637253*^9, {3.507883963552722*^9, 3.507883964325812*^9}, {
   3.507884602887243*^9, 3.507884668140694*^9}, {3.508160912305312*^9, 
   3.508160916273239*^9}, {3.508161178047368*^9, 3.508161178663356*^9}, {
   3.520242444905705*^9, 3.520242462811362*^9}, {3.520242515256281*^9, 
   3.520242515537557*^9}, {3.520421764721227*^9, 3.520421771770569*^9}, {
   3.520421841855568*^9, 3.520421849321148*^9}, {3.520421888600866*^9, 
   3.520421892326528*^9}, {3.520422109210228*^9, 3.520422167950575*^9}, {
   3.520422201023795*^9, 3.520422205047305*^9}, {3.520422337344874*^9, 
   3.520422421071539*^9}, {3.520590680092812*^9, 3.520590711893722*^9}, {
   3.520590781521338*^9, 3.520590795966717*^9}, {3.520591226195406*^9, 
   3.520591240038307*^9}, {3.520601881307502*^9, 3.520601882092852*^9}, {
   3.524044511624154*^9, 3.52404451492298*^9}, {3.524044547404213*^9, 
   3.524044549627349*^9}, {3.524044778104684*^9, 3.524044795280702*^9}, 
   3.524555244523746*^9, {3.524555288584175*^9, 3.524555315808396*^9}, {
   3.524555363910387*^9, 3.524555377781718*^9}, {3.524555784594505*^9, 
   3.524555809327095*^9}, {3.52455601312634*^9, 3.52455602076801*^9}, {
   3.53177023662048*^9, 3.531770242557644*^9}, {3.59254503518889*^9, 
   3.59254507172961*^9}, {3.592545222393182*^9, 3.592545256670334*^9}, {
   3.6338408393340816`*^9, 3.633840902756267*^9}, {3.633841005205833*^9, 
   3.6338410818507147`*^9}, {3.633841127360651*^9, 3.633841127543775*^9}, {
   3.633841162541236*^9, 3.63384116875344*^9}, {3.633841253414789*^9, 
   3.633841265821685*^9}, {3.633841532898087*^9, 3.6338415330157747`*^9}, {
   3.633841625899555*^9, 3.633841626081249*^9}, {3.633896376794669*^9, 
   3.633896396915306*^9}, {3.633948289854741*^9, 3.633948319671237*^9}, {
   3.6339483882818604`*^9, 3.633948392619916*^9}, {3.6350729135397053`*^9, 
   3.635072913733696*^9}, {3.635073161305767*^9, 3.635073182442675*^9}, {
   3.63507415018439*^9, 3.635074152133349*^9}, {3.635074691984624*^9, 
   3.6350746920762253`*^9}, {3.636708187174897*^9, 3.636708189477592*^9}}],

Cell[BoxData["0.001067054545803088`"], "Output",
 CellChangeTimes->{
  3.6338412753199863`*^9, {3.633841493574916*^9, 3.633841534309265*^9}, 
   3.633841627345543*^9, {3.633896369056164*^9, 3.633896399054454*^9}, {
   3.6339482673403387`*^9, 3.633948320746924*^9}, 3.633948407737378*^9, 
   3.633952508207878*^9, 3.633952589327639*^9, 3.633954963385343*^9, 
   3.633955243259877*^9, 3.633955601253334*^9, 3.633957085032189*^9, 
   3.633959174785907*^9, 3.633959252882131*^9, 3.633960448130125*^9, 
   3.6339647097927732`*^9, 3.633964799440563*^9, 3.633965073618312*^9, 
   3.634903544985857*^9, 3.634903672962476*^9, 3.6349768947307777`*^9, {
   3.635072908617848*^9, 3.63507291494205*^9}, {3.63507316400359*^9, 
   3.635073188087305*^9}, 3.6350741533135567`*^9, 3.635074430690495*^9, 
   3.6350744999950123`*^9, 3.635074693261792*^9, 3.635074821334898*^9, 
   3.6350753518466463`*^9, 3.6354147297970533`*^9, 3.635415278485096*^9, 
   3.636707982703376*^9, 3.636708190663313*^9, 3.636724350552874*^9, 
   3.636724435652587*^9, 3.636724872485669*^9, 3.636728176379825*^9, 
   3.6367284164313097`*^9, 3.636728498149315*^9, 3.63679240083051*^9, 
   3.636866577229806*^9, 3.639394583225239*^9, 3.639394712551601*^9, 
   3.639395349880114*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"selgradP", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.85", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", "0.1", 
   ",", "0.05", ",", "dp10"}], "]"}]], "Input",
 CellChangeTimes->{{3.633841146467895*^9, 3.6338411729706783`*^9}, {
  3.633841268006699*^9, 3.633841271270121*^9}, {3.633841537200982*^9, 
  3.633841537447731*^9}, {3.63384163116467*^9, 3.6338416312911577`*^9}, {
  3.63389638580166*^9, 3.633896420136635*^9}, {3.633948294564855*^9, 
  3.633948327434853*^9}, {3.6339483818412952`*^9, 3.633948399232532*^9}, {
  3.635072916954574*^9, 3.635072918122916*^9}, {3.63507315744748*^9, 
  3.6350731845618267`*^9}, {3.635074155078315*^9, 3.6350741568870173`*^9}, {
  3.635074695396921*^9, 3.635074705676044*^9}, {3.636708180360708*^9, 
  3.636708182790545*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.0010670545458030863`"}]], "Output",
 CellChangeTimes->{
  3.6338416325666447`*^9, 3.633896369835621*^9, {3.633896404838826*^9, 
   3.633896421406248*^9}, {3.633948267946642*^9, 3.6339483285039473`*^9}, {
   3.633948383279475*^9, 3.633948402044857*^9}, 3.633952509000257*^9, 
   3.633952590115697*^9, 3.6339549643498917`*^9, 3.633955244018688*^9, 
   3.633955601982304*^9, 3.633957085872353*^9, 3.6339591755499067`*^9, 
   3.633959253591732*^9, 3.6339604489306383`*^9, 3.633964710470735*^9, 
   3.633964800178752*^9, 3.633965074335883*^9, 3.634903545694659*^9, 
   3.6349036736339684`*^9, 3.634976895459941*^9, {3.635072909283642*^9, 
   3.635072919938973*^9}, {3.635073158740198*^9, 3.6350731856807528`*^9}, 
   3.6350741579869537`*^9, 3.635074431295425*^9, 3.635074500716003*^9, {
   3.635074698629427*^9, 3.63507470678275*^9}, 3.6350748220576267`*^9, 
   3.63507535256536*^9, 3.635414730390658*^9, 3.635415279238533*^9, 
   3.6367079834524393`*^9, 3.636708184003316*^9, 3.636724351261339*^9, 
   3.6367244375874*^9, 3.63672487330611*^9, 3.636728177249671*^9, 
   3.636728417259533*^9, 3.636728498963498*^9, 3.6367924016389236`*^9, 
   3.636866578114291*^9, 3.6393945923647423`*^9, 3.639394713328064*^9, 
   3.639395350567737*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"selgradP", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.85", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", "0.1", 
   ",", "0.05", ",", "dp21"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"selgradP", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.1", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.85", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", "0.1", 
   ",", "0.05", ",", "dp11"}], "]"}]}], "Input",
 CellChangeTimes->{{3.635074914352614*^9, 3.635074918892292*^9}, {
  3.635074950115717*^9, 3.635074951250153*^9}, {3.636708148859241*^9, 
  3.6367081652718983`*^9}, {3.636724489310561*^9, 3.636724492239441*^9}, {
  3.6367248448536377`*^9, 3.636724852653509*^9}, {3.636724882964361*^9, 
  3.636724884753642*^9}, {3.636728389080207*^9, 3.636728391934698*^9}, {
  3.636728437559031*^9, 3.6367284535018377`*^9}, {3.639394600997595*^9, 
  3.639394629987481*^9}, {3.639395328439082*^9, 3.639395342677387*^9}, {
  3.6393955292583017`*^9, 3.639395538297308*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.1517561301535355`"}]], "Output",
 CellChangeTimes->{
  3.635074920256033*^9, 3.635074952552846*^9, 3.635075353181649*^9, 
   3.635414731094845*^9, 3.635415279884273*^9, 3.636707984068252*^9, {
   3.636708151102477*^9, 3.636708167920759*^9}, 3.636724351883505*^9, 
   3.6367244391201353`*^9, 3.636724494101027*^9, {3.636724873971117*^9, 
   3.636724886157332*^9}, 3.6367281778963537`*^9, {3.63672841791002*^9, 
   3.636728454617778*^9}, 3.6367284995992727`*^9, 3.63679240228259*^9, 
   3.636866578719453*^9, {3.63939459592455*^9, 3.639394631299252*^9}, 
   3.63939471400765*^9, 3.6393953512112503`*^9, {3.639395531405526*^9, 
   3.639395539487733*^9}}],

Cell[BoxData["0.1517561301535355`"], "Output",
 CellChangeTimes->{
  3.635074920256033*^9, 3.635074952552846*^9, 3.635075353181649*^9, 
   3.635414731094845*^9, 3.635415279884273*^9, 3.636707984068252*^9, {
   3.636708151102477*^9, 3.636708167920759*^9}, 3.636724351883505*^9, 
   3.6367244391201353`*^9, 3.636724494101027*^9, {3.636724873971117*^9, 
   3.636724886157332*^9}, 3.6367281778963537`*^9, {3.63672841791002*^9, 
   3.636728454617778*^9}, 3.6367284995992727`*^9, 3.63679240228259*^9, 
   3.636866578719453*^9, {3.63939459592455*^9, 3.639394631299252*^9}, 
   3.63939471400765*^9, 3.6393953512112503`*^9, {3.639395531405526*^9, 
   3.639395540124351*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Selection gradients for the migration rate, m", "Section",
 CellChangeTimes->{{3.501844825699147*^9, 3.5018448260221663`*^9}, {
  3.593777661084167*^9, 3.593777663884243*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"localaddmJ", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["asen", "2"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "1", ",", "1"}], "]"}], "-", 
      RowBox[{
       RowBox[{"dm", "[", 
        RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ajuv", "\[Equal]", "0"}], ",", 
         RowBox[{"raSmJ", "[", "es", "]"}], ",", 
         RowBox[{"raSaJ", "[", "es", "]"}]}], "]"}]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"1", "-", "asen"}], "2"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "0", ",", "1"}], "]"}], "-", 
      RowBox[{
       RowBox[{"dm", "[", 
        RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ajuv", "\[Equal]", "0"}], ",", 
         RowBox[{"rmSmJ", "[", "es", "]"}], ",", 
         RowBox[{"rmSaJ", "[", "es", "]"}]}], "]"}]}]}], ")"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "0", ",", "1"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.63394600758029*^9, 3.633946015928052*^9}, 
   3.633946115077915*^9, {3.6339461762112913`*^9, 3.633946197344942*^9}, {
   3.633946272526923*^9, 3.633946352214116*^9}, {3.63394642506849*^9, 
   3.633946473540327*^9}, {3.6339465865622387`*^9, 3.633946597880704*^9}, {
   3.633947577066608*^9, 3.633947578377364*^9}, {3.633948554055045*^9, 
   3.6339485541615562`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"localmaddmJ", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["asen", "2"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "1", ",", "1"}], "]"}], "-", 
      RowBox[{
       RowBox[{"dm", "[", 
        RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ajuv", "\[Equal]", "0"}], ",", 
         RowBox[{"raSmJ", "[", "es", "]"}], ",", 
         RowBox[{"raSaJ", "[", "es", "]"}]}], "]"}]}]}], ")"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"1", "-", "asen"}], "2"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "0", ",", "1"}], "]"}], "-", 
      RowBox[{
       RowBox[{"dm", "[", 
        RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ajuv", "\[Equal]", "0"}], ",", 
         RowBox[{"rmSmJ", "[", "es", "]"}], ",", 
         RowBox[{"rmSaJ", "[", "es", "]"}]}], "]"}]}]}], ")"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "0", ",", "1"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.63394600758029*^9, 3.633946015928052*^9}, 
   3.633946115077915*^9, {3.6339461762112913`*^9, 3.633946197344942*^9}, {
   3.633946272526923*^9, 3.633946352214116*^9}, {3.63394642506849*^9, 
   3.633946473540327*^9}, {3.633946578024622*^9, 3.63394661415238*^9}, {
   3.6339475686905327`*^9, 3.63394757452361*^9}, {3.63394855245564*^9, 
   3.6339485525171013`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"localaddmS", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["ajuv", "2"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "1", ",", "0"}], "]"}], "-", 
      RowBox[{
       RowBox[{"dm", "[", 
        RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"asen", "\[Equal]", "0"}], ",", 
         RowBox[{"rmSaJ", "[", "es", "]"}], ",", 
         RowBox[{"raSaJ", "[", "es", "]"}]}], "]"}]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"1", "-", "ajuv"}], "2"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "0", ",", "0"}], "]"}], "-", 
      RowBox[{
       RowBox[{"dm", "[", 
        RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"asen", "\[Equal]", "0"}], ",", 
         RowBox[{"rmSmJ", "[", "es", "]"}], ",", 
         RowBox[{"raSmJ", "[", "es", "]"}]}], "]"}]}]}], ")"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "0", ",", "0"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.63394600758029*^9, 3.633946015928052*^9}, 
   3.633946115077915*^9, {3.6339461762112913`*^9, 3.633946197344942*^9}, {
   3.633946272526923*^9, 3.633946352214116*^9}, {3.63394642506849*^9, 
   3.633946473540327*^9}, {3.6339465865622387`*^9, 3.633946597880704*^9}, {
   3.633947519221393*^9, 3.633947636088475*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"localmaddmS", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["ajuv", "2"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "1", ",", "0"}], "]"}], "-", 
      RowBox[{
       RowBox[{"dm", "[", 
        RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"asen", "\[Equal]", "0"}], ",", 
         RowBox[{"rmSaJ", "[", "es", "]"}], ",", 
         RowBox[{"raSaJ", "[", "es", "]"}]}], "]"}]}]}], ")"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"1", "-", "ajuv"}], "2"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "0", ",", "0"}], "]"}], "-", 
      RowBox[{
       RowBox[{"dm", "[", 
        RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"asen", "\[Equal]", "0"}], ",", 
         RowBox[{"rmSmJ", "[", "es", "]"}], ",", 
         RowBox[{"raSmJ", "[", "es", "]"}]}], "]"}]}]}], ")"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "0", ",", "0"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.63394600758029*^9, 3.633946015928052*^9}, 
   3.633946115077915*^9, {3.6339461762112913`*^9, 3.633946197344942*^9}, {
   3.633946272526923*^9, 3.633946352214116*^9}, {3.63394642506849*^9, 
   3.633946473540327*^9}, {3.633946578024622*^9, 3.63394661415238*^9}, {
   3.633947585402154*^9, 3.633947586441283*^9}, {3.6339476501029997`*^9, 
   3.633947708235664*^9}, {3.633947763249715*^9, 3.633947780800802*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.633946603743165*^9, 3.633946604552699*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"localcomptotaldmJ", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"dispad", "[", "es", "]"}], "+", 
   RowBox[{"dispmad", "[", "es", "]"}], "+", 
   RowBox[{"localaddmJ", "[", 
    RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}], "+", 
   RowBox[{"localmaddmJ", "[", 
    RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.633945765539743*^9, 3.633945774683359*^9}, {
  3.633945915748393*^9, 3.6339459473415747`*^9}, {3.6339459991533947`*^9, 
  3.633946003411237*^9}, {3.633946112199038*^9, 3.633946121383168*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"localcomptotaldmS", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"dispad", "[", "es", "]"}], "+", 
   RowBox[{"dispmad", "[", "es", "]"}], "+", 
   RowBox[{"localaddmS", "[", 
    RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}], "+", 
   RowBox[{"localmaddmS", "[", 
    RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.633947483280683*^9, 3.633947488158985*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"madotherjuvdm", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{
    RowBox[{"localmaddmJ", "[", 
     RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}], "+", 
    RowBox[{"dispmad", "[", "es", "]"}]}], 
   RowBox[{
    RowBox[{"localcomptotaldmJ", "[", 
     RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}], "+", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"g", "[", 
      RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "-", 
       RowBox[{"dm", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}], ")"}]}]}]]}]], "Input",\

 CellChangeTimes->{{3.633947245936311*^9, 3.633947301095894*^9}, {
  3.6339473680787077`*^9, 3.633947414357624*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"adotherjuvdm", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{
    RowBox[{"localaddmJ", "[", 
     RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}], "+", 
    RowBox[{"dispad", "[", "es", "]"}]}], 
   RowBox[{
    RowBox[{"localcomptotaldmJ", "[", 
     RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}], "+", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"g", "[", 
      RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], "-", 
       RowBox[{"dm", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}]}], ")"}]}]}]]}]], "Input",\

 CellChangeTimes->{3.6339474083739347`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"madothersendm", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{
    RowBox[{"localmaddmS", "[", 
     RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}], "+", 
    RowBox[{"dispmad", "[", "es", "]"}]}], 
   RowBox[{
    RowBox[{"localcomptotaldmS", "[", 
     RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}], "+", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"g", "[", 
      RowBox[{"es", ",", "asen", ",", "1"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "asen", ",", "1"}], "]"}], "-", 
       RowBox[{"dm", "[", 
        RowBox[{"es", ",", "asen", ",", "1"}], "]"}]}], ")"}]}]}]]}]], "Input",\

 CellChangeTimes->{{3.6339479439017487`*^9, 3.6339479626697493`*^9}, {
  3.6349034736512213`*^9, 3.634903486026273*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"adothersendm", "[", 
   RowBox[{"es_", ",", "ajuv_", ",", "asen_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{
    RowBox[{"localaddmS", "[", 
     RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}], "+", 
    RowBox[{"dispad", "[", "es", "]"}]}], 
   RowBox[{
    RowBox[{"localcomptotaldmS", "[", 
     RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}], "+", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"g", "[", 
      RowBox[{"es", ",", "asen", ",", "1"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "asen", ",", "1"}], "]"}], "-", 
       RowBox[{"dm", "[", 
        RowBox[{"es", ",", "asen", ",", "1"}], "]"}]}], ")"}]}]}]]}]], "Input",\

 CellChangeTimes->{{3.633947975253407*^9, 3.633947989803287*^9}, {
  3.634903476835553*^9, 3.634903490553423*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvjdtdm", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", "es", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vj", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", 
           RowBox[{"1", "-", "aself"}], ",", 
           RowBox[{"1", "-", "asenior"}]}], "]"}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"environmental", " ", "change"}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
           RowBox[{"dm", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"localcomptotaldmJ", "[", 
             RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], "+", 
            RowBox[{
             FractionBox["1", "2"], 
             RowBox[{"g", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", 
           RowBox[{"1", "-", "aself"}], ",", "asenior"}], "]"}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "juvenile"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", " ",
          "a", " ", "different", " ", "type"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"m", "[", 
             RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
            RowBox[{"dm", "[", 
             RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
          FractionBox["1", "2"], 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"localcomptotaldmJ", "[", 
              RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], "+", 
             RowBox[{
              FractionBox["1", "2"], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
                RowBox[{"dm", "[", 
                 RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}]}], 
            ")"}]}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "juvenile"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", "nonfocal", " ", "offspring"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
           RowBox[{"dm", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"localcomptotaldmJ", "[", 
             RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], "+", 
            RowBox[{
             FractionBox["1", "2"], 
             RowBox[{"g", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "aself"}], "]"}], "+", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "aself"}], "]"}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"senior", " ", "dies"}], ",", " ", 
        RowBox[{"focal", " ", "takes", " ", "over"}], ",", " ", 
        RowBox[{
         RowBox[{"focal", "'"}], "s", " ", "place", " ", "is", " ", "taken", 
         " ", "by", " ", "focal", " ", "offspring", " ", "of", " ", "the", 
         " ", "same", " ", "type", " ", "as", " ", "focal"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
           RowBox[{"dm", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"localcomptotaldmJ", "[", 
             RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], "+", 
            RowBox[{
             FractionBox["1", "2"], 
             RowBox[{"g", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", 
           RowBox[{"1", "-", "aself"}]}], "]"}], "+", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", 
           RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"senior", " ", "dies"}], ",", " ", 
        RowBox[{"focal", " ", "takes", " ", "over"}], ",", " ", 
        RowBox[{
         RowBox[{"focal", "'"}], "s", " ", "place", " ", "is", " ", "taken", 
         " ", "by", " ", "focal", " ", "offspring", " ", "of", " ", 
         "different", " ", "type", " ", "as", " ", "focal"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
       RowBox[{"madotherjuvdm", "[", 
        RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"senior", " ", "dies"}], ",", " ", 
        RowBox[{"focal", " ", "takes", " ", "over"}], ",", " ", 
        RowBox[{
         RowBox[{"focal", "'"}], "s", " ", "place", " ", "is", " ", "taken", 
         " ", "by", " ", "nonfocal"}], ",", " ", 
        RowBox[{"maladapted", " ", "offspring"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "asenior", ",", "1"}], "]"}], 
       RowBox[{"adotherjuvdm", "[", 
        RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "asenior"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"senior", " ", "dies"}], ",", " ", 
        RowBox[{"focal", " ", "takes", " ", "over"}], ",", " ", 
        RowBox[{
         RowBox[{"focal", "'"}], "s", " ", "place", " ", "is", " ", "taken", 
         " ", "by", " ", "nonfocal"}], ",", " ", 
        RowBox[{"adapted", " ", "offspring"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "k"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
         RowBox[{"dm", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "aju", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "asen"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "asen"}], "]"}]}]}], ")"}]}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "on", " ", "other", " ", "patch", " ", "juv", " ", "dies"}], " ",
              "*)"}], "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "asen", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "aju"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "aju"}], "]"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "on", " ", "other", " ", "patch", " ", "senior", " ", "dies"}], 
            " ", "*)"}], "\[IndentingNewLine]", ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"nes", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"aju", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"asen", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"asenior", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6334084080101213`*^9, 3.633408621437086*^9}, {
   3.6334086672433157`*^9, 3.633408715858348*^9}, {3.633408910762005*^9, 
   3.633409004305276*^9}, {3.633409079984435*^9, 3.6334091436039467`*^9}, {
   3.633409234220334*^9, 3.6334093376593933`*^9}, {3.63340946258109*^9, 
   3.63340955582442*^9}, {3.633409591100646*^9, 3.6334096722567387`*^9}, {
   3.633409801247815*^9, 3.6334098590954533`*^9}, {3.633409968851397*^9, 
   3.6334099743284073`*^9}, {3.6334120000365953`*^9, 
   3.6334120036565847`*^9}, {3.633412120988165*^9, 3.633412313351788*^9}, {
   3.6334123969233217`*^9, 3.633412616820354*^9}, {3.6334986115316343`*^9, 
   3.63349863506009*^9}, {3.633501181927599*^9, 3.63350118523438*^9}, {
   3.633502342169443*^9, 3.633502353983124*^9}, 3.6335027594929647`*^9, {
   3.633502799345827*^9, 3.633502800366242*^9}, {3.63394563446436*^9, 
   3.633945697250585*^9}, {3.633946158632494*^9, 3.633946160069211*^9}, {
   3.633946484234398*^9, 3.6339465281025143`*^9}, {3.633946622420424*^9, 
   3.633946660683837*^9}, {3.633947126647677*^9, 3.633947235632702*^9}, {
   3.633948030750008*^9, 3.633948041892091*^9}, {3.633948216107942*^9, 
   3.633948216188643*^9}, {3.635072397685092*^9, 3.635072434477046*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvsdtdm", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", "es", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", 
           RowBox[{"1", "-", "aself"}], ",", 
           RowBox[{"1", "-", "ajuv"}]}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
           RowBox[{"dm", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"localcomptotaldmS", "[", 
             RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], "+", 
            RowBox[{
             FractionBox["1", "2"], 
             RowBox[{"g", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", 
           RowBox[{"1", "-", "aself"}], ",", "ajuv"}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "senior"}], ",", " ", 
        RowBox[{
         RowBox[{"replaced", " ", "by", " ", "juvenile"}], ";", " ", 
         RowBox[{
          RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "recruited", 
          " ", "of", " ", "different", " ", "type", " ", "as", " ", 
          "focal"}]}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
           RowBox[{"dm", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"localcomptotaldmS", "[", 
             RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], "+", 
            RowBox[{
             FractionBox["1", "2"], 
             RowBox[{"g", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "senior"}], ",", " ", 
        RowBox[{
         RowBox[{"replaced", " ", "by", " ", "juvenile"}], ";", " ", 
         RowBox[{
          RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "recruited", 
          " ", "of", " ", "same", " ", "type", " ", "as", " ", "focal"}]}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"m", "[", 
             RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
            RowBox[{"dm", "[", 
             RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
          FractionBox["1", "2"], 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"localcomptotaldmS", "[", 
              RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], "+", 
             RowBox[{
              FractionBox["1", "2"], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
                RowBox[{"dm", "[", 
                 RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}]}], 
            ")"}]}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "focal", " ", "senior"}], ",", " ", 
        RowBox[{
         RowBox[{"replaced", " ", "by", " ", "juvenile"}], ";", " ", 
         RowBox[{
         "replaced", " ", "by", " ", "nonfocal", " ", "offspring"}]}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
           RowBox[{"dm", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"localcomptotaldmS", "[", 
             RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], "+", 
            RowBox[{
             FractionBox["1", "2"], 
             RowBox[{"g", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", 
           RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], "+", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", 
           RowBox[{"1", "-", "aself"}]}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "juvenile"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", 
         RowBox[{"focal", "'"}], "s", " ", "offspring"}], ",", " ", 
        RowBox[{"different", " ", "type", " ", "as", " ", "senior"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
           RowBox[{"dm", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"localcomptotaldmS", "[", 
             RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], "+", 
            RowBox[{
             FractionBox["1", "2"], 
             RowBox[{"g", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vj", "[", 
          RowBox[{"es", ",", "aself", ",", "aself"}], "]"}], "+", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "aself"}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "juvenile"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", 
         RowBox[{"focal", "'"}], "s", " ", "offspring"}], ",", " ", 
        RowBox[{"same", " ", "type", " ", "as", " ", "senior"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"madothersendm", "[", 
        RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "juvenile"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "nonfocal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "ajuv", ",", "0"}], "]"}], 
       RowBox[{"adothersendm", "[", 
        RowBox[{"es", ",", "ajuv", ",", "aself"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "-", 
         RowBox[{"vs", "[", 
          RowBox[{"es", ",", "aself", ",", "ajuv"}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"death", " ", "juvenile"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "nonfocal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", "k"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
         RowBox[{"dm", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "aju", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "asen"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "asen"}], "]"}]}]}], ")"}]}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "on", " ", "other", " ", "patch", " ", "juv", " ", "dies"}], " ",
              "*)"}], "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "asen", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "aju"}], 
                 "]"}]}], "\[IndentingNewLine]", "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "aju", ",", "asen"}], "]"}]}], 
                RowBox[{"vj", "[", 
                 RowBox[{"nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "aju"}], "]"}]}]}], ")"}]}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "on", " ", "other", " ", "patch", " ", "senior", " ", "dies"}], 
            " ", "*)"}], "\[IndentingNewLine]", ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"nes", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"aju", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"asen", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ajuv", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6334126304959583`*^9, 3.633412646375149*^9}, {
   3.633412841374126*^9, 3.633412902626623*^9}, {3.633413015169194*^9, 
   3.633413034229413*^9}, {3.633413072369688*^9, 3.633413146905407*^9}, {
   3.6334132155743237`*^9, 3.633413244855592*^9}, {3.6334132949687023`*^9, 
   3.633413295297819*^9}, {3.633498161372232*^9, 3.633498192698634*^9}, {
   3.633498489639135*^9, 3.633498601038528*^9}, {3.633498644577499*^9, 
   3.633498650518743*^9}, {3.633498759700585*^9, 3.633498795183405*^9}, {
   3.633498841351445*^9, 3.633498899014537*^9}, {3.633498941318145*^9, 
   3.633498946027717*^9}, {3.6335005757881536`*^9, 3.633500609820137*^9}, {
   3.633500885640175*^9, 3.6335009290853977`*^9}, {3.6335009961960363`*^9, 
   3.633501023091476*^9}, {3.633501053242216*^9, 3.633501177595662*^9}, {
   3.633501325720121*^9, 3.633501331043683*^9}, {3.633502371351656*^9, 
   3.633502389163336*^9}, 3.633502829308981*^9, {3.633514873952476*^9, 
   3.633514877240644*^9}, {3.6339474590533333`*^9, 3.633947473785987*^9}, {
   3.633947788355878*^9, 3.633947848094116*^9}, {3.633947913591041*^9, 
   3.633947925698309*^9}, {3.633948052279888*^9, 3.633948054576367*^9}, {
   3.633948091796713*^9, 3.6339480975972843`*^9}, {3.633948219356772*^9, 
   3.6339482194701643`*^9}, {3.635072450860207*^9, 3.6350724694517527`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dmdt", "[", "dpval_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"f", "[", 
       RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"dvsdtdm", "[", 
           RowBox[{"[", 
            RowBox[{"es", ",", 
             RowBox[{"1", "+", "asen"}], ",", 
             RowBox[{"1", "+", "ajuv"}]}], "]"}], "]"}], ",", "dpval"}], 
         "]"}], "+", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"dvjdtdm", "[", 
           RowBox[{"[", 
            RowBox[{"es", ",", 
             RowBox[{"1", "+", "ajuv"}], ",", 
             RowBox[{"1", "+", "asen"}]}], "]"}], "]"}], ",", "dpval"}], 
         "]"}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ajuv", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"asen", ",", "0", ",", "1"}], "}"}]}], "]"}], "/.", 
   RowBox[{"dmt", "\[Rule]", "0"}]}]}]], "Input",
 CellChangeTimes->{{3.633840021108121*^9, 3.633840071538885*^9}, {
   3.6338401085046263`*^9, 3.6338402041106777`*^9}, {3.63384026431561*^9, 
   3.633840266906165*^9}, {3.6338403163532467`*^9, 3.633840437117086*^9}, {
   3.63384050456122*^9, 3.633840516735833*^9}, {3.633840596136141*^9, 
   3.63384062147458*^9}, 3.633841242195788*^9, 3.633841515230401*^9, {
   3.63394822550735*^9, 3.6339482342832813`*^9}, {3.633964774749003*^9, 
   3.633964778508893*^9}, {3.6349056600196457`*^9, 3.6349056658019238`*^9}}],

Cell["Numerical value of the selection gradient", "Text",
 CellChangeTimes->{{3.593494549744481*^9, 3.5934945648160954`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"selgradM", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
     RowBox[{"{", "m_", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p10s_", ",", "p20s_", ",", "p11s_", ",", "p21s_"}], "}"}], ",",
      "ks_", ",", "Qs_", ",", "trait_"}], "]"}], ":=", "\[IndentingNewLine]", 
   
   RowBox[{"Return", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dmdt", "[", "trait", "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
         RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
         RowBox[{"k", "\[Rule]", "ks"}], ",", 
         RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
         RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
         RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
         RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
         RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
         RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
         RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
         RowBox[{"mt", "\[Rule]", "m"}], ",", 
         RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
         RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
         RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
         RowBox[{"p21", "\[Rule]", "p21s"}]}], "}"}]}], "/.", 
      RowBox[{"ans3", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"s1s", ",", "s2s"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"c1s", ",", "c2s", ",", "c3s", ",", "c4s"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"q1s", ",", "q2s"}], "}"}], ",", 
        RowBox[{"{", "m", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p10s", ",", "p20s", ",", "p11s", ",", "p21s"}], "}"}], ",", 
        "ks", ",", "Qs"}], "]"}]}], "/.", 
     RowBox[{"trait", "\[Rule]", "0"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"selgradM", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.3", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", "0.1", 
   ",", "0.005", ",", "dmt"}], "]"}]}], "Input",
 CellChangeTimes->{{3.505140560825174*^9, 3.50514064385368*^9}, {
   3.505140714222675*^9, 3.505140746631989*^9}, 3.505141681810299*^9, {
   3.505141739370999*^9, 3.505141741390123*^9}, {3.5051417786037*^9, 
   3.505141823518378*^9}, {3.505162181348971*^9, 3.50516229325249*^9}, {
   3.5051623715172*^9, 3.505162376920246*^9}, {3.505162433552815*^9, 
   3.505162434058462*^9}, {3.505657684657195*^9, 3.505657708798037*^9}, {
   3.505815579213955*^9, 3.505815579839667*^9}, {3.505815706057299*^9, 
   3.505815706748337*^9}, {3.505836524337347*^9, 3.50583653604466*^9}, {
   3.505900621331135*^9, 3.50590062168389*^9}, {3.505900681816407*^9, 
   3.505900681925982*^9}, {3.505903100412446*^9, 3.505903105178415*^9}, {
   3.505903306382735*^9, 3.505903306450782*^9}, {3.505903337466215*^9, 
   3.505903337554181*^9}, {3.505903376116904*^9, 3.505903414205284*^9}, {
   3.507215441586883*^9, 3.507215441864266*^9}, {3.507217233968476*^9, 
   3.507217235012242*^9}, {3.507219035704643*^9, 3.507219036006999*^9}, 
   3.5072271240964108`*^9, {3.507445896704231*^9, 3.507445928564635*^9}, 
   3.507883896637253*^9, {3.507883963552722*^9, 3.507883964325812*^9}, {
   3.507884602887243*^9, 3.507884668140694*^9}, {3.508160912305312*^9, 
   3.508160916273239*^9}, {3.508161178047368*^9, 3.508161178663356*^9}, {
   3.520242444905705*^9, 3.520242462811362*^9}, {3.520242515256281*^9, 
   3.520242515537557*^9}, {3.520421764721227*^9, 3.520421771770569*^9}, {
   3.520421841855568*^9, 3.520421849321148*^9}, {3.520421888600866*^9, 
   3.520421892326528*^9}, {3.520422109210228*^9, 3.520422167950575*^9}, {
   3.520422201023795*^9, 3.520422205047305*^9}, {3.520422337344874*^9, 
   3.520422421071539*^9}, {3.520590680092812*^9, 3.520590711893722*^9}, {
   3.520590781521338*^9, 3.520590795966717*^9}, {3.520591226195406*^9, 
   3.520591240038307*^9}, {3.520601881307502*^9, 3.520601882092852*^9}, {
   3.524044511624154*^9, 3.52404451492298*^9}, {3.524044547404213*^9, 
   3.524044549627349*^9}, {3.524044778104684*^9, 3.524044795280702*^9}, 
   3.524555244523746*^9, {3.524555288584175*^9, 3.524555315808396*^9}, {
   3.524555363910387*^9, 3.524555377781718*^9}, {3.524555784594505*^9, 
   3.524555809327095*^9}, {3.52455601312634*^9, 3.52455602076801*^9}, {
   3.53177023662048*^9, 3.531770242557644*^9}, {3.59254503518889*^9, 
   3.59254507172961*^9}, {3.592545222393182*^9, 3.592545256670334*^9}, {
   3.6338408393340816`*^9, 3.633840902756267*^9}, {3.633841005205833*^9, 
   3.6338410818507147`*^9}, {3.633841127360651*^9, 3.633841127543775*^9}, {
   3.633841162541236*^9, 3.63384116875344*^9}, {3.633841253414789*^9, 
   3.633841265821685*^9}, {3.633841532898087*^9, 3.6338415330157747`*^9}, {
   3.633841625899555*^9, 3.633841626081249*^9}, {3.633896376794669*^9, 
   3.633896396915306*^9}, {3.633948476261424*^9, 3.633948493083673*^9}, {
   3.633948532227983*^9, 3.633948536204941*^9}, {3.633948570588236*^9, 
   3.6339485708706284`*^9}}],

Cell[BoxData["0.6555155086050702`"], "Output",
 CellChangeTimes->{
  3.6338412753199863`*^9, {3.633841493574916*^9, 3.633841534309265*^9}, 
   3.633841627345543*^9, {3.633896369056164*^9, 3.633896399054454*^9}, {
   3.633948484755673*^9, 3.633948494612328*^9}, {3.633948537875154*^9, 
   3.633948572216146*^9}, 3.63395251145881*^9, 3.6339525926181183`*^9, 
   3.633954966904809*^9, 3.633955246479425*^9, 3.633955604438682*^9, 
   3.633957088744296*^9, 3.633959178034172*^9, 3.633959255960883*^9, 
   3.633960451480447*^9, 3.6339647130374193`*^9, 3.6339648026054153`*^9, 
   3.6339650766844997`*^9, 3.634903676215118*^9, 3.634976898010017*^9, 
   3.63507482450773*^9, 3.635075356250594*^9, 3.635414734394538*^9, 
   3.6354152831463013`*^9, 3.636728502785624*^9, 3.6367924054897346`*^9, 
   3.636866582578822*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Exporting to C syntax", "Subtitle",
 CellChangeTimes->{{3.503400143336439*^9, 3.503400150072166*^9}}],

Cell[CellGroupData[{

Cell["Functions", "Subsection",
 CellChangeTimes->{{3.633948723799774*^9, 3.633948726855362*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "export", " ", "a", " ", "system", " ", "of", " ", "differential", " ", 
   "equations", " ", "for", " ", "recursion"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.590824692099465*^9, 3.590824701769435*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"exportDiffRecur", "[", 
   RowBox[{
   "file_", ",", "sys_", ",", "lhs1_", ",", "lhs2_", ",", "step_", ",", 
    "Tend_", ",", "delta_", ",", "boundfunc_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mainstr", ",", "iter"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mainstr", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"initialize", " ", "the", " ", "xtplus1", " ", "lhs"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "<=", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", "\"\<double \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\< = 0;\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "now", " ", "print", " ", "the", " ", "for", " ", "loop", " ", "to", 
       " ", "iterate", " ", "the", " ", "system"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"mainstr", "=", 
      RowBox[{
      "mainstr", "<>", "\"\<\\n\\n for (int rtime = 0; rtime < \>\"", "<>", 
       RowBox[{"ToString", "[", "Tend", "]"}], "<>", 
       "\"\<; ++rtime)\\n{\\n\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "<=", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\< = \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<+\>\"", "<>", 
          RowBox[{"ToString", "[", "step", "]"}], "<>", "\"\<*(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"sys", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "now", " ", "print", " ", "the", " ", "delta", " ", "checking"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mainstr", "=", 
      RowBox[{"mainstr", "<>", "\"\<\\nif(\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", "\"\<fabs(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<-\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<)<\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", "delta", "]"}], "]"}], "<>", 
          "\"\<\\n\\t\\t&& \>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"erase", " ", "last"}], " ", "&&", " ", 
       RowBox[{"and", " ", "close", " ", "if", " ", "parentheses"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mainstr", "=", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"mainstr", ",", 
         RowBox[{
          RowBox[{"StringLength", "[", "mainstr", "]"}], "-", "3"}]}], "]"}], 
       "<>", "\"\<)\\n{\\n\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "put", " ", "values", " ", "from", " ", "tplus1", " ", "to", " ", "t"}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<=\>\"", "<>", 
          RowBox[{"ToString", "[", "boundfunc", "]"}], "<>", "\"\<(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"end", " ", "if", " ", "statement"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"mainstr", "=", 
      RowBox[{"mainstr", "<>", "\"\<\\n\\t break;\\n}\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "put", " ", "values", " ", "from", " ", "tplus1", " ", "to", " ", "t"}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<=\>\"", "<>", 
          RowBox[{"ToString", "[", "boundfunc", "]"}], "<>", "\"\<(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"end", " ", "for", " ", "loop"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"mainstr", "=", 
      RowBox[{"mainstr", "<>", "\"\<\\n}\\n\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", "\"\<gsl_vector_set(f,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"iter", "-", "1"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"file", ",", "mainstr"}], "]"}], ";"}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.590824494031481*^9, 3.5908244987542067`*^9}, {
   3.590824688049684*^9, 3.590824689177642*^9}, {3.590824726077338*^9, 
   3.590824819049809*^9}, {3.5908248739935303`*^9, 3.590824925754787*^9}, {
   3.590825036561387*^9, 3.590825126234809*^9}, {3.5908251802423697`*^9, 
   3.590825320995825*^9}, {3.5908253647951612`*^9, 3.5908256308482227`*^9}, 
   3.590825724885985*^9, {3.5908296671027403`*^9, 3.590829904284482*^9}, {
   3.590829936121765*^9, 3.590829970644486*^9}, {3.590830008219141*^9, 
   3.59083026925244*^9}, {3.5908308454160967`*^9, 3.5908309406084223`*^9}, {
   3.590831297981771*^9, 3.590831310679865*^9}, {3.5908313621671124`*^9, 
   3.590831374759654*^9}, {3.590831405453176*^9, 3.59083140577787*^9}, {
   3.590831442824209*^9, 3.5908314475484037`*^9}, {3.590831495257579*^9, 
   3.590831590063092*^9}, {3.590831621644826*^9, 3.590831704009104*^9}, 
   3.590835167612055*^9, {3.590835215286303*^9, 3.590835229648106*^9}, {
   3.59083564362383*^9, 3.5908356616050367`*^9}, {3.5908408172483*^9, 
   3.590840819363501*^9}, {3.590899281419011*^9, 3.590899286902195*^9}, {
   3.590899344670518*^9, 3.5908993451548643`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"export", " ", "all", " ", "the", " ", "variables", " ", "used"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"exportvarStruct", "[", 
     RowBox[{"file_", ",", "vars_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"str", ",", "iter"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"str", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"iter", "=", "1"}], ",", 
         RowBox[{"iter", "\[LessEqual]", 
          RowBox[{"Length", "[", "vars", "]"}]}], ",", 
         RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"str", "=", 
           RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"CForm", "[", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
            "\"\<;\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"file", ",", 
         RowBox[{"str", "<>", "\"\<\\n\\n\>\""}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "export", " ", "those", " ", "variables", " ", "that", " ", "are", " ", 
     "also", " ", "parameters"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"exportParamStruct", "[", 
     RowBox[{"file_", ",", "vars_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"str", ",", "iter"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"str", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"iter", "=", "1"}], ",", 
         RowBox[{"iter", "\[LessEqual]", 
          RowBox[{"Length", "[", "vars", "]"}]}], ",", 
         RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"str", "=", 
           RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"CForm", "[", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
            "\"\<;\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"file", ",", 
         RowBox[{"str", "<>", "\"\<\\n\\n\>\""}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Export patch frequency differential equations\
\>", "Subsection",
 CellChangeTimes->{{3.633948665869166*^9, 3.633948671533196*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dirname", "=", 
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/maternal_age/src/numerical/pbethedge\>\""}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.633948845970737*^9, 3.633948858950864*^9}, {
  3.6354122260205593`*^9, 3.635412227221094*^9}, {3.636792288638378*^9, 
  3.636792292549329*^9}, {3.6368654725040207`*^9, 3.636865477985508*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs1", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ftplus1", "[", 
      RowBox[{"es", ",", "ajuv", ",", "asen"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"ajuv", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"asen", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.590830995553282*^9, 3.590831019103163*^9}, {
  3.6339487629945307`*^9, 3.6339487814248867`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.590831013239851*^9, 3.590831021033671*^9}, 
   3.5908315007820053`*^9, 3.590831629980961*^9, 3.590831678076036*^9, 
   3.5908353068794823`*^9, 3.590837291922063*^9, 3.5908408308911467`*^9, 
   3.590841046106442*^9, 3.590899363949039*^9, 3.590906448500978*^9, 
   3.5912549927166357`*^9, 3.591255384520417*^9, 3.5912555097576313`*^9, 
   3.59257065808182*^9, 3.592571570109268*^9, 3.59257164901926*^9, 
   3.592573289136086*^9, 3.592573525279479*^9, 3.592574053230147*^9, 
   3.592574281490479*^9, 3.5926461976245003`*^9, {3.6339487820494843`*^9, 
   3.6339487869325247`*^9}, 3.633949912768382*^9, 3.6339525115851307`*^9, 
   3.633952592809423*^9, 3.633954967031329*^9, 3.6339552466791887`*^9, 
   3.633955604577128*^9, 3.633957088863068*^9, 3.633959178192387*^9, 
   3.633959256072709*^9, 3.6339604516951942`*^9, 3.633960809397183*^9, 
   3.633964713114575*^9, 3.633964802722361*^9, 3.633965076753581*^9, 
   3.634903676297566*^9, 3.634976898168387*^9, 3.6350748246355057`*^9, 
   3.6350753563961773`*^9, 3.635414734522997*^9, 3.635415283268791*^9, 
   3.636728503069415*^9, 3.636792405634181*^9, 3.6368665828561783`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"exportDiffRecur", "[", 
  RowBox[{
   RowBox[{"dirname", "<>", "\"\</patchrecurs.txt\>\""}], ",", "feqtabPlain", 
   ",", "lhs1", ",", "freqs", ",", "0.01", ",", "1000000", ",", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{"-", "7"}], ")"}]}], ",", "bound01"}], "]"}]], "Input",
 CellChangeTimes->{{3.5908309445698223`*^9, 3.590830987989614*^9}, {
   3.590831024917672*^9, 3.590831027357374*^9}, {3.590831061334312*^9, 
   3.590831088158276*^9}, {3.590831209437612*^9, 3.590831264862075*^9}, {
   3.590831313478467*^9, 3.5908313146115007`*^9}, {3.59083509430632*^9, 
   3.590835102985559*^9}, {3.633948793664184*^9, 3.633948867295075*^9}, {
   3.633948924275844*^9, 3.633948925338778*^9}, 3.633948999896229*^9, {
   3.633952410781393*^9, 3.6339524132676888`*^9}, {3.633952475689004*^9, 
   3.633952487688436*^9}, 3.633952563318735*^9, 3.6354152528441963`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export reproductive values", "Subsection",
 CellChangeTimes->{{3.633949094939683*^9, 3.633949130499846*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs1", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"vjtplus1", "[", 
        RowBox[{"es", ",", "as", ",", "ao"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"as", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ao", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"vstplus1", "[", 
        RowBox[{"es", ",", "as", ",", "ao"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"as", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ao", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.590832827629897*^9, 3.5908328405590963`*^9}, 
   3.633949135209441*^9, {3.6339491809114447`*^9, 3.633949252224616*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"vjtplus1", "[", 
    RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"vjtplus1", "[", 
    RowBox[{"1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"vjtplus1", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"vjtplus1", "[", 
    RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"vjtplus1", "[", 
    RowBox[{"2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"vjtplus1", "[", 
    RowBox[{"2", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"vjtplus1", "[", 
    RowBox[{"2", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"vjtplus1", "[", 
    RowBox[{"2", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"vstplus1", "[", 
    RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"vstplus1", "[", 
    RowBox[{"1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"vstplus1", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"vstplus1", "[", 
    RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"vstplus1", "[", 
    RowBox[{"2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"vstplus1", "[", 
    RowBox[{"2", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"vstplus1", "[", 
    RowBox[{"2", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"vstplus1", "[", 
    RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.633949188647108*^9, 3.633949222906417*^9}, 
   3.633949912841543*^9, 3.6339525116307373`*^9, 3.633952592873447*^9, 
   3.6339549670801983`*^9, 3.633955246785759*^9, 3.633955604679015*^9, 
   3.633957088951046*^9, 3.6339591783152857`*^9, 3.6339592561414757`*^9, 
   3.633960451762743*^9, 3.633960809494403*^9, 3.633964713167857*^9, 
   3.63396480281677*^9, 3.633965076818046*^9, 3.634903676396842*^9, 
   3.6349768982832603`*^9, 3.635074824737652*^9, 3.6350753564647207`*^9, 
   3.635414734630645*^9, 3.635415283324492*^9, 3.636728503170328*^9, 
   3.636792405723136*^9, 3.6368665829885397`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs2", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"vj", "[", 
        RowBox[{"es", ",", "as", ",", "ao"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"as", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ao", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"vs", "[", 
        RowBox[{"es", ",", "as", ",", "ao"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"as", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ao", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.633949258522767*^9, 3.633949266981833*^9}, {
  3.633949309003722*^9, 3.633949315346547*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"vj", "[", 
    RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"vj", "[", 
    RowBox[{"1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"vj", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"vj", "[", 
    RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"vj", "[", 
    RowBox[{"2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"vj", "[", 
    RowBox[{"2", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"vj", "[", 
    RowBox[{"2", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"vj", "[", 
    RowBox[{"2", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"vs", "[", 
    RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"vs", "[", 
    RowBox[{"1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"vs", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"vs", "[", 
    RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"vs", "[", 
    RowBox[{"2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"vs", "[", 
    RowBox[{"2", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"vs", "[", 
    RowBox[{"2", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"vs", "[", 
    RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.633949318440134*^9, 3.63394991287822*^9, 
  3.633952511654386*^9, 3.633952592908287*^9, 3.633954967109078*^9, 
  3.6339552468938923`*^9, 3.633955604732424*^9, 3.6339570890202436`*^9, 
  3.633959178361905*^9, 3.633959256182543*^9, 3.633960451796652*^9, 
  3.633960809553672*^9, 3.633964713202396*^9, 3.6339648028721333`*^9, 
  3.633965076844325*^9, 3.634903676432149*^9, 3.63497689831956*^9, 
  3.635074824772251*^9, 3.635075356495874*^9, 3.635414734672242*^9, 
  3.635415283368884*^9, 3.63672850320306*^9, 3.636792405758562*^9, 
  3.636866583042433*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"exportDiffRecur", "[", 
  RowBox[{
   RowBox[{"dirname", "<>", "\"\</repvals.txt\>\""}], ",", 
   RowBox[{"Flatten", "[", "veqtabPlain", "]"}], ",", "lhs1", ",", "lhs2", 
   ",", "0.01", ",", "1000000", ",", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{"-", "7"}], ")"}]}], ",", "bound0"}], "]"}]], "Input",
 CellChangeTimes->{{3.5908309445698223`*^9, 3.590830987989614*^9}, {
   3.590831024917672*^9, 3.590831027357374*^9}, {3.590831061334312*^9, 
   3.590831088158276*^9}, {3.590831209437612*^9, 3.590831264862075*^9}, {
   3.590831313478467*^9, 3.5908313146115007`*^9}, {3.5908327135275373`*^9, 
   3.590832716378105*^9}, {3.590832814910838*^9, 3.5908328204897003`*^9}, {
   3.5908328629264383`*^9, 3.590832875870335*^9}, {3.5908351115946827`*^9, 
   3.590835117824935*^9}, {3.590841018849063*^9, 3.590841021297264*^9}, {
   3.633949346589108*^9, 3.633949376965355*^9}, 3.633955225031974*^9, 
   3.633955586144198*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Export relatedness coefficients\
\>", "Subsection",
 CellChangeTimes->{{3.63394966745649*^9, 3.633949671535762*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"lhs1", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"raSaJtplus1", "[", "1", "]"}], ",", 
     RowBox[{"raSaJtplus1", "[", "2", "]"}], ",", 
     RowBox[{"rmSaJtplus1", "[", "1", "]"}], ",", 
     RowBox[{"rmSaJtplus1", "[", "2", "]"}], ",", 
     RowBox[{"raSmJtplus1", "[", "1", "]"}], ",", 
     RowBox[{"raSmJtplus1", "[", "2", "]"}], ",", 
     RowBox[{"rmSmJtplus1", "[", "1", "]"}], ",", 
     RowBox[{"rmSmJtplus1", "[", "2", "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6339602883163757`*^9, 3.633960289923397*^9}, {
  3.633960375745604*^9, 3.6339604005249147`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["relvars"], "Input",
 CellChangeTimes->{{3.6339601227568607`*^9, 3.6339601228920307`*^9}, {
  3.633960443860742*^9, 3.633960444412609*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"raSaJ", "[", "1", "]"}], ",", 
   RowBox[{"raSaJ", "[", "2", "]"}], ",", 
   RowBox[{"rmSaJ", "[", "1", "]"}], ",", 
   RowBox[{"rmSaJ", "[", "2", "]"}], ",", 
   RowBox[{"raSmJ", "[", "1", "]"}], ",", 
   RowBox[{"raSmJ", "[", "2", "]"}], ",", 
   RowBox[{"rmSmJ", "[", "1", "]"}], ",", 
   RowBox[{"rmSmJ", "[", "2", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.633960451982408*^9, 3.6339608097118*^9, 
  3.633964713412249*^9, 3.633964803015081*^9, 3.633965077005066*^9, 
  3.6349036765714207`*^9, 3.6349768984745693`*^9, 3.635074824934371*^9, 
  3.6350753566609163`*^9, 3.635414734819941*^9, 3.635415283524953*^9, 
  3.636728503358803*^9, 3.636792405911312*^9, 3.636866583231845*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["reltab0"], "Input",
 CellChangeTimes->{{3.633957569723092*^9, 3.633957571722898*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   PanelBox[GridBox[{
      {
       StyleBox[
        StyleBox[
         DynamicBox[ToBoxes[
           FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
           StandardForm],
          ImageSizeCache->{504., {3., 12.}}],
         StripOnInput->False,
         DynamicUpdating->True], "Panel",
        StripOnInput->False,
        Background->None]},
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"raSaJ", "[", "1", "]"}]}], "+", 
            FractionBox[
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "q1"}], ")"}], " ", 
                RowBox[{"\[LeftSkeleton]", "3", "\[RightSkeleton]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "mt"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "p11"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Q"}], ")"}]}], "-", 
                    RowBox[{"p11", " ", "Q"}]}], ")"}]}], 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "q1"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "mt"}], ")"}], " ", 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]}], 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "q1"}]]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "k"}], ")"}], " ", "mt", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                    ")"}]}]}], ")"}]}]], "+", 
                  FractionBox[
                   RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[LeftSkeleton]", "2", "\[RightSkeleton]"}]}], 
                    ")"}], 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]}]]}],
                  ")"}]}], 
               RowBox[{"2", "-", 
                RowBox[{"2", " ", "q2"}], "+", 
                RowBox[{"mt", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "2"}], "+", 
                   RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "q1"}], ")"}], " ", 
                    RowBox[{"f", "[", 
                    RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "+", 
                   RowBox[{"\[LeftSkeleton]", "39", "\[RightSkeleton]"}], "+", 
                   RowBox[{"2", " ", "k", " ", "q1", " ", 
                    RowBox[{"f", "[", 
                    RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}]], 
              "+", 
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "q1"}], ")"}], " ", 
                RowBox[{"\[LeftSkeleton]", "3", "\[RightSkeleton]"}], " ", 
                RowBox[{"(", 
                 RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                 ")"}]}], 
               RowBox[{"2", "-", 
                RowBox[{"2", " ", "q2"}], "+", 
                RowBox[{"mt", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                  ")"}]}]}]], "+", 
              RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "+", 
              FractionBox[
               RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
               RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]], "+", 
              RowBox[{"s2", " ", 
               RowBox[{"f", "[", 
                RowBox[{"2", ",", "0", ",", "0"}], "]"}], " ", 
               RowBox[{"rmSmJ", "[", "2", "]"}]}]}], 
             RowBox[{
              RowBox[{"s2", " ", 
               RowBox[{"f", "[", 
                RowBox[{"2", ",", "0", ",", "0"}], "]"}]}], "+", 
              FractionBox[
               RowBox[{"2", " ", 
                RowBox[{"\[LeftSkeleton]", "4", "\[RightSkeleton]"}]}], 
               RowBox[{"2", "-", 
                RowBox[{"2", " ", "q2"}], "+", 
                RowBox[{"mt", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                  ")"}]}]}]], "+", 
              FractionBox[
               RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], ")"}], 
                
                RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]}]], "+", 
              
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "q1"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "q2"}], ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"1", ",", "1", ",", "0"}], "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "mt"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                    ")"}]}], 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "q1"}]], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "k"}], ")"}], " ", "mt", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[LeftSkeleton]", "10", "\[RightSkeleton]"}], 
                    "+", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]}], 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]]}], 
                    ")"}]}]}], ")"}]}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "c3"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "q1"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "q2"}], ")"}]}], "+", 
                  RowBox[{"mt", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"q2", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"f", "[", 
                    RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "+", 
                    RowBox[{"\[LeftSkeleton]", "15", "\[RightSkeleton]"}], 
                    "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"f", "[", 
                    RowBox[{"2", ",", "1", ",", "0"}], "]"}]}]}], ")"}]}], 
                    "-", 
                    RowBox[{"q1", " ", 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]}], 
                    "-", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"\[LeftSkeleton]", "19", "\[RightSkeleton]"}], 
                    "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"f", "[", 
                    RowBox[{"2", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]]}]]}], ",", 
           RowBox[{"\[LeftSkeleton]", "6", "\[RightSkeleton]"}], ",", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"rmSmJ", "[", "2", "]"}]}], "+", 
            RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]}]}], "}"}],
         Short[#, 5]& ],
        Background->GrayLevel[1],
        BaseStyle->{Deployed -> False},
        Frame->True,
        FrameStyle->GrayLevel[0, 0.2],
        StripOnInput->False]},
      {
       RowBox[{
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
             StandardForm],
            ImageSizeCache->{87., {0., 12.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 123, 29672105636864993661, 5/2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
             StandardForm],
            ImageSizeCache->{92., {0., 12.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 123, 29672105636864993661, 5 2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
             StandardForm],
            ImageSizeCache->{143., {3., 12.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 123, 29672105636864993661, Infinity],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
             StandardForm],
            ImageSizeCache->{133., {0., 12.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>FrontEndExecute[{
            FrontEnd`SetOptions[
            FrontEnd`$FrontEnd, 
             FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
            FrontEnd`FrontEndToken["PreferencesDialog"]}],
         Evaluator->None,
         Method->"Preemptive"]}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[1.2]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    DefaultBaseStyle->{},
    FrameMargins->5],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[123]]], "Output",
 CellChangeTimes->{3.6339575723915663`*^9, 3.633959178692548*^9, 
  3.6339592564663277`*^9, 3.633960452244835*^9, 3.633960809932087*^9, 
  3.6339647135777483`*^9, 3.633964803243587*^9, 3.633965077196307*^9, 
  3.634903676785645*^9, 3.634976898701297*^9, 3.6350748251178827`*^9, 
  3.6350753568840017`*^9, 3.635414735075835*^9, 3.635415283713258*^9, 
  3.636728503570651*^9, 3.636792406351419*^9, 3.636866583438697*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"exportDiffRecur", "[", 
  RowBox[{
   RowBox[{"dirname", "<>", "\"\</relatedness.txt\>\""}], ",", "reltab0", ",",
    "lhs1", ",", "relvars", ",", "0.01", ",", "1000000", ",", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{"-", "7"}], ")"}]}], ",", "bound01"}], "]"}]], "Input",
 CellChangeTimes->{{3.5908309445698223`*^9, 3.590830987989614*^9}, {
   3.590831024917672*^9, 3.590831027357374*^9}, {3.590831061334312*^9, 
   3.590831088158276*^9}, {3.590831209437612*^9, 3.590831264862075*^9}, {
   3.590831313478467*^9, 3.5908313146115007`*^9}, {3.5908327135275373`*^9, 
   3.590832716378105*^9}, {3.590832814910838*^9, 3.5908328204897003`*^9}, {
   3.5908328629264383`*^9, 3.590832875870335*^9}, {3.5908332487393913`*^9, 
   3.5908332656018467`*^9}, {3.590835124242126*^9, 3.590835130286148*^9}, 
   3.633949562835455*^9, 3.633949642352481*^9, 3.633959157209539*^9, 
   3.63395923621408*^9, {3.633960804618338*^9, 3.633960804744619*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export selection gradients", "Subsection",
 CellChangeTimes->{{3.633950144681546*^9, 3.633950178775806*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mainrecursion", "[", 
   RowBox[{
   "file_", ",", "lhs1_", ",", "lhs2_", ",", "sys_", ",", "step_", ",", 
    "boundfunc_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mainstr", ",", "iter"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mainstr", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", "\"\<double \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<;\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "<=", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\< = \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", "boundfunc", "]"}], "]"}], "<>", "\"\<(\>\"",
           "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<+\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", "step", "]"}], "]"}], "<>", "\"\<*(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"sys", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<));\\n\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", "\"\<gsl_vector_set(f,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"iter", "-", "1"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"file", ",", "mainstr"}], "]"}], ";"}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.590834528268754*^9, 3.5908345406910887`*^9}, {
  3.5908345731626368`*^9, 3.590834675056554*^9}, {3.59083471597438*^9, 
  3.590834821120158*^9}, {3.590834853928339*^9, 3.5908348608410273`*^9}, {
  3.590835771695839*^9, 3.59083578825672*^9}, {3.5908359289600773`*^9, 
  3.590835932990438*^9}, {3.590840618567021*^9, 3.590840672227709*^9}, {
  3.590840711466693*^9, 3.590840786098345*^9}, {3.590840866972934*^9, 
  3.5908408676441708`*^9}, {3.590906715159862*^9, 3.590906758199222*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"mainrecursion", "[", 
   RowBox[{
    RowBox[{"dirname", "<>", "\"\</selgrad.txt\>\""}], ",", 
    RowBox[{"{", 
     RowBox[{
     "p11tplus1", ",", "p21tplus1", ",", "p10tplus1", ",", "p20tplus1", ",", 
      "mttplus1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p11", ",", "p21", ",", "p10", ",", "p20", ",", "mt"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dpdt", "[", "dp11", "]"}], ",", 
      RowBox[{"dpdt", "[", "dp21", "]"}], ",", 
      RowBox[{"dpdt", "[", "dp10", "]"}], ",", 
      RowBox[{"dpdt", "[", "dp20", "]"}], ",", 
      RowBox[{"dmdt", "[", "dmt", "]"}]}], "}"}], ",", "0.01", ",", 
    "bound01"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.590834863067157*^9, 3.5908348659045677`*^9}, {
   3.5908350208710938`*^9, 3.590835056118764*^9}, {3.590835395027761*^9, 
   3.5908354700620193`*^9}, {3.590835813388159*^9, 3.5908358193860083`*^9}, {
   3.590835893242031*^9, 3.590835938161178*^9}, {3.59083721166047*^9, 
   3.590837216588141*^9}, {3.5908372506434507`*^9, 3.590837278979712*^9}, 
   3.5908408426915493`*^9, {3.591255327965082*^9, 3.591255373916926*^9}, {
   3.5925713854064827`*^9, 3.592571404414489*^9}, {3.592574241149887*^9, 
   3.5925742557514*^9}, {3.5926460594032516`*^9, 3.5926460625675592`*^9}, {
   3.633949698827869*^9, 3.63394977871297*^9}, {3.633964668879614*^9, 
   3.63396467400016*^9}, {3.634977831819654*^9, 3.63497783209041*^9}, {
   3.635413157590366*^9, 3.6354131654491796`*^9}, {3.636792303238253*^9, 
   3.636792360988698*^9}, {3.636865399054618*^9, 3.636865406263175*^9}}],

Cell[BoxData[
 RowBox[{"mainrecursion", "[", 
  RowBox[{
   RowBox[{"dirname", "<>", "\"\</selgrad.txt\>\""}], ",", 
   RowBox[{"{", 
    RowBox[{"p11tplus1", ",", "p10tplus1", ",", "mttplus1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p11", ",", "p10", ",", "mt"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dpdt", "[", "dp11", "]"}], ",", 
     RowBox[{"dpdt", "[", "dp10", "]"}], ",", 
     RowBox[{"dmdt", "[", "dmt", "]"}]}], "}"}], ",", "0.01", ",", 
   "bound01"}], "]"}]], "Input",
 CellChangeTimes->{{3.6368654149504957`*^9, 3.636865459228044*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"exportvarStruct", "[", 
   RowBox[{
    RowBox[{"dirname", "<>", "\"\</variables.txt\>\""}], ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c1", ",", "c2", ",", "c3", ",", "c4", ",", "q1", ",", "q2", ",", "k", 
        ",", "mt", ",", "s1", ",", "s2", ",", "Q", ",", "p11", ",", "p21", 
        ",", "p10", ",", "p20"}], "}"}], ",", "freqs", ",", "rvals", ",", 
      "relvars"}], "]"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.590824508033992*^9, 3.590824510035123*^9}, {
   3.590836149589223*^9, 3.59083615739601*^9}, {3.5908363596734037`*^9, 
   3.5908363664583187`*^9}, {3.590837303024035*^9, 3.590837303763467*^9}, {
   3.590837354515375*^9, 3.590837425506982*^9}, {3.590837476699024*^9, 
   3.5908375182256727`*^9}, 3.5908405283010883`*^9, {3.591254984752503*^9, 
   3.591254986592825*^9}, {3.592571634075862*^9, 3.592571634982567*^9}, 
   3.5925742351812277`*^9, {3.592574307804111*^9, 3.5925743088758497`*^9}, {
   3.633949812898211*^9, 3.633949879150069*^9}, {3.635415214379311*^9, 
   3.635415214512344*^9}, {3.6367923661253357`*^9, 3.6367923680355053`*^9}, {
   3.636865465692223*^9, 3.636865468442924*^9}}],

Cell[BoxData[
 RowBox[{"exportvarStruct", "[", 
  RowBox[{
   RowBox[{"dirname", "<>", "\"\</variables.txt\>\""}], ",", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "c1", ",", "c2", ",", "c3", ",", "c4", ",", "q1", ",", "q2", ",", "k", 
       ",", "mt", ",", "s1", ",", "s2", ",", "Q", ",", "p11", ",", "p10"}], 
      "}"}], ",", "freqs", ",", "rvals", ",", "relvars"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.590824508033992*^9, 3.590824510035123*^9}, {
   3.590836149589223*^9, 3.59083615739601*^9}, {3.5908363596734037`*^9, 
   3.5908363664583187`*^9}, {3.590837303024035*^9, 3.590837303763467*^9}, {
   3.590837354515375*^9, 3.590837425506982*^9}, {3.590837476699024*^9, 
   3.5908375182256727`*^9}, 3.5908405283010883`*^9, {3.591254984752503*^9, 
   3.591254986592825*^9}, {3.592571634075862*^9, 3.592571634982567*^9}, 
   3.5925742351812277`*^9, {3.592574307804111*^9, 3.5925743088758497`*^9}, {
   3.633949812898211*^9, 3.633949879150069*^9}, {3.635415214379311*^9, 
   3.635415214512344*^9}, {3.6367923661253357`*^9, 3.6367923680355053`*^9}, {
   3.636865465692223*^9, 3.636865468442924*^9}, {3.6368674712200613`*^9, 
   3.6368674786045313`*^9}}],

Cell[BoxData[
 RowBox[{"exportParamStruct", "[", 
  RowBox[{
   RowBox[{"dirname", "<>", "\"\</params.txt\>\""}], ",", 
   RowBox[{"{", 
    RowBox[{
    "c1", ",", "c2", ",", "c3", ",", "c4", ",", "q1", ",", "q2", ",", "k", 
     ",", "s1", ",", "s2", ",", "Q"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.590824508033992*^9, 3.590824510035123*^9}, {
  3.590836149589223*^9, 3.59083615739601*^9}, {3.5908363596734037`*^9, 
  3.5908363664583187`*^9}, {3.590837303024035*^9, 3.590837303763467*^9}, {
  3.590837354515375*^9, 3.590837470002576*^9}, {3.592571636699113*^9, 
  3.59257163758764*^9}, {3.592571677386757*^9, 3.592571677538636*^9}, {
  3.592574237139097*^9, 3.5925742381966267`*^9}, {3.592646066928492*^9, 
  3.59264606934616*^9}, {3.633949896750095*^9, 3.633949909788252*^9}, {
  3.633965054445489*^9, 3.633965054596797*^9}, {3.6367923056849327`*^9, 
  3.6367923065812197`*^9}}]
}, Open  ]]
}, Open  ]]
},
CellGrouping->Manual,
WindowSize->{1855, 1056},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
DockedCells->(FrontEndExecute[{
   FrontEnd`NotebookApply[
    FrontEnd`InputNotebook[], #, Placeholder]}]& ),
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> True}},
Magnification->1.5,
FrontEndVersion->"9.0 for Linux x86 (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 299, 4, 108, "Title"],
Cell[859, 26, 152, 2, 52, "Text"],
Cell[CellGroupData[{
Cell[1036, 32, 116, 1, 110, "Section"],
Cell[1155, 35, 94, 1, 44, "Text"],
Cell[1252, 38, 384, 6, 44, "Input"],
Cell[1639, 46, 1214, 40, 131, "Text"],
Cell[2856, 88, 728, 21, 110, "Text"],
Cell[3587, 111, 322, 9, 73, "Input"],
Cell[3912, 122, 125, 1, 44, "Text"],
Cell[4040, 125, 460, 9, 101, "Text"],
Cell[4503, 136, 3844, 93, 213, "Input"],
Cell[8350, 231, 2068, 54, 239, "Text"],
Cell[10421, 287, 5040, 147, 633, "Input"],
Cell[15464, 436, 4946, 146, 633, "Input"],
Cell[20413, 584, 7391, 190, 689, "Input"],
Cell[CellGroupData[{
Cell[27829, 778, 696, 11, 44, "Input"],
Cell[28528, 791, 2102, 34, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30667, 830, 350, 6, 44, "Input"],
Cell[31020, 838, 551, 12, 44, "Output"]
}, Open  ]],
Cell[31586, 853, 531, 14, 74, "Text"],
Cell[32120, 869, 1543, 41, 110, "Input"],
Cell[33666, 912, 394, 6, 46, "Text"],
Cell[34063, 920, 2055, 49, 113, "Input"],
Cell[36121, 971, 155, 2, 46, "Text"],
Cell[CellGroupData[{
Cell[36301, 977, 166, 3, 44, "Input"],
Cell[36470, 982, 978, 17, 44, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37497, 1005, 67, 0, 110, "Section"],
Cell[37567, 1007, 2330, 81, 176, "Text"],
Cell[39900, 1090, 6054, 142, 337, "Input"],
Cell[45957, 1234, 482, 10, 74, "Text"],
Cell[46442, 1246, 10890, 261, 1234, "Input"],
Cell[CellGroupData[{
Cell[57357, 1511, 471, 12, 44, "Input"],
Cell[57831, 1525, 2363, 64, 95, "Output"]
}, Open  ]],
Cell[60209, 1592, 238, 3, 46, "Text"],
Cell[60450, 1597, 502, 12, 44, "Input"],
Cell[60955, 1611, 385, 11, 44, "Text"],
Cell[61343, 1624, 1003, 20, 83, "Input"],
Cell[62349, 1646, 450, 9, 74, "Text"],
Cell[62802, 1657, 20596, 476, 941, "Input"],
Cell[83401, 2135, 132, 3, 44, "Text"],
Cell[CellGroupData[{
Cell[83558, 2142, 642, 16, 44, "Input"],
Cell[84203, 2160, 2332, 42, 44, "Output"],
Cell[86538, 2204, 99, 1, 44, "Text"],
Cell[86640, 2207, 501, 14, 44, "Input"]
}, Open  ]],
Cell[87156, 2224, 124, 3, 44, "Text"],
Cell[87283, 2229, 481, 13, 44, "Input"],
Cell[87767, 2244, 180, 4, 44, "Input"],
Cell[87950, 2250, 238, 4, 44, "Text"],
Cell[88191, 2256, 1550, 40, 73, "Input"],
Cell[89744, 2298, 956, 22, 44, "Input"],
Cell[90703, 2322, 176, 4, 44, "Text"],
Cell[90882, 2328, 660, 15, 44, "Input"],
Cell[91545, 2345, 231, 4, 46, "Text"],
Cell[91779, 2351, 3037, 58, 101, "Input"],
Cell[94819, 2411, 3095, 59, 101, "Input"],
Cell[97917, 2472, 3184, 60, 101, "Input"],
Cell[CellGroupData[{
Cell[101126, 2536, 1483, 27, 44, "Input"],
Cell[102612, 2565, 2226, 33, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104875, 2603, 784, 17, 44, "Input"],
Cell[105662, 2622, 2198, 50, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107897, 2677, 692, 16, 44, "Input"],
Cell[108592, 2695, 2799, 59, 73, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[111440, 2760, 38, 0, 110, "Section"],
Cell[111481, 2762, 165, 3, 44, "Text"],
Cell[111649, 2767, 905, 19, 156, "Input"],
Cell[112557, 2788, 1004, 21, 156, "Input"],
Cell[113564, 2811, 116, 1, 44, "Text"],
Cell[113683, 2814, 26605, 638, 2202, "Input"],
Cell[140291, 3454, 25884, 628, 2091, "Input"],
Cell[166178, 4084, 312, 8, 44, "Input"],
Cell[166493, 4094, 100, 1, 44, "Text"],
Cell[166596, 4097, 2857, 87, 212, "Input"],
Cell[169456, 4186, 908, 21, 73, "Input"],
Cell[170367, 4209, 685, 19, 44, "Input"],
Cell[171055, 4230, 1957, 35, 73, "Input"],
Cell[CellGroupData[{
Cell[173037, 4269, 1243, 31, 73, "Input"],
Cell[174283, 4302, 4579, 119, 129, "Output"]
}, Open  ]],
Cell[178877, 4424, 180, 3, 46, "Text"],
Cell[179060, 4429, 2308, 49, 101, "Input"],
Cell[181371, 4480, 1819, 44, 101, "Input"],
Cell[CellGroupData[{
Cell[183215, 4528, 2027, 34, 44, "Input"],
Cell[185245, 4564, 4646, 120, 226, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189928, 4689, 2027, 34, 66, "Input"],
Cell[191958, 4725, 4678, 120, 226, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[196685, 4851, 96, 1, 165, "Section"],
Cell[196784, 4854, 198, 4, 757, "Text"],
Cell[196985, 4860, 3944, 114, 5085, "Input"],
Cell[200932, 4976, 6666, 163, 5062, "Input"],
Cell[207601, 5141, 6248, 160, 5062, "Input"],
Cell[213852, 5303, 6671, 172, 5541, "Input"],
Cell[220526, 5477, 6478, 170, 8311, "Input"],
Cell[227007, 5649, 16868, 414, 19368, "Input"],
Cell[CellGroupData[{
Cell[243900, 6067, 486, 13, 1122, "Input"],
Cell[244389, 6082, 31337, 797, 235, "Output"]
}, Open  ]],
Cell[275741, 6882, 1996, 47, 3282, "Input"],
Cell[277740, 6931, 601, 15, 1122, "Input"],
Cell[278344, 6948, 165, 2, 1167, "Text"],
Cell[278512, 6952, 1414, 35, 1851, "Input"],
Cell[279929, 6989, 8577, 201, 15490, "Input"],
Cell[288509, 7192, 734, 17, 1122, "Input"],
Cell[CellGroupData[{
Cell[289268, 7213, 278, 7, 1122, "Input"],
Cell[289549, 7222, 332, 4, 235, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[289918, 7231, 2443, 40, 1122, "Input"],
Cell[292364, 7273, 5710, 142, 235, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[298123, 7421, 115, 1, 94, "Section"],
Cell[298241, 7424, 165, 3, 66, "Text"],
Cell[298409, 7429, 905, 19, 234, "Input"],
Cell[299317, 7450, 1004, 21, 234, "Input"],
Cell[300324, 7473, 116, 1, 66, "Text"],
Cell[300443, 7476, 32516, 769, 4137, "Input"],
Cell[332962, 8247, 31130, 749, 3988, "Input"]
}, Open  ]],
Cell[364107, 8999, 1100, 33, 184, "Input"],
Cell[CellGroupData[{
Cell[365232, 9036, 587, 22, 165, "Section"],
Cell[365822, 9060, 4630, 117, 715, "Input"],
Cell[370455, 9179, 4500, 116, 745, "Input"],
Cell[374958, 9297, 14373, 343, 1450, "Input"],
Cell[389334, 9642, 15308, 369, 1594, "Input"],
Cell[404645, 10013, 344, 6, 66, "Text"],
Cell[404992, 10021, 1510, 40, 184, "Input"],
Cell[406505, 10063, 125, 1, 66, "Text"],
Cell[CellGroupData[{
Cell[406655, 10068, 5467, 104, 277, "Input"],
Cell[412125, 10174, 1238, 18, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[413400, 10197, 1042, 21, 66, "Input"],
Cell[414445, 10220, 1262, 19, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[415744, 10244, 1436, 32, 109, "Input"],
Cell[417183, 10278, 682, 11, 66, "Output"],
Cell[417868, 10291, 665, 10, 66, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[418582, 10307, 181, 2, 165, "Section"],
Cell[418766, 10311, 1843, 49, 5014, "Input"],
Cell[420612, 10362, 1786, 47, 5014, "Input"],
Cell[422401, 10411, 1791, 48, 5085, "Input"],
Cell[424195, 10461, 1832, 47, 5085, "Input"],
Cell[426030, 10510, 92, 1, 1369, "Input"],
Cell[426125, 10513, 627, 13, 1369, "Input"],
Cell[426755, 10528, 479, 11, 1369, "Input"],
Cell[427237, 10541, 868, 24, 3390, "Input"],
Cell[428108, 10567, 792, 23, 3390, "Input"],
Cell[428903, 10592, 872, 24, 3390, "Input"],
Cell[429778, 10618, 863, 24, 3390, "Input"],
Cell[430644, 10644, 15839, 379, 227448, "Input"],
Cell[446486, 11025, 17440, 423, 253720, "Input"],
Cell[463929, 11450, 1647, 41, 24666, "Input"],
Cell[465579, 11493, 125, 1, 7080, "Text"],
Cell[CellGroupData[{
Cell[465729, 11498, 5365, 104, 34444, "Input"],
Cell[471097, 11604, 811, 12, 792, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[471957, 11622, 107, 1, 118, "Subtitle"],
Cell[CellGroupData[{
Cell[472089, 11627, 97, 1, 87, "Subsection"],
Cell[472189, 11630, 257, 5, 121270, "Input"],
Cell[472449, 11637, 9057, 205, 2837571, "Input"],
Cell[481509, 11844, 2663, 65, 1286019, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[484209, 11914, 141, 3, 66, "Subsection"],
Cell[484353, 11919, 390, 9, 66, "Input"],
Cell[CellGroupData[{
Cell[484768, 11932, 560, 15, 66, "Input"],
Cell[485331, 11949, 1837, 34, 66, "Output"]
}, Open  ]],
Cell[487183, 11986, 893, 15, 66, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[488113, 12006, 114, 1, 87, "Subsection"],
Cell[CellGroupData[{
Cell[488252, 12011, 1025, 27, 109, "Input"],
Cell[489280, 12040, 1966, 43, 151, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[491283, 12088, 986, 27, 66, "Input"],
Cell[492272, 12117, 1828, 43, 109, "Output"]
}, Open  ]],
Cell[494115, 12163, 955, 17, 66, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[495107, 12185, 126, 3, 87, "Subsection"],
Cell[495236, 12190, 626, 14, 66, "Input"],
Cell[CellGroupData[{
Cell[495887, 12208, 152, 2, 66, "Input"],
Cell[496042, 12212, 741, 15, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[496820, 12232, 99, 1, 66, "Input"],
Cell[496922, 12235, 13352, 329, 472, "Output"]
}, Open  ]],
Cell[510289, 12567, 969, 16, 148, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[511295, 12588, 114, 1, 198, "Subsection"],
Cell[511412, 12591, 3638, 83, 1378, "Input"],
Cell[515053, 12676, 1605, 31, 244, "Input"],
Cell[516661, 12709, 575, 14, 148, "Input"],
Cell[517239, 12725, 1216, 22, 148, "Input"],
Cell[518458, 12749, 1202, 22, 148, "Input"],
Cell[519663, 12773, 893, 16, 148, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
