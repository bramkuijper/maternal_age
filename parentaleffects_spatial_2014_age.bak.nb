(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[   1143717,      27483]
NotebookOptionsPosition[   1128827,      27049]
NotebookOutlinePosition[   1129393,      27070]
CellTagsIndexPosition[   1129350,      27067]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.60895692267762*^9}],

Cell[TextData[StyleBox["Maternal Effects and Maternal Age",
 FontSize->24]], "Title",
 CellChangeTimes->{{3.593494666799176*^9, 3.593494707374599*^9}, {
  3.5937783195816603`*^9, 3.5937783301250973`*^9}, {3.608870866174801*^9, 
  3.608870867597124*^9}, {3.6240267916373568`*^9, 3.624026811995323*^9}}],

Cell[TextData[StyleBox["Bram Kuijper & Rufus A. Johnstone",
 FontSize->16]], "Text",
 CellChangeTimes->{{3.593778276437594*^9, 3.5937782840517187`*^9}}],

Cell[CellGroupData[{

Cell["Parameters and initialization", "Section",
 CellChangeTimes->{{3.5925369193881607`*^9, 3.592536949051231*^9}}],

Cell["Clear memory:", "Text",
 CellChangeTimes->{{3.59344239283613*^9, 3.593442395379766*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.500128427684636*^9, 3.500128451258902*^9}, 
   3.50073299731535*^9, {3.5018611272843018`*^9, 3.501861128504798*^9}, 
   3.501861166978281*^9, {3.505125110823873*^9, 3.505125111480598*^9}, {
   3.509288972748003*^9, 3.509288973397145*^9}, {3.509608637730192*^9, 
   3.509608638396096*^9}}],

Cell[TextData[{
 StyleBox["- Patch frequncies ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", 
    RowBox[{"x", ",", "i", ",", "j", ",", "k"}]], TraditionalForm]],
  FontWeight->"Bold"],
 StyleBox["\n",
  FontWeight->"Bold"],
 StyleBox["x",
  FontSlant->"Italic"],
 ": environment ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "1"], TraditionalForm]]],
 " or ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "2"], TraditionalForm]]],
 " (here annotated as ",
 StyleBox["a",
  FontSlant->"Italic"],
 ", ",
 StyleBox["b",
  FontSlant->"Italic"],
 ")\n",
 StyleBox["i",
  FontSlant->"Italic"],
 ": number of young breeders adapted to local environment\n",
 StyleBox["j",
  FontSlant->"Italic"],
 ": number of young breeders maladapted to local environment\n",
 StyleBox["k",
  FontSlant->"Italic"],
 ": number of old breeders adapted to local environment"
}], "Text",
 CellChangeTimes->{{3.500116732616866*^9, 3.5001167713959846`*^9}, {
  3.592536638246684*^9, 3.592536709381946*^9}, {3.5925368332856894`*^9, 
  3.5925368556518803`*^9}, {3.5934424013557873`*^9, 3.59344240478764*^9}, {
  3.5934435772716312`*^9, 3.5934435786830397`*^9}, {3.607685242639638*^9, 
  3.607685289006283*^9}, {3.618922101159214*^9, 3.618922178073358*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"e_", ",", "a1_", ",", "m1_", ",", "a2_", ",", "m2_"}], "]"}], ":=", 
  RowBox[{"fx", "[", 
   RowBox[{"e", ",", "a1", ",", "m1", ",", "a2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.607685424645199*^9, 3.607685465832694*^9}, {
  3.60768549794396*^9, 3.607685520058104*^9}, {3.607699744787403*^9, 
  3.607699752073833*^9}, {3.618922362359199*^9, 3.6189223804237757`*^9}, {
  3.624048493487925*^9, 3.624048494451849*^9}}],

Cell[TextData[{
 StyleBox["- Switching rates\n",
  FontWeight->"Bold"],
 Cell[BoxData[{
  FormBox[
   RowBox[{
    SubscriptBox["s", "1"], "=", 
    SubscriptBox["s", 
     RowBox[{
      SubscriptBox["e", "1"], "\[Rule]", 
      SubscriptBox["e", "2"]}]]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    SubscriptBox["s", "2"], "=", 
    SubscriptBox["s", 
     RowBox[{
      SubscriptBox["e", "2"], "\[Rule]", 
      SubscriptBox["e", "1"]}]]}], TraditionalForm]}]]
}], "Text",
 CellChangeTimes->{{3.500116778255621*^9, 3.500116786939053*^9}, {
  3.5925373284084177`*^9, 3.5925373751662283`*^9}, {3.593443566867229*^9, 
  3.5934435669632*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"st", "=", 
   RowBox[{"{", 
    RowBox[{"s1", ",", "s2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "[", "es_", "]"}], ":=", 
  RowBox[{"st", "[", 
   RowBox[{"[", "es", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5925373087718763`*^9, 3.5925373233792*^9}}],

Cell["\<\
Specification of the evolutionary variables\
\>", "Text",
 CellChangeTimes->{{3.592537654940291*^9, 3.592537660676259*^9}}],

Cell[TextData[{
 StyleBox["- Dispersal locus",
  FontWeight->"Bold"],
 "\nmx: resident dispersal rates\ndmx: \[Delta], slight difference between \
mutant and resident dispersal rates"
}], "Text",
 CellChangeTimes->{{3.5925374540299177`*^9, 3.592537454998452*^9}, {
  3.592537662916122*^9, 3.5925376632683887`*^9}, {3.592537720779931*^9, 
  3.592537797507066*^9}, {3.5934435603070107`*^9, 3.593443589964015*^9}, {
  3.593443687619841*^9, 3.593443689099412*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mx", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mt", ",", "mt"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mt", ",", "mt"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mt", ",", "mt"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mt", ",", "mt"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dmx", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dmt", ",", "dmt"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dmt", ",", "dmt"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dmt", ",", "dmt"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dmt", ",", "dmt"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m", "[", 
    RowBox[{"es_", ",", "state_", ",", "age_"}], "]"}], ":=", 
   RowBox[{"mx", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"age", "+", "1"}], ",", "es", ",", 
      RowBox[{"1", "+", "state"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dm", "[", 
    RowBox[{"es_", ",", "state_", ",", "age_"}], "]"}], ":=", 
   RowBox[{"dmx", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"age", "+", "1"}], ",", "es", ",", 
      RowBox[{"1", "+", "state"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"varlistM", ":=", 
    RowBox[{"{", "mt", "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "definitions", " ", "needed", " ", "later", " ", "for", " ", "function", 
    " ", "specification"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varlistdM", ":=", 
   RowBox[{"{", "dmt", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arglistM", ":=", "ms__Real"}], ";"}]}], "Input",
 CellChangeTimes->{{3.500118773163447*^9, 3.500118910263569*^9}, {
   3.500119087597973*^9, 3.500119090980617*^9}, {3.5001195528530283`*^9, 
   3.500119593468643*^9}, {3.500120092623599*^9, 3.500120092748851*^9}, {
   3.500136368745949*^9, 3.500136374906622*^9}, {3.5001423795874243`*^9, 
   3.500142397835494*^9}, {3.5001910544408283`*^9, 3.5001910707255917`*^9}, {
   3.505128236491838*^9, 3.505128288704921*^9}, {3.505133288973331*^9, 
   3.505133296177403*^9}, {3.505133522438445*^9, 3.505133549659513*^9}, {
   3.505134014352137*^9, 3.50513403905585*^9}, {3.505134240579132*^9, 
   3.505134241767873*^9}, {3.505139351314415*^9, 3.505139372086256*^9}, {
   3.5051558273320293`*^9, 3.505155855600602*^9}, {3.50539467615995*^9, 
   3.505394676982449*^9}, {3.505463244026674*^9, 3.505463257417686*^9}, {
   3.505463307333784*^9, 3.505463321253703*^9}, {3.50546575267028*^9, 
   3.505465768233089*^9}, {3.505484976325813*^9, 3.505484983948823*^9}, {
   3.50548503239085*^9, 3.505485033454481*^9}, {3.505558270883147*^9, 
   3.505558284187843*^9}, {3.505571015107941*^9, 3.505571047863003*^9}, {
   3.505581160740476*^9, 3.50558117287267*^9}, {3.505583355345198*^9, 
   3.505583361715997*^9}, {3.505583682927802*^9, 3.505583683359265*^9}, 
   3.50558371668095*^9, {3.505654692054782*^9, 3.505654715998914*^9}, {
   3.505654759113348*^9, 3.505654761139649*^9}, {3.50565724255633*^9, 
   3.505657273309394*^9}, {3.505661781217031*^9, 3.505661845410152*^9}, {
   3.505661877847231*^9, 3.505661889520056*^9}, {3.505751661144566*^9, 
   3.505751681752979*^9}, {3.505751745355992*^9, 3.505751753278463*^9}, {
   3.507884037673462*^9, 3.507884044308074*^9}, {3.515223764045479*^9, 
   3.515223766960201*^9}, {3.59344329997761*^9, 3.5934433141234093`*^9}, {
   3.6240488182675467`*^9, 3.624048882538862*^9}, 3.6240491606050177`*^9, 
   3.624082038492394*^9}],

Cell[TextData[{
 StyleBox["- Phenotype-dependent switching",
  FontWeight->"Bold"],
 "\npx: table of probabilities that females with a particular phenotype \
produce offspring of a different phenotype than their own. \ndpx: same, but \
now as a function of a slight mutant difference relative to resident\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["p", "1"], ",", 
    SubscriptBox["p", "2"]}], TraditionalForm]]],
 ": probability of producing ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "1"], TraditionalForm]]],
 "-offspring  for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "1"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "2"], TraditionalForm]]],
 " parents respectively\nQ: `trembling hand\[CloseCurlyQuote] error to avoid \
local maxima (sensu Selten 1975 Int J Game Theor 4: 25-55)\n\np[es,ad]: \
lookup function connecting a female\[CloseCurlyQuote]s environment ",
 StyleBox["es",
  FontSlant->"Italic"],
 " and her adapted/maladapted state ",
 StyleBox["ad",
  FontSlant->"Italic"],
 " to values of px \nFor example, p[1,0] reflects a female living in \
environment ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "1"], TraditionalForm]]],
 " with \[OpenCurlyQuote]adaptedness\[CloseCurlyQuote]=0 (i.e., maladapted). \
In other words, this is a ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", 
    RowBox[{"2", " "}]], TraditionalForm]]],
 "-female (which is adapted to environment ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "2"], TraditionalForm]]],
 "). See main text."
}], "Text",
 CellChangeTimes->{{3.592537529829274*^9, 3.592537608764773*^9}, {
  3.592537665787866*^9, 3.592537666036079*^9}, {3.592537805202849*^9, 
  3.592537830338646*^9}, {3.592543662226894*^9, 3.592543678923498*^9}, {
  3.593442422212388*^9, 3.593442485691265*^9}, {3.593443236238962*^9, 
  3.5934432559978437`*^9}, {3.593443341806076*^9, 3.5934435210194693`*^9}, {
  3.593443562188596*^9, 3.593443683563737*^9}, {3.607685567541914*^9, 
  3.607685570004575*^9}, {3.607685652396105*^9, 3.607685680059689*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"px", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "p20"}], "+", 
          RowBox[{"Q", 
           RowBox[{"(", 
            RowBox[{"1", "-", "p20"}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "p10"}], ")"}]}], "+", 
          RowBox[{"Q", " ", "p10"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "p10"}], ")"}]}], "+", 
          RowBox[{"Q", " ", "p10"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "p20"}], "+", 
          RowBox[{"Q", 
           RowBox[{"(", 
            RowBox[{"1", "-", "p20"}], ")"}]}]}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "p21"}], "+", 
          RowBox[{"Q", 
           RowBox[{"(", 
            RowBox[{"1", "-", "p21"}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "p11"}], ")"}]}], "+", 
          RowBox[{"Q", " ", "p11"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "p11"}], ")"}]}], "+", 
          RowBox[{"Q", " ", "p11"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "p21"}], "+", 
          RowBox[{"Q", 
           RowBox[{"(", 
            RowBox[{"1", "-", "p21"}], ")"}]}]}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dpx", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "p20"}], "-", 
          RowBox[{"Q", " ", "dp20"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}]}], "dp10"}], "+", 
          RowBox[{"Q", " ", "dp10"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}]}], "dp10"}], "+", 
          RowBox[{"Q", " ", "dp10"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "dp20"}], "+", 
          RowBox[{
           RowBox[{"-", "dp20"}], " ", "Q"}]}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "dp21"}], "+", 
          RowBox[{
           RowBox[{"-", "dp21"}], " ", "Q"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "dp11"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}]}], "+", 
          RowBox[{"Q", " ", "dp11"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}]}], "dp11"}], "+", 
          RowBox[{"Q", " ", "dp11"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "dp21"}], "+", 
          RowBox[{
           RowBox[{"-", "dp21"}], " ", "Q"}]}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", 
    RowBox[{"es_", ",", "ad_", ",", "age_"}], "]"}], ":=", 
   RowBox[{"px", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"age", "+", "1"}], ",", "es", ",", 
      RowBox[{"1", "+", "ad"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dp", "[", 
   RowBox[{"es_", ",", "ad_", ",", "age_"}], "]"}], ":=", 
  RowBox[{"dpx", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"age", "+", "1"}], ",", "es", ",", 
     RowBox[{"1", "+", "ad"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.517038062927934*^9, 3.51703816854226*^9}, {
   3.51905182898097*^9, 3.519051833116747*^9}, {3.520238431048418*^9, 
   3.520238433809459*^9}, {3.520241987657432*^9, 3.520242003026947*^9}, {
   3.520242820378682*^9, 3.520242825954704*^9}, {3.520243764786285*^9, 
   3.520243764836133*^9}, 3.52024391190013*^9, {3.520244311149429*^9, 
   3.520244311961317*^9}, {3.52024449388923*^9, 3.520244495018912*^9}, {
   3.520244741108325*^9, 3.520244741844243*^9}, {3.520244856084298*^9, 
   3.520244860756021*^9}, {3.520253380519802*^9, 3.520253380863543*^9}, {
   3.520414422134022*^9, 3.520414425613311*^9}, {3.520414525684128*^9, 
   3.520414527662351*^9}, {3.520434069244433*^9, 3.520434072029148*^9}, {
   3.520586789091575*^9, 3.52058679184248*^9}, {3.521874430981219*^9, 
   3.521874431323632*^9}, {3.52257859226308*^9, 3.52257859675019*^9}, {
   3.524043568339653*^9, 3.52404359269764*^9}, {3.524553556495103*^9, 
   3.524553606251944*^9}, {3.524553918507112*^9, 3.5245539506721*^9}, {
   3.525850588866333*^9, 3.525850590761015*^9}, {3.525850874608904*^9, 
   3.52585088449899*^9}, {3.525850951689707*^9, 3.525850953593128*^9}, {
   3.526018821964699*^9, 3.526018825526871*^9}, {3.529061426773059*^9, 
   3.529061432864193*^9}, {3.531769959557863*^9, 3.531769961986011*^9}, {
   3.531813417393294*^9, 3.531813426256126*^9}, {3.532112898613368*^9, 
   3.532112901190764*^9}, {3.591254623425433*^9, 3.591254674241444*^9}, {
   3.591254782320562*^9, 3.591254807306346*^9}, {3.591255456850945*^9, 
   3.591255467228277*^9}, {3.59253752077489*^9, 3.592537526295137*^9}, {
   3.593443320155177*^9, 3.593443320604072*^9}, {3.6240280850117617`*^9, 
   3.6240280882261267`*^9}, {3.62402812107955*^9, 3.624028237540576*^9}, {
   3.624028271040254*^9, 3.6240283051777687`*^9}, {3.6240283471418543`*^9, 
   3.624028446581362*^9}, {3.624028481492853*^9, 3.624028507960659*^9}}],

Cell[TextData[{
 StyleBox["- Mortality selection parameters",
  FontWeight->"Bold"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["c", "1"], ",", 
    SubscriptBox["c", "2"]}], TraditionalForm]]],
 ": mortality parameters for maladapted individuals (mortality for adapted \
individuals = 1)\nFor examp"
}], "Text",
 CellChangeTimes->{{3.592537851082424*^9, 3.592537857386005*^9}, {
  3.59253793334632*^9, 3.592537965257461*^9}, {3.593443533412225*^9, 
  3.5934435640436087`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dx", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"1", "-", "c1"}]], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"1", "-", "c2"}]], ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"1", "-", "c3"}]], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"1", "-", "c4"}]], ",", "1"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "[", 
   RowBox[{"es_", ",", "state_", ",", "age_"}], "]"}], ":=", 
  RowBox[{"dx", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"age", "+", "1"}], ",", "es", ",", 
     RowBox[{"1", "+", "state"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5001332396173964`*^9, 3.500133281520371*^9}, {
   3.500136200146578*^9, 3.500136210329666*^9}, {3.50019263291833*^9, 
   3.500192634364931*^9}, {3.501930681155058*^9, 3.501930688304488*^9}, {
   3.529063162916232*^9, 3.529063180835222*^9}, {3.531745922364476*^9, 
   3.531745923930574*^9}, {3.531753845404137*^9, 3.531753847069844*^9}, 
   3.592537868033029*^9, {3.624027670912199*^9, 3.624027672199456*^9}, {
   3.624027776542458*^9, 3.624027777806684*^9}, {3.624027817031006*^9, 
   3.624027909607691*^9}, {3.624027945293303*^9, 3.624027949438402*^9}}],

Cell[TextData[{
 StyleBox["- Fecundity selection,",
  FontWeight->"Bold"],
 "\n(will be considered in a follow-up paper, Kuijper & Johnstone, in \
preparation). In the current paper ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "1"], "=", 
    RowBox[{
     SubscriptBox["q", "2"], "=", "0"}]}], TraditionalForm]]],
 " (i.e., no fecundity selection)"
}], "Text",
 CellChangeTimes->{{3.592537996952724*^9, 3.592538031208852*^9}, 
   3.5925381100882196`*^9, {3.592542916506803*^9, 3.59254293150633*^9}, {
   3.593443695890839*^9, 3.5934437229465857`*^9}, {3.6240276653933*^9, 
   3.6240276679135942`*^9}, 3.624027773542657*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gx", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         FractionBox["1", 
          RowBox[{"1", "-", "q1"}]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         FractionBox["1", 
          RowBox[{"1", "-", "q2"}]]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         FractionBox["1", 
          RowBox[{"1", "-", "q1"}]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         FractionBox["1", 
          RowBox[{"1", "-", "q2"}]]}], "}"}]}], "}"}]}], "}"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "[", 
   RowBox[{"es_", ",", "state_", ",", "age_"}], "]"}], ":=", 
  RowBox[{"gx", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"age", "+", "1"}], ",", "es", ",", 
     RowBox[{"1", "+", "state"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.5001362469952993`*^9, {3.5001363089459*^9, 3.500136374034523*^9}, {
   3.500137044277297*^9, 3.500137056632866*^9}, {3.500192628905581*^9, 
   3.50019263010264*^9}, {3.515223772880254*^9, 3.515223784680871*^9}, 
   3.515223924473187*^9, {3.515224082129158*^9, 3.515224083857226*^9}, {
   3.515657870386673*^9, 3.515657873587348*^9}, {3.522140274375248*^9, 
   3.522140279087269*^9}, {3.522140310086524*^9, 3.522140341051928*^9}, {
   3.522578386308506*^9, 3.522578410393209*^9}, {3.526018481416929*^9, 
   3.526018487167841*^9}, {3.526018802116892*^9, 3.526018803063705*^9}, {
   3.52664437543906*^9, 3.526644382349394*^9}, {3.529063122319402*^9, 
   3.529063155149573*^9}, {3.53175382627929*^9, 3.531753836680533*^9}, {
   3.532110552853554*^9, 3.532110558952022*^9}, {3.591583551770855*^9, 
   3.591583556601612*^9}, {3.592537975488604*^9, 3.592537995359036*^9}, {
   3.592538034198379*^9, 3.592538044079611*^9}, {3.592538094340519*^9, 
   3.592538105045054*^9}, {3.592542908180541*^9, 3.592542912944188*^9}, {
   3.6240950822297*^9, 3.624095100838315*^9}}],

Cell[TextData[StyleBox["- Number of breeders per patch",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.593443728066662*^9, 3.5934437360340567`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"n", "=", "2"}]], "Input",
 CellChangeTimes->{{3.6240951692045107`*^9, 3.624095170528673*^9}, {
  3.624280986194656*^9, 3.624280986660377*^9}}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.6240953313148327`*^9, 3.624100989177085*^9, 
  3.6241174114769487`*^9, 3.62420398088582*^9, 3.624280933724107*^9, 
  3.624280989717226*^9, 3.624282706912945*^9, 3.624301572009207*^9, 
  3.624346228161007*^9, 3.624365908606504*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Patch frequencies", "Section"]], "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"localad", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["a1", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["a2", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["m1", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"n", "-", "a2", "-", "a1", "-", "m1"}], "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], 
     ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localmad", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["a1", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["a2", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["m1", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"n", "-", "a2", "-", "a1", "-", "m1"}], "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.500120873674243*^9, 3.5001210355847692`*^9}, {
   3.500121143974712*^9, 3.5001211891721582`*^9}, {3.5001254507449503`*^9, 
   3.5001254895331507`*^9}, {3.5001255395065823`*^9, 3.50012556780807*^9}, {
   3.50012559895665*^9, 3.500125609305683*^9}, 3.500125734437594*^9, {
   3.500125795420335*^9, 3.500125838193928*^9}, {3.5001260925815897`*^9, 
   3.50012619653481*^9}, {3.500126318936735*^9, 3.500126490780538*^9}, {
   3.500126522241294*^9, 3.500126614249658*^9}, {3.5001266560703173`*^9, 
   3.500126692145039*^9}, {3.50012679804455*^9, 3.500126865625854*^9}, {
   3.5001269598438177`*^9, 3.500127010728797*^9}, {3.500127066746924*^9, 
   3.500127075242776*^9}, 3.500127168349073*^9, {3.500127799012751*^9, 
   3.50012794447775*^9}, {3.500127989244396*^9, 3.500128053011385*^9}, {
   3.500128120681616*^9, 3.5001281869125023`*^9}, {3.500128273678108*^9, 
   3.500128282830265*^9}, {3.500128331005128*^9, 3.500128412672514*^9}, {
   3.500128485970336*^9, 3.5001285037885857`*^9}, {3.500128604416666*^9, 
   3.500128654695407*^9}, {3.500128793134313*^9, 3.500128821190743*^9}, {
   3.500128924224536*^9, 3.500128962612554*^9}, {3.500129044296741*^9, 
   3.500129059197551*^9}, {3.500189795589278*^9, 3.500189809037795*^9}, {
   3.500191120480218*^9, 3.500191135144388*^9}, {3.500192700247055*^9, 
   3.5001927267342463`*^9}, {3.5007274959643087`*^9, 
   3.5007274971650257`*^9}, {3.500727569917247*^9, 3.5007275729396*^9}, {
   3.500728699556571*^9, 3.500728740477393*^9}, {3.500728835717046*^9, 
   3.500728850269268*^9}, {3.5007290429903793`*^9, 3.50072910127816*^9}, {
   3.5007291775293827`*^9, 3.5007291977631283`*^9}, {3.500732760953953*^9, 
   3.5007327631378593`*^9}, {3.5007330148648577`*^9, 3.500733037851882*^9}, {
   3.5018653388124866`*^9, 3.501865368880773*^9}, {3.502634529232007*^9, 
   3.502634563110133*^9}, {3.5026347197756767`*^9, 3.5026348117526073`*^9}, {
   3.502634899986861*^9, 3.5026349004268627`*^9}, {3.503042079156918*^9, 
   3.50304208574548*^9}, {3.503042184532455*^9, 3.503042189260453*^9}, {
   3.505128467356586*^9, 3.505128474487809*^9}, {3.505128506618724*^9, 
   3.505128554696378*^9}, {3.505815927928623*^9, 3.505815929681814*^9}, {
   3.507037958421404*^9, 3.507038012491966*^9}, {3.507218416099026*^9, 
   3.507218426680966*^9}, {3.507218486766817*^9, 3.507218528077397*^9}, 
   3.592538400160944*^9, 3.592538470702742*^9, 3.592538512268461*^9, {
   3.592538604446601*^9, 3.592538607212532*^9}, {3.592543613859783*^9, 
   3.592543624398034*^9}, {3.62409267422051*^9, 3.6240926975096073`*^9}, {
   3.62409274038883*^9, 3.624092856324395*^9}}],

Cell[TextData[{
 StyleBox["- Migrant juveniles arriving in an environment to which they are \
adapted (dispad) or maladapted (dispmad)\n",
  FontWeight->"Bold"],
 StyleBox["k",
  FontSlant->"Italic"],
 ": cost of dispersal. Calculations below are  derived in the same fashion as \
calculations involving philopatric juveniles. See also in-line comments"
}], "Text",
 CellChangeTimes->{{3.592538529147274*^9, 3.5925385842660847`*^9}, {
  3.593443761786683*^9, 3.593443844378488*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dispad", "[", "es_", "]"}], ":=", 
   RowBox[{"(*", " ", 
    RowBox[{
    "probability", " ", "that", " ", "a", " ", "migrant", " ", "migrates", 
     " ", "into", " ", "environment", " ", "es", " ", "where", " ", "it", " ",
      "is", " ", "adapted"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "k"}], ")"}], "*", 
     RowBox[{"Sum", "[", 
      RowBox[{"(*", " ", 
       RowBox[{"sum", " ", "over", " ", "environments"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{"(*", " ", 
         RowBox[{
         "sum", " ", "over", " ", "number", " ", "of", " ", "adapted", " ", 
          "breeders"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"es", "\[Equal]", "esSum"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"esSum", ",", "a1", ",", "m1", ",", "a2", ",", 
              RowBox[{"n", "-", "a1", "-", "m1", "-", "a2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["a1", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "1", ",", "0"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["m1", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["a2", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "1", ",", "1"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"n", "-", "a2", "-", "a1", "-", "m1"}], "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}]}]}], ")"}]}], 
           ",", 
           RowBox[{"(*", " ", 
            RowBox[{"environment", " ", "same", " ", "as", " ", "target"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"esSum", ",", "a1", ",", "m1", ",", "a2", ",", 
              RowBox[{"n", "-", "a1", "-", "m1", "-", "a2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["a1", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["m1", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "0", ",", "0"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["a2", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"n", "-", "a2", "-", "a1", "-", "m1"}], "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "0", ",", "1"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}]}]}], ")"}]}]}], 
          " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "environment", " ", "different", " ", "from", " ", "target"}], " ",
            "*)"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"{", 
          RowBox[{"a1", ",", "0", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m1", ",", "0", ",", 
           RowBox[{"n", "-", "a1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a2", ",", "0", ",", 
           RowBox[{"n", "-", "a1", "-", "m1"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"esSum", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dispmad", "[", "es_", "]"}], ":=", 
   RowBox[{"(*", " ", 
    RowBox[{
    "probability", " ", "that", " ", "a", " ", "migrant", " ", "migrates", 
     " ", "into", " ", "environment", " ", "es", " ", "where", " ", "it", " ",
      "is", " ", "maladapted"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "k"}], ")"}], "*", 
     RowBox[{"Sum", "[", 
      RowBox[{"(*", " ", 
       RowBox[{"sum", " ", "over", " ", "environments"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{"(*", " ", 
         RowBox[{
         "sum", " ", "over", " ", "number", " ", "of", " ", "adapted", " ", 
          "breeders"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"es", "\[Equal]", "esSum"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"esSum", ",", "a1", ",", "m1", ",", "a2", ",", 
              RowBox[{"n", "-", "a1", "-", "m1", "-", "a2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["a1", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["m1", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "0", ",", "0"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["a2", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"n", "-", "a2", "-", "a1", "-", "m1"}], "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "0", ",", "1"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}]}]}], ")"}]}], 
           " ", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"environment", " ", "same", " ", "as", " ", "target"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"esSum", ",", "a1", ",", "m1", ",", "a2", ",", 
              RowBox[{"n", "-", "a1", "-", "m1", "-", "a2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["a1", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "1", ",", "0"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["m1", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["a2", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "1", ",", "1"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"n", "-", "a2", "-", "a1", "-", "m1"}], "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}]}]}], ")"}]}]}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "environment", " ", "different", " ", "from", " ", "target"}], " ",
            "*)"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"{", 
          RowBox[{"a1", ",", "0", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m1", ",", "0", ",", 
           RowBox[{"n", "-", "a1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a2", ",", "0", ",", 
           RowBox[{"n", "-", "a1", "-", "m1"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"esSum", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.624092914352302*^9, 3.6240930822533493`*^9}, {
  3.6240931420025187`*^9, 3.624093225122897*^9}}],

Cell[TextData[StyleBox["- Total number of locally competing juveniles:",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.59253861564257*^9, 3.592538624986649*^9}, 
   3.592542341792898*^9, {3.59344384898559*^9, 3.59344384910559*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"localcomptotal", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"localad", "[", 
    RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
   RowBox[{"localmad", "[", 
    RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
   RowBox[{"dispad", "[", "es", "]"}], "+", 
   RowBox[{"dispmad", "[", "es", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.624093238440284*^9, 3.624093256143965*^9}, {
  3.6242810234661503`*^9, 3.624281024489506*^9}}],

Cell[TextData[{
 "ap[es,a]: Probability that any adapted juvenile will win competition over \
breeding spots in an environment of type ",
 StyleBox["es",
  FontSlant->"Italic"],
 " with ",
 StyleBox["a",
  FontSlant->"Italic"],
 " adapted adult breeders."
}], "Text",
 CellChangeTimes->{{3.5925423472402363`*^9, 3.592542367063136*^9}, {
  3.5934439214345818`*^9, 3.59344395112869*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ap", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_", ",", "m2_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{
    RowBox[{"localad", "[", 
     RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
    RowBox[{"dispad", "[", "es", "]"}]}], 
   RowBox[{"localcomptotal", "[", 
    RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}]]}]], "Input",
 CellChangeTimes->{{3.50011871566383*^9, 3.5001187192399063`*^9}, {
  3.500118749446988*^9, 3.5001187498715553`*^9}, {3.50011898132974*^9, 
  3.500119107117433*^9}, {3.500120259137155*^9, 3.5001202933416452`*^9}, {
  3.500120354606805*^9, 3.500120418327129*^9}, {3.500126699926446*^9, 
  3.500126706681553*^9}, {3.500126764548074*^9, 3.500126768982004*^9}, {
  3.500126872493771*^9, 3.500126901933896*^9}, {3.5001280981944838`*^9, 
  3.5001280987513313`*^9}, {3.507218430517244*^9, 3.507218462584997*^9}, {
  3.507218821963867*^9, 3.507218824172164*^9}, {3.624093269615767*^9, 
  3.6240932941936913`*^9}, {3.624281017342733*^9, 3.624281018309783*^9}}],

Cell[TextData[{
 StyleBox["- Differential equations for the patch frequencies\n",
  FontWeight->"Bold"],
 "Each event (switching, mortality of different types of breeders) is \
highlighted by an in-line comment. Table contains right hand side of \
differential equations:"
}], "Text",
 CellChangeTimes->{{3.592538865120399*^9, 3.592538880359948*^9}, {
  3.593443853610029*^9, 3.593443888705567*^9}, {3.5934439714013977`*^9, 
  3.593443992009426*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tablerecPlain", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m2", "=", 
         RowBox[{"n", "-", "a1", "-", "a2", "-", "m1"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"3", "-", "es"}], "]"}], " ", 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", "m1", ",", "a1", ",", "m2", ",", 
           "a2"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"s", "[", "es", "]"}], " ", 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", "m2"}], "]"}]}],
         " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "change", " ", "due", " ", "to", " ", "environmental", " ", 
          "switching"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"a1", "-", "1"}], "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{
            RowBox[{"m1", "+", "1"}], "\[LessEqual]", "n"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1", "-", "1"}], ",", 
             RowBox[{"m1", "+", "1"}], ",", "a2", ",", "m2"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1", "-", "1"}], ",", 
             RowBox[{"m1", "+", "1"}], ",", "a2", ",", "m2"}], "]"}]}], ",", 
          "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "maladapted", " ", "juvenile", " ", "breeder", " ", "dies"}], ",", 
          " ", 
          RowBox[{
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "juvenile", " ", 
            "breeder", " ", "on", " ", "a", " ", "m1"}], "+", "1"}], ",", 
          RowBox[{"a1", "-", 
           RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "-", 
        RowBox[{"m1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", "m2"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", "m2"}], "]"}]}],
         "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "maladapted", " ", "juvenile", " ", "breeder", " ", "dies"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "an", " ", "adapted", " ", "juvenile", 
           " ", "breeder", " ", "on", " ", "a", " ", "m1"}], ",", 
          RowBox[{"a1", " ", "patch"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"m1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"m2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "a1", ",", 
             RowBox[{"m1", "+", "1"}], ",", "a2", ",", 
             RowBox[{"m2", "-", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "maladapted", " ", "juvenile", " ", "breeder", " ", "survives", 
            " ", "to", " ", "become", " ", "a", " ", "maladapted", " ", 
            "adult", " ", "breeder", " ", "on", " ", "a", " ", "m1"}], "+", 
           "1"}], ",", 
          RowBox[{"m2", "-", 
           RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "-", 
        RowBox[{"m1", " ", 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", "m2"}], "]"}]}],
         "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "maladapted", " ", "juvenile", " ", "breeder", " ", "survives", " ",
            "to", " ", "become", " ", "a", " ", "maladapted", " ", "adult", 
           " ", "breeder", " ", "on", " ", "a", " ", "m1"}], ",", 
          RowBox[{"m2", " ", "patch"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"a1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"m1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"a1", "+", "1"}], ",", 
               RowBox[{"m1", "-", "1"}], ",", "a2", ",", "m2"}], "]"}]}], 
            ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1", "+", "1"}], ",", 
             RowBox[{"m1", "-", "1"}], ",", "a2", ",", "m2"}], "]"}]}], ",", 
          "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "adapted", " ", "juvenile", " ", "breeder", " ", "dies", " ", 
            "and", " ", "is", " ", "replaced", " ", "by", " ", "a", " ", 
            "maladapted", " ", "breeder", " ", "on", " ", "a", " ", "a1"}], 
           "+", "1"}], ",", 
          RowBox[{"m1", "-", 
           RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "-", 
        RowBox[{"a1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", "m2"}], 
            "]"}]}], ")"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", "m2"}], "]"}]}],
         "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "adapted", " ", "juvenile", " ", "breeder", " ", "dies", " ", "and",
            " ", "is", " ", "replaced", " ", "by", " ", "a", " ", 
           "maladapted", " ", "breeder", " ", "on", " ", "a", " ", "a1"}], 
          ",", 
          RowBox[{"m1", " ", "patch"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"a1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"a2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1", "+", "1"}], ",", "m1", ",", 
             RowBox[{"a2", "-", "1"}], ",", "m2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "adapted", " ", "juvenile", " ", "breeder", " ", "survives", " ", 
            "and", " ", "becomes", " ", "an", " ", "adapted", " ", "adult", 
            " ", "breeder", " ", "on", " ", "a", " ", "a1"}], "+", "1"}], ",", 
          RowBox[{"a2", "-", 
           RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "-", 
        RowBox[{"a1", " ", 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", "m2"}], "]"}]}],
         "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "adapted", " ", "juvenile", " ", "breeder", " ", "survives", " ", 
           "and", " ", "becomes", " ", "an", " ", "adapted", " ", "adult", 
           " ", "breeder", " ", "on", " ", "a", " ", "a1"}], ",", 
          RowBox[{"a2", " ", "patch"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"m2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"a1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1", "-", "1"}], ",", "m1", ",", "a2", ",", 
             RowBox[{"m2", "+", "1"}]}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1", "-", "1"}], ",", "m1", ",", "a2", ",", 
             RowBox[{"m2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "maladapted", " ", "adult", " ", "breeder", " ", "dies", " ", 
            "and", " ", "is", " ", "replaced", " ", "by", " ", "an", " ", 
            "adapted", " ", "juvenile", " ", "breeder", " ", "on", " ", "a", 
            " ", "a1"}], "-", "1"}], ",", 
          RowBox[{"m2", "+", 
           RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"m2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"m1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "a1", ",", 
               RowBox[{"m1", "-", "1"}], ",", "a2", ",", 
               RowBox[{"m2", "+", "1"}]}], "]"}]}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "a1", ",", 
             RowBox[{"m1", "-", "1"}], ",", "a2", ",", 
             RowBox[{"m2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "maladapted", " ", "adult", " ", "breeder", " ", "dies", " ", 
            "and", " ", "is", " ", "replaced", " ", "by", " ", "a", " ", 
            "maladapted", " ", "juvenile", " ", "breeder", " ", "on", " ", 
            "a", " ", "m1"}], "-", "1"}], ",", 
          RowBox[{"m2", "+", 
           RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "-", 
        RowBox[{"m2", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", "m2"}], "]"}]}],
         "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "maladapted", " ", "adult", " ", "breeder", " ", "dies", " ", "and",
            " ", "is", " ", "replaced", " ", "by", " ", "a", " ", "juvenile", 
           " ", "breeder", " ", "on", " ", "a", " ", "a1"}], ",", "m1", ",", 
          RowBox[{"m2", " ", "patch"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"a2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"a1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1", "-", "1"}], ",", "m1", ",", 
             RowBox[{"a2", "+", "1"}], ",", "m2"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1", "-", "1"}], ",", "m1", ",", 
             RowBox[{"a2", "+", "1"}], ",", "m2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "adapted", " ", "adult", " ", "breeder", " ", "dies", " ", "and", 
            " ", "is", " ", "replaced", " ", "by", " ", "an", " ", "adapted", 
            " ", "juvenile", " ", "breeder", " ", "on", " ", "a", " ", "a1"}],
            "-", "1"}], ",", 
          RowBox[{"a2", "+", 
           RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"a2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"m1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "a1", ",", 
               RowBox[{"m1", "-", "1"}], ",", 
               RowBox[{"a2", "+", "1"}], ",", "m2"}], "]"}]}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "a1", ",", 
             RowBox[{"m1", "-", "1"}], ",", 
             RowBox[{"a2", "+", "1"}], ",", "m2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "adapted", " ", "adult", " ", "breeder", " ", "dies", " ", "and", 
            " ", "is", " ", "replaced", " ", "by", " ", "a", " ", 
            "maladapted", " ", "juvenile", " ", "breeder", " ", "on", " ", 
            "a", " ", "m1"}], "-", "1"}], ",", 
          RowBox[{"a2", "+", 
           RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "-", 
        RowBox[{"a2", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", "m2"}], 
          "]"}]}]}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "adapted", " ", "adult", " ", "breeder", " ", "dies", " ", "and", " ",
          "is", " ", "replaced", " ", "by", " ", "a", " ", "juvenile", " ", 
         "breeder", " ", "on", " ", "a", " ", "a1"}], ",", "m1", ",", 
        RowBox[{"a2", " ", "patch"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", "0", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m1", ",", "0", ",", 
       RowBox[{"n", "-", "a1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2", ",", "0", ",", 
       RowBox[{"n", "-", "a1", "-", "m1"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.497725665398181*^9, 3.49772567455873*^9}, {
   3.500117613263631*^9, 3.500117643761853*^9}, {3.5001177516223183`*^9, 
   3.500117752501072*^9}, {3.500117857030566*^9, 3.5001178583488903`*^9}, {
   3.500118014156376*^9, 3.500118014555167*^9}, {3.500130682127385*^9, 
   3.500130682910915*^9}, {3.500130968751739*^9, 3.500130981782063*^9}, {
   3.5001310118326597`*^9, 3.5001310308665447`*^9}, {3.500132758531279*^9, 
   3.500132775509473*^9}, {3.500132946361661*^9, 3.5001329748220167`*^9}, {
   3.500133041546383*^9, 3.5001330657380753`*^9}, {3.500133148259763*^9, 
   3.500133160687606*^9}, {3.5001331990639763`*^9, 3.5001332041244717`*^9}, {
   3.500133307447483*^9, 3.5001333237167377`*^9}, {3.5001333725271587`*^9, 
   3.500133372617695*^9}, {3.500133404973748*^9, 3.50013341486411*^9}, {
   3.500133481452409*^9, 3.500133576453206*^9}, {3.500133771813458*^9, 
   3.500133812116024*^9}, 3.5001338580403643`*^9, {3.500137409431617*^9, 
   3.500137429291832*^9}, {3.500192977665819*^9, 3.500192977715926*^9}, {
   3.500732820820187*^9, 3.500732826027463*^9}, {3.5007330519650593`*^9, 
   3.500733052006358*^9}, {3.501861096205023*^9, 3.501861098564929*^9}, {
   3.5018611968794737`*^9, 3.501861214539522*^9}, {3.503234220521749*^9, 
   3.5032342488826036`*^9}, {3.520244802903954*^9, 3.520244815359407*^9}, {
   3.59253889449739*^9, 3.592538895255055*^9}, {3.592542374414714*^9, 
   3.592542378840889*^9}, {3.624093325141708*^9, 3.624093774057206*^9}, {
   3.624093861127411*^9, 3.624093928395637*^9}, {3.62409396215143*^9, 
   3.624093981781871*^9}, {3.624094016820443*^9, 3.6240942573261003`*^9}, {
   3.624094361056925*^9, 3.624094451925911*^9}, {3.62409469792808*^9, 
   3.6240947216628523`*^9}, {3.624094768681231*^9, 3.62409487167994*^9}, {
   3.624094966722213*^9, 3.6240950695613537`*^9}, {3.6241009450660887`*^9, 
   3.624100974581635*^9}}],

Cell["Table specification for numerical solving:", "Text",
 CellChangeTimes->{{3.593443894024782*^9, 3.593443905705183*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "tablerec", "]"}]], "Input",
 CellChangeTimes->{{3.62428151423694*^9, 3.624281516965394*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.624281517318358*^9, 3.624282707972188*^9, 
  3.624301598489459*^9, 3.6243462284685707`*^9, 3.62436591251108*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"tablerec", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"H", "\[Equal]", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"H", ",", 
        RowBox[{"Flatten", "[", "tablerecPlain", "]"}]}], "}"}]}], "]"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5032342341741734`*^9, 3.503234266926181*^9}, {
  3.503247680722105*^9, 3.503247687323996*^9}, {3.503247759915304*^9, 
  3.503247762951304*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tablerec", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.624096486441481*^9, 3.6240964885424433`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"fx", "[", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}]}], 
     RowBox[{"1", "-", "c3"}]]}], "-", 
   RowBox[{"s1", " ", 
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}]}], "+", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], "+", 
   RowBox[{"s2", " ", 
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}]}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{3.624096488894251*^9, 3.6241009963901567`*^9, 
  3.6241174190801*^9, 3.624203988186748*^9, 3.62428094075799*^9, 
  3.6242810325490837`*^9, 3.624282708016877*^9, 3.624301598679536*^9, 
  3.624346228514627*^9, 3.624365912576889*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ftab", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m2", "=", 
         RowBox[{"n", "-", "a1", "-", "m1", "-", "a2"}]}], "}"}], ",", 
       RowBox[{"f", "[", 
        RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", "m2"}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", "0", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m1", ",", "0", ",", 
       RowBox[{"n", "-", "a1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2", ",", "0", ",", 
       RowBox[{"n", "-", "a1", "-", "m1"}]}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.624095309280492*^9, 3.6240953230676394`*^9}, {
  3.624095370514904*^9, 3.624095373547062*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.624095323576385*^9, {3.624095367978516*^9, 3.624095375418024*^9}, 
   3.624095639816987*^9, 3.624100996440538*^9, 3.624117419119975*^9, 
   3.624203988253417*^9, 3.624280940795124*^9, 3.624281032697885*^9, 
   3.624282708057701*^9, 3.624301598761321*^9, 3.624346228562113*^9, 
   3.624365912634502*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"feqtab", "=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "tablerec", "]"}], ",", 
     RowBox[{
      RowBox[{"Total", "[", "ftab", "]"}], "\[Equal]", "1"}], ",", "1"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"feqtabalt", "=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "tablerec", "]"}], ",", 
     RowBox[{
      RowBox[{"Total", "[", "ftab", "]"}], "\[Equal]", "1"}], ",", "5"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.500137431453726*^9, 3.500137463701515*^9}, {
  3.590817338397416*^9, 3.590817338508321*^9}, {3.624095219684259*^9, 
  3.624095253596705*^9}, {3.6240952841351213`*^9, 3.6240953070375147`*^9}, {
  3.6240953865240593`*^9, 3.624095404243273*^9}, {3.6240959635961742`*^9, 
  3.624095963788168*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"feqtabPlain", "=", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", "tablerecPlain", "]"}], ",", 
      RowBox[{
       RowBox[{"Total", "[", "ftab", "]"}], "-", "1"}], ",", "1"}], "]"}]}], 
   ";"}], " "}]], "Input",
 CellChangeTimes->{{3.503234279738905*^9, 3.5032343436360292`*^9}, {
  3.51938949377985*^9, 3.519389511821157*^9}, {3.519389622676245*^9, 
  3.519389655947711*^9}, {3.520253572315612*^9, 3.520253574751763*^9}, {
  3.6240955235582857`*^9, 3.624095526070043*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"frootstartvals", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xi", ",", 
      RowBox[{"1", "/", 
       RowBox[{"Length", "[", "ftab", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"xi", ",", "ftab"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.501861533592969*^9, 3.501861653264894*^9}, {
  3.5018617247356167`*^9, 3.501861876017569*^9}, {3.501861977500671*^9, 
  3.501862034852276*^9}, {3.501862081796956*^9, 3.5018620886297607`*^9}, {
  3.624095532349883*^9, 3.624095560878952*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.62409556159268*^9, 3.624095639874612*^9, 
  3.624095967388462*^9, 3.624100996529471*^9, 3.624117419214882*^9, 
  3.624203988363365*^9, 3.6242809408396673`*^9, 3.624281032802898*^9, 
  3.624282708111437*^9, 3.6243015988579197`*^9, 3.6243462286169767`*^9, 
  3.624365912705229*^9}]
}, Open  ]],

Cell[TextData[StyleBox["- Numerically solve for the equilibrium patch \
frequencies",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.592543108024868*^9, 3.592543126136325*^9}, {
  3.593443910410306*^9, 3.593443910521289*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans1test", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "m_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p10s_", ",", "p11s_", ",", "p20s_", ",", "p21s_"}], "}"}], ",", 
    "ks_", ",", "Qs_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"feqtab", "/.", 
   RowBox[{"Join", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
      RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
      RowBox[{"k", "\[Rule]", "ks"}], ",", 
      RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
      RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
      RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
      RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
      RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
      RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
      RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
      RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
      RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
      RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
      RowBox[{"p21", "\[Rule]", "p21s"}], ",", 
      RowBox[{"mt", "\[Rule]", "m"}]}], "}"}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.497727309947049*^9, {3.4977274499343033`*^9, 3.4977274554810753`*^9}, {
   3.497727542910244*^9, 3.497727564845056*^9}, 3.497731404139268*^9, {
   3.500136022461656*^9, 3.5001360651617203`*^9}, {3.500136107964839*^9, 
   3.5001361178544693`*^9}, {3.500136168298623*^9, 3.500136171192801*^9}, {
   3.500136226922933*^9, 3.500136236150736*^9}, {3.500136382914144*^9, 
   3.5001363834540253`*^9}, 3.5001365520437107`*^9, {3.5001366530355577`*^9, 
   3.500136672281103*^9}, {3.500136703690104*^9, 3.5001367436671047`*^9}, {
   3.500137064431172*^9, 3.500137084372213*^9}, {3.500137506604393*^9, 
   3.500137521481576*^9}, {3.500137577253257*^9, 3.500137620562414*^9}, {
   3.500138253541423*^9, 3.500138292548037*^9}, {3.5001383371273537`*^9, 
   3.5001383946806183`*^9}, {3.5001385957662697`*^9, 3.50013875313482*^9}, {
   3.500139018540197*^9, 3.500139046280306*^9}, {3.501862116832633*^9, 
   3.5018621477327423`*^9}, {3.505129786476176*^9, 3.50512979545977*^9}, {
   3.505130396736271*^9, 3.505130403469315*^9}, {3.505133566876094*^9, 
   3.5051337047295*^9}, {3.505133939247291*^9, 3.505133966224418*^9}, {
   3.505134048274804*^9, 3.505134112717098*^9}, {3.505134277245621*^9, 
   3.505134289377655*^9}, {3.505134391490318*^9, 3.505134403065894*^9}, {
   3.508161024692579*^9, 3.508161040735461*^9}, {3.520242615818755*^9, 
   3.520242618482863*^9}, {3.520242802887409*^9, 3.520242810353731*^9}, {
   3.52455396640682*^9, 3.524553988441077*^9}, {3.592542961010631*^9, 
   3.5925429876260843`*^9}, 3.592543052726901*^9, {3.592543085831949*^9, 
   3.59254308655621*^9}, {3.6240955654269857`*^9, 3.6240956285476837`*^9}, {
   3.624095666433518*^9, 3.624095672818058*^9}, {3.6240957736684*^9, 
   3.624095811862276*^9}, {3.624095842065344*^9, 3.624095864456068*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans1", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "m_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p10s_", ",", "p11s_", ",", "p20s_", ",", "p21s_"}], "}"}], ",", 
    "ks_", ",", "Qs_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{"feqtab", "/.", 
     RowBox[{"Join", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
        RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
        RowBox[{"k", "\[Rule]", "ks"}], ",", 
        RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
        RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
        RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
        RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
        RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
        RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
        RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
        RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
        RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
        RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
        RowBox[{"p21", "\[Rule]", "p21s"}], ",", 
        RowBox[{"mt", "\[Rule]", "m"}]}], "}"}], "]"}]}], ",", 
    "frootstartvals"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.497727309947049*^9, {3.4977274499343033`*^9, 3.4977274554810753`*^9}, {
   3.497727542910244*^9, 3.497727564845056*^9}, 3.497731404139268*^9, {
   3.500136022461656*^9, 3.5001360651617203`*^9}, {3.500136107964839*^9, 
   3.5001361178544693`*^9}, {3.500136168298623*^9, 3.500136171192801*^9}, {
   3.500136226922933*^9, 3.500136236150736*^9}, {3.500136382914144*^9, 
   3.5001363834540253`*^9}, 3.5001365520437107`*^9, {3.5001366530355577`*^9, 
   3.500136672281103*^9}, {3.500136703690104*^9, 3.5001367436671047`*^9}, {
   3.500137064431172*^9, 3.500137084372213*^9}, {3.500137506604393*^9, 
   3.500137521481576*^9}, {3.500137577253257*^9, 3.500137620562414*^9}, {
   3.500138253541423*^9, 3.500138292548037*^9}, {3.5001383371273537`*^9, 
   3.5001383946806183`*^9}, {3.5001385957662697`*^9, 3.50013875313482*^9}, {
   3.500139018540197*^9, 3.500139046280306*^9}, {3.501862116832633*^9, 
   3.5018621477327423`*^9}, {3.505129786476176*^9, 3.50512979545977*^9}, {
   3.505130396736271*^9, 3.505130403469315*^9}, {3.505133566876094*^9, 
   3.5051337047295*^9}, {3.505133939247291*^9, 3.505133966224418*^9}, {
   3.505134048274804*^9, 3.505134112717098*^9}, {3.505134277245621*^9, 
   3.505134289377655*^9}, {3.505134391490318*^9, 3.505134403065894*^9}, {
   3.508161024692579*^9, 3.508161040735461*^9}, {3.520242615818755*^9, 
   3.520242618482863*^9}, {3.520242802887409*^9, 3.520242810353731*^9}, {
   3.52455396640682*^9, 3.524553988441077*^9}, {3.592542961010631*^9, 
   3.5925429876260843`*^9}, 3.592543052726901*^9, {3.592543085831949*^9, 
   3.59254308655621*^9}, {3.6240955654269857`*^9, 3.6240956285476837`*^9}, {
   3.624095666433518*^9, 3.624095672818058*^9}, {3.6240957736684*^9, 
   3.624095811862276*^9}, {3.624095842065344*^9, 3.624095919188507*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans1alt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "m_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p10s_", ",", "p11s_", ",", "p20s_", ",", "p21s_"}], "}"}], ",", 
    "ks_", ",", "Qs_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{"feqtabalt", "/.", 
     RowBox[{"Join", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
        RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
        RowBox[{"k", "\[Rule]", "ks"}], ",", 
        RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
        RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
        RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
        RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
        RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
        RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
        RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
        RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
        RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
        RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
        RowBox[{"p21", "\[Rule]", "p21s"}], ",", 
        RowBox[{"mt", "\[Rule]", "m"}]}], "}"}], "]"}]}], ",", 
    "frootstartvals"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.497727309947049*^9, {3.4977274499343033`*^9, 3.4977274554810753`*^9}, {
   3.497727542910244*^9, 3.497727564845056*^9}, 3.497731404139268*^9, {
   3.500136022461656*^9, 3.5001360651617203`*^9}, {3.500136107964839*^9, 
   3.5001361178544693`*^9}, {3.500136168298623*^9, 3.500136171192801*^9}, {
   3.500136226922933*^9, 3.500136236150736*^9}, {3.500136382914144*^9, 
   3.5001363834540253`*^9}, 3.5001365520437107`*^9, {3.5001366530355577`*^9, 
   3.500136672281103*^9}, {3.500136703690104*^9, 3.5001367436671047`*^9}, {
   3.500137064431172*^9, 3.500137084372213*^9}, {3.500137506604393*^9, 
   3.500137521481576*^9}, {3.500137577253257*^9, 3.500137620562414*^9}, {
   3.500138253541423*^9, 3.500138292548037*^9}, {3.5001383371273537`*^9, 
   3.5001383946806183`*^9}, {3.5001385957662697`*^9, 3.50013875313482*^9}, {
   3.500139018540197*^9, 3.500139046280306*^9}, {3.501862116832633*^9, 
   3.5018621477327423`*^9}, {3.505129786476176*^9, 3.50512979545977*^9}, {
   3.505130396736271*^9, 3.505130403469315*^9}, {3.505133566876094*^9, 
   3.5051337047295*^9}, {3.505133939247291*^9, 3.505133966224418*^9}, {
   3.505134048274804*^9, 3.505134112717098*^9}, {3.505134277245621*^9, 
   3.505134289377655*^9}, {3.505134391490318*^9, 3.505134403065894*^9}, {
   3.508161024692579*^9, 3.508161040735461*^9}, {3.520242615818755*^9, 
   3.520242618482863*^9}, {3.520242802887409*^9, 3.520242810353731*^9}, {
   3.52455396640682*^9, 3.524553988441077*^9}, {3.592542961010631*^9, 
   3.5925429876260843`*^9}, 3.592543052726901*^9, {3.592543085831949*^9, 
   3.59254308655621*^9}, {3.6240955654269857`*^9, 3.6240956285476837`*^9}, {
   3.624095666433518*^9, 3.624095672818058*^9}, {3.6240957736684*^9, 
   3.624095811862276*^9}, {3.624095842065344*^9, 3.624095942512992*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ans1", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", ".3", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3", ",", "0.5", ",", "0.3", ",", "0.5"}], "}"}], ",", "0.1", 
   ",", "0.005"}], "]"}]], "Input",
 CellChangeTimes->{{3.624095984739854*^9, 3.624095985051387*^9}, {
  3.624096638144051*^9, 3.6240966562437162`*^9}, {3.624096830494413*^9, 
  3.624096831473947*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.019470724310211428`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.03865384500358826`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", 
    "0.02630022490078703`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.0615933084584788`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.06459101211514764`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "0.05504496129522279`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.05336069476279887`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.061689006392650195`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.08546577364552174`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.03383044911559312`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.008123111718634744`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.034673501269224756`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", 
    "0.05204990187494546`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.023403890283462833`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.06010375305588322`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "0.015612814783130402`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.04192657888460931`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.12038939253225793`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.06712505512432902`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.07659200047352227`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6240959861558*^9, {3.624096639124889*^9, 3.624096664598081*^9}, 
   3.624096838859268*^9, 3.624100996622394*^9, 3.6241174193201027`*^9, 
   3.6242039885309*^9, 3.624280941037951*^9, 3.624281033245626*^9, 
   3.624282708630476*^9, 3.624301599356181*^9, 3.624346229067992*^9, 
   3.6243659131644707`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ans1alt", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", ".3", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3", ",", "0.5", ",", "0.3", ",", "0.5"}], "}"}], ",", "0.1", 
   ",", "0.005"}], "]"}]], "Input",
 CellChangeTimes->{{3.508161640641067*^9, 3.508161641073309*^9}, {
  3.508161752322453*^9, 3.508161765951121*^9}, {3.508161799901812*^9, 
  3.508161800462989*^9}, {3.514211189150174*^9, 3.514211207453239*^9}, {
  3.524554160262734*^9, 3.524554164750863*^9}, {3.5908173106268053`*^9, 
  3.5908173275139637`*^9}, {3.590823477424436*^9, 3.5908235383263607`*^9}, {
  3.590823850204959*^9, 3.590823871661927*^9}, {3.59125483045569*^9, 
  3.591254834448448*^9}, {3.592543063033259*^9, 3.59254307403925*^9}, {
  3.608820230181753*^9, 3.60882023041466*^9}, {3.624095651263062*^9, 
  3.6240956577109537`*^9}, {3.624095946094096*^9, 3.62409594636499*^9}, {
  3.624096635840129*^9, 3.6240966596693163`*^9}, {3.62409683516304*^9, 
  3.624096836064969*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.019470724310211455`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.03865384500358827`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", 
    "0.026300224900787032`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.06159330845847883`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.06459101211514767`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "0.0550449612952228`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.05336069476279888`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.0616890063926502`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.08546577364552174`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.03383044911559311`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.008123111718634744`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.034673501269224756`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", 
    "0.052049901874945445`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.023403890283462833`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.060103753055883204`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "0.0156128147831304`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.0419265788846093`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.12038939253225789`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.06712505512432902`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.07659200047352226`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.608820225915379*^9, 3.608820234124021*^9}, 
   3.608820321494277*^9, 3.6088205280135927`*^9, {3.6240956399335833`*^9, 
   3.624095674839657*^9}, 3.624095742683869*^9, 3.624095775474194*^9, 
   3.624095946918483*^9, 3.624095988252405*^9, {3.6240966408610353`*^9, 
   3.624096660262941*^9}, 3.624096836587844*^9, 3.6241009966932087`*^9, 
   3.624117419385565*^9, 3.624203988615159*^9, 3.62428094110515*^9, 
   3.624281033590795*^9, 3.624282709152506*^9, 3.624301599839867*^9, 
   3.62434622954918*^9, 3.624365913484585*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Reproductive values", "Section"],

Cell[TextData[{
 StyleBox["- Table of the reproductive values:",
  FontWeight->"Bold"],
 " ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["v", "ijk"], TraditionalForm]]],
 ":\nreproductive value in environment ",
 StyleBox["i",
  FontSlant->"Italic"],
 ", with focal individual being either locally maladapted  ",
 StyleBox["j",
  FontSlant->"Italic"],
 "=0 or adapted (",
 StyleBox["j",
  FontSlant->"Italic"],
 "=1) in the presence of ",
 StyleBox["k",
  FontSlant->"Italic"],
 " adapted (and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "-", "k"}], TraditionalForm]]],
 " maladapted individuals)"
}], "Text",
 CellChangeTimes->{{3.5001395213819447`*^9, 3.500139595085684*^9}, {
  3.592543494436854*^9, 3.592543590049955*^9}, {3.593444005336341*^9, 
  3.59344403474393*^9}}],

Cell[TextData[StyleBox["- Adapted/Maladapted individuals produced by nonfocal \
individual on the patch",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.5001397535132713`*^9, 3.5001397607796917`*^9}, {
  3.500139829018998*^9, 3.5001398481950006`*^9}, {3.5018732640362577`*^9, 
  3.501873267079073*^9}, {3.5934440338407097`*^9, 3.593444049487831*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"localadother", "[", 
   RowBox[{"es_", ",", "a1other_", ",", "m1other_", ",", "a2other_"}], "]"}], 
  ":=", 
  RowBox[{
   RowBox[{
    FractionBox["a1other", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["m1other", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["a2other", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"n", "-", "1", "-", "a1other", "-", "m1other", "-", "a2other"}], 
     "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], 
     ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localmadother", "[", 
   RowBox[{"es_", ",", "a1other_", ",", "m1other_", ",", "a2other_"}], "]"}], 
  ":=", 
  RowBox[{
   RowBox[{
    FractionBox["a1other", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["m1other", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["a2other", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"n", "-", "1", "-", "a1other", "-", "m1other", "-", "a2other"}], 
     "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}]}]}]}]}], "Input",
 CellChangeTimes->{
  3.59254363092905*^9, {3.6242016785281067`*^9, 3.624201707337722*^9}, {
   3.624202331530916*^9, 3.624202337928005*^9}, {3.624202384234132*^9, 
   3.624202419163906*^9}, {3.624202581312338*^9, 3.624202645379182*^9}}],

Cell[TextData[{
 StyleBox["- Table with differential equations of the reproductive values",
  FontWeight->"Bold"],
 "\n",
 "See in-line comments"
}], "Text",
 CellChangeTimes->{{3.59344406709587*^9, 3.593444088648077*^9}}],

Cell[CellGroupData[{

Cell["Reproductive values: juveniles", "Subsection",
 CellChangeTimes->{{3.624194703418602*^9, 3.624194704634268*^9}, {
  3.624194744419376*^9, 3.6241947751070137`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"veqtabPlainJuv", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m2other", "=", 
         RowBox[{
         "n", "-", "1", "-", "a1other", "-", "m1other", "-", "a2other"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", "es", "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{
             RowBox[{"3", "-", "es"}], ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "m1other", ",", "a1other", ",",
              "m2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"a", ".", " ", "focal"}], " ", "juvenile", " ", "breeder", 
           " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "own", " ", "offspring", " ", "of", " ",
            "a", " ", "different", " ", "type"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", "n"}], ")"}], 
             RowBox[{"g", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
            RowBox[{"localcomptotal", "[", 
             RowBox[{"es", ",", 
              RowBox[{"a1other", "+", "aself"}], ",", 
              RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
             "]"}]]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"b", ".", " ", "focal"}], " ", "juvenile", " ", "breeder", 
           " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "other", " ", "offspring"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{
           "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}], "-", 
          RowBox[{"v", "[", 
           RowBox[{
           "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]}], ")"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"1", 
          RowBox[{"c", ".", " ", "focal"}], " ", "juvenile", " ", "adapted", 
          " ", "breeder", " ", "matures", " ", "to", " ", "the", " ", "next", 
          " ", "stage"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"v", "[", 
             RowBox[{"es", ",", "0", ",", "aself", ",", 
              RowBox[{"a1other", "-", "1", "+", "aself"}], ",", 
              RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
             "]"}]}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"a", ".", " ", "adapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", 
           "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", 
             RowBox[{"a1other", "-", "1", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", "a2other"}], "]"}], "-", 
           
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"b", ".", " ", "adapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", "a",
            " ", "different", " ", "type", " ", "as", " ", "focal"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1"}], ",", 
             RowBox[{"m1other", "+", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"c", ".", " ", "adapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "nonfocal", " ", "offspring", " ", 
           "that", " ", "is", " ", "maladapted"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "+", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"2", 
          RowBox[{"d", ".", " ", "adapted"}], " ", "nonfocal", " ", 
          "juvenile", " ", "matures", " ", "to", " ", "adult", " ", 
          "breedership"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"v", "[", 
             RowBox[{"es", ",", "0", ",", "aself", ",", 
              RowBox[{"a1other", "+", "aself"}], ",", 
              RowBox[{"m1other", "-", "1", "+", "1", "-", "aself"}], ",", 
              "a2other"}], "]"}]}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"a", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", 
           "the", " ", "same", " ", "phenotype", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "-", "1", "+", "1", "-", "aself"}], ",", 
             "a2other"}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "-", "1", "+", "aself"}], ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"b", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", "a",
            " ", "different", " ", "phenotype", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", 
             RowBox[{"m1other", "-", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"c", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "nonfocal", " ", "offspring", " ", 
           "that", " ", "is", " ", "adapted"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "-", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"3", 
          RowBox[{"d", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
          "juvenile", " ", "breeder", " ", "survives", " ", "to", " ", 
          "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"a", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "a", " ", "different", " ", "type", " ", "than", " ", 
           "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"v", "[", 
             RowBox[{"es", ",", "0", ",", "aself", ",", 
              RowBox[{"a1other", "+", "aself"}], ",", 
              RowBox[{"m1other", "+", "1", "-", "aself"}], ",", 
              RowBox[{"a2other", "-", "1"}]}], "]"}]}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"b", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"c", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "nonfocal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "+", "1"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"d", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "nonfocal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", "a2other"}], "]"}], "+", 
           
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"a", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "a", " ", "different", " ", "type", " ", "than", " ", 
           "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"v", "[", 
             RowBox[{"es", ",", "0", ",", "aself", ",", 
              RowBox[{"a1other", "+", "aself"}], ",", 
              RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
             "]"}]}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"b", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", "m1other", ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"c", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "+", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"d", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "n"}], ")"}], 
         RowBox[{"g", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", "k"}], ")"}], 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"zm2", "=", 
               RowBox[{"n", "-", "za1", "-", "zm1", "-", "za2"}]}], "}"}], 
             ",", 
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{
               "zes", ",", "za1", ",", "zm1", ",", "za2", ",", "zm2"}], "]"}], 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"za1", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "1", ",", "0"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", 
                    RowBox[{"za1", "-", "1"}], ",", "zm1", ",", "za2"}], 
                    "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    RowBox[{"za1", "-", "1"}], ",", "zm1", ",", "za2"}], 
                    "]"}]}]}], "\[IndentingNewLine]", ")"}]}], 
                "\[IndentingNewLine]", "+", 
                RowBox[{"zm1", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "0", ",", "0"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    RowBox[{"zm1", "-", "1"}], ",", "za2"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", 
                    RowBox[{"zm1", "-", "1"}], ",", "za2"}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "+", 
                
                RowBox[{"za2", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "1", ",", "1"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    "zm1", ",", 
                    RowBox[{"za2", "-", "1"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", "zm1", ",", 
                    RowBox[{"za2", "-", "1"}]}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "+", 
                
                RowBox[{"zm2", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "0", ",", "1"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    "zm1", ",", "za2"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", "zm1", ",", "za2"}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", 
               ")"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"zes", ",", "1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"za1", ",", "0", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zm1", ",", "0", ",", 
             RowBox[{"n", "-", "za1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"za2", ",", "0", ",", 
             RowBox[{"n", "-", "za1", "-", "zm1"}]}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a1other", ",", "0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m1other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other", "-", "m1other"}]}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.624105393315069*^9, 3.624105424785666*^9}, {
   3.624105542758597*^9, 3.624105550700832*^9}, {3.624105634651022*^9, 
   3.6241056558512907`*^9}, {3.624106910657282*^9, 3.624106951717827*^9}, {
   3.62410723426145*^9, 3.6241072952709713`*^9}, {3.6241073313493013`*^9, 
   3.6241074057358103`*^9}, {3.6241074645950747`*^9, 3.624107630937098*^9}, {
   3.624107672161605*^9, 3.624107696256287*^9}, {3.624107728743771*^9, 
   3.624107907116013*^9}, {3.624108519063383*^9, 3.624108589425164*^9}, {
   3.624108641315518*^9, 3.624108644553985*^9}, {3.624108833022855*^9, 
   3.624108864366914*^9}, {3.624108999412953*^9, 3.624109037338584*^9}, {
   3.624109757301538*^9, 3.624109816130487*^9}, {3.624110628383292*^9, 
   3.624110833628664*^9}, {3.624110908970429*^9, 3.624110929575144*^9}, {
   3.624110974936181*^9, 3.624111011867834*^9}, {3.624111075130018*^9, 
   3.624111098126931*^9}, {3.624111172158141*^9, 3.6241111756160097`*^9}, {
   3.624111247687255*^9, 3.624111290220771*^9}, {3.624111337718417*^9, 
   3.6241113929905357`*^9}, 3.624111459721759*^9, {3.624111503087812*^9, 
   3.624111567750102*^9}, {3.624111644629919*^9, 3.624111655607366*^9}, {
   3.624112058631222*^9, 3.624112177756599*^9}, 3.624112296789069*^9, {
   3.6241123277544823`*^9, 3.624112356208357*^9}, {3.624112476305134*^9, 
   3.624112495511964*^9}, {3.624112544110755*^9, 3.6241125623089447`*^9}, {
   3.624112634463889*^9, 3.6241126670311213`*^9}, {3.624112699002626*^9, 
   3.624112757417794*^9}, {3.624112800664715*^9, 3.624112811731379*^9}, {
   3.624114458578978*^9, 3.6241145110967503`*^9}, {3.6241156278447027`*^9, 
   3.624115676439664*^9}, {3.624115710006269*^9, 3.624115720724999*^9}, {
   3.624116126772534*^9, 3.624116143875856*^9}, {3.624117054944509*^9, 
   3.624117122909733*^9}, {3.624117232977274*^9, 3.624117233371319*^9}, {
   3.624117347738717*^9, 3.624117358275321*^9}, {3.624117388353952*^9, 
   3.6241173962020197`*^9}, {3.624117435590787*^9, 3.624117491493388*^9}, {
   3.6241179082263193`*^9, 3.624117919533782*^9}, 3.624121236873742*^9, {
   3.624121576678515*^9, 3.624121768038467*^9}, {3.624121818408928*^9, 
   3.62412184063608*^9}, {3.624122066672517*^9, 3.624122085633874*^9}, {
   3.624122146422144*^9, 3.624122210443741*^9}, {3.62412825762978*^9, 
   3.624128279184132*^9}, {3.6241349066411533`*^9, 3.624134935983481*^9}, {
   3.624134973365363*^9, 3.624135067662483*^9}, {3.624135275875266*^9, 
   3.624135304590047*^9}, {3.624135424804736*^9, 3.6241354794836073`*^9}, {
   3.624135537150897*^9, 3.624135551681814*^9}, {3.624136317804256*^9, 
   3.624136592868403*^9}, {3.624136623531128*^9, 3.624136666441414*^9}, {
   3.624136752200927*^9, 3.6241367920838137`*^9}, {3.6241368256210117`*^9, 
   3.624136916638122*^9}, {3.62418830554675*^9, 3.6241883064004908`*^9}, {
   3.6241886156711493`*^9, 3.624188616434956*^9}, {3.624197138929085*^9, 
   3.624197141443653*^9}, {3.624199077465385*^9, 3.6241990776535378`*^9}, {
   3.624201194317346*^9, 3.624201231631407*^9}, {3.624201533263768*^9, 
   3.624201560299189*^9}, {3.6242029666179333`*^9, 3.624203130670968*^9}, {
   3.624204116478397*^9, 3.624204116652637*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reproductive values: adults", "Subsection",
 CellChangeTimes->{{3.624194765851487*^9, 3.624194770611102*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"veqtabPlainAd", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m2other", "=", 
         RowBox[{
         "n", "-", "1", "-", "a1other", "-", "m1other", "-", "a2other"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", "es", "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{
             RowBox[{"3", "-", "es"}], ",", "1", ",", 
             RowBox[{"1", "-", "aself"}], ",", "m1other", ",", "a1other", ",",
              "m2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", 
             RowBox[{"a1other", "-", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", "a2other"}], "]"}], "-", 
           
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"a", ".", " ", "adapted"}], " ", "juvenile", " ", 
           "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "own", " ", "offspring", " ", "of", " ",
            "a", " ", "different", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"b", ".", " ", "adapted"}], " ", "juvenile", " ", 
           "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "own", " ", "offspring", " ", "of", " ",
            "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1"}], ",", 
             RowBox[{"m1other", "+", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"c", ".", " ", "adapted"}], " ", "juvenile", " ", 
           "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "nonfocal", " ", "maladapted", " ", 
           "juvenile", " ", "offspring"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "+", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"1", 
          RowBox[{"d", ".", " ", "focal"}], " ", "juvenile", " ", "adapted", 
          " ", "breeder", " ", "matures", " ", "to", " ", "the", " ", "next", 
          " ", "stage"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "-", "1"}], ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "-", "1", "+", "1", "-", "aself"}], ",", 
             "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"a", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", 
           "the", " ", "same", " ", "phenotype", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "a1other", ",", 
             RowBox[{"m1other", "-", "1"}], ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "-", "1", "+", "aself"}], ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"b", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", "a",
            " ", "different", " ", "phenotype", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", 
             RowBox[{"m1other", "-", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"c", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "nonfocal", " ", "offspring", " ", 
           "that", " ", "is", " ", "adapted"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "-", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"2", 
          RowBox[{"d", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
          "juvenile", " ", "breeder", " ", "survives", " ", "to", " ", 
          "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"a", ".", " ", "focal"}], " ", "adult", " ", "breeder", 
           " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "a", " ", "different", " ", "type", " ", "as", " ", 
           "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"b", ".", " ", "focal"}], " ", "adult", " ", "breeder", 
           " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", "n"}], ")"}], 
             RowBox[{"g", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
            RowBox[{"localcomptotal", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
              RowBox[{"a2other", "+", "aself"}]}], "]"}]]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"c", ".", " ", "focal"}], " ", "adult", " ", "breeder", 
           " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "nonfocal", " ", "offspring"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself", "-", "1"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"a", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "a", " ", "different", " ", "type", " ", "than", " ", 
           "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself", "-", "1"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"b", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"c", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "nonfocal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "+", "1"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"d", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "nonfocal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"a", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", "a2other"}], "]"}], "-", 
           
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"b", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", "m1other", ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"c", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "+", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"d", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "n"}], ")"}], 
         RowBox[{"g", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", "k"}], ")"}], 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"zm2", "=", 
               RowBox[{"n", "-", "za1", "-", "zm1", "-", "za2"}]}], "}"}], 
             ",", 
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{
               "zes", ",", "za1", ",", "zm1", ",", "za2", ",", "zm2"}], "]"}], 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"za1", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "1", ",", "0"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", 
                    RowBox[{"za1", "-", "1"}], ",", "zm1", ",", "za2"}], 
                    "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    RowBox[{"za1", "-", "1"}], ",", "zm1", ",", "za2"}], 
                    "]"}]}]}], "\[IndentingNewLine]", ")"}]}], 
                "\[IndentingNewLine]", "+", 
                RowBox[{"zm1", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "0", ",", "0"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    RowBox[{"zm1", "-", "1"}], ",", "za2"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", 
                    RowBox[{"zm1", "-", "1"}], ",", "za2"}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "+", 
                
                RowBox[{"za2", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "1", ",", "1"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    "zm1", ",", 
                    RowBox[{"za2", "-", "1"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", "zm1", ",", 
                    RowBox[{"za2", "-", "1"}]}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "+", 
                
                RowBox[{"zm2", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "0", ",", "1"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    "zm1", ",", "za2"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", "zm1", ",", "za2"}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", 
               ")"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"zes", ",", "1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"za1", ",", "0", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zm1", ",", "0", ",", 
             RowBox[{"n", "-", "za1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"za2", ",", "0", ",", 
             RowBox[{"n", "-", "za1", "-", "zm1"}]}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a1other", ",", "0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m1other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other", "-", "m1other"}]}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.624105393315069*^9, 3.624105424785666*^9}, {
   3.624105542758597*^9, 3.624105550700832*^9}, {3.624105634651022*^9, 
   3.6241056558512907`*^9}, {3.624106910657282*^9, 3.624106951717827*^9}, {
   3.62410723426145*^9, 3.6241072952709713`*^9}, {3.6241073313493013`*^9, 
   3.6241074057358103`*^9}, {3.6241074645950747`*^9, 3.624107630937098*^9}, {
   3.624107672161605*^9, 3.624107696256287*^9}, {3.624107728743771*^9, 
   3.624107907116013*^9}, {3.624108519063383*^9, 3.624108589425164*^9}, {
   3.624108641315518*^9, 3.624108644553985*^9}, {3.624108833022855*^9, 
   3.624108864366914*^9}, {3.624108999412953*^9, 3.624109037338584*^9}, {
   3.624109757301538*^9, 3.624109816130487*^9}, {3.624110628383292*^9, 
   3.624110833628664*^9}, {3.624110908970429*^9, 3.624110929575144*^9}, {
   3.624110974936181*^9, 3.624111011867834*^9}, {3.624111075130018*^9, 
   3.624111098126931*^9}, {3.624111172158141*^9, 3.6241111756160097`*^9}, {
   3.624111247687255*^9, 3.624111290220771*^9}, {3.624111337718417*^9, 
   3.6241113929905357`*^9}, 3.624111459721759*^9, {3.624111503087812*^9, 
   3.624111567750102*^9}, {3.624111644629919*^9, 3.624111655607366*^9}, {
   3.624112058631222*^9, 3.624112177756599*^9}, 3.624112296789069*^9, {
   3.6241123277544823`*^9, 3.624112356208357*^9}, {3.624112476305134*^9, 
   3.624112495511964*^9}, {3.624112544110755*^9, 3.6241125623089447`*^9}, {
   3.624112634463889*^9, 3.6241126670311213`*^9}, {3.624112699002626*^9, 
   3.624112757417794*^9}, {3.624112800664715*^9, 3.624112811731379*^9}, {
   3.624114458578978*^9, 3.6241145110967503`*^9}, {3.6241156278447027`*^9, 
   3.624115676439664*^9}, {3.624115710006269*^9, 3.624115720724999*^9}, {
   3.624116126772534*^9, 3.624116143875856*^9}, {3.624117054944509*^9, 
   3.624117122909733*^9}, {3.624117232977274*^9, 3.624117233371319*^9}, {
   3.624117347738717*^9, 3.624117358275321*^9}, {3.624117388353952*^9, 
   3.6241173962020197`*^9}, {3.624117435590787*^9, 3.624117491493388*^9}, {
   3.6241179082263193`*^9, 3.624117919533782*^9}, 3.624121236873742*^9, {
   3.624121576678515*^9, 3.624121768038467*^9}, {3.624121818408928*^9, 
   3.62412184063608*^9}, {3.624122066672517*^9, 3.624122085633874*^9}, {
   3.624122146422144*^9, 3.624122210443741*^9}, {3.62412825762978*^9, 
   3.624128279184132*^9}, {3.6241349066411533`*^9, 3.624134935983481*^9}, {
   3.624134973365363*^9, 3.624135067662483*^9}, {3.624135275875266*^9, 
   3.624135304590047*^9}, {3.624135424804736*^9, 3.6241354794836073`*^9}, {
   3.624135537150897*^9, 3.624135551681814*^9}, {3.624136317804256*^9, 
   3.624136592868403*^9}, {3.624136623531128*^9, 3.624136666441414*^9}, {
   3.624136752200927*^9, 3.6241367920838137`*^9}, {3.6241368256210117`*^9, 
   3.624136916638122*^9}, {3.6241371119526377`*^9, 3.624137123015327*^9}, {
   3.6241374691646013`*^9, 3.624137482972671*^9}, {3.62413752011064*^9, 
   3.624137593860952*^9}, {3.624137635384986*^9, 3.624137709797246*^9}, 
   3.624188325910187*^9, {3.624195595519504*^9, 3.624195754485969*^9}, {
   3.624196895973914*^9, 3.624196947786957*^9}, {3.62419700975912*^9, 
   3.624197118941063*^9}, {3.624197187438719*^9, 3.624197221520343*^9}, {
   3.6241972550854397`*^9, 3.624197332028689*^9}, {3.6241973719157763`*^9, 
   3.624197420877294*^9}, {3.62419828534858*^9, 3.624198288802609*^9}, {
   3.624198319938748*^9, 3.6241983445530663`*^9}, {3.624198810897176*^9, 
   3.6241988875524607`*^9}, {3.6241989556213207`*^9, 
   3.6241990234801693`*^9}, {3.62419905426888*^9, 3.624199054363193*^9}, {
   3.62419911295243*^9, 3.624199113125098*^9}, {3.624199146457932*^9, 
   3.624199149804529*^9}, {3.624199184101955*^9, 3.624199204727675*^9}, {
   3.6241992966541157`*^9, 3.624199346002799*^9}, {3.624199431265285*^9, 
   3.624199444946371*^9}, {3.624199495212886*^9, 3.6241995219215612`*^9}, {
   3.624199566362286*^9, 3.624199684797461*^9}, {3.624199739365447*^9, 
   3.624199793268449*^9}, {3.624200115688655*^9, 3.624200116575446*^9}, {
   3.624200156439021*^9, 3.624200161419701*^9}, {3.624200195640967*^9, 
   3.624200293813195*^9}, {3.624200524231401*^9, 3.6242005507180767`*^9}, {
   3.624201033128936*^9, 3.6242010491402683`*^9}, {3.6242011314151993`*^9, 
   3.624201157681975*^9}, {3.6242013117409353`*^9, 3.624201401595797*^9}, {
   3.624203185613224*^9, 3.62420324017876*^9}, {3.62420331045933*^9, 
   3.624203338476714*^9}, {3.624203379360961*^9, 3.624203379451083*^9}, {
   3.624203414346799*^9, 3.624203450906179*^9}, {3.624203677437587*^9, 
   3.6242036997938766`*^9}, {3.624204133116194*^9, 3.6242041333410673`*^9}, {
   3.624280719591448*^9, 3.624280719701469*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constraints (e.g., average reproductive value is constant)", \
"Subsection",
 CellChangeTimes->{{3.616146232386489*^9, 3.616146251171417*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rvCombinatorics", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    FractionBox["a1", "n"], 
    RowBox[{"v", "[", 
     RowBox[{"es", ",", "0", ",", "1", ",", 
      RowBox[{"a1", "-", "1"}], ",", "m1", ",", "a2"}], "]"}]}], "+", 
   RowBox[{
    FractionBox["m1", "n"], 
    RowBox[{"v", "[", 
     RowBox[{"es", ",", "0", ",", "0", ",", "a1", ",", 
      RowBox[{"m1", "-", "1"}], ",", "a2"}], "]"}]}], "+", 
   RowBox[{
    FractionBox["a2", "n"], 
    RowBox[{"v", "[", 
     RowBox[{"es", ",", "1", ",", "1", ",", "a1", ",", "m1", ",", 
      RowBox[{"a2", "-", "1"}]}], "]"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"n", "-", "a1", "-", "m1", "-", "a2"}], "n"], 
    RowBox[{"v", "[", 
     RowBox[{"es", ",", "1", ",", "0", ",", "a1", ",", "m1", ",", "a2"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.607779020301613*^9, 3.6077790439808407`*^9}, {
   3.607779090483363*^9, 3.607779105510744*^9}, {3.6077791758543873`*^9, 
   3.6077791866359863`*^9}, {3.607779263018914*^9, 3.607779352213462*^9}, {
   3.607779497915346*^9, 3.6077795249713984`*^9}, {3.607779588010723*^9, 
   3.607779726837728*^9}, {3.607779937420652*^9, 3.607779948144641*^9}, {
   3.607779978921884*^9, 3.6077800286412163`*^9}, {3.607780159674581*^9, 
   3.607780212431211*^9}, {3.607780247742075*^9, 3.607780280206851*^9}, {
   3.607780321529426*^9, 3.607780333501069*^9}, {3.6077803642301407`*^9, 
   3.60778042543262*^9}, {3.608471296899273*^9, 3.608471327334947*^9}, 
   3.608525677003003*^9, {3.608621127598675*^9, 3.608621147479912*^9}, {
   3.62420456927682*^9, 3.624204685858012*^9}, {3.624204809735545*^9, 
   3.624204820222549*^9}, {3.624205065200027*^9, 3.624205079541525*^9}, {
   3.624207303276064*^9, 3.624207304966489*^9}, {3.624207373859433*^9, 
   3.624207373999675*^9}, 3.624280855696699*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rvtotal", "=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", 
       RowBox[{"n", "-", "a1", "-", "m1", "-", "a2"}]}], "]"}], 
     RowBox[{"rvCombinatorics", "[", 
      RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a1", ",", "0", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m1", ",", "0", ",", 
      RowBox[{"n", "-", "a1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a2", ",", "0", ",", 
      RowBox[{"n", "-", "a1", "-", "m1"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.607778816157462*^9, 3.607778821588315*^9}, {
   3.607778938661419*^9, 3.6077789716072493`*^9}, {3.607780446187346*^9, 
   3.607780452842698*^9}, {3.607780505772138*^9, 3.607780514899021*^9}, 
   3.607780572965794*^9, 3.607782028839376*^9, 3.608525677003538*^9, {
   3.6242050961629972`*^9, 3.624205168714857*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}]}], 
  "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}]}], 
  "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}]}], 
  "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}]}], 
  "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}]}], 
  "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}]}], 
  "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}]}], 
  "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}]}], 
  "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], 
       "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.624205100416065*^9, 3.624205169928602*^9, 
  3.624207307227707*^9, 3.624207376242751*^9, 3.6242809423829412`*^9, 
  3.624281057465014*^9, 3.624281960453722*^9, 3.624282723354959*^9, 
  3.624301629809804*^9, 3.624301866265417*^9, 3.6243462396792717`*^9, 
  3.624365923526335*^9}]
}, Open  ]]
}, Open  ]],

Cell["\<\
Combine the systems of equations for juvenile and adult reproductive values\
\>", "Text",
 CellChangeTimes->{{3.624204505642796*^9, 3.624204524385427*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"veqtabPlain", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"veqtabPlainJuv", ",", "veqtabPlainAd"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.624204086223699*^9, 3.624204103888562*^9}, 
   3.624204219545186*^9}],

Cell["Specify ingredients for numerical solving:", "Text",
 CellChangeTimes->{3.593444110336153*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"veqtab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"x", "\[Equal]", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Flatten", "[", "veqtabPlain", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"veqtabPlain1", "=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "veqtabPlain", "]"}], ",", 
     RowBox[{"rvtotal", "\[Equal]", "1"}], ",", "1"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.505135127820217*^9, 3.505135205993911*^9}, {
   3.50513611034762*^9, 3.505136113075313*^9}, {3.507217456958711*^9, 
   3.5072174574988*^9}, {3.520430829666444*^9, 3.520430831170349*^9}, 
   3.520431566258815*^9, {3.525507803122896*^9, 3.525507813769655*^9}, {
   3.624204050869768*^9, 3.624204062405881*^9}, 3.624204102034343*^9, {
   3.624204140260621*^9, 3.624204143451494*^9}, {3.624280860536449*^9, 
   3.6242808625370913`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "veqtab", "]"}]], "Input",
 CellChangeTimes->{{3.624301837347498*^9, 3.624301846112699*^9}}],

Cell[BoxData[
 RowBox[{"{", "32", "}"}]], "Output",
 CellChangeTimes->{{3.624301846560603*^9, 3.62430186639149*^9}, 
   3.624346239735635*^9, 3.624365923619277*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"veqtab1", "=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "veqtab", "]"}], ",", 
     RowBox[{"rvtotal", "\[Equal]", "1"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"veqtabalt", "=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "veqtab", "]"}], ",", 
     RowBox[{"rvtotal", "\[Equal]", "1"}], ",", "25"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"rvals", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{
      "es", ",", "age", ",", "aself", ",", "a1other", ",", "m1other", ",", 
       "a2other"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"age", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a1other", ",", "0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m1other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other", "-", "m1other"}]}], "}"}]}], 
    "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.500191454064715*^9, 3.5001915301548977`*^9}, {
   3.503248155435731*^9, 3.503248184014865*^9}, {3.503248404174206*^9, 
   3.503248408037532*^9}, {3.5032484879944773`*^9, 3.503248564736147*^9}, {
   3.503248606455018*^9, 3.5032486443739347`*^9}, {3.503248907107168*^9, 
   3.503248941554319*^9}, {3.503248990797192*^9, 3.5032490177031803`*^9}, {
   3.503249052989256*^9, 3.503249058397912*^9}, {3.503249225456058*^9, 
   3.503249232572372*^9}, {3.52041981573889*^9, 3.520419815807377*^9}, {
   3.520419929199638*^9, 3.520419960348857*^9}, {3.520420386583107*^9, 
   3.52042039467243*^9}, {3.52042052102429*^9, 3.520420530710544*^9}, {
   3.520427661952775*^9, 3.520427687777916*^9}, {3.520428052792645*^9, 
   3.520428052841705*^9}, {3.520429085313047*^9, 3.520429135675322*^9}, {
   3.520429182985737*^9, 3.520429193252388*^9}, {3.524043766176027*^9, 
   3.524043808428645*^9}, {3.524043914020914*^9, 3.524043922558467*^9}, {
   3.524044206048073*^9, 3.524044207302169*^9}, {3.524044305100863*^9, 
   3.524044307940649*^9}, 3.524044728908094*^9, 3.52404481629412*^9, 
   3.524555029728461*^9, {3.531829251631015*^9, 3.531829276142815*^9}, {
   3.548672344448597*^9, 3.5486723446003237`*^9}, {3.624280876453071*^9, 
   3.624280957554735*^9}, {3.624281101001891*^9, 3.624281114428638*^9}, {
   3.62428194027269*^9, 3.624281945527236*^9}, {3.624282354714712*^9, 
   3.624282356482774*^9}, {3.62430185002206*^9, 3.624301850182891*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.624281105920567*^9, 3.624281115549718*^9}, {
   3.624281946855241*^9, 3.624281960582658*^9}, 3.624282357489018*^9, 
   3.6242827234968033`*^9, 3.624301629879539*^9, 3.6243018664951277`*^9, 
   3.624346239780632*^9, 3.624365923666636*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["rvals"], "Input",
 CellChangeTimes->{{3.624280958562119*^9, 3.624280959645495*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.62428096004163*^9, 3.624281057532894*^9, 
  3.624281118566571*^9, 3.624281960589666*^9, 3.624282723604632*^9, 
  3.624301629886148*^9, 3.6243018665949717`*^9, 3.6243462397857447`*^9, 
  3.62436592375327*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.624281767418119*^9, 3.624281783265133*^9}}],

Cell["", "Text",
 CellChangeTimes->{{3.5925439622482033`*^9, 3.592543972568615*^9}, 
   3.593444103127953*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"rvstartvals", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "rvals"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"frootstartvals2", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"frootstartvals", ",", "rvstartvals"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5018622698079367`*^9, 3.501862289606407*^9}, {
  3.5018623307386227`*^9, 3.501862365664167*^9}, {3.5018624304785347`*^9, 
  3.501862533405551*^9}, {3.520429173721002*^9, 3.520429174705935*^9}, {
  3.6242810748702927`*^9, 3.6242810751956377`*^9}, {3.624281125383884*^9, 
  3.624281135718894*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6088203241493273`*^9, 3.608820529511283*^9, 
  3.624281057582263*^9, 3.624281136532633*^9, 3.624281960700596*^9, 
  3.624282723712644*^9, 3.624301629959219*^9, 3.624301866699524*^9, 
  3.6243462398361893`*^9, 3.624365923822468*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6088203241493273`*^9, 3.608820529511283*^9, 
  3.624281057582263*^9, 3.624281136532633*^9, 3.624281960700596*^9, 
  3.624282723712644*^9, 3.624301629959219*^9, 3.624301866699524*^9, 
  3.6243462398361893`*^9, 3.624365923825255*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rvalstest", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", "\[Rule]", "1.0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "rvals"}], "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6242817185644503`*^9, 3.6242817346999693`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["rvalstest"], "Input",
 CellChangeTimes->{{3.624281918390265*^9, 3.6242819192337627`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.62428192262121*^9, 3.624281960841617*^9, 
  3.6242827238367453`*^9, 3.624301630033222*^9, 3.624301866813711*^9, 
  3.6243462398891907`*^9, 3.624365923878602*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"fxtest", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", "\[Rule]", "0.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "ftab"}], "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6242817567347097`*^9, 3.624281759690734*^9}, {
  3.624281796762117*^9, 3.6242818074677153`*^9}, {3.6242819022110987`*^9, 
  3.624281903635325*^9}}],

Cell[CellGroupData[{

Cell[BoxData["fxtest"], "Input",
 CellChangeTimes->{{3.6242818663108177`*^9, 3.624281866978546*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.1`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.624281867389296*^9, 3.6242819050214033`*^9, 
  3.6242819609571953`*^9, 3.624282723952879*^9, 3.6243016301070633`*^9, 
  3.624301866919903*^9, 3.624346239943775*^9, 3.624365923928866*^9}]
}, Open  ]],

Cell[TextData[StyleBox["Functions to solve for reproductive values \
numerically:",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.593444115376205*^9, 3.593444123951432*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ans2test", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
     RowBox[{"{", "m_", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p10s_", ",", "p11s_", ",", "p20s_", ",", "p21s_"}], "}"}], ",",
      "ks_", ",", "Qs_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"veqtab1", "/.", 
    RowBox[{"Join", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
       RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
       RowBox[{"k", "\[Rule]", "ks"}], ",", 
       RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
       RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
       RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
       RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
       RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
       RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
       RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
       RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
       RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
       RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
       RowBox[{"p21", "\[Rule]", "p21s"}], ",", 
       RowBox[{"mt", "\[Rule]", "m"}]}], "}"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.624281225718567*^9, 3.624281244454824*^9}, {
  3.6242812972831173`*^9, 3.624281308600658*^9}, {3.624281400046466*^9, 
  3.6242814016036997`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans2alt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "m_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p10s_", ",", "p11s_", ",", "p20s_", ",", "p21s_"}], "}"}], ",", 
    "ks_", ",", "Qs_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"feqtabalt", ",", "veqtabalt"}], "]"}], "/.", 
     RowBox[{"Join", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
        RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
        RowBox[{"k", "\[Rule]", "ks"}], ",", 
        RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
        RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
        RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
        RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
        RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
        RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
        RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
        RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
        RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
        RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
        RowBox[{"p21", "\[Rule]", "p21s"}], ",", 
        RowBox[{"mt", "\[Rule]", "m"}]}], "}"}], "]"}]}], ",", 
    "frootstartvals2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.624281225718567*^9, 3.624281244454824*^9}, {
  3.624282373037307*^9, 3.624282375920752*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans2", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "m_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p10s_", ",", "p11s_", ",", "p20s_", ",", "p21s_"}], "}"}], ",", 
    "ks_", ",", "Qs_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"feqtab", ",", "veqtab1"}], "]"}], "/.", 
     RowBox[{"Join", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
        RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
        RowBox[{"k", "\[Rule]", "ks"}], ",", 
        RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
        RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
        RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
        RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
        RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
        RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
        RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
        RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
        RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
        RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
        RowBox[{"p21", "\[Rule]", "p21s"}], ",", 
        RowBox[{"mt", "\[Rule]", "m"}]}], "}"}], "]"}]}], ",", 
    "frootstartvals2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5001916798996162`*^9, 3.500191697184021*^9}, {
   3.500191746661626*^9, 3.500191829605167*^9}, {3.5018625449943523`*^9, 
   3.501862553243379*^9}, {3.505134989076899*^9, 3.505135020740206*^9}, {
   3.505135294068394*^9, 3.505135298071993*^9}, {3.505135349357525*^9, 
   3.505135353720825*^9}, {3.505135717667018*^9, 3.505135718094597*^9}, {
   3.505135768611511*^9, 3.505135774783208*^9}, {3.505135830753673*^9, 
   3.505135873580983*^9}, {3.505135964949779*^9, 3.505136036881705*^9}, {
   3.505136141097201*^9, 3.505136150378752*^9}, {3.508161078184225*^9, 
   3.508161091740897*^9}, {3.520419842079061*^9, 3.520419844240124*^9}, {
   3.52455494510407*^9, 3.524554954808517*^9}, {3.5908239835408707`*^9, 
   3.590824013411441*^9}, {3.590824186979704*^9, 3.590824205987976*^9}, {
   3.5925440708761597`*^9, 3.5925440957750673`*^9}, {3.6242824975393476`*^9, 
   3.624282506760273*^9}, 3.6242826451232767`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"awh", "=", 
  RowBox[{"ans2alt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0.3", ",", "0.1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0.5", ",", "0.1", ",", "0.8", ",", "0.8"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", "0.1", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0.5", ",", "0.7", ",", "0.3", ",", "0.5"}], "}"}], ",", "0.1", 
    ",", "0.05"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.500192029842957*^9, 3.500192032446335*^9}, {
   3.501923482525814*^9, 3.501923510215691*^9}, 3.5019239348204813`*^9, {
   3.50193133558246*^9, 3.501931358478292*^9}, {3.5032540622901*^9, 
   3.503254067378688*^9}, {3.505135027019304*^9, 3.505135031903424*^9}, {
   3.50513578285544*^9, 3.505135784285997*^9}, {3.505135894350724*^9, 
   3.505135895026915*^9}, {3.507217302061491*^9, 3.507217316708229*^9}, {
   3.508161095277032*^9, 3.508161096760681*^9}, {3.508161237183029*^9, 
   3.508161239674842*^9}, {3.508161319583596*^9, 3.508161323949635*^9}, {
   3.51566001997472*^9, 3.515660071679375*^9}, {3.520419450927335*^9, 
   3.520419468632097*^9}, {3.520419567807807*^9, 3.520419570324196*^9}, {
   3.520419750326867*^9, 3.520419756677986*^9}, {3.520420937695824*^9, 
   3.520420953180814*^9}, {3.520427627254544*^9, 3.520427638687585*^9}, {
   3.520429208593634*^9, 3.520429231674042*^9}, {3.524554969421171*^9, 
   3.524554973766278*^9}, {3.524555006868618*^9, 3.524555007460496*^9}, {
   3.524555062494341*^9, 3.524555063917426*^9}, {3.590823966331852*^9, 
   3.590823968139655*^9}, {3.590824274713768*^9, 3.590824276960957*^9}, {
   3.5925441110935087`*^9, 3.592544125601429*^9}, {3.5925442568585777`*^9, 
   3.59254426919372*^9}, {3.624281248446003*^9, 3.624281387064067*^9}, {
   3.6242816862150507`*^9, 3.624281701783063*^9}, {3.624281739061611*^9, 
   3.624281748125304*^9}, {3.6242818111965723`*^9, 3.624281812787917*^9}, {
   3.624281891044326*^9, 3.624281895012829*^9}, {3.6242822887443943`*^9, 
   3.624282322056324*^9}, {3.624282603871292*^9, 3.624282617925349*^9}, {
   3.624282744660499*^9, 3.624282745564041*^9}, {3.624301641222934*^9, 
   3.624301644921186*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.001835319902273984`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.0074531623890625644`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", 
    "0.02500862194099583`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.01142431606049275`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.0321512996435606`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "0.023658886533240196`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.012134388688026783`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.057126248819786514`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.04635398980790293`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.032853766214658034`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.003935816445038907`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.02669234719506774`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", 
    "0.0747947893292929`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.03224915951259422`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.13289869467404036`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "0.06974715138918018`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.027688674499154107`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.1565184616208329`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.1332927085088435`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.09218219682595505`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.0682512605983197`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.7366528630400017`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.9198415578562242`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.7222512670209996`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.330621640073225`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.0181721456722557`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.2083005560819267`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.9985097994798969`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.892577637879793`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.5912283221871062`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.7446093261616668`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.5788210389283975`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.318407039172898`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.9945266449216857`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.1933694989640953`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.9754510113943479`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.2231452259450173`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.8413774045150477`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.9734940648809921`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.8333163084414126`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.39983602443682`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.045788024780397`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.18161971138562`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.0357868097591747`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.9132986174750457`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.5777212363460232`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.6712751007566475`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.5720374523353908`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.3835393495074386`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.0287431668267721`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.1654438869188835`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.0187747460824954`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.624282328196806*^9, 3.624282384670986*^9, 3.624282523870741*^9, {
   3.6242826061148367`*^9, 3.6242826528276587`*^9}, {3.624282729768002*^9, 
   3.624282756160851*^9}, {3.624301636453946*^9, 3.624301651608383*^9}, 
   3.6243018732448587`*^9, 3.62434624622935*^9, 3.624365929899737*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"awh", "=", 
  RowBox[{"ans2", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0.3", ",", "0.1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0.5", ",", "0.1", ",", "0.8", ",", "0.8"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", "0.1", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0.5", ",", "0.7", ",", "0.3", ",", "0.5"}], "}"}], ",", "0.1", 
    ",", "0.05"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.500192029842957*^9, 3.500192032446335*^9}, {
   3.501923482525814*^9, 3.501923510215691*^9}, 3.5019239348204813`*^9, {
   3.50193133558246*^9, 3.501931358478292*^9}, {3.5032540622901*^9, 
   3.503254067378688*^9}, {3.505135027019304*^9, 3.505135031903424*^9}, {
   3.50513578285544*^9, 3.505135784285997*^9}, {3.505135894350724*^9, 
   3.505135895026915*^9}, {3.507217302061491*^9, 3.507217316708229*^9}, {
   3.508161095277032*^9, 3.508161096760681*^9}, {3.508161237183029*^9, 
   3.508161239674842*^9}, {3.508161319583596*^9, 3.508161323949635*^9}, {
   3.51566001997472*^9, 3.515660071679375*^9}, {3.520419450927335*^9, 
   3.520419468632097*^9}, {3.520419567807807*^9, 3.520419570324196*^9}, {
   3.520419750326867*^9, 3.520419756677986*^9}, {3.520420937695824*^9, 
   3.520420953180814*^9}, {3.520427627254544*^9, 3.520427638687585*^9}, {
   3.520429208593634*^9, 3.520429231674042*^9}, {3.524554969421171*^9, 
   3.524554973766278*^9}, {3.524555006868618*^9, 3.524555007460496*^9}, {
   3.524555062494341*^9, 3.524555063917426*^9}, {3.590823966331852*^9, 
   3.590823968139655*^9}, {3.590824274713768*^9, 3.590824276960957*^9}, {
   3.5925441110935087`*^9, 3.592544125601429*^9}, {3.5925442568585777`*^9, 
   3.59254426919372*^9}, {3.624281248446003*^9, 3.624281387064067*^9}, {
   3.6242816862150507`*^9, 3.624281701783063*^9}, {3.624281739061611*^9, 
   3.624281748125304*^9}, {3.6242818111965723`*^9, 3.624281812787917*^9}, {
   3.624281891044326*^9, 3.624281895012829*^9}, {3.6242822887443943`*^9, 
   3.624282322056324*^9}, {3.624282533118898*^9, 3.624282533389902*^9}, {
   3.624282609662045*^9, 3.624282615389073*^9}, {3.62428274722824*^9, 
   3.624282748493088*^9}, 3.624301659606031*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.001835319902273984`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.007453162389062558`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", 
    "0.02500862194099581`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.011424316060492747`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.032151299643560574`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "0.023658886533240185`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.012134388688026776`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.05712624881978648`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.04635398980790291`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.03285376621465802`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.003935816445038907`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.02669234719506775`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", 
    "0.07479478932929291`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.03224915951259422`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.1328986946740404`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "0.06974715138918018`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.027688674499154107`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.15651846162083294`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.13329270850884348`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.09218219682595505`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.068251260598321`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.7366528630400021`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.919841557856225`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.7222512670210001`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.3306216400732256`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.0181721456722563`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.2083005560819273`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.9985097994798974`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.8925776378797937`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.5912283221871065`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.7446093261616673`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.5788210389283979`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.3184070391728986`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.9945266449216861`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.193369498964096`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.9754510113943483`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.2231452259450177`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.841377404515048`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.9734940648809924`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.8333163084414129`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.3998360244368204`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.0457880247803972`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.1816197113856204`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.0357868097591751`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.9132986174750449`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.5777212363460235`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.6712751007566476`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.572037452335391`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.383539349507439`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.0287431668267724`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.1654438869188837`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.0187747460824956`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.624282328196806*^9, 3.624282384670986*^9, {3.624282523870741*^9, 
   3.6242825421501293`*^9}, {3.624282612198122*^9, 3.624282661220426*^9}, {
   3.6242827389589987`*^9, 3.6242827680932837`*^9}, 3.624301666672387*^9, 
   3.624301885398232*^9, 3.624346252322991*^9, 3.624365935985079*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Relatedness", "Section",
 CellChangeTimes->{{3.497731804687118*^9, 3.497731811045567*^9}}],

Cell["\<\
CC=coefficient of consanguinity (Michod & Hamilton 1980 Nature)\
\>", "Text",
 CellChangeTimes->{{3.616159120093837*^9, 3.6161591332375603`*^9}}],

Cell[CellGroupData[{

Cell["Auxiliary functions", "Subsection",
 CellChangeTimes->{{3.616139810278734*^9, 3.616139813358396*^9}}],

Cell["\<\
Probability that of all adapted young in the local patch, the  adapted young \
has been produced by locally adapted juvenile breeder (a1)\
\>", "Text",
 CellChangeTimes->{{3.608631523352783*^9, 3.608631573687293*^9}, {
  3.6086316072072887`*^9, 3.6086316242234077`*^9}, {3.60888007381842*^9, 
  3.608880075945784*^9}, {3.608880124216983*^9, 3.6088801256808243`*^9}, {
  3.617964554707355*^9, 3.6179645564181633`*^9}, {3.624368088160989*^9, 
  3.6243681009039717`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"afromlocala1", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"localad", "[", 
        RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
       RowBox[{"dispad", "[", "es", "]"}]}], ")"}]}], ")"}], 
   RowBox[{"g", "[", 
    RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"a1", "/", "n"}], ")"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"p", "[", 
      RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.501358842092887*^9, 3.501358895141707*^9}, {
   3.501359277817292*^9, 3.501359282714561*^9}, {3.501359349410309*^9, 
   3.501359357354445*^9}, {3.501359670871066*^9, 3.5013596839728622`*^9}, {
   3.505136185585985*^9, 3.505136185817593*^9}, {3.507218921148726*^9, 
   3.507218923212683*^9}, {3.50721899439552*^9, 3.507219004498115*^9}, 
   3.608631556734653*^9, {3.617964513154127*^9, 3.6179645717623262`*^9}, 
   3.624368077544115*^9, {3.62436813443001*^9, 3.624368184614644*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"afromlocalm1", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"localad", "[", 
        RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
       RowBox[{"dispad", "[", "es", "]"}]}], ")"}]}], ")"}], 
   RowBox[{"g", "[", 
    RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"m1", "/", "n"}], ")"}], 
   RowBox[{"p", "[", 
    RowBox[{"es", ",", "0", ",", "0"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.501358842092887*^9, 3.501358895141707*^9}, {
   3.501359277817292*^9, 3.501359282714561*^9}, {3.501359349410309*^9, 
   3.501359357354445*^9}, {3.501359670871066*^9, 3.5013596839728622`*^9}, {
   3.505136185585985*^9, 3.505136185817593*^9}, {3.507218921148726*^9, 
   3.507218923212683*^9}, {3.50721899439552*^9, 3.507219004498115*^9}, 
   3.608631556734653*^9, {3.617964513154127*^9, 3.6179645717623262`*^9}, 
   3.624368077544115*^9, {3.62436813443001*^9, 3.62436823237426*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"afromlocala2", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"localad", "[", 
        RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
       RowBox[{"dispad", "[", "es", "]"}]}], ")"}]}], ")"}], 
   RowBox[{"g", "[", 
    RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"a2", "/", "n"}], ")"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"p", "[", 
      RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.501358842092887*^9, 3.501358895141707*^9}, {
   3.501359277817292*^9, 3.501359282714561*^9}, {3.501359349410309*^9, 
   3.501359357354445*^9}, {3.501359670871066*^9, 3.5013596839728622`*^9}, {
   3.505136185585985*^9, 3.505136185817593*^9}, {3.507218921148726*^9, 
   3.507218923212683*^9}, {3.50721899439552*^9, 3.507219004498115*^9}, 
   3.608631556734653*^9, {3.617964513154127*^9, 3.6179645717623262`*^9}, 
   3.624368077544115*^9, {3.62436813443001*^9, 3.624368184614644*^9}, {
   3.624368252125638*^9, 3.624368262596404*^9}, {3.624368323228489*^9, 
   3.624368323357209*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"afromlocalm2", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"localad", "[", 
        RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
       RowBox[{"dispad", "[", "es", "]"}]}], ")"}]}], ")"}], 
   RowBox[{"g", "[", 
    RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "a1", "-", "a2", "-", "m1"}], ")"}], "/", "n"}], 
    ")"}], 
   RowBox[{"p", "[", 
    RowBox[{"es", ",", "0", ",", "1"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.501358842092887*^9, 3.501358895141707*^9}, {
   3.501359277817292*^9, 3.501359282714561*^9}, {3.501359349410309*^9, 
   3.501359357354445*^9}, {3.501359670871066*^9, 3.5013596839728622`*^9}, {
   3.505136185585985*^9, 3.505136185817593*^9}, {3.507218921148726*^9, 
   3.507218923212683*^9}, {3.50721899439552*^9, 3.507219004498115*^9}, 
   3.608631556734653*^9, {3.617964513154127*^9, 3.6179645717623262`*^9}, 
   3.624368077544115*^9, {3.62436813443001*^9, 3.624368184614644*^9}, {
   3.6243683264455833`*^9, 3.6243683617251387`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mfromlocala1", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"localad", "[", 
        RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
       RowBox[{"dispad", "[", "es", "]"}]}], ")"}]}], ")"}], 
   RowBox[{"g", "[", 
    RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"a1", "/", "n"}], ")"}], 
   RowBox[{"p", "[", 
    RowBox[{"es", ",", "1", ",", "0"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.501358842092887*^9, 3.501358895141707*^9}, {
   3.501359277817292*^9, 3.501359282714561*^9}, {3.501359349410309*^9, 
   3.501359357354445*^9}, {3.501359670871066*^9, 3.5013596839728622`*^9}, {
   3.505136185585985*^9, 3.505136185817593*^9}, {3.507218921148726*^9, 
   3.507218923212683*^9}, {3.50721899439552*^9, 3.507219004498115*^9}, 
   3.608631556734653*^9, {3.617964513154127*^9, 3.6179645717623262`*^9}, 
   3.624368077544115*^9, {3.62436813443001*^9, 3.624368184614644*^9}, {
   3.62436838627654*^9, 3.624368397643898*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mfromlocalm1", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"localad", "[", 
        RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
       RowBox[{"dispad", "[", "es", "]"}]}], ")"}]}], ")"}], 
   RowBox[{"g", "[", 
    RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"m1", "/", "n"}], ")"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"p", "[", 
      RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.501358842092887*^9, 3.501358895141707*^9}, {
   3.501359277817292*^9, 3.501359282714561*^9}, {3.501359349410309*^9, 
   3.501359357354445*^9}, {3.501359670871066*^9, 3.5013596839728622`*^9}, {
   3.505136185585985*^9, 3.505136185817593*^9}, {3.507218921148726*^9, 
   3.507218923212683*^9}, {3.50721899439552*^9, 3.507219004498115*^9}, 
   3.608631556734653*^9, {3.617964513154127*^9, 3.6179645717623262`*^9}, 
   3.624368077544115*^9, {3.62436813443001*^9, 3.62436823237426*^9}, {
   3.624368388132432*^9, 3.624368401532116*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mfromlocala2", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"localad", "[", 
        RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
       RowBox[{"dispad", "[", "es", "]"}]}], ")"}]}], ")"}], 
   RowBox[{"g", "[", 
    RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"a2", "/", "n"}], ")"}], 
   RowBox[{"p", "[", 
    RowBox[{"es", ",", "1", ",", "1"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.501358842092887*^9, 3.501358895141707*^9}, {
   3.501359277817292*^9, 3.501359282714561*^9}, {3.501359349410309*^9, 
   3.501359357354445*^9}, {3.501359670871066*^9, 3.5013596839728622`*^9}, {
   3.505136185585985*^9, 3.505136185817593*^9}, {3.507218921148726*^9, 
   3.507218923212683*^9}, {3.50721899439552*^9, 3.507219004498115*^9}, 
   3.608631556734653*^9, {3.617964513154127*^9, 3.6179645717623262`*^9}, 
   3.624368077544115*^9, {3.62436813443001*^9, 3.624368184614644*^9}, {
   3.624368252125638*^9, 3.624368262596404*^9}, {3.624368323228489*^9, 
   3.624368323357209*^9}, {3.6243683891162453`*^9, 3.624368404884116*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mfromlocalm2", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"localad", "[", 
        RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
       RowBox[{"dispad", "[", "es", "]"}]}], ")"}]}], ")"}], 
   RowBox[{"g", "[", 
    RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "a1", "-", "a2", "-", "m1"}], ")"}], "/", "n"}], 
    ")"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"p", "[", 
      RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.501358842092887*^9, 3.501358895141707*^9}, {
   3.501359277817292*^9, 3.501359282714561*^9}, {3.501359349410309*^9, 
   3.501359357354445*^9}, {3.501359670871066*^9, 3.5013596839728622`*^9}, {
   3.505136185585985*^9, 3.505136185817593*^9}, {3.507218921148726*^9, 
   3.507218923212683*^9}, {3.50721899439552*^9, 3.507219004498115*^9}, 
   3.608631556734653*^9, {3.617964513154127*^9, 3.6179645717623262`*^9}, 
   3.624368077544115*^9, {3.62436813443001*^9, 3.624368184614644*^9}, {
   3.6243683264455833`*^9, 3.6243684079574947`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Relatedness between pairs of adapted juveniles", "Subsection",
 CellChangeTimes->{{3.624348323025687*^9, 3.624348332304028*^9}, {
  3.624363100131246*^9, 3.6243631054046087`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "r", "]"}]], "Input",
 CellChangeTimes->{{3.62436861555676*^9, 3.624368621160589*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ra1a1tab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{
       "A1", ",", "A1", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
       "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}], 
          RowBox[{"r", "[", 
           RowBox[{"M1", ",", "M1", ",", "es", ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]",
          "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"na1", "-", "2"}], "na1"], 
             RowBox[{"r", "[", 
              RowBox[{
              "A1", ",", "A1", ",", "es", ",", "na1", ",", "nm1", ",", 
               "na2"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["2", "na1"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"afromlocala1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox["1", "na1"], "+", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"na1", "-", "1"}], "na1"], 
                   RowBox[{"r", "[", 
                    RowBox[{
                    "A1", ",", "A1", ",", "es", ",", "na1", ",", "nm1", ",", 
                    "na2"}], "]"}]}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocalm1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocala2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocalm2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "A1", ",", "es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "death", " ", "adapted", " ", "juvenille", " ", "on", " ", 
             "na1"}], "+", 
            RowBox[{"1", " ", "patch"}]}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "A1", ",", "es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
            " ", "na1"}], "+", 
           RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}]}], 
           ")"}], 
          RowBox[{"r", "[", 
           RowBox[{
           "A1", ",", "A1", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
           "]"}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], " ",
           "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "2"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "A1", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", 
                 RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["2", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", 
                    RowBox[{"na1", "-", "1"}]], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na1", "-", "2"}], 
                    RowBox[{"na1", "-", "1"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "A1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], 
                   ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M2", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], 
                ")"}]}]}], ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{"replaced", " ", "by", " ", "adapted", " ", "juvenile"}]}],
           " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "A1", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to", 
           " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "2"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "A1", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                 RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
              RowBox[{
               FractionBox["2", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", 
                    RowBox[{"na1", "-", "1"}]], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na1", "-", "2"}], 
                    RowBox[{"na1", "-", "1"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "A1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "A1", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "2"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "A1", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], "]"}]}],
               "+", 
              RowBox[{
               FractionBox["2", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", 
                    RowBox[{"na1", "-", "1"}]], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na1", "-", "2"}], 
                    RowBox[{"na1", "-", "1"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "A1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                    "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}]}], ")"}]}]}], ")"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",",
            " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "A1", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}]}], 
           ")"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
             RowBox[{
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
              "\[GreaterEqual]", "0"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nm1", "+", "1"}], ")"}], 
             RowBox[{"f", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", 
                RowBox[{"(", 
                 RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
              "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
             RowBox[{
              RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"na2", "+", "1"}], ")"}], " ", 
             RowBox[{"d", "[", 
              RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
             RowBox[{"f", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", 
                RowBox[{"(", 
                 RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", 
                RowBox[{"(", 
                 RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
           "]"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",",
            "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}]}], ",", "0"}], "]"}]}], ")"}]}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na1", ",", "2", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nm1", ",", "0", ",", 
       RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na2", ",", "0", ",", 
       RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.624302371333778*^9, 3.6243024125426188`*^9}, {
   3.6243028274912653`*^9, 3.6243029055041723`*^9}, {3.6243032547992907`*^9, 
   3.624303296552454*^9}, {3.624303439665804*^9, 3.624303469793705*^9}, {
   3.624303504597529*^9, 3.624303515626656*^9}, {3.624303953275794*^9, 
   3.624303955661152*^9}, {3.62430403571349*^9, 3.624304090734439*^9}, {
   3.624304482871949*^9, 3.624304526932238*^9}, {3.6243056584888372`*^9, 
   3.62430570335483*^9}, 3.6243058598933887`*^9, {3.624306251844326*^9, 
   3.624306258941802*^9}, 3.62430629883864*^9, {3.624306332641201*^9, 
   3.624306389842059*^9}, {3.6243071876723213`*^9, 3.624307204002542*^9}, {
   3.624340070721993*^9, 3.624340104658491*^9}, {3.624340160399*^9, 
   3.624340160625435*^9}, {3.624341285683601*^9, 3.624341285857761*^9}, {
   3.624341567202887*^9, 3.624341569656107*^9}, {3.624341876347229*^9, 
   3.62434205148129*^9}, {3.624342916533228*^9, 3.624342982335129*^9}, {
   3.624343065740284*^9, 3.624343210268524*^9}, {3.624343248999522*^9, 
   3.6243432707243023`*^9}, {3.6243433014432364`*^9, 
   3.6243433718271017`*^9}, {3.6243434581143*^9, 3.624343458965274*^9}, {
   3.624343562620357*^9, 3.6243435976830997`*^9}, {3.624343732188504*^9, 
   3.624344006726016*^9}, {3.624344126581244*^9, 3.624344199386602*^9}, {
   3.6243447499158297`*^9, 3.624344840488538*^9}, {3.6243450132092943`*^9, 
   3.624345431597501*^9}, {3.624345599240451*^9, 3.6243456481965647`*^9}, {
   3.624345934839198*^9, 3.624345936876704*^9}, {3.6243459721177387`*^9, 
   3.6243462106280823`*^9}, {3.624347591537723*^9, 3.624347755722567*^9}, {
   3.624348198007516*^9, 3.6243482179264708`*^9}, {3.6243482525398912`*^9, 
   3.624348266657654*^9}, {3.624356895198255*^9, 3.624356918300398*^9}, {
   3.6243569521886263`*^9, 3.624356985457391*^9}, {3.624368739362833*^9, 
   3.6243687671627483`*^9}, {3.624368799220381*^9, 3.6243688168881483`*^9}, {
   3.624369129654187*^9, 3.624369140775166*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Relatedness between adapted and maladapted juveniles", "Subsection",
 CellChangeTimes->{{3.624363130957767*^9, 3.624363143628471*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ra1m1tab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{
       "A1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
       "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}], 
          RowBox[{"r", "[", 
           RowBox[{"A1", ",", "M1", ",", "es", ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]",
          "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"na1", "-", "1"}], "na1"], 
             RowBox[{"r", "[", 
              RowBox[{
              "A1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
               "na2"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["1", "na1"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"afromlocala1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocalm1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox["1", "nm1"], "+", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"nm1", "-", "1"}], "nm1"], 
                   RowBox[{"r", "[", 
                    RowBox[{
                    "M1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
                    "na2"}], "]"}]}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocala2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "M1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocalm2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "M1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"+", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
              RowBox[{
               RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"na1", "+", "1"}], ")"}], 
              RowBox[{"d", "[", 
               RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
              RowBox[{"f", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"ap", "[", 
                 RowBox[{"es", ",", 
                  RowBox[{"na1", "+", "1"}], ",", 
                  RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                  RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], 
                 "]"}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"nm1", "-", "1"}], "nm1"], 
                 RowBox[{"r", "[", 
                  RowBox[{"A1", ",", "M1", ",", "es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 FractionBox["1", "nm1"], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"mfromlocala1", "[", 
                    RowBox[{"es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    FractionBox["1", "na1"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na1", "-", "1"}], "na1"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "A1", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                    ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"mfromlocalm1", "[", 
                    RowBox[{"es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                    RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"mfromlocala2", "[", 
                    RowBox[{"es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                    RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"mfromlocalm2", "[", 
                    RowBox[{"es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                    RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                  ")"}]}]}], ")"}]}], ",", "0"}], "]"}]}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
             "death", " ", "adapted", " ", "juvenille", " ", "on", " ", 
              "na1"}], "+", "1"}], ",", 
            RowBox[{"nm", "-", 
             RowBox[{"1", " ", "patch"}]}], ",", " ", 
            RowBox[{
            "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
           " ", "*)"}], "\[IndentingNewLine]", "+", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
             RowBox[{
              RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"na1", "+", "1"}], ")"}], 
             RowBox[{"f", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
               RowBox[{"na2", "-", "1"}], ",", 
               RowBox[{"n", "-", 
                RowBox[{"(", 
                 RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
             RowBox[{"r", "[", 
              RowBox[{"A1", ",", "M1", ",", "es", ",", 
               RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
               RowBox[{"na2", "-", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
             "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
              " ", "na1"}], "+", "1"}], ",", 
            RowBox[{"na2", "-", 
             RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}]}], 
           " ", "*)"}], "\[IndentingNewLine]", "+", " ", 
          RowBox[{"nm1", " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"nm1", "-", "1"}], "nm1"], 
              RowBox[{"r", "[", 
               RowBox[{
               "A1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
                "na2"}], "]"}]}], "+", 
             RowBox[{
              FractionBox["1", "nm1"], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"mfromlocala1", "[", 
                  RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["1", "na1"], "+", 
                   RowBox[{
                    FractionBox[
                    RowBox[{"na1", "-", "1"}], "na1"], 
                    RowBox[{"r", "[", 
                    RowBox[{
                    "A1", ",", "A1", ",", "es", ",", "na1", ",", "nm1", ",", 
                    "na2"}], "]"}]}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm1", "[", 
                  RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{
                  "A1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
                   "na2"}], "]"}]}], "+", 
                RowBox[{"mfromlocala2", "[", 
                 RowBox[{
                 "A2", ",", "A1", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}], "+", 
                RowBox[{"mfromlocalm2", "[", 
                 RowBox[{
                 "M2", ",", "A1", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], ")"}]}]}], ")"}]}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
            RowBox[{
            "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], 
           " ", "*)"}], "\[IndentingNewLine]", "+", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
             RowBox[{
              RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nm1", "+", "1"}], ")"}], 
             RowBox[{"d", "[", 
              RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
             RowBox[{"f", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "-", "1"}], ",", 
               RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "-", "1"}], ",", 
               RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                FractionBox[
                 RowBox[{"na1", "-", "1"}], "na1"], 
                RowBox[{"r", "[", 
                 RowBox[{"A1", ",", "M1", ",", "es", ",", 
                  RowBox[{"na1", "-", "1"}], ",", 
                  RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
               RowBox[{
                FractionBox["1", "na1"], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"afromlocala1", "[", 
                    RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                   RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"afromlocalm1", "[", 
                    RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"nm1", "+", "1"}]], "+", 
                    RowBox[{
                    FractionBox["nm1", 
                    RowBox[{"nm1", "+", "1"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"M1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], 
                    ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"afromlocala2", "[", 
                    RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                   RowBox[{"r", "[", 
                    RowBox[{"A2", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"afromlocalm2", "[", 
                    RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                   RowBox[{"r", "[", 
                    RowBox[{"M2", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], 
                 ")"}]}]}], ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
            RowBox[{
             RowBox[{
             "replaced", " ", "by", " ", "adapted", " ", "juvenile", " ", 
              "on", " ", "a", " ", "na1"}], "-", "1"}], ",", 
            RowBox[{"nm1", "+", 
             RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
          "\[IndentingNewLine]", "+", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
             RowBox[{
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
              "\[GreaterEqual]", "0"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nm1", "+", "1"}], ")"}], 
             RowBox[{"f", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", 
                RowBox[{"(", 
                 RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
              "]"}], 
             RowBox[{"r", "[", 
              RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
               RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
           "]"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to",
             " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
             RowBox[{
              RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"na2", "+", "1"}], ")"}], " ", 
             RowBox[{"d", "[", 
              RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
             RowBox[{"f", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", 
                RowBox[{"(", 
                 RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", 
                RowBox[{"(", 
                 RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                FractionBox[
                 RowBox[{"na1", "-", "1"}], "na1"], 
                RowBox[{"r", "[", 
                 RowBox[{"A1", ",", "M1", ",", "es", ",", 
                  RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                  RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
               RowBox[{
                FractionBox["1", "na1"], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"afromlocala1", "[", 
                    RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                   RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"afromlocalm1", "[", 
                    RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox["1", "nm1"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"nm1", "-", "1"}], "nm1"], 
                    RowBox[{"r", "[", 
                    RowBox[{"M1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"afromlocala2", "[", 
                    RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                   RowBox[{"r", "[", 
                    RowBox[{"M1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"afromlocalm2", "[", 
                    RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                   RowBox[{"r", "[", 
                    RowBox[{"M1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}]}], 
              ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
            " ", 
            RowBox[{
            "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
           "*)"}], "\[IndentingNewLine]", "+", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
             RowBox[{
              RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"na2", "+", "1"}], ")"}], 
             RowBox[{"d", "[", 
              RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
             RowBox[{"f", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", "na1", "-", 
                RowBox[{"(", 
                 RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"ap", "[", 
                RowBox[{"es", ",", "na1", ",", 
                 RowBox[{"nm1", "-", "1"}], ",", 
                 RowBox[{"na2", "+", "1"}], ",", 
                 RowBox[{"n", "-", "na1", "-", 
                  RowBox[{"(", 
                   RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                  RowBox[{"(", 
                   RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                FractionBox[
                 RowBox[{"nm1", "-", "1"}], "nm1"], 
                RowBox[{"r", "[", 
                 RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
                  RowBox[{"nm1", "-", "1"}], ",", 
                  RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
               RowBox[{
                FractionBox["1", "nm1"], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"mfromlocala1", "[", 
                    RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox["1", "na1"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na1", "-", "1"}], "na1"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "A1", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"mfromlocalm1", "[", 
                    RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                   RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"mfromlocala2", "[", 
                    RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                   RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "A2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"mfromlocalm2", "[", 
                    RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                   RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "M2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}]}], 
              ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
            " ", 
            RowBox[{
            "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
           " ", "*)"}], "\[IndentingNewLine]", "+", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", 
                RowBox[{"(", 
                 RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", 
                "+", "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
             RowBox[{
              RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], " ", 
             RowBox[{"d", "[", 
              RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
             RowBox[{"f", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
               RowBox[{"n", "-", 
                RowBox[{"(", 
                 RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", 
                "+", "1"}]}], "]"}], 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
               RowBox[{"n", "-", 
                RowBox[{"(", 
                 RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", 
                "+", "1"}]}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                FractionBox[
                 RowBox[{"na1", "-", "1"}], "na1"], 
                RowBox[{"r", "[", 
                 RowBox[{"A1", ",", "M1", ",", "es", ",", 
                  RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                 "]"}]}], "+", 
               RowBox[{
                FractionBox["1", "na1"], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"afromlocala1", "[", 
                    RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                    "]"}], 
                   RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                    "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"afromlocalm1", "[", 
                    RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                    "]"}], 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox["1", "nm1"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"nm1", "-", "1"}], "nm1"], 
                    RowBox[{"r", "[", 
                    RowBox[{"M1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                    "]"}]}]}], ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"afromlocala2", "[", 
                    RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                    "]"}], 
                   RowBox[{"r", "[", 
                    RowBox[{"A2", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                    "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"afromlocalm2", "[", 
                    RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                    "]"}], 
                   RowBox[{"r", "[", 
                    RowBox[{"M2", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                    "]"}]}]}], ")"}]}]}], ")"}]}], ",", "0"}], "]"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], 
            ",", " ", 
            RowBox[{
            "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
           "*)"}], "\[IndentingNewLine]", "+", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
               ")"}], "\[LessEqual]", "n"}], "&&", 
             RowBox[{
              RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], 
             RowBox[{"d", "[", 
              RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
             RowBox[{"f", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
              "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"ap", "[", 
                RowBox[{"es", ",", "na1", ",", 
                 RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                 RowBox[{
                 "n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
                "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                FractionBox[
                 RowBox[{"nm1", "-", "1"}], "nm1"], 
                RowBox[{"r", "[", 
                 RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
                  RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
               RowBox[{
                FractionBox["1", "nm1"], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"mfromlocala1", "[", 
                    RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                   RowBox[{"(", 
                    RowBox[{
                    FractionBox["1", "na1"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na1", "-", "1"}], "na1"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "A1", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                    ")"}]}], "+", 
                  RowBox[{
                   RowBox[{"mfromlocalm1", "[", 
                    RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                   RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"mfromlocala2", "[", 
                    RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                   RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "A2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"mfromlocalm2", "[", 
                    RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                   RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "M2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                 ")"}]}]}], ")"}]}], ",", "0"}], "]"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",",
            " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "*)"}], "\[IndentingNewLine]", ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",",
            "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}]}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
        ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na1", ",", "2", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nm1", ",", "0", ",", 
       RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na2", ",", "0", ",", 
       RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.624302371333778*^9, 3.6243024125426188`*^9}, {
   3.6243028274912653`*^9, 3.6243029055041723`*^9}, {3.6243032547992907`*^9, 
   3.624303296552454*^9}, {3.624303439665804*^9, 3.624303469793705*^9}, {
   3.624303504597529*^9, 3.624303515626656*^9}, {3.624303953275794*^9, 
   3.624303955661152*^9}, {3.62430403571349*^9, 3.624304090734439*^9}, {
   3.624304482871949*^9, 3.624304526932238*^9}, {3.6243056584888372`*^9, 
   3.62430570335483*^9}, 3.6243058598933887`*^9, {3.624306251844326*^9, 
   3.624306258941802*^9}, 3.62430629883864*^9, {3.624306332641201*^9, 
   3.624306389842059*^9}, {3.6243071876723213`*^9, 3.624307204002542*^9}, {
   3.624340070721993*^9, 3.624340104658491*^9}, {3.624340160399*^9, 
   3.624340160625435*^9}, {3.624341285683601*^9, 3.624341285857761*^9}, {
   3.624341567202887*^9, 3.624341569656107*^9}, {3.624341876347229*^9, 
   3.62434205148129*^9}, {3.624342916533228*^9, 3.624342982335129*^9}, {
   3.624343065740284*^9, 3.624343210268524*^9}, {3.624343248999522*^9, 
   3.6243432707243023`*^9}, {3.6243433014432364`*^9, 
   3.6243433718271017`*^9}, {3.6243434581143*^9, 3.624343458965274*^9}, {
   3.624343562620357*^9, 3.6243435976830997`*^9}, {3.624343732188504*^9, 
   3.624344006726016*^9}, {3.624344126581244*^9, 3.624344199386602*^9}, {
   3.6243447499158297`*^9, 3.624344840488538*^9}, {3.6243450132092943`*^9, 
   3.624345431597501*^9}, {3.624345599240451*^9, 3.6243456481965647`*^9}, {
   3.624345934839198*^9, 3.624345936876704*^9}, {3.6243459721177387`*^9, 
   3.6243462106280823`*^9}, {3.624347591537723*^9, 3.624347755722567*^9}, {
   3.624348198007516*^9, 3.6243482179264708`*^9}, {3.6243482525398912`*^9, 
   3.624348266657654*^9}, {3.62434836723208*^9, 3.624348392347834*^9}, {
   3.624350735285244*^9, 3.62435075443115*^9}, {3.6243507946082993`*^9, 
   3.624350885180558*^9}, {3.6243513356039047`*^9, 3.624351340749043*^9}, {
   3.624351668681178*^9, 3.624351669278874*^9}, {3.6243518488718348`*^9, 
   3.624351861366447*^9}, {3.624351935381558*^9, 3.624351980501761*^9}, {
   3.624352011642293*^9, 3.624352133423257*^9}, {3.624352547821821*^9, 
   3.6243525975310593`*^9}, {3.624352636178549*^9, 3.624352666408836*^9}, {
   3.6243528800667057`*^9, 3.6243528816098013`*^9}, {3.624355881047595*^9, 
   3.624356110924863*^9}, {3.624356157840003*^9, 3.624356158111594*^9}, {
   3.624356202494185*^9, 3.624356296354809*^9}, {3.624356389719812*^9, 
   3.624356580759553*^9}, {3.62435661523709*^9, 3.6243568742997627`*^9}, {
   3.624357009391694*^9, 3.624357030093951*^9}, {3.624357067486843*^9, 
   3.624357179330071*^9}, {3.624357272513235*^9, 3.624357531321918*^9}, {
   3.62435785211161*^9, 3.624357886430176*^9}, {3.624357924747765*^9, 
   3.624358034392644*^9}, {3.624358069863727*^9, 3.624358270370534*^9}, {
   3.6243590706496687`*^9, 3.6243590834029627`*^9}, {3.6243591639129877`*^9, 
   3.6243594029082212`*^9}, {3.624361102875093*^9, 3.624361103239318*^9}, 
   3.624369194685254*^9, {3.624369349961759*^9, 3.6243693551921453`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \[NoBreak]\\!\\(1\\/0\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624369197388815*^9, 3.6243693610114202`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \[NoBreak]\\!\\(1\\/0\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624369197388815*^9, 3.624369361083886*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(ComplexInfinity + \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624369197388815*^9, 3.6243693610858183`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \[NoBreak]\\!\\(1\\/0\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624369197388815*^9, 3.624369361160891*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Power :: \
infy\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624369197388815*^9, 3.624369361228168*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(ComplexInfinity + \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624369197388815*^9, 3.624369361229487*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Relatedness between adapted and maladapted juveniles\
\>", "Subsection",
 CellChangeTimes->{{3.624363130957767*^9, 3.624363143628471*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ra1m1tab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{
       "A1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
       "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}], 
          RowBox[{"r", "[", 
           RowBox[{"A1", ",", "M1", ",", "es", ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]",
          "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"na1", "-", "1"}], "na1"], 
             RowBox[{"r", "[", 
              RowBox[{
              "A1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
               "na2"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["1", "na1"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"afromlocala1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocalm1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox["1", "nm1"], "+", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"nm1", "-", "1"}], "nm1"], 
                   RowBox[{"r", "[", 
                    RowBox[{
                    "M1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
                    "na2"}], "]"}]}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocala2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "M1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocalm2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "M1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"nm1", "-", "1"}], "nm1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M1", ",", "es", ",", 
                 RowBox[{"na1", "+", "1"}], ",", 
                 RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "nm1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"mfromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", "na1"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na1", "-", "1"}], "na1"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "A1", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                   ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                ")"}]}]}], ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "death", " ", "adapted", " ", "juvenille", " ", "on", " ", 
             "na1"}], "+", "1"}], ",", 
           RowBox[{"nm", "-", 
            RowBox[{"1", " ", "patch"}]}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "M1", ",", "es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
             " ", "na1"}], "+", "1"}], ",", 
           RowBox[{"na2", "-", 
            RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}]}], " ",
           "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"nm1", "-", "1"}], "nm1"], 
             RowBox[{"r", "[", 
              RowBox[{
              "A1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
               "na2"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["1", "nm1"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"mfromlocala1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox["1", "na1"], "+", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"na1", "-", "1"}], "na1"], 
                   RowBox[{"r", "[", 
                    RowBox[{
                    "A1", ",", "A1", ",", "es", ",", "na1", ",", "nm1", ",", 
                    "na2"}], "]"}]}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"mfromlocalm1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{"mfromlocala2", "[", 
                RowBox[{
                "A2", ",", "A1", ",", "es", ",", "na1", ",", "nm1", ",", 
                 "na2"}], "]"}], "+", 
               RowBox[{"mfromlocalm2", "[", 
                RowBox[{
                "M2", ",", "A1", ",", "es", ",", "na1", ",", "nm1", ",", 
                 "na2"}], "]"}]}], ")"}]}]}], ")"}]}], "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], " ",
           "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "1"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M1", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", 
                 RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", 
                    RowBox[{"nm1", "+", "1"}]], "+", 
                    RowBox[{
                    FractionBox["nm1", 
                    RowBox[{"nm1", "+", "1"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"M1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], 
                   ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A2", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M2", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], 
                ")"}]}]}], ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{
            RowBox[{
            "replaced", " ", "by", " ", "adapted", " ", "juvenile", " ", "on",
              " ", "a", " ", "na1"}], "-", "1"}], ",", 
           RowBox[{"nm1", "+", 
            RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to", 
           " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "1"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M1", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                 RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", "nm1"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"nm1", "-", "1"}], "nm1"], 
                    RowBox[{"r", "[", 
                    RowBox[{"M1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"nm1", "-", "1"}], "nm1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
                 RowBox[{"nm1", "-", "1"}], ",", 
                 RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "nm1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"mfromlocala1", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", "na1"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na1", "-", "1"}], "na1"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "A1", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm1", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocala2", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm2", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "1"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M1", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], "]"}]}],
               "+", 
              RowBox[{
               FractionBox["1", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", "nm1"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"nm1", "-", "1"}], "nm1"], 
                    RowBox[{"r", "[", 
                    RowBox[{"M1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                    "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A2", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M2", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}]}], ")"}]}]}], ")"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",",
            " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"nm1", "-", "1"}], "nm1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
                 RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "nm1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"mfromlocala1", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", "na1"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na1", "-", "1"}], "na1"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "A1", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                   ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm1", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocala2", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm2", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                ")"}]}]}], ")"}]}], ",", "0"}], "]"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",",
            "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}]}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
        ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na1", ",", "1", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nm1", ",", "1", ",", 
       RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na2", ",", "0", ",", 
       RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.624302371333778*^9, 3.6243024125426188`*^9}, {
   3.6243028274912653`*^9, 3.6243029055041723`*^9}, {3.6243032547992907`*^9, 
   3.624303296552454*^9}, {3.624303439665804*^9, 3.624303469793705*^9}, {
   3.624303504597529*^9, 3.624303515626656*^9}, {3.624303953275794*^9, 
   3.624303955661152*^9}, {3.62430403571349*^9, 3.624304090734439*^9}, {
   3.624304482871949*^9, 3.624304526932238*^9}, {3.6243056584888372`*^9, 
   3.62430570335483*^9}, 3.6243058598933887`*^9, {3.624306251844326*^9, 
   3.624306258941802*^9}, 3.62430629883864*^9, {3.624306332641201*^9, 
   3.624306389842059*^9}, {3.6243071876723213`*^9, 3.624307204002542*^9}, {
   3.624340070721993*^9, 3.624340104658491*^9}, {3.624340160399*^9, 
   3.624340160625435*^9}, {3.624341285683601*^9, 3.624341285857761*^9}, {
   3.624341567202887*^9, 3.624341569656107*^9}, {3.624341876347229*^9, 
   3.62434205148129*^9}, {3.624342916533228*^9, 3.624342982335129*^9}, {
   3.624343065740284*^9, 3.624343210268524*^9}, {3.624343248999522*^9, 
   3.6243432707243023`*^9}, {3.6243433014432364`*^9, 
   3.6243433718271017`*^9}, {3.6243434581143*^9, 3.624343458965274*^9}, {
   3.624343562620357*^9, 3.6243435976830997`*^9}, {3.624343732188504*^9, 
   3.624344006726016*^9}, {3.624344126581244*^9, 3.624344199386602*^9}, {
   3.6243447499158297`*^9, 3.624344840488538*^9}, {3.6243450132092943`*^9, 
   3.624345431597501*^9}, {3.624345599240451*^9, 3.6243456481965647`*^9}, {
   3.624345934839198*^9, 3.624345936876704*^9}, {3.6243459721177387`*^9, 
   3.6243462106280823`*^9}, {3.624347591537723*^9, 3.624347755722567*^9}, {
   3.624348198007516*^9, 3.6243482179264708`*^9}, {3.6243482525398912`*^9, 
   3.624348266657654*^9}, {3.62434836723208*^9, 3.624348392347834*^9}, {
   3.624350735285244*^9, 3.62435075443115*^9}, {3.6243507946082993`*^9, 
   3.624350885180558*^9}, {3.6243513356039047`*^9, 3.624351340749043*^9}, {
   3.624351668681178*^9, 3.624351669278874*^9}, {3.6243518488718348`*^9, 
   3.624351861366447*^9}, {3.624351935381558*^9, 3.624351980501761*^9}, {
   3.624352011642293*^9, 3.624352133423257*^9}, {3.624352547821821*^9, 
   3.6243525975310593`*^9}, {3.624352636178549*^9, 3.624352666408836*^9}, {
   3.6243528800667057`*^9, 3.6243528816098013`*^9}, {3.624355881047595*^9, 
   3.624356110924863*^9}, {3.624356157840003*^9, 3.624356158111594*^9}, {
   3.624356202494185*^9, 3.624356296354809*^9}, {3.624356389719812*^9, 
   3.624356580759553*^9}, {3.62435661523709*^9, 3.6243568742997627`*^9}, {
   3.624357009391694*^9, 3.624357030093951*^9}, {3.624357067486843*^9, 
   3.624357179330071*^9}, {3.624357272513235*^9, 3.624357531321918*^9}, {
   3.62435785211161*^9, 3.624357886430176*^9}, {3.624357924747765*^9, 
   3.624358034392644*^9}, {3.624358069863727*^9, 3.624358270370534*^9}, {
   3.6243590706496687`*^9, 3.6243590834029627`*^9}, {3.6243591639129877`*^9, 
   3.6243594029082212`*^9}, {3.624361102875093*^9, 3.624361103239318*^9}, 
   3.624369194685254*^9, {3.624369408285685*^9, 3.624369413229538*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Relatedness between adapted juvenile and adapted adult\
\>", "Subsection",
 CellChangeTimes->{{3.624363164646661*^9, 3.62436318040772*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ra1a2tab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{
       "A1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
       "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}], 
          RowBox[{"r", "[", 
           RowBox[{"M1", ",", "M2", ",", "es", ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]",
          "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"na1", "-", "1"}], "na1"], 
             RowBox[{"r", "[", 
              RowBox[{
              "A1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
               "na2"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["1", "na1"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"afromlocala1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocalm1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A2", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocala2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox["1", "na2"], "+", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"na2", "-", "1"}], "na2"], 
                   RowBox[{"r", "[", 
                    RowBox[{
                    "A2", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
                    "na2"}], "]"}]}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocalm2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "A2", ",", "es", ",", 
              RowBox[{"na1", "+", 
               RowBox[{"1", "nm1"}], "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "death", " ", "adapted", " ", "juvenille", " ", "on", " ", 
             "na1"}], "+", "1"}], ",", 
           RowBox[{"nm", "-", 
            RowBox[{"1", " ", "patch"}]}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["1", "na2"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "A1", ",", "es", ",", 
                 RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
                 RowBox[{"na2", "-", "1"}]}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"na2", "-", "1"}], "na2"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "A2", ",", "es", ",", 
                 RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
                 RowBox[{"na2", "-", "1"}]}], "]"}]}]}], ")"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
             " ", "na1"}], "+", "1"}], ",", 
           RowBox[{"na2", "-", 
            RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}]}], " ",
           "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}], 
          RowBox[{"r", "[", 
           RowBox[{
           "A1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
           "]"}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], " ",
           "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "1"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "A2", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", 
                 RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A2", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", "na2"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na2", "-", "1"}], "na2"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A2", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], 
                   ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], 
                ")"}]}]}], ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{
            RowBox[{
            "replaced", " ", "by", " ", "adapted", " ", "juvenile", " ", "on",
              " ", "a", " ", "na1"}], "-", "1"}], ",", 
           RowBox[{"nm1", "+", 
            RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "A2", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to", 
           " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "1"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "A2", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                 RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", "na2"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na2", "-", "1"}], "na2"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A2", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "A2", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "1"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "A2", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], "]"}]}],
               "+", 
              RowBox[{
               FractionBox["1", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", "na2"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na2", "-", "1"}], "na2"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A2", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                    "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}]}], ")"}]}]}], ")"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",",
            " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "A2", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",",
            "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}]}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
        ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na1", ",", "1", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nm1", ",", "0", ",", 
       RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na2", ",", "1", ",", 
       RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.624369430348342*^9, 3.624369453289847*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Relatedness between adapted juvenile and maladapted adult\
\>", "Subsection",
 CellChangeTimes->{{3.6243632303277617`*^9, 3.624363238699778*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ra1m2tab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{
       "A1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
       "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}], 
          RowBox[{"r", "[", 
           RowBox[{"M1", ",", "A2", ",", "es", ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]",
          "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"na1", "-", "1"}], "na1"], 
             RowBox[{"r", "[", 
              RowBox[{
              "A1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
               "na2"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["1", "na1"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"afromlocala1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocalm1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "M1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocala2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocalm2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox["1", 
                   RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], "+", 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    "n", "-", "na1", "-", "nm1", "-", "na2", "-", "1"}], 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
                   RowBox[{"r", "[", 
                    RowBox[{
                    "M2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                    "na2"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "M2", ",", "es", ",", 
              RowBox[{"na1", "+", 
               RowBox[{"1", "nm1"}], "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "death", " ", "adapted", " ", "juvenille", " ", "on", " ", 
             "na1"}], "+", "1"}], ",", 
           RowBox[{"nm", "-", 
            RowBox[{"1", " ", "patch"}]}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "M2", ",", "es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
             " ", "na1"}], "+", "1"}], ",", 
           RowBox[{"na2", "-", 
            RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}]}], " ",
           "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}], 
          RowBox[{"r", "[", 
           RowBox[{
           "A1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
           "]"}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], " ",
           "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "1"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M2", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", 
                 RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    "n", "-", "na1", "-", "nm1", "-", "na2", "-", "1"}], 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"M2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], 
                   ")"}]}]}], ")"}]}]}], ")"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{
            RowBox[{
            "replaced", " ", "by", " ", "adapted", " ", "juvenile", " ", "on",
              " ", "a", " ", "na1"}], "-", "1"}], ",", 
           RowBox[{"nm1", "+", 
            RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "-", "1"}], 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M2", ",", "es", ",", "na1", ",", 
                 RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
                 RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], ")"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to", 
           " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "1"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M2", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                 RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    "n", "-", "na1", "-", "nm1", "-", "na2", "-", "1"}], 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"M2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}]}], 
                ")"}]}]}], ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "M2", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "1"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M2", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], "]"}]}],
               "+", 
              RowBox[{
               FractionBox["1", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    "n", "-", "na1", "-", "nm1", "-", "na2", "-", "1"}], 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"M2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}]}], 
                ")"}]}]}], ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",",
            " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "M2", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",",
            "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}]}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
        ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na1", ",", "1", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nm1", ",", "0", ",", 
       RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na2", ",", "0", ",", 
       RowBox[{"n", "-", "na1", "-", "nm1", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.624302371333778*^9, 3.6243024125426188`*^9}, {
   3.6243028274912653`*^9, 3.6243029055041723`*^9}, {3.6243032547992907`*^9, 
   3.624303296552454*^9}, {3.624303439665804*^9, 3.624303469793705*^9}, {
   3.624303504597529*^9, 3.624303515626656*^9}, {3.624303953275794*^9, 
   3.624303955661152*^9}, {3.62430403571349*^9, 3.624304090734439*^9}, {
   3.624304482871949*^9, 3.624304526932238*^9}, {3.6243056584888372`*^9, 
   3.62430570335483*^9}, 3.6243058598933887`*^9, {3.624306251844326*^9, 
   3.624306258941802*^9}, 3.62430629883864*^9, {3.624306332641201*^9, 
   3.624306389842059*^9}, {3.6243071876723213`*^9, 3.624307204002542*^9}, {
   3.624340070721993*^9, 3.624340104658491*^9}, {3.624340160399*^9, 
   3.624340160625435*^9}, {3.624341285683601*^9, 3.624341285857761*^9}, {
   3.624341567202887*^9, 3.624341569656107*^9}, {3.624341876347229*^9, 
   3.62434205148129*^9}, {3.624342916533228*^9, 3.624342982335129*^9}, {
   3.624343065740284*^9, 3.624343210268524*^9}, {3.624343248999522*^9, 
   3.6243432707243023`*^9}, {3.6243433014432364`*^9, 
   3.6243433718271017`*^9}, {3.6243434581143*^9, 3.624343458965274*^9}, {
   3.624343562620357*^9, 3.6243435976830997`*^9}, {3.624343732188504*^9, 
   3.624344006726016*^9}, {3.624344126581244*^9, 3.624344199386602*^9}, {
   3.6243447499158297`*^9, 3.624344840488538*^9}, {3.6243450132092943`*^9, 
   3.624345431597501*^9}, {3.624345599240451*^9, 3.6243456481965647`*^9}, {
   3.624345934839198*^9, 3.624345936876704*^9}, {3.6243459721177387`*^9, 
   3.6243462106280823`*^9}, {3.624347591537723*^9, 3.624347755722567*^9}, {
   3.624348198007516*^9, 3.6243482179264708`*^9}, {3.6243482525398912`*^9, 
   3.624348266657654*^9}, {3.62434836723208*^9, 3.624348392347834*^9}, {
   3.624350735285244*^9, 3.62435075443115*^9}, {3.6243507946082993`*^9, 
   3.624350885180558*^9}, {3.6243513356039047`*^9, 3.624351340749043*^9}, {
   3.624351668681178*^9, 3.624351669278874*^9}, {3.6243518488718348`*^9, 
   3.624351861366447*^9}, {3.624351935381558*^9, 3.624351980501761*^9}, {
   3.624352011642293*^9, 3.624352133423257*^9}, {3.624352547821821*^9, 
   3.6243525975310593`*^9}, {3.624352636178549*^9, 3.624352666408836*^9}, {
   3.6243528800667057`*^9, 3.6243528816098013`*^9}, {3.624355881047595*^9, 
   3.624356110924863*^9}, {3.624356157840003*^9, 3.624356158111594*^9}, {
   3.624356202494185*^9, 3.624356296354809*^9}, {3.624356389719812*^9, 
   3.624356580759553*^9}, {3.62435661523709*^9, 3.6243568742997627`*^9}, {
   3.624357009391694*^9, 3.624357030093951*^9}, {3.624357067486843*^9, 
   3.624357179330071*^9}, {3.624357272513235*^9, 3.624357531321918*^9}, {
   3.62435785211161*^9, 3.624357886430176*^9}, {3.624357924747765*^9, 
   3.624358034392644*^9}, {3.624358069863727*^9, 3.624358270370534*^9}, {
   3.6243590706496687`*^9, 3.6243590834029627`*^9}, {3.6243591639129877`*^9, 
   3.6243594029082212`*^9}, {3.62435967097499*^9, 3.624359748068956*^9}, {
   3.624359835742345*^9, 3.624359921207162*^9}, {3.6243599832048798`*^9, 
   3.624359984189419*^9}, {3.624360085002398*^9, 3.624360228998149*^9}, {
   3.624360273473156*^9, 3.624360307329399*^9}, {3.6243603964807577`*^9, 
   3.6243604657025347`*^9}, {3.624360542188869*^9, 3.624360563670354*^9}, {
   3.624360606780002*^9, 3.624360610019396*^9}, {3.624360956903163*^9, 
   3.6243610034406*^9}, {3.6243610360502653`*^9, 3.624361049566495*^9}, {
   3.624361132286113*^9, 3.624361159696424*^9}, {3.624361213856702*^9, 
   3.6243613914943857`*^9}, {3.6243614218906603`*^9, 3.624361535525997*^9}, {
   3.624361622770063*^9, 3.624361640850445*^9}, {3.624361758854197*^9, 
   3.624361759194154*^9}, {3.624361792771669*^9, 3.6243618091382236`*^9}, {
   3.6243618498434963`*^9, 3.6243619325824347`*^9}, {3.6243620301821737`*^9, 
   3.624362101384323*^9}, {3.624362131730844*^9, 3.624362239927814*^9}, {
   3.624362344922744*^9, 3.62436235350001*^9}, {3.624362409519112*^9, 
   3.624362409785557*^9}, {3.624369468596389*^9, 3.624369501450274*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Relatedness between pairs of maladapted juveniles\
\>", "Subsection",
 CellChangeTimes->{{3.62436327019763*^9, 3.6243632806977797`*^9}}],

Cell[BoxData[
 RowBox[{"rm1m1tab", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{
      "M1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}],
      "\[Equal]", 
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"3", "-", "es"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}], 
         RowBox[{"r", "[", 
          RowBox[{"A1", ",", "A1", ",", "es", ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"na1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"r", "[", 
          RowBox[{
          "M1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "+", "1"}], ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"nm1", "-", "2"}], "nm1"], 
              RowBox[{"r", "[", 
               RowBox[{"M1", ",", "M1", ",", "es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
             RowBox[{
              FractionBox["2", "nm1"], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"mfromlocala1", "[", 
                  RowBox[{"es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"A1", ",", "M1", ",", "es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm1", "[", 
                  RowBox[{"es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["1", 
                    RowBox[{"nm1", "-", "1"}]], "+", 
                   RowBox[{
                    FractionBox[
                    RowBox[{"nm1", "-", "2"}], 
                    RowBox[{"nm1", "-", "1"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"M1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                  ")"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocala2", "[", 
                  RowBox[{"es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"M1", ",", "A2", ",", "es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm2", "[", 
                  RowBox[{"es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"M1", ",", "M2", ",", "es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
               ")"}]}]}], ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "death", " ", "adapted", " ", "juvenille", " ", "on", " ", "na1"}],
            "+", 
           RowBox[{"1", " ", "patch"}]}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M1", ",", "M1", ",", "es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
           " ", "na1"}], "+", 
          RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"nm1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}]}], 
          ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"nm1", "-", "2"}], "nm1"], 
            RowBox[{"r", "[", 
             RowBox[{
             "M1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}],
              "]"}]}], "+", 
           RowBox[{
            FractionBox["2", "nm1"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"mfromlocala1", "[", 
                RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
               RowBox[{"r", "[", 
                RowBox[{
                "A1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
                 "na2"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"mfromlocalm1", "[", 
                RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 FractionBox["1", "nm1"], "+", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"nm1", "-", "1"}], "nm1"], 
                  RowBox[{"r", "[", 
                   RowBox[{
                   "M1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
                    "na2"}], "]"}]}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"mfromlocala2", "[", 
                RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
               RowBox[{"r", "[", 
                RowBox[{
                "A2", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
                 "na2"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"mfromlocalm2", "[", 
                RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
               RowBox[{"r", "[", 
                RowBox[{
                "M2", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
                 "na2"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M1", ",", "M1", ",", "es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "juvenile"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"n", "-", "na1", "-", 
             RowBox[{"(", 
              RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
            "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
            "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M1", ",", "M1", ",", "es", ",", "na1", ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to", 
          " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M1", ",", "M1", ",", "es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", "na1", "-", 
                RowBox[{"(", 
                 RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"nm1", "-", "2"}], "nm1"], 
              RowBox[{"r", "[", 
               RowBox[{"M1", ",", "M1", ",", "es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
             RowBox[{
              FractionBox["2", "nm1"], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"mfromlocala1", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm1", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["1", 
                    RowBox[{"nm1", "-", "1"}]], "+", 
                   RowBox[{
                    FractionBox[
                    RowBox[{"nm1", "-", "2"}], 
                    RowBox[{"nm1", "-", "1"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"M1", ",", "M1", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocala2", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"M1", ",", "A2", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocal", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"M2", ",", "M1", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}]}], ")"}]}],
           ",", "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"(", 
              RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
             "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M1", ",", "M1", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], "]"}]}], 
          ",", "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
            ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
              "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"nm1", "-", "2"}], "nm1"], 
              RowBox[{"r", "[", 
               RowBox[{"M1", ",", "M1", ",", "es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
             RowBox[{
              FractionBox["2", "nm1"], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"mfromlocala1", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm1", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["1", 
                    RowBox[{"nm1", "-", "1"}]], "+", 
                   RowBox[{
                    FractionBox[
                    RowBox[{"nm1", "-", "2"}], "nm1"], 
                    RowBox[{"r", "[", 
                    RowBox[{"M1", ",", "M1", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                  ")"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocala2", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"A2", ",", "M1", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm2", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"M1", ",", "M2", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
               ")"}]}]}], ")"}]}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
         " ", 
         RowBox[{
         "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"3", "-", "es"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"na1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "+", "1"}], ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
            ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"nm1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}]}], 
          ")"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}]}], ",",
           "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", "na1", "-", 
                RowBox[{"(", 
                 RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",", 
          "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"(", 
              RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
             "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
            ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
              "]"}]}], ")"}]}], ",", "0"}], "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"na1", ",", "2", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"nm1", ",", "0", ",", 
      RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"na2", ",", "0", ",", 
      RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.624302371333778*^9, 3.6243024125426188`*^9}, {
   3.6243028274912653`*^9, 3.6243029055041723`*^9}, {3.6243032547992907`*^9, 
   3.624303296552454*^9}, {3.624303439665804*^9, 3.624303469793705*^9}, {
   3.624303504597529*^9, 3.624303515626656*^9}, {3.624303953275794*^9, 
   3.624303955661152*^9}, {3.62430403571349*^9, 3.624304090734439*^9}, {
   3.624304482871949*^9, 3.624304526932238*^9}, {3.6243056584888372`*^9, 
   3.62430570335483*^9}, 3.6243058598933887`*^9, {3.624306251844326*^9, 
   3.624306258941802*^9}, 3.62430629883864*^9, {3.624306332641201*^9, 
   3.624306389842059*^9}, {3.6243071876723213`*^9, 3.624307204002542*^9}, {
   3.624340070721993*^9, 3.624340104658491*^9}, {3.624340160399*^9, 
   3.624340160625435*^9}, {3.624341285683601*^9, 3.624341285857761*^9}, {
   3.624341567202887*^9, 3.624341569656107*^9}, {3.624341876347229*^9, 
   3.62434205148129*^9}, {3.624342916533228*^9, 3.624342982335129*^9}, {
   3.624343065740284*^9, 3.624343210268524*^9}, {3.624343248999522*^9, 
   3.6243432707243023`*^9}, {3.6243433014432364`*^9, 
   3.6243433718271017`*^9}, {3.6243434581143*^9, 3.624343458965274*^9}, {
   3.624343562620357*^9, 3.6243435976830997`*^9}, {3.624343732188504*^9, 
   3.624344006726016*^9}, {3.624344126581244*^9, 3.624344199386602*^9}, {
   3.6243447499158297`*^9, 3.624344840488538*^9}, {3.6243450132092943`*^9, 
   3.624345431597501*^9}, {3.624345599240451*^9, 3.6243456481965647`*^9}, {
   3.624345934839198*^9, 3.624345936876704*^9}, {3.6243459721177387`*^9, 
   3.6243462106280823`*^9}, {3.624347591537723*^9, 3.624347755722567*^9}, {
   3.624348198007516*^9, 3.6243482179264708`*^9}, {3.6243482525398912`*^9, 
   3.624348266657654*^9}, {3.624356895198255*^9, 3.624356918300398*^9}, {
   3.6243569521886263`*^9, 3.624356985457391*^9}, {3.624362511601883*^9, 
   3.624362524663512*^9}, {3.6243629570932207`*^9, 3.624362965225898*^9}, {
   3.624362999416973*^9, 3.624363055290331*^9}, {3.624363315124364*^9, 
   3.624363402036727*^9}, {3.624363434051179*^9, 3.624363499650799*^9}, {
   3.624363548854782*^9, 3.624363555411622*^9}, {3.6243636047973747`*^9, 
   3.6243637909266777`*^9}, {3.624363821741766*^9, 3.624363941623722*^9}, {
   3.624363992340425*^9, 3.624364027986538*^9}, {3.624364249534594*^9, 
   3.6243643148423223`*^9}, {3.624364357296321*^9, 3.624364631220211*^9}, {
   3.624365338648443*^9, 3.624365353148354*^9}, {3.624365442901268*^9, 
   3.624365455749531*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Relatedness between maladapted juvenile and adapted adult\
\>", "Subsection",
 CellChangeTimes->{{3.62436466326877*^9, 3.6243646721393538`*^9}}],

Cell[BoxData[
 RowBox[{"rm1a2tab", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{
      "M1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}],
      "\[Equal]", 
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"3", "-", "es"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}], 
         RowBox[{"r", "[", 
          RowBox[{"A1", ",", "M2", ",", "es", ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"na1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"r", "[", 
          RowBox[{
          "M1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "+", "1"}], ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"nm1", "-", "1"}], "nm1"], 
              RowBox[{"r", "[", 
               RowBox[{"M1", ",", "A2", ",", "es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
             RowBox[{
              FractionBox["1", "nm1"], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"mfromlocala1", "[", 
                  RowBox[{"es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"A1", ",", "A2", ",", "es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm1", "[", 
                  RowBox[{"es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"M1", ",", "A2", ",", "es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocala2", "[", 
                  RowBox[{"es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["1", "na2"], "+", 
                   RowBox[{
                    FractionBox[
                    RowBox[{"na2", "-", "1"}], "na2"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A2", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                  ")"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm2", "[", 
                  RowBox[{"es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"A2", ",", "M2", ",", "es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
               ")"}]}]}], ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "death", " ", "adapted", " ", "juvenille", " ", "on", " ", "na1"}],
            "+", 
           RowBox[{"1", " ", "patch"}]}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["1", "na2"], 
              RowBox[{"r", "[", 
               RowBox[{"A1", ",", "M1", ",", 
                RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
                RowBox[{"na2", "-", "1"}]}], "]"}]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"na2", "-", "1"}], "na2"], 
              RowBox[{"r", "[", 
               RowBox[{"M1", ",", "A2", ",", 
                RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
                RowBox[{"na2", "-", "1"}]}], "]"}]}]}], ")"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
           " ", "na1"}], "+", 
          RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"nm1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}]}], 
          ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"nm1", "-", "1"}], "nm1"], 
            RowBox[{"r", "[", 
             RowBox[{
             "M1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}],
              "]"}]}], "+", 
           RowBox[{
            FractionBox["1", "nm1"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"mfromlocala1", "[", 
                RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
               RowBox[{"r", "[", 
                RowBox[{
                "A1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
                 "na2"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"mfromlocalm1", "[", 
                RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
               RowBox[{"r", "[", 
                RowBox[{
                "M1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
                 "na2"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"mfromlocala2", "[", 
                RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 FractionBox["1", "na2"], "+", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"na2", "-", "1"}], "na2"], 
                  RowBox[{"r", "[", 
                   RowBox[{
                   "A2", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
                    "na2"}], "]"}]}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"mfromlocalm2", "[", 
                RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
               RowBox[{"r", "[", 
                RowBox[{
                "M1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
                 "na2"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M1", ",", "A2", ",", "es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "juvenile"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"n", "-", "na1", "-", 
             RowBox[{"(", 
              RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
            "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
            "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M1", ",", "A2", ",", "es", ",", "na1", ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to", 
          " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M1", ",", "A2", ",", "es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", "na1", "-", 
                RowBox[{"(", 
                 RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"nm1", "-", "1"}], "nm1"], 
              RowBox[{"r", "[", 
               RowBox[{"M1", ",", "A2", ",", "es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
             RowBox[{
              FractionBox["1", "nm1"], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"mfromlocala1", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"A1", ",", "A2", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm1", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"M1", ",", "A2", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocala2", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["1", "na2"], "+", 
                   RowBox[{
                    FractionBox[
                    RowBox[{"na2", "-", "1"}], "na2"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A2", ",", "A2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocal", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"M2", ",", "A2", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}]}], ")"}]}],
           ",", "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"(", 
              RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
             "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M1", ",", "A2", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], "]"}]}], 
          ",", "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
            ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
              "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"nm1", "-", "1"}], "nm1"], 
              RowBox[{"r", "[", 
               RowBox[{"M1", ",", "A2", ",", "es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
             RowBox[{
              FractionBox["1", "nm1"], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"mfromlocala1", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"A1", ",", "A2", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm1", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"M1", ",", "A2", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocala2", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["1", "na2"], "+", 
                   RowBox[{
                    FractionBox[
                    RowBox[{"na2", "-", "1"}], "na2"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A2", ",", "A2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                  ")"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm2", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"A2", ",", "M2", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
               ")"}]}]}], ")"}]}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
         " ", 
         RowBox[{
         "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"3", "-", "es"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"na1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "+", "1"}], ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
            ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"nm1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}]}], 
          ")"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}]}], ",",
           "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", "na1", "-", 
                RowBox[{"(", 
                 RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",", 
          "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"(", 
              RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
             "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
            ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
              "]"}]}], ")"}]}], ",", "0"}], "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"na1", ",", "2", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"nm1", ",", "0", ",", 
      RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"na2", ",", "0", ",", 
      RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.624302371333778*^9, 3.6243024125426188`*^9}, {
   3.6243028274912653`*^9, 3.6243029055041723`*^9}, {3.6243032547992907`*^9, 
   3.624303296552454*^9}, {3.624303439665804*^9, 3.624303469793705*^9}, {
   3.624303504597529*^9, 3.624303515626656*^9}, {3.624303953275794*^9, 
   3.624303955661152*^9}, {3.62430403571349*^9, 3.624304090734439*^9}, {
   3.624304482871949*^9, 3.624304526932238*^9}, {3.6243056584888372`*^9, 
   3.62430570335483*^9}, 3.6243058598933887`*^9, {3.624306251844326*^9, 
   3.624306258941802*^9}, 3.62430629883864*^9, {3.624306332641201*^9, 
   3.624306389842059*^9}, {3.6243071876723213`*^9, 3.624307204002542*^9}, {
   3.624340070721993*^9, 3.624340104658491*^9}, {3.624340160399*^9, 
   3.624340160625435*^9}, {3.624341285683601*^9, 3.624341285857761*^9}, {
   3.624341567202887*^9, 3.624341569656107*^9}, {3.624341876347229*^9, 
   3.62434205148129*^9}, {3.624342916533228*^9, 3.624342982335129*^9}, {
   3.624343065740284*^9, 3.624343210268524*^9}, {3.624343248999522*^9, 
   3.6243432707243023`*^9}, {3.6243433014432364`*^9, 
   3.6243433718271017`*^9}, {3.6243434581143*^9, 3.624343458965274*^9}, {
   3.624343562620357*^9, 3.6243435976830997`*^9}, {3.624343732188504*^9, 
   3.624344006726016*^9}, {3.624344126581244*^9, 3.624344199386602*^9}, {
   3.6243447499158297`*^9, 3.624344840488538*^9}, {3.6243450132092943`*^9, 
   3.624345431597501*^9}, {3.624345599240451*^9, 3.6243456481965647`*^9}, {
   3.624345934839198*^9, 3.624345936876704*^9}, {3.6243459721177387`*^9, 
   3.6243462106280823`*^9}, {3.624347591537723*^9, 3.624347755722567*^9}, {
   3.624348198007516*^9, 3.6243482179264708`*^9}, {3.6243482525398912`*^9, 
   3.624348266657654*^9}, {3.624356895198255*^9, 3.624356918300398*^9}, {
   3.6243569521886263`*^9, 3.624356985457391*^9}, {3.624362511601883*^9, 
   3.624362524663512*^9}, {3.6243629570932207`*^9, 3.624362965225898*^9}, {
   3.624362999416973*^9, 3.624363055290331*^9}, {3.624363315124364*^9, 
   3.624363402036727*^9}, {3.624363434051179*^9, 3.624363499650799*^9}, {
   3.624363548854782*^9, 3.624363555411622*^9}, {3.6243636047973747`*^9, 
   3.6243637909266777`*^9}, {3.624363821741766*^9, 3.624363941623722*^9}, {
   3.624363992340425*^9, 3.624364027986538*^9}, {3.624364249534594*^9, 
   3.6243643148423223`*^9}, {3.624364357296321*^9, 3.6243647366403418`*^9}, {
   3.6243649824426937`*^9, 3.624365023268116*^9}, {3.6243650617884912`*^9, 
   3.62436509662251*^9}, {3.624365149222931*^9, 3.6243652275747147`*^9}, {
   3.624365302977343*^9, 3.624365315159102*^9}, {3.624365416099092*^9, 
   3.6243654319346437`*^9}, {3.6243654690108757`*^9, 3.624365557361085*^9}, {
   3.62436561571834*^9, 3.6243656160523243`*^9}, {3.624365661662487*^9, 
   3.624365883055266*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Relatedness between maladapted juvenile and maladapted adult\
\>", "Subsection",
 CellChangeTimes->{{3.62436466326877*^9, 3.6243646721393538`*^9}, {
  3.624366032083535*^9, 3.624366032338337*^9}}],

Cell[BoxData[
 RowBox[{"rm1m2tab", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{
      "M1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}],
      "\[Equal]", 
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"3", "-", "es"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}], 
         RowBox[{"r", "[", 
          RowBox[{"A1", ",", "A2", ",", "es", ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"na1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"r", "[", 
          RowBox[{
          "M1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "+", "1"}], ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"nm1", "-", "1"}], "nm1"], 
              RowBox[{"r", "[", 
               RowBox[{"M1", ",", "M2", ",", "es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
             RowBox[{
              FractionBox["1", "nm1"], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"mfromlocala1", "[", 
                  RowBox[{"es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"A1", ",", "M2", ",", "es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm1", "[", 
                  RowBox[{"es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"M1", ",", "M2", ",", "es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocala2", "[", 
                  RowBox[{"es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"A2", ",", "M2", ",", "es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm2", "[", 
                  RowBox[{"es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["1", 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], "+", 
                   RowBox[{
                    FractionBox[
                    RowBox[{
                    "n", "-", "na1", "-", "nm1", "-", "na2", "-", "1"}], 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"M2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                  ")"}]}]}], ")"}]}]}], ")"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "death", " ", "adapted", " ", "juvenille", " ", "on", " ", "na1"}],
            "+", 
           RowBox[{"1", " ", "patch"}]}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M1", ",", "M2", ",", "es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
           " ", "na1"}], "+", 
          RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"nm1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}]}], 
          ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"nm1", "-", "1"}], "nm1"], 
            RowBox[{"r", "[", 
             RowBox[{
             "M1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}],
              "]"}]}], "+", 
           RowBox[{
            FractionBox["1", "nm1"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"mfromlocala1", "[", 
                RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
               RowBox[{"r", "[", 
                RowBox[{
                "A1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                 "na2"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"mfromlocalm1", "[", 
                RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
               RowBox[{"r", "[", 
                RowBox[{
                "M1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                 "na2"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"mfromlocala2", "[", 
                RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
               RowBox[{"r", "[", 
                RowBox[{
                "A2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                 "na2"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"mfromlocalm2", "[", 
                RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 FractionBox["1", 
                  RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], "+", 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                   "n", "-", "na1", "-", "nm1", "-", "na2", "-", "1"}], 
                   RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
                  RowBox[{"r", "[", 
                   RowBox[{
                   "M2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                    "na2"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M1", ",", "M2", ",", "es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "juvenile"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"n", "-", "na1", "-", 
             RowBox[{"(", 
              RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
            "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["1", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
              RowBox[{"r", "[", 
               RowBox[{"M1", ",", "M1", ",", "es", ",", "na1", ",", 
                RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "-", "1"}], 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
              RowBox[{"r", "[", 
               RowBox[{"M1", ",", "M2", ",", "es", ",", "na1", ",", 
                RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], ")"}]}], 
          ",", "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to", 
          " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M1", ",", "M2", ",", "es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", "na1", "-", 
                RowBox[{"(", 
                 RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"nm1", "-", "1"}], "nm1"], 
              RowBox[{"r", "[", 
               RowBox[{"M1", ",", "M2", ",", "es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
             RowBox[{
              FractionBox["1", "nm1"], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"mfromlocala1", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"A1", ",", "M2", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm1", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"M1", ",", "M2", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocala2", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"A2", ",", "M2", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm2", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["1", 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], "+", 
                   RowBox[{
                    FractionBox[
                    RowBox[{
                    "n", "-", "na1", "-", "nm1", "-", "na2", "-", "1"}], 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"M2", ",", "M2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}]}], 
               ")"}]}]}], ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"(", 
              RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
             "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M1", ",", "M2", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], "]"}]}], 
          ",", "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
            ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
              "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"nm1", "-", "1"}], "nm1"], 
              RowBox[{"r", "[", 
               RowBox[{"M1", ",", "M2", ",", "es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
             RowBox[{
              FractionBox["1", "nm1"], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"mfromlocala1", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"A1", ",", "M2", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm1", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"M1", ",", "M2", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocala2", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"M1", ",", "A2", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm2", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["1", 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], "+", 
                   RowBox[{
                    FractionBox[
                    RowBox[{
                    "n", "-", "na1", "-", "nm1", "-", "na2", "-", "1"}], 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"M2", ",", "M2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                  ")"}]}]}], ")"}]}]}], ")"}]}], ",", "0"}], "]"}]}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
         " ", 
         RowBox[{
         "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"3", "-", "es"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"na1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "+", "1"}], ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
            ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"nm1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}]}], 
          ")"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}]}], ",",
           "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", "na1", "-", 
                RowBox[{"(", 
                 RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",", 
          "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"(", 
              RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
             "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
            ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
              "]"}]}], ")"}]}], ",", "0"}], "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"na1", ",", "2", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"nm1", ",", "0", ",", 
      RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"na2", ",", "0", ",", 
      RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.624302371333778*^9, 3.6243024125426188`*^9}, {
   3.6243028274912653`*^9, 3.6243029055041723`*^9}, {3.6243032547992907`*^9, 
   3.624303296552454*^9}, {3.624303439665804*^9, 3.624303469793705*^9}, {
   3.624303504597529*^9, 3.624303515626656*^9}, {3.624303953275794*^9, 
   3.624303955661152*^9}, {3.62430403571349*^9, 3.624304090734439*^9}, {
   3.624304482871949*^9, 3.624304526932238*^9}, {3.6243056584888372`*^9, 
   3.62430570335483*^9}, 3.6243058598933887`*^9, {3.624306251844326*^9, 
   3.624306258941802*^9}, 3.62430629883864*^9, {3.624306332641201*^9, 
   3.624306389842059*^9}, {3.6243071876723213`*^9, 3.624307204002542*^9}, {
   3.624340070721993*^9, 3.624340104658491*^9}, {3.624340160399*^9, 
   3.624340160625435*^9}, {3.624341285683601*^9, 3.624341285857761*^9}, {
   3.624341567202887*^9, 3.624341569656107*^9}, {3.624341876347229*^9, 
   3.62434205148129*^9}, {3.624342916533228*^9, 3.624342982335129*^9}, {
   3.624343065740284*^9, 3.624343210268524*^9}, {3.624343248999522*^9, 
   3.6243432707243023`*^9}, {3.6243433014432364`*^9, 
   3.6243433718271017`*^9}, {3.6243434581143*^9, 3.624343458965274*^9}, {
   3.624343562620357*^9, 3.6243435976830997`*^9}, {3.624343732188504*^9, 
   3.624344006726016*^9}, {3.624344126581244*^9, 3.624344199386602*^9}, {
   3.6243447499158297`*^9, 3.624344840488538*^9}, {3.6243450132092943`*^9, 
   3.624345431597501*^9}, {3.624345599240451*^9, 3.6243456481965647`*^9}, {
   3.624345934839198*^9, 3.624345936876704*^9}, {3.6243459721177387`*^9, 
   3.6243462106280823`*^9}, {3.624347591537723*^9, 3.624347755722567*^9}, {
   3.624348198007516*^9, 3.6243482179264708`*^9}, {3.6243482525398912`*^9, 
   3.624348266657654*^9}, {3.624356895198255*^9, 3.624356918300398*^9}, {
   3.6243569521886263`*^9, 3.624356985457391*^9}, {3.624362511601883*^9, 
   3.624362524663512*^9}, {3.6243629570932207`*^9, 3.624362965225898*^9}, {
   3.624362999416973*^9, 3.624363055290331*^9}, {3.624363315124364*^9, 
   3.624363402036727*^9}, {3.624363434051179*^9, 3.624363499650799*^9}, {
   3.624363548854782*^9, 3.624363555411622*^9}, {3.6243636047973747`*^9, 
   3.6243637909266777`*^9}, {3.624363821741766*^9, 3.624363941623722*^9}, {
   3.624363992340425*^9, 3.624364027986538*^9}, {3.624364249534594*^9, 
   3.6243643148423223`*^9}, {3.624364357296321*^9, 3.6243647366403418`*^9}, {
   3.6243649824426937`*^9, 3.624365023268116*^9}, {3.6243650617884912`*^9, 
   3.62436509662251*^9}, {3.624365149222931*^9, 3.6243652275747147`*^9}, {
   3.624365302977343*^9, 3.624365315159102*^9}, {3.624365416099092*^9, 
   3.6243654319346437`*^9}, {3.6243654690108757`*^9, 3.624365557361085*^9}, {
   3.62436561571834*^9, 3.6243656160523243`*^9}, {3.624365661662487*^9, 
   3.624365883055266*^9}, {3.624366040363915*^9, 3.624366145705874*^9}, {
   3.6243662187414017`*^9, 3.6243664601487837`*^9}, {3.6243665656635103`*^9, 
   3.624366636837788*^9}, {3.6243666684744577`*^9, 3.6243666816067*^9}, 
   3.624366730589622*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Relatedness between pairs of adapted adults\
\>", "Subsection",
 CellChangeTimes->{{3.624366750377925*^9, 3.624366757417934*^9}}],

Cell[BoxData[
 RowBox[{"ra2a2tab", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{
      "A2", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}],
      "\[Equal]", 
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"3", "-", "es"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}], 
         RowBox[{"r", "[", 
          RowBox[{"M2", ",", "M2", ",", "es", ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"na1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"r", "[", 
          RowBox[{
          "A2", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "+", "1"}], ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
            ")"}], 
           RowBox[{"r", "[", 
            RowBox[{"A2", ",", "A2", ",", 
             RowBox[{"na1", "+", "1"}], ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "death", " ", "adapted", " ", "juvenille", " ", "on", " ", "na1"}],
            "+", 
           RowBox[{"1", " ", "patch"}]}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["2", "na2"], 
              RowBox[{"r", "[", 
               RowBox[{"A1", ",", "A2", ",", "es", ",", 
                RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
                RowBox[{"na2", "-", "1"}]}], "]"}]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"na2", "-", "2"}], "na2"], 
              RowBox[{"r", "[", 
               RowBox[{"A2", ",", "A2", ",", "es", ",", 
                RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
                RowBox[{"na2", "-", "1"}]}], "]"}]}]}], ")"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
           " ", "na1"}], "+", 
          RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"nm1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}]}], 
          ")"}], 
         RowBox[{"r", "[", 
          RowBox[{
          "A2", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"A2", ",", "A2", ",", "es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "juvenile"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"n", "-", "na1", "-", 
             RowBox[{"(", 
              RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
            "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
            "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"A2", ",", "A2", ",", "es", ",", "na1", ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to", 
          " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"A2", ",", "A2", ",", "es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", "na1", "-", 
                RowBox[{"(", 
                 RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
           RowBox[{"r", "[", 
            RowBox[{"A2", ",", "A2", ",", "es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", 
             RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"(", 
              RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
             "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"A2", ",", "A2", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], "]"}]}], 
          ",", "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
            ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
              "]"}]}], ")"}], 
           RowBox[{"r", "[", 
            RowBox[{"A2", ",", "A2", ",", "es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
         "]"}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
         " ", 
         RowBox[{
         "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"3", "-", "es"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"na1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "+", "1"}], ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
            ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"nm1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}]}], 
          ")"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}]}], ",",
           "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", "na1", "-", 
                RowBox[{"(", 
                 RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",", 
          "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"(", 
              RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
             "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
            ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
              "]"}]}], ")"}]}], ",", "0"}], "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"na1", ",", "2", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"nm1", ",", "0", ",", 
      RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"na2", ",", "0", ",", 
      RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.624302371333778*^9, 3.6243024125426188`*^9}, {
   3.6243028274912653`*^9, 3.6243029055041723`*^9}, {3.6243032547992907`*^9, 
   3.624303296552454*^9}, {3.624303439665804*^9, 3.624303469793705*^9}, {
   3.624303504597529*^9, 3.624303515626656*^9}, {3.624303953275794*^9, 
   3.624303955661152*^9}, {3.62430403571349*^9, 3.624304090734439*^9}, {
   3.624304482871949*^9, 3.624304526932238*^9}, {3.6243056584888372`*^9, 
   3.62430570335483*^9}, 3.6243058598933887`*^9, {3.624306251844326*^9, 
   3.624306258941802*^9}, 3.62430629883864*^9, {3.624306332641201*^9, 
   3.624306389842059*^9}, {3.6243071876723213`*^9, 3.624307204002542*^9}, {
   3.624340070721993*^9, 3.624340104658491*^9}, {3.624340160399*^9, 
   3.624340160625435*^9}, {3.624341285683601*^9, 3.624341285857761*^9}, {
   3.624341567202887*^9, 3.624341569656107*^9}, {3.624341876347229*^9, 
   3.62434205148129*^9}, {3.624342916533228*^9, 3.624342982335129*^9}, {
   3.624343065740284*^9, 3.624343210268524*^9}, {3.624343248999522*^9, 
   3.6243432707243023`*^9}, {3.6243433014432364`*^9, 
   3.6243433718271017`*^9}, {3.6243434581143*^9, 3.624343458965274*^9}, {
   3.624343562620357*^9, 3.6243435976830997`*^9}, {3.624343732188504*^9, 
   3.624344006726016*^9}, {3.624344126581244*^9, 3.624344199386602*^9}, {
   3.6243447499158297`*^9, 3.624344840488538*^9}, {3.6243450132092943`*^9, 
   3.624345431597501*^9}, {3.624345599240451*^9, 3.6243456481965647`*^9}, {
   3.624345934839198*^9, 3.624345936876704*^9}, {3.6243459721177387`*^9, 
   3.6243462106280823`*^9}, {3.624347591537723*^9, 3.624347755722567*^9}, {
   3.624348198007516*^9, 3.6243482179264708`*^9}, {3.6243482525398912`*^9, 
   3.624348266657654*^9}, {3.624356895198255*^9, 3.624356918300398*^9}, {
   3.6243569521886263`*^9, 3.624356985457391*^9}, {3.624362511601883*^9, 
   3.624362524663512*^9}, {3.6243629570932207`*^9, 3.624362965225898*^9}, {
   3.624362999416973*^9, 3.624363055290331*^9}, {3.624363315124364*^9, 
   3.624363402036727*^9}, {3.624363434051179*^9, 3.624363499650799*^9}, {
   3.624363548854782*^9, 3.624363555411622*^9}, {3.6243636047973747`*^9, 
   3.6243637909266777`*^9}, {3.624363821741766*^9, 3.624363941623722*^9}, {
   3.624363992340425*^9, 3.624364027986538*^9}, {3.624364249534594*^9, 
   3.6243643148423223`*^9}, {3.624364357296321*^9, 3.6243647366403418`*^9}, {
   3.6243649824426937`*^9, 3.624365023268116*^9}, {3.6243650617884912`*^9, 
   3.62436509662251*^9}, {3.624365149222931*^9, 3.6243652275747147`*^9}, {
   3.624365302977343*^9, 3.624365315159102*^9}, {3.624365416099092*^9, 
   3.6243654319346437`*^9}, {3.6243654690108757`*^9, 3.624365557361085*^9}, {
   3.62436561571834*^9, 3.6243656160523243`*^9}, {3.624365661662487*^9, 
   3.624365883055266*^9}, {3.624366040363915*^9, 3.624366145705874*^9}, {
   3.6243662187414017`*^9, 3.6243664601487837`*^9}, {3.6243665656635103`*^9, 
   3.624366636837788*^9}, {3.6243666684744577`*^9, 3.6243666816067*^9}, 
   3.624366730589622*^9, {3.624366806271656*^9, 3.62436682995068*^9}, {
   3.624366860346286*^9, 3.62436686068569*^9}, {3.624366891052558*^9, 
   3.624367016358869*^9}, {3.624367058197258*^9, 3.6243670685455236`*^9}, {
   3.624367319326849*^9, 3.6243674237340403`*^9}, {3.624367468866968*^9, 
   3.624367491357793*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Relatedness between adapted and maladapted adults\
\>", "Subsection",
 CellChangeTimes->{{3.624366750377925*^9, 3.624366757417934*^9}, {
  3.6243675089734163`*^9, 3.624367515533433*^9}}],

Cell[BoxData[
 RowBox[{"ra2a2tab", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{
      "A2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}],
      "\[Equal]", 
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"3", "-", "es"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}], 
         RowBox[{"r", "[", 
          RowBox[{"A2", ",", "M2", ",", "es", ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"na1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"r", "[", 
          RowBox[{
          "A2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "+", "1"}], ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
            ")"}], 
           RowBox[{"r", "[", 
            RowBox[{"A2", ",", "M2", ",", 
             RowBox[{"na1", "+", "1"}], ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "death", " ", "adapted", " ", "juvenille", " ", "on", " ", "na1"}],
            "+", 
           RowBox[{"1", " ", "patch"}]}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["1", "na2"], 
              RowBox[{"r", "[", 
               RowBox[{"A1", ",", "M2", ",", "es", ",", 
                RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
                RowBox[{"na2", "-", "1"}]}], "]"}]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"na2", "-", "1"}], "na2"], 
              RowBox[{"r", "[", 
               RowBox[{"A2", ",", "M2", ",", "es", ",", 
                RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
                RowBox[{"na2", "-", "1"}]}], "]"}]}]}], ")"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
           " ", "na1"}], "+", 
          RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"nm1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}]}], 
          ")"}], 
         RowBox[{"r", "[", 
          RowBox[{
          "A2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"A2", ",", "M2", ",", "es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "juvenile"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"n", "-", "na1", "-", 
             RowBox[{"(", 
              RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
            "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["1", "nm1"], 
              RowBox[{"r", "[", 
               RowBox[{"M1", ",", "A2", ",", "es", ",", "na1", ",", 
                RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"nm1", "-", "1"}], "nm1"], 
              RowBox[{"r", "[", 
               RowBox[{"A2", ",", "M2", ",", "es", ",", "na1", ",", 
                RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], ")"}]}], 
          ",", "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to", 
          " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"A2", ",", "M2", ",", "es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", "na1", "-", 
                RowBox[{"(", 
                 RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
           RowBox[{"r", "[", 
            RowBox[{"A2", ",", "M2", ",", "es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", 
             RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"(", 
              RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
             "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"A2", ",", "M2", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], "]"}]}], 
          ",", "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
            ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
              "]"}]}], ")"}], 
           RowBox[{"r", "[", 
            RowBox[{"A2", ",", "M2", ",", "es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
         "]"}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
         " ", 
         RowBox[{
         "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"3", "-", "es"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"na1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "+", "1"}], ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
            ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"nm1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}]}], 
          ")"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}]}], ",",
           "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", "na1", "-", 
                RowBox[{"(", 
                 RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",", 
          "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"(", 
              RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
             "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
            ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
              "]"}]}], ")"}]}], ",", "0"}], "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"na1", ",", "2", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"nm1", ",", "0", ",", 
      RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"na2", ",", "0", ",", 
      RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.624302371333778*^9, 3.6243024125426188`*^9}, {
   3.6243028274912653`*^9, 3.6243029055041723`*^9}, {3.6243032547992907`*^9, 
   3.624303296552454*^9}, {3.624303439665804*^9, 3.624303469793705*^9}, {
   3.624303504597529*^9, 3.624303515626656*^9}, {3.624303953275794*^9, 
   3.624303955661152*^9}, {3.62430403571349*^9, 3.624304090734439*^9}, {
   3.624304482871949*^9, 3.624304526932238*^9}, {3.6243056584888372`*^9, 
   3.62430570335483*^9}, 3.6243058598933887`*^9, {3.624306251844326*^9, 
   3.624306258941802*^9}, 3.62430629883864*^9, {3.624306332641201*^9, 
   3.624306389842059*^9}, {3.6243071876723213`*^9, 3.624307204002542*^9}, {
   3.624340070721993*^9, 3.624340104658491*^9}, {3.624340160399*^9, 
   3.624340160625435*^9}, {3.624341285683601*^9, 3.624341285857761*^9}, {
   3.624341567202887*^9, 3.624341569656107*^9}, {3.624341876347229*^9, 
   3.62434205148129*^9}, {3.624342916533228*^9, 3.624342982335129*^9}, {
   3.624343065740284*^9, 3.624343210268524*^9}, {3.624343248999522*^9, 
   3.6243432707243023`*^9}, {3.6243433014432364`*^9, 
   3.6243433718271017`*^9}, {3.6243434581143*^9, 3.624343458965274*^9}, {
   3.624343562620357*^9, 3.6243435976830997`*^9}, {3.624343732188504*^9, 
   3.624344006726016*^9}, {3.624344126581244*^9, 3.624344199386602*^9}, {
   3.6243447499158297`*^9, 3.624344840488538*^9}, {3.6243450132092943`*^9, 
   3.624345431597501*^9}, {3.624345599240451*^9, 3.6243456481965647`*^9}, {
   3.624345934839198*^9, 3.624345936876704*^9}, {3.6243459721177387`*^9, 
   3.6243462106280823`*^9}, {3.624347591537723*^9, 3.624347755722567*^9}, {
   3.624348198007516*^9, 3.6243482179264708`*^9}, {3.6243482525398912`*^9, 
   3.624348266657654*^9}, {3.624356895198255*^9, 3.624356918300398*^9}, {
   3.6243569521886263`*^9, 3.624356985457391*^9}, {3.624362511601883*^9, 
   3.624362524663512*^9}, {3.6243629570932207`*^9, 3.624362965225898*^9}, {
   3.624362999416973*^9, 3.624363055290331*^9}, {3.624363315124364*^9, 
   3.624363402036727*^9}, {3.624363434051179*^9, 3.624363499650799*^9}, {
   3.624363548854782*^9, 3.624363555411622*^9}, {3.6243636047973747`*^9, 
   3.6243637909266777`*^9}, {3.624363821741766*^9, 3.624363941623722*^9}, {
   3.624363992340425*^9, 3.624364027986538*^9}, {3.624364249534594*^9, 
   3.6243643148423223`*^9}, {3.624364357296321*^9, 3.6243647366403418`*^9}, {
   3.6243649824426937`*^9, 3.624365023268116*^9}, {3.6243650617884912`*^9, 
   3.62436509662251*^9}, {3.624365149222931*^9, 3.6243652275747147`*^9}, {
   3.624365302977343*^9, 3.624365315159102*^9}, {3.624365416099092*^9, 
   3.6243654319346437`*^9}, {3.6243654690108757`*^9, 3.624365557361085*^9}, {
   3.62436561571834*^9, 3.6243656160523243`*^9}, {3.624365661662487*^9, 
   3.624365883055266*^9}, {3.624366040363915*^9, 3.624366145705874*^9}, {
   3.6243662187414017`*^9, 3.6243664601487837`*^9}, {3.6243665656635103`*^9, 
   3.624366636837788*^9}, {3.6243666684744577`*^9, 3.6243666816067*^9}, 
   3.624366730589622*^9, {3.624366806271656*^9, 3.62436682995068*^9}, {
   3.624366860346286*^9, 3.62436686068569*^9}, {3.624366891052558*^9, 
   3.624367016358869*^9}, {3.624367058197258*^9, 3.6243670685455236`*^9}, {
   3.624367319326849*^9, 3.6243674237340403`*^9}, {3.624367468866968*^9, 
   3.624367491357793*^9}, {3.62436752239821*^9, 3.624367564740653*^9}, {
   3.62436766491252*^9, 3.62436780891978*^9}, {3.6243680226060762`*^9, 
   3.6243680266060343`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Relatedness between pairs of maladapted adults\
\>", "Subsection",
 CellChangeTimes->{{3.624366750377925*^9, 3.624366757417934*^9}, {
  3.6243675089734163`*^9, 3.624367515533433*^9}, {3.624367832850853*^9, 
  3.624367862634791*^9}}],

Cell[BoxData[
 RowBox[{"ra2a2tab", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{
      "M2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}],
      "\[Equal]", 
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"3", "-", "es"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}], 
         RowBox[{"r", "[", 
          RowBox[{"A2", ",", "A2", ",", "es", ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"na1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"r", "[", 
          RowBox[{
          "M2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "+", "1"}], ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
            ")"}], 
           RowBox[{"r", "[", 
            RowBox[{"M2", ",", "M2", ",", 
             RowBox[{"na1", "+", "1"}], ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "death", " ", "adapted", " ", "juvenille", " ", "on", " ", "na1"}],
            "+", 
           RowBox[{"1", " ", "patch"}]}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M2", ",", "M2", ",", "es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
           " ", "na1"}], "+", 
          RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"nm1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}]}], 
          ")"}], 
         RowBox[{"r", "[", 
          RowBox[{
          "M2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M2", ",", "M2", ",", "es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "juvenile"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"n", "-", "na1", "-", 
             RowBox[{"(", 
              RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
            "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["2", "nm1"], 
              RowBox[{"r", "[", 
               RowBox[{"M1", ",", "M2", ",", "es", ",", "na1", ",", 
                RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"nm1", "-", "2"}], "nm1"], 
              RowBox[{"r", "[", 
               RowBox[{"M2", ",", "M2", ",", "es", ",", "na1", ",", 
                RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], ")"}]}], 
          ",", "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to", 
          " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M2", ",", "M2", ",", "es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", "na1", "-", 
                RowBox[{"(", 
                 RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
           RowBox[{"r", "[", 
            RowBox[{"M2", ",", "M2", ",", "es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", 
             RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"(", 
              RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
             "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M2", ",", "M2", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], "]"}]}], 
          ",", "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
            ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
              "]"}]}], ")"}], 
           RowBox[{"r", "[", 
            RowBox[{"M2", ",", "M2", ",", "es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
         "]"}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
         " ", 
         RowBox[{
         "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"3", "-", "es"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"na1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "+", "1"}], ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
            ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"nm1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}]}], 
          ")"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}]}], ",",
           "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", "na1", "-", 
                RowBox[{"(", 
                 RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",", 
          "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"(", 
              RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
             "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
            ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
              "]"}]}], ")"}]}], ",", "0"}], "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"na1", ",", "2", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"nm1", ",", "0", ",", 
      RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"na2", ",", "0", ",", 
      RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.624302371333778*^9, 3.6243024125426188`*^9}, {
   3.6243028274912653`*^9, 3.6243029055041723`*^9}, {3.6243032547992907`*^9, 
   3.624303296552454*^9}, {3.624303439665804*^9, 3.624303469793705*^9}, {
   3.624303504597529*^9, 3.624303515626656*^9}, {3.624303953275794*^9, 
   3.624303955661152*^9}, {3.62430403571349*^9, 3.624304090734439*^9}, {
   3.624304482871949*^9, 3.624304526932238*^9}, {3.6243056584888372`*^9, 
   3.62430570335483*^9}, 3.6243058598933887`*^9, {3.624306251844326*^9, 
   3.624306258941802*^9}, 3.62430629883864*^9, {3.624306332641201*^9, 
   3.624306389842059*^9}, {3.6243071876723213`*^9, 3.624307204002542*^9}, {
   3.624340070721993*^9, 3.624340104658491*^9}, {3.624340160399*^9, 
   3.624340160625435*^9}, {3.624341285683601*^9, 3.624341285857761*^9}, {
   3.624341567202887*^9, 3.624341569656107*^9}, {3.624341876347229*^9, 
   3.62434205148129*^9}, {3.624342916533228*^9, 3.624342982335129*^9}, {
   3.624343065740284*^9, 3.624343210268524*^9}, {3.624343248999522*^9, 
   3.6243432707243023`*^9}, {3.6243433014432364`*^9, 
   3.6243433718271017`*^9}, {3.6243434581143*^9, 3.624343458965274*^9}, {
   3.624343562620357*^9, 3.6243435976830997`*^9}, {3.624343732188504*^9, 
   3.624344006726016*^9}, {3.624344126581244*^9, 3.624344199386602*^9}, {
   3.6243447499158297`*^9, 3.624344840488538*^9}, {3.6243450132092943`*^9, 
   3.624345431597501*^9}, {3.624345599240451*^9, 3.6243456481965647`*^9}, {
   3.624345934839198*^9, 3.624345936876704*^9}, {3.6243459721177387`*^9, 
   3.6243462106280823`*^9}, {3.624347591537723*^9, 3.624347755722567*^9}, {
   3.624348198007516*^9, 3.6243482179264708`*^9}, {3.6243482525398912`*^9, 
   3.624348266657654*^9}, {3.624356895198255*^9, 3.624356918300398*^9}, {
   3.6243569521886263`*^9, 3.624356985457391*^9}, {3.624362511601883*^9, 
   3.624362524663512*^9}, {3.6243629570932207`*^9, 3.624362965225898*^9}, {
   3.624362999416973*^9, 3.624363055290331*^9}, {3.624363315124364*^9, 
   3.624363402036727*^9}, {3.624363434051179*^9, 3.624363499650799*^9}, {
   3.624363548854782*^9, 3.624363555411622*^9}, {3.6243636047973747`*^9, 
   3.6243637909266777`*^9}, {3.624363821741766*^9, 3.624363941623722*^9}, {
   3.624363992340425*^9, 3.624364027986538*^9}, {3.624364249534594*^9, 
   3.6243643148423223`*^9}, {3.624364357296321*^9, 3.6243647366403418`*^9}, {
   3.6243649824426937`*^9, 3.624365023268116*^9}, {3.6243650617884912`*^9, 
   3.62436509662251*^9}, {3.624365149222931*^9, 3.6243652275747147`*^9}, {
   3.624365302977343*^9, 3.624365315159102*^9}, {3.624365416099092*^9, 
   3.6243654319346437`*^9}, {3.6243654690108757`*^9, 3.624365557361085*^9}, {
   3.62436561571834*^9, 3.6243656160523243`*^9}, {3.624365661662487*^9, 
   3.624365883055266*^9}, {3.624366040363915*^9, 3.624366145705874*^9}, {
   3.6243662187414017`*^9, 3.6243664601487837`*^9}, {3.6243665656635103`*^9, 
   3.624366636837788*^9}, {3.6243666684744577`*^9, 3.6243666816067*^9}, 
   3.624366730589622*^9, {3.624366806271656*^9, 3.62436682995068*^9}, {
   3.624366860346286*^9, 3.62436686068569*^9}, {3.624366891052558*^9, 
   3.624367016358869*^9}, {3.624367058197258*^9, 3.6243670685455236`*^9}, {
   3.624367319326849*^9, 3.6243674237340403`*^9}, {3.624367468866968*^9, 
   3.624367491357793*^9}, {3.62436752239821*^9, 3.624367564740653*^9}, {
   3.62436766491252*^9, 3.62436780891978*^9}, {3.624367844664619*^9, 
   3.624368014320919*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Evaluation of all coefficients", "Subsection",
 CellChangeTimes->{{3.616139737071217*^9, 3.6161397424071302`*^9}, {
  3.6161593499170237`*^9, 3.616159350179462*^9}}],

Cell["\<\
Some auxiliary tables for numerically solving\
\>", "Text",
 CellChangeTimes->{{3.593445646381062*^9, 3.5934456563973103`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"reltab", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
     "ra1a1tab", ",", "ra1m1tab", ",", "ra1a2tb", ",", "ra1m2tab", ",", 
      "rm1m1tab", ",", "rm1a2tab", ",", "rm1m2tab", ",", "ra2a2tab", ",", 
      "ra2m2tab", ",", "rm2m2tab"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reltab0", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "-", 
      RowBox[{"x", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "reltab"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"relvals", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"aF", ",", "aF", ",", "es", ",", "af", ",", "am"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"af", ",", "2", ",", "nf"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"am", ",", "0", ",", "nm"}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"aF", ",", "mF", ",", "es", ",", "af", ",", "am"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"af", ",", "1", ",", 
          RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"am", ",", "0", ",", "nm"}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"mF", ",", "mF", ",", "es", ",", "af", ",", "am"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"af", ",", "0", ",", 
          RowBox[{"nf", "-", "2"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"am", ",", "0", ",", "nm"}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"aF", ",", "aM", ",", "es", ",", "af", ",", "am"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"af", ",", "1", ",", "nf"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"am", ",", "1", ",", "nm"}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"aF", ",", "mM", ",", "es", ",", "af", ",", "am"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"af", ",", "1", ",", "nf"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"am", ",", "0", ",", 
          RowBox[{"nm", "-", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"mF", ",", "aM", ",", "es", ",", "af", ",", "am"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"af", ",", "0", ",", 
          RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"am", ",", "1", ",", "nm"}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"mF", ",", "mM", ",", "es", ",", "af", ",", "am"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"af", ",", "0", ",", 
          RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"am", ",", "0", ",", 
          RowBox[{"nm", "-", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"aM", ",", "aM", ",", "es", ",", "af", ",", "am"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"am", ",", "2", ",", "nm"}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"aM", ",", "mM", ",", "es", ",", "af", ",", "am"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"am", ",", "1", ",", 
          RowBox[{"nm", "-", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"mM", ",", "mM", ",", "es", ",", "af", ",", "am"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"am", ",", "0", ",", 
          RowBox[{"nm", "-", "2"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"F", "[", 
         RowBox[{"aM", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"am", ",", "1", ",", "nm"}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"F", "[", 
         RowBox[{"aF", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"af", ",", "1", ",", "nf"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"am", ",", "0", ",", "nm"}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"F", "[", 
         RowBox[{"mM", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"am", ",", "0", ",", 
          RowBox[{"nm", "-", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"F", "[", 
         RowBox[{"mF", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"af", ",", "0", ",", 
          RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"am", ",", "0", ",", "nm"}], "}"}]}], "]"}]}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.501836992729465*^9, 3.501836995095668*^9}, {
   3.501837797482402*^9, 3.501837821375182*^9}, {3.5051971853745937`*^9, 
   3.505197201715537*^9}, {3.505197232487157*^9, 3.505197243327004*^9}, {
   3.505211434509547*^9, 3.505211521752357*^9}, {3.505211556992576*^9, 
   3.505211568382031*^9}, {3.505211620703909*^9, 3.505211623282103*^9}, {
   3.505211706901904*^9, 3.505211718029876*^9}, 3.505302284780422*^9, {
   3.520421215472803*^9, 3.520421228578953*^9}, {3.520421328940182*^9, 
   3.52042133038615*^9}, {3.520421436390558*^9, 3.520421459204155*^9}, {
   3.608650391024482*^9, 3.608650470439294*^9}, {3.608650540812324*^9, 
   3.608650601014215*^9}, 3.6086516365764523`*^9, {3.608723862225259*^9, 
   3.6087238794758673`*^9}, {3.60881987921003*^9, 3.608819879831455*^9}, {
   3.6158926191850643`*^9, 3.6158926373077173`*^9}, {3.6158929418051243`*^9, 
   3.6158929586323643`*^9}, {3.615893014183621*^9, 3.615893034050313*^9}, {
   3.6158931202938833`*^9, 3.6158931522050247`*^9}, {3.615897323144853*^9, 
   3.615897361893403*^9}, {3.615897418735423*^9, 3.615897535239332*^9}, {
   3.6158977659410067`*^9, 3.615897835875355*^9}, {3.6243684348936033`*^9, 
   3.624368511593505*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "iterb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Iterator \[NoBreak]\\!\\({nfa, 2, nf}\\)\[NoBreak] does \
not have appropriate bounds. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/iterb\\\", ButtonNote -> \
\\\"Table::iterb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6243462564920397`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "iterb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Iterator \[NoBreak]\\!\\({nfa, 1, \\(\\(nf - 1\\)\\)}\\)\
\[NoBreak] does not have appropriate bounds. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/iterb\\\", ButtonNote -> \
\\\"Table::iterb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346256544372*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "iterb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Iterator \[NoBreak]\\!\\({nfa, 0, \\(\\(nf - 2\\)\\)}\\)\
\[NoBreak] does not have appropriate bounds. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/iterb\\\", ButtonNote -> \
\\\"Table::iterb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6243462565921392`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Table :: \
iterb\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346256595254*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "itform"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Argument \[NoBreak]\\!\\(\\(\\(r[\\(\\(aF, mF, es, nfa, \
nma\\)\\)]\\)\\) \[Equal] \\(\\(\\(\\(\\(s[\\(\\(3 - es\\)\\)]\\)\\)\\\\ \
\\(\\(f[\\(\\(\\(\\(3 - es\\)\\), \\(\\(nf - nfa\\)\\), \\(\\(nm - \
nma\\)\\)\\)\\)]\\)\\)\\\\ \\(\\(r[\\(\\(aF, mF, \\(\\(3 - es\\)\\), \\(\\(nf \
- nfa\\)\\), \\(\\(nm - nma\\)\\)\\)\\)]\\)\\)\\)\\) + \\(\\(\[LeftSkeleton] \
7 \[RightSkeleton]\\)\\) + \\(\\(\\(\\(If[\\(\\(\\(\\(\\(\\(nm > 0\\)\\) && \
\\(\\(\\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\) > 0\\)\
\\)\\)\\), 1, 0\\)\\)]\\)\\)\\\\ \\(\\(f[\\(\\(es, nfa, \\(\\(nma - \
1\\)\\)\\)\\)]\\)\\)\\\\ \\(\\((nm - \\(\\((nma - 1)\\)\\))\\)\\)\\\\ \
\\(\\(d[\\(\\(es, 0\\)\\)]\\)\\)\\\\ \\(\\(ap[\\(\\(es, nfa\\)\\)]\\)\\)\\\\ \
\\(\\(r[\\(\\(aF, mF, es, nfa, \\(\\(nma - \
1\\)\\)\\)\\)]\\)\\)\\)\\)\\)\\/\\(\\(\\(\\(\\(s[\\(\\(3 + \\(\\(Times[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\)\\)]\\)\\)\\\\ \
\\(\\(f[\\(\\(\\(\\(3 + \\(\\(Times[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\), \\(\\(nf + \\(\\(Times[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\)\\), \\(\\(nm + \
\\(\\(Times[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\)\\)\\)]\\)\\)\\)\\) + \
\\(\\(\\(\\(If[\\(\\(\\(\\(\\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\) \[GreaterEqual] 0\\)\\), 1, 0\\)\\)]\\)\\)\\\\ \
\\(\\((nf - \\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\))\
\\)\\)\\\\ \\(\\(d[\\(\\(es, 0\\)\\)]\\)\\)\\\\ \\(\\(ap[\\(\\(es, \\(\\(nfa \
- 1\\)\\)\\)\\)]\\)\\)\\\\ \\(\\(f[\\(\\(es, \\(\\(nfa - 1\\)\\), \
nma\\)\\)]\\)\\)\\)\\) + \\(\\(\[LeftSkeleton] 6 \[RightSkeleton]\\)\\) + \\(\
\\(\\(\\(If[\\(\\(\\(\\(\\(\\(Greater[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\) && \\(\\(Greater[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\), 1, 0\\)\\)]\\)\\)\\\\ \\(\\(f[\\(\\(es, \
nfa, \\(\\(nma - 1\\)\\)\\)\\)]\\)\\)\\\\ \\(\\((nm - \\(\\(Plus[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\))\\)\\)\\\\ \\(\\(d[\\(\\(es, \
0\\)\\)]\\)\\)\\\\ \\(\\(ap[\\(\\(es, nfa\\)\\)]\\)\\)\\)\\)\\)\\)\[NoBreak] \
at position \[NoBreak]\\!\\(5\\)\[NoBreak] does not have the correct form for \
an iterator. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/itform\\\", ButtonNote -> \
\\\"Table::itform\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346256598311*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "iterb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Iterator \[NoBreak]\\!\\({x, \
\\(\\(Table[\\(\\(\\(\\(\\(\\(r[\\(\\(aF, aF, es, nfa, nma\\)\\)]\\)\\) \
\[Equal] \\(\\(\\(\\(\\(s[\\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\
\\)\\)]\\)\\)]\\)\\)\\\\ \\(\\(f[\\(\\(\\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\), \\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\), \\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\)]\\)\\)\\\\ \\(\\(r[\\(\\(mF, mF, \
\\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\), \\(\\(Plus[\
\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\), \\(\\(Plus[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\)\\)]\\)\\)\\)\\) + \\(\\(\
\[LeftSkeleton] 7 \[RightSkeleton]\\)\\) + \\(\\(\\(\\(f[\\(\\(es, nfa, \
nma\\)\\)]\\)\\)\\\\ nma\\\\ \\(\\(d[\\(\\(es, 1\\)\\)]\\)\\)\\\\ \
\\(\\(ap[\\(\\(es, nfa\\)\\)]\\)\\)\\\\ \\(\\(r[\\(\\(aF, aF, es, nfa, nma\\)\
\\)]\\)\\)\\)\\)\\)\\/\\(\\(\\(\\(\\(s[\\(\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(f[\\(\\(\[LeftSkeleton] 3 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\) + \\(\\(\\(\\(f[\\(\\(\[LeftSkeleton] 3 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(d[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(ap[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\) + \\(\\(\\(\\(f[\\(\\(\[LeftSkeleton] 3 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(d[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\) + \\(\\(\\(\\(If[\\(\\(\[LeftSkeleton] 3 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(\[LeftSkeleton] 3 \[RightSkeleton]\\)\
\\)\\\\ \\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\) + \\(\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)\\) + \\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\) + \\(\
\\(\\(\\(f[\\(\\(\[LeftSkeleton] 3 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \
\\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(d[\
\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(Plus[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\)\\) + \\(\\(\\(\\(If[\\(\\(\
\[LeftSkeleton] 3 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(f[\\(\\(\
\[LeftSkeleton] 3 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(Plus[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(d[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(Plus[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\)\\) + \\(\\(\\(\\(f[\\(\\(\
\[LeftSkeleton] 3 \[RightSkeleton]\\)\\)]\\)\\)\\\\ nma\\\\ \\(\\(d[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(ap[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\)\\)\\)\\)\\), \\(\\({es, 1, \
2}\\)\\), \\(\\({nfa, 2, nf}\\)\\), \\(\\({nma, 0, nm}\\)\\), \\(\\(\
\[LeftSkeleton] 43 \[RightSkeleton]\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\), \\(\\(\\(\\(F[\\(\\(aF, es, nfa, nma\\)\\)]\\)\\) \
\[Equal] \\(\\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\) + \\(\\(\
\[LeftSkeleton] 7 \[RightSkeleton]\\)\\) + \\(\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)\\)\\)\\/\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)\\), \
\\(\\({es, 1, 2}\\)\\), \\(\\(\[LeftSkeleton] 6 \[RightSkeleton]\\)\\)\\)\\)]\
\\)\\)}\\)\[NoBreak] does not have appropriate bounds. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/iterb\\\", \
ButtonNote -> \\\"Table::iterb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346256640604*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "iterb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Iterator \[NoBreak]\\!\\({x, \
\\(\\(Table[\\(\\(\\(\\(\\(\\(r[\\(\\(aF, aF, es, nfa, nma\\)\\)]\\)\\) \
\[Equal] \\(\\(\\(\\(\\(s[\\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\
\\)\\)]\\)\\)]\\)\\)\\\\ \\(\\(f[\\(\\(\\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\), \\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\), \\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\)]\\)\\)\\\\ \\(\\(r[\\(\\(mF, mF, \
\\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\), \\(\\(Plus[\
\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\), \\(\\(Plus[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\)\\)]\\)\\)\\)\\) + \\(\\(\
\[LeftSkeleton] 7 \[RightSkeleton]\\)\\) + \\(\\(\\(\\(f[\\(\\(es, nfa, \
nma\\)\\)]\\)\\)\\\\ nma\\\\ \\(\\(d[\\(\\(es, 1\\)\\)]\\)\\)\\\\ \
\\(\\(ap[\\(\\(es, nfa\\)\\)]\\)\\)\\\\ \\(\\(r[\\(\\(aF, aF, es, nfa, nma\\)\
\\)]\\)\\)\\)\\)\\)\\/\\(\\(\\(\\(\\(s[\\(\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(f[\\(\\(\[LeftSkeleton] 3 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\) + \\(\\(\\(\\(f[\\(\\(\[LeftSkeleton] 3 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(d[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(ap[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\) + \\(\\(\\(\\(f[\\(\\(\[LeftSkeleton] 3 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(d[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\) + \\(\\(\\(\\(If[\\(\\(\[LeftSkeleton] 3 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(\[LeftSkeleton] 3 \[RightSkeleton]\\)\
\\)\\\\ \\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\) + \\(\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)\\) + \\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\) + \\(\
\\(\\(\\(f[\\(\\(\[LeftSkeleton] 3 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \
\\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(d[\
\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(Plus[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\)\\) + \\(\\(\\(\\(If[\\(\\(\
\[LeftSkeleton] 3 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(f[\\(\\(\
\[LeftSkeleton] 3 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(Plus[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(d[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(Plus[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\)\\) + \\(\\(\\(\\(f[\\(\\(\
\[LeftSkeleton] 3 \[RightSkeleton]\\)\\)]\\)\\)\\\\ nma\\\\ \\(\\(d[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(ap[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\)\\)\\)\\)\\), \\(\\({es, 1, \
2}\\)\\), \\(\\({nfa, 2, nf}\\)\\), \\(\\({nma, 0, nm}\\)\\), \\(\\(\
\[LeftSkeleton] 43 \[RightSkeleton]\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\), \\(\\(\\(\\(F[\\(\\(aF, es, nfa, nma\\)\\)]\\)\\) \
\[Equal] \\(\\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\) + \\(\\(\
\[LeftSkeleton] 7 \[RightSkeleton]\\)\\) + \\(\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)\\)\\)\\/\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)\\), \
\\(\\({es, 1, 2}\\)\\), \\(\\(\[LeftSkeleton] 6 \[RightSkeleton]\\)\\)\\)\\)]\
\\)\\)}\\)\[NoBreak] does not have appropriate bounds. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/iterb\\\", \
ButtonNote -> \\\"Table::iterb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6243462566895523`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "iterb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Iterator \[NoBreak]\\!\\({af, 2, nf}\\)\[NoBreak] does not \
have appropriate bounds. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/iterb\\\", ButtonNote -> \
\\\"Table::iterb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346256741337*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "iterb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Iterator \[NoBreak]\\!\\({af, 1, \\(\\(nf - 1\\)\\)}\\)\
\[NoBreak] does not have appropriate bounds. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/iterb\\\", ButtonNote -> \
\\\"Table::iterb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346256744214*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "iterb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Iterator \[NoBreak]\\!\\({af, 0, \\(\\(nf - 2\\)\\)}\\)\
\[NoBreak] does not have appropriate bounds. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/iterb\\\", ButtonNote -> \
\\\"Table::iterb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346256799995*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Table :: \
iterb\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346256802292*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "itform"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Argument \[NoBreak]\\!\\(r[\\(\\(aF, mF, es, af, am\\)\\)]\
\\)\[NoBreak] at position \[NoBreak]\\!\\(5\\)\[NoBreak] does not have the \
correct form for an iterator. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/itform\\\", ButtonNote -> \
\\\"Table::itform\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346256803556*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rosol", "=", 
   RowBox[{"reltab", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Q", "\[Rule]", "0"}], ",", 
      RowBox[{"t", "\[Rule]", "0"}], ",", 
      RowBox[{"i", "\[Rule]", "0"}], ",", 
      RowBox[{"q1", "\[Rule]", "0"}], ",", 
      RowBox[{"q2", "\[Rule]", "0"}], ",", 
      RowBox[{"k", "\[Rule]", "0"}], ",", 
      RowBox[{"p1", "\[Rule]", "1"}], ",", 
      RowBox[{"p2", "\[Rule]", "0"}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.531823785147376*^9, 3.531823828965721*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "itform"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Argument \[NoBreak]\\!\\(\\(\\(r[\\(\\(aF, mF, es, nfa, \
nma\\)\\)]\\)\\) \[Equal] \\(\\(\\(\\(\\(s[\\(\\(3 - es\\)\\)]\\)\\)\\\\ \
\\(\\(f[\\(\\(\\(\\(3 - es\\)\\), \\(\\(nf - nfa\\)\\), \\(\\(nm - \
nma\\)\\)\\)\\)]\\)\\)\\\\ \\(\\(r[\\(\\(aF, mF, \\(\\(3 - es\\)\\), \\(\\(nf \
- nfa\\)\\), \\(\\(nm - nma\\)\\)\\)\\)]\\)\\)\\)\\) + \\(\\(\[LeftSkeleton] \
7 \[RightSkeleton]\\)\\) + \\(\\(\\(\\(If[\\(\\(\\(\\(\\(\\(nm > 0\\)\\) && \
\\(\\(\\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\) > 0\\)\
\\)\\)\\), 1, 0\\)\\)]\\)\\)\\\\ \\(\\(f[\\(\\(es, nfa, \\(\\(nma - \
1\\)\\)\\)\\)]\\)\\)\\\\ \\(\\((nm - \\(\\((nma - 1)\\)\\))\\)\\)\\\\ \
\\(\\(d[\\(\\(es, 0\\)\\)]\\)\\)\\\\ \\(\\(ap[\\(\\(es, nfa\\)\\)]\\)\\)\\\\ \
\\(\\(r[\\(\\(aF, mF, es, nfa, \\(\\(nma - \
1\\)\\)\\)\\)]\\)\\)\\)\\)\\)\\/\\(\\(\\(\\(\\(s[\\(\\(3 + \\(\\(Times[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\)\\)]\\)\\)\\\\ \
\\(\\(f[\\(\\(\\(\\(3 + \\(\\(Times[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\), \\(\\(nf + \\(\\(Times[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\)\\), \\(\\(nm + \
\\(\\(Times[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\)\\)\\)]\\)\\)\\)\\) + \
\\(\\(\\(\\(If[\\(\\(\\(\\(\\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\) \[GreaterEqual] 0\\)\\), 1, 0\\)\\)]\\)\\)\\\\ \
\\(\\((nf - \\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\))\
\\)\\)\\\\ \\(\\(d[\\(\\(es, 0\\)\\)]\\)\\)\\\\ \\(\\(ap[\\(\\(es, \\(\\(nfa \
- 1\\)\\)\\)\\)]\\)\\)\\\\ \\(\\(f[\\(\\(es, \\(\\(nfa - 1\\)\\), \
nma\\)\\)]\\)\\)\\)\\) + \\(\\(\[LeftSkeleton] 6 \[RightSkeleton]\\)\\) + \\(\
\\(\\(\\(If[\\(\\(\\(\\(\\(\\(Greater[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\) && \\(\\(Greater[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\), 1, 0\\)\\)]\\)\\)\\\\ \\(\\(f[\\(\\(es, \
nfa, \\(\\(nma - 1\\)\\)\\)\\)]\\)\\)\\\\ \\(\\((nm - \\(\\(Plus[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\))\\)\\)\\\\ \\(\\(d[\\(\\(es, \
0\\)\\)]\\)\\)\\\\ \\(\\(ap[\\(\\(es, nfa\\)\\)]\\)\\)\\)\\)\\)\\)\[NoBreak] \
at position \[NoBreak]\\!\\(5\\)\[NoBreak] does not have the correct form for \
an iterator. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/itform\\\", ButtonNote -> \
\\\"Table::itform\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346256863756*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reltab0", "//", "Variables"}]], "Input",
 CellChangeTimes->{{3.60881782890604*^9, 3.608817842460063*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "iterb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Iterator \[NoBreak]\\!\\({x, \
\\(\\(Table[\\(\\(\\(\\(\\(\\(r[\\(\\(aF, aF, es, nfa, nma\\)\\)]\\)\\) \
\[Equal] \\(\\(\\(\\(\\(s[\\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\
\\)\\)]\\)\\)]\\)\\)\\\\ \\(\\(f[\\(\\(\\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\), \\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\), \\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\)]\\)\\)\\\\ \\(\\(r[\\(\\(mF, mF, \
\\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\), \\(\\(Plus[\
\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\), \\(\\(Plus[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\)\\)]\\)\\)\\)\\) + \\(\\(\
\[LeftSkeleton] 7 \[RightSkeleton]\\)\\) + \\(\\(\\(\\(f[\\(\\(es, nfa, \
nma\\)\\)]\\)\\)\\\\ nma\\\\ \\(\\(d[\\(\\(es, 1\\)\\)]\\)\\)\\\\ \
\\(\\(ap[\\(\\(es, nfa\\)\\)]\\)\\)\\\\ \\(\\(r[\\(\\(aF, aF, es, nfa, nma\\)\
\\)]\\)\\)\\)\\)\\)\\/\\(\\(\\(\\(\\(s[\\(\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(f[\\(\\(\[LeftSkeleton] 3 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\) + \\(\\(\\(\\(f[\\(\\(\[LeftSkeleton] 3 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(d[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(ap[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\) + \\(\\(\\(\\(f[\\(\\(\[LeftSkeleton] 3 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(d[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\) + \\(\\(\\(\\(If[\\(\\(\[LeftSkeleton] 3 \
\[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(\[LeftSkeleton] 3 \[RightSkeleton]\\)\
\\)\\\\ \\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\)]\\)\\)\\)\\) + \\(\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)\\) + \\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\) + \\(\
\\(\\(\\(f[\\(\\(\[LeftSkeleton] 3 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \
\\(\\(Plus[\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(d[\
\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(Plus[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\)\\) + \\(\\(\\(\\(If[\\(\\(\
\[LeftSkeleton] 3 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(f[\\(\\(\
\[LeftSkeleton] 3 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(Plus[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(d[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(Plus[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\)\\) + \\(\\(\\(\\(f[\\(\\(\
\[LeftSkeleton] 3 \[RightSkeleton]\\)\\)]\\)\\)\\\\ nma\\\\ \\(\\(d[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\\\ \\(\\(ap[\\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\)]\\)\\)\\)\\)\\)\\)\\), \\(\\({es, 1, \
2}\\)\\), \\(\\({nfa, 2, nf}\\)\\), \\(\\({nma, 0, nm}\\)\\), \\(\\(\
\[LeftSkeleton] 43 \[RightSkeleton]\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\), \\(\\(\\(\\(F[\\(\\(aF, es, nfa, nma\\)\\)]\\)\\) \
\[Equal] \\(\\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\) + \\(\\(\
\[LeftSkeleton] 7 \[RightSkeleton]\\)\\) + \\(\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)\\)\\)\\/\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)\\), \
\\(\\({es, 1, 2}\\)\\), \\(\\(\[LeftSkeleton] 6 \[RightSkeleton]\\)\\)\\)\\)]\
\\)\\)}\\)\[NoBreak] does not have appropriate bounds. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/iterb\\\", \
ButtonNote -> \\\"Table::iterb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346256917255*^9}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   PanelBox[GridBox[{
      {
       StyleBox[
        StyleBox[
         DynamicBox[ToBoxes[
           FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
           StandardForm],
          ImageSizeCache->{505., {3., 12.}}],
         StripOnInput->False,
         DynamicUpdating->True], "Panel",
        StripOnInput->False,
        Background->None]},
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "x", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "-", 
             RowBox[{
             "x", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"r", "[", 
                  RowBox[{
                  "aF", ",", "aF", ",", "es", ",", "nfa", ",", "nma"}], "]"}],
                  "\[Equal]", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"3", "-", "es"}], "]"}], " ", 
                    RowBox[{"f", "[", 
                    RowBox[{
                    RowBox[{"3", "-", "es"}], ",", 
                    RowBox[{"nf", "-", "nfa"}], ",", 
                    RowBox[{"nm", "-", "nma"}]}], "]"}], " ", 
                    RowBox[{"r", "[", 
                    RowBox[{"mF", ",", "mF", ",", 
                    RowBox[{"3", "-", "es"}], ",", 
                    RowBox[{"nf", "-", "nfa"}], ",", 
                    RowBox[{"nm", "-", "nma"}]}], "]"}]}], "+", 
                   RowBox[{"\[LeftSkeleton]", "7", "\[RightSkeleton]"}], "+", 
                   
                   RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"es", ",", "nfa", ",", "nma"}], "]"}], " ", "nma",
                     " ", 
                    RowBox[{"d", "[", 
                    RowBox[{"es", ",", "1"}], "]"}], " ", 
                    RowBox[{"ap", "[", 
                    RowBox[{"es", ",", "nfa"}], "]"}], " ", 
                    RowBox[{"r", "[", 
                    RowBox[{
                    "aF", ",", "aF", ",", "es", ",", "nfa", ",", "nma"}], 
                    "]"}]}]}], 
                  RowBox[{
                   RowBox[{
                    RowBox[{"s", "[", 
                    RowBox[{"3", "-", "es"}], "]"}], " ", 
                    RowBox[{"f", "[", 
                    RowBox[{
                    RowBox[{"3", "-", "es"}], ",", 
                    RowBox[{"nf", "-", "nfa"}], ",", 
                    RowBox[{"nm", "-", "nma"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"es", ",", 
                    RowBox[{"nfa", "-", "1"}], ",", "nma"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"nf", "-", 
                    RowBox[{"(", 
                    RowBox[{"nfa", "-", "1"}], ")"}]}], ")"}], " ", 
                    RowBox[{"d", "[", 
                    RowBox[{"es", ",", "0"}], "]"}], " ", 
                    RowBox[{"ap", "[", 
                    RowBox[{"es", ",", 
                    RowBox[{"nfa", "-", "1"}]}], "]"}]}], "+", 
                   RowBox[{"\[LeftSkeleton]", "5", "\[RightSkeleton]"}], "+", 
                   
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"nma", "+", "1"}], "\[LessEqual]", "nm"}], ",", 
                    "1", ",", "0"}], "]"}], " ", 
                    RowBox[{"f", "[", 
                    RowBox[{"es", ",", "nfa", ",", 
                    RowBox[{"nma", "+", "1"}]}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"nma", "+", "1"}], ")"}], " ", 
                    RowBox[{"d", "[", 
                    RowBox[{"es", ",", "1"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"ap", "[", 
                    RowBox[{"es", ",", "nfa"}], "]"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"es", ",", "nfa", ",", "nma"}], "]"}], " ", "nma",
                     " ", 
                    RowBox[{"d", "[", 
                    RowBox[{"es", ",", "1"}], "]"}], " ", 
                    RowBox[{"ap", "[", 
                    RowBox[{"es", ",", "nfa"}], "]"}]}]}]]}], ",", 
                RowBox[{"{", 
                 RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"nfa", ",", "2", ",", "nf"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"nma", ",", "0", ",", "nm"}], "}"}], ",", 
                RowBox[{
                 RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                 "\[Equal]", 
                 FractionBox[
                  RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                  RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]]}], 
                ",", 
                RowBox[{"\[LeftSkeleton]", "46", "\[RightSkeleton]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"nma", ",", "0", ",", "nm"}], "}"}], ",", 
                RowBox[{
                 RowBox[{"F", "[", 
                  RowBox[{"mF", ",", "es", ",", "nfa", ",", "nma"}], "]"}], 
                 "\[Equal]", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "+", 
                   
                   RowBox[{"\[LeftSkeleton]", "7", "\[RightSkeleton]"}], "+", 
                   
                   RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]}], 
                  RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]]}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"nfa", ",", "0", ",", 
                  RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"nma", ",", "0", ",", "nm"}], "}"}]}], "]"}]}], 
             "}"}]}], "]"}], "}"}],
         Short[#, 5]& ],
        Background->GrayLevel[1],
        BaseStyle->{Deployed -> False},
        Frame->True,
        FrameStyle->GrayLevel[0, 0.2],
        StripOnInput->False]},
      {
       RowBox[{
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
             StandardForm],
            ImageSizeCache->{87., {0., 12.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 199, 29589779097533417315, 5/2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
             StandardForm],
            ImageSizeCache->{92., {0., 12.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 199, 29589779097533417315, 5 2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
             StandardForm],
            ImageSizeCache->{144., {3., 12.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 199, 29589779097533417315, Infinity],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
             StandardForm],
            ImageSizeCache->{133., {0., 12.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>FrontEndExecute[{
            FrontEnd`SetOptions[
            FrontEnd`$FrontEnd, 
             FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
            FrontEnd`FrontEndToken["PreferencesDialog"]}],
         Evaluator->None,
         Method->"Preemptive"]}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[1.2]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    DefaultBaseStyle->{},
    FrameMargins->5],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[199]]], "Output",
 CellChangeTimes->{{3.608817830999254*^9, 3.6088178428246727`*^9}, {
   3.6088180282668962`*^9, 3.608818040906784*^9}, 3.608818153914057*^9, 
   3.6088183235170317`*^9, 3.60881837838028*^9, 3.608818468542901*^9, 
   3.608818550104966*^9, {3.608819647002627*^9, 3.608819675819385*^9}, 
   3.608819907856155*^9, 3.608820507808198*^9, {3.608822497273141*^9, 
   3.608822517886456*^9}, 3.608822646150723*^9, 3.60882275604989*^9, 
   3.608822848592197*^9, 3.608822998301586*^9, 3.608823095376391*^9, 
   3.60882326101007*^9, 3.608824630580785*^9, 3.6088252116713057`*^9, {
   3.60882711997162*^9, 3.6088271643312073`*^9}, 3.608828133044594*^9, 
   3.608866505116766*^9, 3.615894749712183*^9, 3.615896885605345*^9, 
   3.615896996099819*^9, 3.6158971923349123`*^9, 3.615897539135741*^9, 
   3.615897720010075*^9, 3.615897840200197*^9, {3.61589933496947*^9, 
   3.615899348693527*^9}, 3.615899419694076*^9, 3.615899601053179*^9, 
   3.61590006265182*^9, 3.616066694532317*^9, 3.616066890790728*^9, 
   3.6160674404473047`*^9, 3.616067556217127*^9, 3.6160677179989357`*^9, 
   3.616068647788962*^9, 3.616134352695427*^9, 3.616134675855145*^9, 
   3.616141960267151*^9, 3.616142171298069*^9, 3.616153791432816*^9, 
   3.6161602657917137`*^9, 3.616160862811846*^9, {3.616231963461871*^9, 
   3.616231989920328*^9}, 3.6162330081338043`*^9, 3.617963576259454*^9, 
   3.6179648579931917`*^9, 3.618562236431974*^9, 3.62434625701724*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["relvals"], "Input",
 CellChangeTimes->{{3.615897311078114*^9, 3.6158973137224092`*^9}}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"r", "[", 
    RowBox[{"aF", ",", "aF", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"af", ",", "2", ",", "nf"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"am", ",", "0", ",", "nm"}], "}"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"aF", ",", "mF", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"af", ",", "1", ",", 
     RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"am", ",", "0", ",", "nm"}], "}"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"mF", ",", "mF", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"af", ",", "0", ",", 
     RowBox[{"nf", "-", "2"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"am", ",", "0", ",", "nm"}], "}"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"aF", ",", "aM", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"af", ",", "1", ",", "nf"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"am", ",", "1", ",", "nm"}], "}"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"aF", ",", "mM", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"af", ",", "1", ",", "nf"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"am", ",", "0", ",", 
     RowBox[{"nm", "-", "1"}]}], "}"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"mF", ",", "aM", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"af", ",", "0", ",", 
     RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"am", ",", "1", ",", "nm"}], "}"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"mF", ",", "mM", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"af", ",", "0", ",", 
     RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"am", ",", "0", ",", 
     RowBox[{"nm", "-", "1"}]}], "}"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"aM", ",", "aM", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"am", ",", "2", ",", "nm"}], "}"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"aM", ",", "mM", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"am", ",", "1", ",", 
     RowBox[{"nm", "-", "1"}]}], "}"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"mM", ",", "mM", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"am", ",", "0", ",", 
     RowBox[{"nm", "-", "2"}]}], "}"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"aM", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"am", ",", "1", ",", "nm"}], "}"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"aF", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"af", ",", "1", ",", "nf"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"am", ",", "0", ",", "nm"}], "}"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"mM", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"am", ",", "0", ",", 
     RowBox[{"nm", "-", "1"}]}], "}"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"mF", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"af", ",", "0", ",", 
     RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"am", ",", "0", ",", "nm"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.6158973142083273`*^9, 3.6158975405345297`*^9, 3.615897720097978*^9, 
   3.615899335040271*^9, 3.615899419733345*^9, 3.615899601100992*^9, 
   3.615900062698195*^9, 3.6160666945759697`*^9, 3.6160668908396673`*^9, 
   3.616067440488036*^9, 3.616067556283903*^9, 3.61606771804233*^9, 
   3.616068647795762*^9, 3.616134352747385*^9, 3.616134675909383*^9, 
   3.616141960304387*^9, 3.616142171327695*^9, 3.616153791480185*^9, 
   3.616160265798115*^9, 3.616160862844046*^9, {3.61623196351655*^9, 
   3.616231989975832*^9}, 3.616233008181073*^9, 3.617963576346177*^9, 
   3.617964858106988*^9, 3.618562236564417*^9, 3.6243462570838957`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"relstartvals", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xi", ",", ".1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"xi", ",", "relvals"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6087097064519157`*^9, 3.6087097568613787`*^9}, {
  3.61589473079711*^9, 3.615894731065981*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "iterb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Iterator \[NoBreak]\\!\\({xi, \
\\(\\(Table[\\(\\(\\(\\(r[\\(\\(aF, aF, es, af, am\\)\\)]\\)\\), \\(\\({es, \
1, 2}\\)\\), \\(\\({af, 2, nf}\\)\\), \\(\\({am, 0, nm}\\)\\), \
\\(\\(r[\\(\\(aF, mF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \
\\(\\({af, 1, \\(\\(nf - 1\\)\\)}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(r[\\(\
\\(mF, mF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, \\(\
\\(nf - 2\\)\\)}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(r[\\(\\(aF, aM, es, \
af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 1, nf}\\)\\), \
\\(\\({am, 1, nm}\\)\\), \\(\\(r[\\(\\(aF, mM, es, af, am\\)\\)]\\)\\), \
\\(\\({es, 1, 2}\\)\\), \\(\\({af, 1, nf}\\)\\), \\(\\({am, 0, \\(\\(nm - \
1\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 12 \[RightSkeleton]\\)\\), \
\\(\\(r[\\(\\(aM, mM, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \
\\(\\({af, 0, nf}\\)\\), \\(\\({am, 1, \\(\\(nm - 1\\)\\)}\\)\\), \\(\\(r[\\(\
\\(mM, mM, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, nf}\
\\)\\), \\(\\({am, 0, \\(\\(nm - 2\\)\\)}\\)\\), \\(\\(F[\\(\\(aM, es, af, am\
\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, nf}\\)\\), \\(\\({am, 1, \
nm}\\)\\), \\(\\(F[\\(\\(aF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \
\\(\\({af, 1, nf}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(F[\\(\\(mM, es, af, \
am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\(\[LeftSkeleton] 6 \
\[RightSkeleton]\\)\\)\\)\\)]\\)\\)}\\)\[NoBreak] does not have appropriate \
bounds. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/iterb\\\", ButtonNote -> \
\\\"Table::iterb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346257182477*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "iterb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Iterator \[NoBreak]\\!\\({xi, \
\\(\\(Table[\\(\\(\\(\\(r[\\(\\(aF, aF, es, af, am\\)\\)]\\)\\), \\(\\({es, \
1, 2}\\)\\), \\(\\({af, 2, nf}\\)\\), \\(\\({am, 0, nm}\\)\\), \
\\(\\(r[\\(\\(aF, mF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \
\\(\\({af, 1, \\(\\(nf - 1\\)\\)}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(r[\\(\
\\(mF, mF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, \\(\
\\(nf - 2\\)\\)}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(r[\\(\\(aF, aM, es, \
af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 1, nf}\\)\\), \
\\(\\({am, 1, nm}\\)\\), \\(\\(r[\\(\\(aF, mM, es, af, am\\)\\)]\\)\\), \
\\(\\({es, 1, 2}\\)\\), \\(\\({af, 1, nf}\\)\\), \\(\\({am, 0, \\(\\(nm - \
1\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 12 \[RightSkeleton]\\)\\), \
\\(\\(r[\\(\\(aM, mM, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \
\\(\\({af, 0, nf}\\)\\), \\(\\({am, 1, \\(\\(nm - 1\\)\\)}\\)\\), \\(\\(r[\\(\
\\(mM, mM, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, nf}\
\\)\\), \\(\\({am, 0, \\(\\(nm - 2\\)\\)}\\)\\), \\(\\(F[\\(\\(aM, es, af, am\
\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, nf}\\)\\), \\(\\({am, 1, \
nm}\\)\\), \\(\\(F[\\(\\(aF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \
\\(\\({af, 1, nf}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(F[\\(\\(mM, es, af, \
am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\(\[LeftSkeleton] 6 \
\[RightSkeleton]\\)\\)\\)\\)]\\)\\)}\\)\[NoBreak] does not have appropriate \
bounds. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/iterb\\\", ButtonNote -> \
\\\"Table::iterb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6243462572474947`*^9}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"xi", ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"xi", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"aF", ",", "aF", ",", "es", ",", "af", ",", "am"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "2", ",", "nf"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "0", ",", "nm"}], "}"}], ",", 
       RowBox[{"r", "[", 
        RowBox[{"aF", ",", "mF", ",", "es", ",", "af", ",", "am"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "1", ",", 
         RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "0", ",", "nm"}], "}"}], ",", 
       RowBox[{"r", "[", 
        RowBox[{"mF", ",", "mF", ",", "es", ",", "af", ",", "am"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "0", ",", 
         RowBox[{"nf", "-", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "0", ",", "nm"}], "}"}], ",", 
       RowBox[{"r", "[", 
        RowBox[{"aF", ",", "aM", ",", "es", ",", "af", ",", "am"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "1", ",", "nf"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "1", ",", "nm"}], "}"}], ",", 
       RowBox[{"r", "[", 
        RowBox[{"aF", ",", "mM", ",", "es", ",", "af", ",", "am"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "1", ",", "nf"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "0", ",", 
         RowBox[{"nm", "-", "1"}]}], "}"}], ",", 
       RowBox[{"r", "[", 
        RowBox[{"mF", ",", "aM", ",", "es", ",", "af", ",", "am"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "0", ",", 
         RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "1", ",", "nm"}], "}"}], ",", 
       RowBox[{"r", "[", 
        RowBox[{"mF", ",", "mM", ",", "es", ",", "af", ",", "am"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "0", ",", 
         RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "0", ",", 
         RowBox[{"nm", "-", "1"}]}], "}"}], ",", 
       RowBox[{"r", "[", 
        RowBox[{"aM", ",", "aM", ",", "es", ",", "af", ",", "am"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "2", ",", "nm"}], "}"}], ",", 
       RowBox[{"r", "[", 
        RowBox[{"aM", ",", "mM", ",", "es", ",", "af", ",", "am"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "1", ",", 
         RowBox[{"nm", "-", "1"}]}], "}"}], ",", 
       RowBox[{"r", "[", 
        RowBox[{"mM", ",", "mM", ",", "es", ",", "af", ",", "am"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "0", ",", 
         RowBox[{"nm", "-", "2"}]}], "}"}], ",", 
       RowBox[{"F", "[", 
        RowBox[{"aM", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "1", ",", "nm"}], "}"}], ",", 
       RowBox[{"F", "[", 
        RowBox[{"aF", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "1", ",", "nf"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "0", ",", "nm"}], "}"}], ",", 
       RowBox[{"F", "[", 
        RowBox[{"mM", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "0", ",", 
         RowBox[{"nm", "-", "1"}]}], "}"}], ",", 
       RowBox[{"F", "[", 
        RowBox[{"mF", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "0", ",", 
         RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "0", ",", "nm"}], "}"}]}], "]"}]}], "}"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.6087097481036253`*^9, 3.608723762507711*^9, {3.6087238034402447`*^9, 
   3.608723840025827*^9}, 3.608723884421575*^9, {3.608723967624659*^9, 
   3.60872398231796*^9}, 3.6087240449280357`*^9, 3.60881640765488*^9, 
   3.608816647151969*^9, 3.608817563507653*^9, 3.608817647233808*^9, 
   3.608817709806594*^9, {3.608818028273183*^9, 3.6088180409114532`*^9}, 
   3.6088181539198627`*^9, 3.608818323565962*^9, 3.608818378431678*^9, 
   3.608818468548362*^9, 3.608818550192176*^9, {3.6088196470090647`*^9, 
   3.60881967582472*^9}, 3.608819907861396*^9, 3.608820507814946*^9, {
   3.6088224973400106`*^9, 3.60882251789041*^9}, 3.608822646220479*^9, 
   3.6088227560551558`*^9, 3.608822848597329*^9, 3.60882299830797*^9, 
   3.608823095383321*^9, 3.608823261066386*^9, 3.608824630588497*^9, 
   3.608825211679714*^9, {3.608827119976568*^9, 3.608827164338974*^9}, 
   3.608828133116536*^9, 3.608866505121491*^9, 3.615894749718376*^9, 
   3.615896885650312*^9, 3.6158969961930304`*^9, 3.615897192433629*^9, 
   3.615897546750654*^9, 3.615897720167782*^9, 3.615899335106629*^9, 
   3.615899419785928*^9, 3.61589960110646*^9, 3.6159000627031393`*^9, 
   3.616066694659327*^9, 3.616066890885213*^9, 3.61606744049299*^9, 
   3.616067556352803*^9, 3.616067718080336*^9, 3.6160686478399267`*^9, 
   3.616134352848124*^9, 3.616134675949483*^9, 3.61614196043996*^9, 
   3.616142171349573*^9, 3.6161537915296288`*^9, 3.616160265823889*^9, 
   3.616160862884913*^9, {3.616231963522842*^9, 3.6162319900394917`*^9}, 
   3.616233008186009*^9, 3.617963576424591*^9, 3.617964858113007*^9, 
   3.618562236683125*^9, 3.624346257252244*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"replacerel", "=", 
  RowBox[{
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"mM", ",", "mF", ",", "es", ",", "af", ",", "am"}], "]"}], "->", 
        RowBox[{"r", "[", 
         RowBox[{"mF", ",", "mM", ",", "es", ",", "af", ",", "am"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "0", ",", 
         RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "0", ",", 
         RowBox[{"nm", "-", "1"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"aM", ",", "mF", ",", "es", ",", "af", ",", "am"}], "]"}], "->", 
        RowBox[{"r", "[", 
         RowBox[{"mF", ",", "aM", ",", "es", ",", "af", ",", "am"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "0", ",", 
         RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "1", ",", "nm"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"mM", ",", "aF", ",", "es", ",", "af", ",", "am"}], "]"}], "->", 
        RowBox[{"r", "[", 
         RowBox[{"aF", ",", "mM", ",", "es", ",", "af", ",", "am"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "1", ",", "nf"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "0", ",", 
         RowBox[{"nm", "-", "1"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"aM", ",", "aF", ",", "es", ",", "af", ",", "am"}], "]"}], "->", 
        RowBox[{"r", "[", 
         RowBox[{"aF", ",", "aM", ",", "es", ",", "af", ",", "am"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "1", ",", "nf"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "1", ",", "nm"}], "}"}]}], "]"}]}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.608823445224917*^9, 3.608823447083459*^9}, {
  3.608824540797873*^9, 3.608824603906246*^9}, {3.615897561349169*^9, 
  3.615897605621056*^9}, {3.615900109105042*^9, 3.615900208077546*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "iterb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Iterator \[NoBreak]\\!\\({af, 0, \\(\\(nf - 1\\)\\)}\\)\
\[NoBreak] does not have appropriate bounds. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/iterb\\\", ButtonNote -> \
\\\"Table::iterb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6243462574916697`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "iterb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Iterator \[NoBreak]\\!\\({af, 0, \\(\\(nf - 1\\)\\)}\\)\
\[NoBreak] does not have appropriate bounds. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/iterb\\\", ButtonNote -> \
\\\"Table::iterb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346257546908*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "iterb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Iterator \[NoBreak]\\!\\({af, 1, nf}\\)\[NoBreak] does not \
have appropriate bounds. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/iterb\\\", ButtonNote -> \
\\\"Table::iterb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.62434625760706*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Table :: \
iterb\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346257608712*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "itform"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Argument \[NoBreak]\\!\\(\\(\\(r[\\(\\(aM, mF, es, af, \
am\\)\\)]\\)\\) \[Rule] \\(\\(r[\\(\\(mF, aM, es, af, am\\)\\)]\\)\\)\\)\
\[NoBreak] at position \[NoBreak]\\!\\(5\\)\[NoBreak] does not have the \
correct form for an iterator. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/itform\\\", ButtonNote -> \
\\\"Table::itform\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346257671818*^9}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"mM", ",", "mF", ",", "es", ",", "af", ",", "am"}], "]"}], 
    "\[Rule]", 
    RowBox[{"r", "[", 
     RowBox[{"mF", ",", "mM", ",", "es", ",", "af", ",", "am"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"af", ",", "0", ",", 
     RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"am", ",", "0", ",", 
     RowBox[{"nm", "-", "1"}]}], "}"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"aM", ",", "mF", ",", "es", ",", "af", ",", "am"}], "]"}], 
    "\[Rule]", 
    RowBox[{"r", "[", 
     RowBox[{"mF", ",", "aM", ",", "es", ",", "af", ",", "am"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"af", ",", "0", ",", 
     RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"am", ",", "1", ",", "nm"}], "}"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"mM", ",", "aF", ",", "es", ",", "af", ",", "am"}], "]"}], 
    "\[Rule]", 
    RowBox[{"r", "[", 
     RowBox[{"aF", ",", "mM", ",", "es", ",", "af", ",", "am"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"af", ",", "1", ",", "nf"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"am", ",", "0", ",", 
     RowBox[{"nm", "-", "1"}]}], "}"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"aM", ",", "aF", ",", "es", ",", "af", ",", "am"}], "]"}], 
    "\[Rule]", 
    RowBox[{"r", "[", 
     RowBox[{"aF", ",", "aM", ",", "es", ",", "af", ",", "am"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"af", ",", "1", ",", "nf"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"am", ",", "1", ",", "nm"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.608824580567842*^9, 3.60882463068259*^9}, 
   3.608825211770602*^9, {3.60882712005518*^9, 3.608827164415889*^9}, 
   3.6088281331221533`*^9, 3.608866505206348*^9, 3.6158947497866898`*^9, 
   3.615896885741548*^9, 3.6158969962840137`*^9, 3.6158971924846077`*^9, 
   3.615897550684325*^9, 3.6158975952771263`*^9, 3.615897720245528*^9, 
   3.615899335173531*^9, 3.615899419826786*^9, 3.615899601158367*^9, 
   3.6159000627489557`*^9, 3.615900111326314*^9, {3.61590019809468*^9, 
   3.6159002083897133`*^9}, 3.61606669470288*^9, 3.6160668909347763`*^9, 
   3.6160674405326633`*^9, 3.616067556429201*^9, 3.616067718126644*^9, 
   3.616068647981596*^9, 3.6161343528999157`*^9, 3.61613467599601*^9, 
   3.616141960477766*^9, 3.616142171381548*^9, 3.616153791577458*^9, 
   3.616160265948203*^9, 3.616160862920475*^9, {3.616231963572934*^9, 
   3.61623199010436*^9}, 3.616233008236517*^9, 3.6179635765130653`*^9, 
   3.617964858219001*^9, 3.618562236804428*^9, 3.6243462576744547`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"relsubsvals", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xi", "\[Rule]", "0.1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"xi", ",", "relvals"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6160675095410223`*^9, 3.616067546555146*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "itform"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Argument \[NoBreak]\\!\\(r[\\(\\(aF, mF, es, af, am\\)\\)]\
\\)\[NoBreak] at position \[NoBreak]\\!\\(5\\)\[NoBreak] does not have the \
correct form for an iterator. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/itform\\\", ButtonNote -> \
\\\"Table::itform\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6243462577377377`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "iterb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Iterator \[NoBreak]\\!\\({xi, \
\\(\\(Table[\\(\\(\\(\\(r[\\(\\(aF, aF, es, af, am\\)\\)]\\)\\), \\(\\({es, \
1, 2}\\)\\), \\(\\({af, 2, nf}\\)\\), \\(\\({am, 0, nm}\\)\\), \
\\(\\(r[\\(\\(aF, mF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \
\\(\\({af, 1, \\(\\(nf - 1\\)\\)}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(r[\\(\
\\(mF, mF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, \\(\
\\(nf - 2\\)\\)}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(r[\\(\\(aF, aM, es, \
af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 1, nf}\\)\\), \
\\(\\({am, 1, nm}\\)\\), \\(\\(r[\\(\\(aF, mM, es, af, am\\)\\)]\\)\\), \
\\(\\({es, 1, 2}\\)\\), \\(\\({af, 1, nf}\\)\\), \\(\\({am, 0, \\(\\(nm - \
1\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 12 \[RightSkeleton]\\)\\), \
\\(\\(r[\\(\\(aM, mM, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \
\\(\\({af, 0, nf}\\)\\), \\(\\({am, 1, \\(\\(nm - 1\\)\\)}\\)\\), \\(\\(r[\\(\
\\(mM, mM, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, nf}\
\\)\\), \\(\\({am, 0, \\(\\(nm - 2\\)\\)}\\)\\), \\(\\(F[\\(\\(aM, es, af, am\
\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, nf}\\)\\), \\(\\({am, 1, \
nm}\\)\\), \\(\\(F[\\(\\(aF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \
\\(\\({af, 1, nf}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(F[\\(\\(mM, es, af, \
am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\(\[LeftSkeleton] 6 \
\[RightSkeleton]\\)\\)\\)\\)]\\)\\)}\\)\[NoBreak] does not have appropriate \
bounds. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/iterb\\\", ButtonNote -> \
\\\"Table::iterb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.62434625780024*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "iterb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Iterator \[NoBreak]\\!\\({xi, \
\\(\\(Table[\\(\\(\\(\\(r[\\(\\(aF, aF, es, af, am\\)\\)]\\)\\), \\(\\({es, \
1, 2}\\)\\), \\(\\({af, 2, nf}\\)\\), \\(\\({am, 0, nm}\\)\\), \
\\(\\(r[\\(\\(aF, mF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \
\\(\\({af, 1, \\(\\(nf - 1\\)\\)}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(r[\\(\
\\(mF, mF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, \\(\
\\(nf - 2\\)\\)}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(r[\\(\\(aF, aM, es, \
af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 1, nf}\\)\\), \
\\(\\({am, 1, nm}\\)\\), \\(\\(r[\\(\\(aF, mM, es, af, am\\)\\)]\\)\\), \
\\(\\({es, 1, 2}\\)\\), \\(\\({af, 1, nf}\\)\\), \\(\\({am, 0, \\(\\(nm - \
1\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 12 \[RightSkeleton]\\)\\), \
\\(\\(r[\\(\\(aM, mM, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \
\\(\\({af, 0, nf}\\)\\), \\(\\({am, 1, \\(\\(nm - 1\\)\\)}\\)\\), \\(\\(r[\\(\
\\(mM, mM, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, nf}\
\\)\\), \\(\\({am, 0, \\(\\(nm - 2\\)\\)}\\)\\), \\(\\(F[\\(\\(aM, es, af, am\
\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, nf}\\)\\), \\(\\({am, 1, \
nm}\\)\\), \\(\\(F[\\(\\(aF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \
\\(\\({af, 1, nf}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(F[\\(\\(mM, es, af, \
am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\(\[LeftSkeleton] 6 \
\[RightSkeleton]\\)\\)\\)\\)]\\)\\)}\\)\[NoBreak] does not have appropriate \
bounds. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/iterb\\\", ButtonNote -> \
\\\"Table::iterb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346257803095*^9}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"xi", "\[Rule]", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"xi", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"aF", ",", "aF", ",", "es", ",", "af", ",", "am"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "2", ",", "nf"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "0", ",", "nm"}], "}"}], ",", 
       RowBox[{"r", "[", 
        RowBox[{"aF", ",", "mF", ",", "es", ",", "af", ",", "am"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "1", ",", 
         RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "0", ",", "nm"}], "}"}], ",", 
       RowBox[{"r", "[", 
        RowBox[{"mF", ",", "mF", ",", "es", ",", "af", ",", "am"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "0", ",", 
         RowBox[{"nf", "-", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "0", ",", "nm"}], "}"}], ",", 
       RowBox[{"r", "[", 
        RowBox[{"aF", ",", "aM", ",", "es", ",", "af", ",", "am"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "1", ",", "nf"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "1", ",", "nm"}], "}"}], ",", 
       RowBox[{"r", "[", 
        RowBox[{"aF", ",", "mM", ",", "es", ",", "af", ",", "am"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "1", ",", "nf"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "0", ",", 
         RowBox[{"nm", "-", "1"}]}], "}"}], ",", 
       RowBox[{"r", "[", 
        RowBox[{"mF", ",", "aM", ",", "es", ",", "af", ",", "am"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "0", ",", 
         RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "1", ",", "nm"}], "}"}], ",", 
       RowBox[{"r", "[", 
        RowBox[{"mF", ",", "mM", ",", "es", ",", "af", ",", "am"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "0", ",", 
         RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "0", ",", 
         RowBox[{"nm", "-", "1"}]}], "}"}], ",", 
       RowBox[{"r", "[", 
        RowBox[{"aM", ",", "aM", ",", "es", ",", "af", ",", "am"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "2", ",", "nm"}], "}"}], ",", 
       RowBox[{"r", "[", 
        RowBox[{"aM", ",", "mM", ",", "es", ",", "af", ",", "am"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "1", ",", 
         RowBox[{"nm", "-", "1"}]}], "}"}], ",", 
       RowBox[{"r", "[", 
        RowBox[{"mM", ",", "mM", ",", "es", ",", "af", ",", "am"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "0", ",", 
         RowBox[{"nm", "-", "2"}]}], "}"}], ",", 
       RowBox[{"F", "[", 
        RowBox[{"aM", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "1", ",", "nm"}], "}"}], ",", 
       RowBox[{"F", "[", 
        RowBox[{"aF", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "1", ",", "nf"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "0", ",", "nm"}], "}"}], ",", 
       RowBox[{"F", "[", 
        RowBox[{"mM", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "0", ",", 
         RowBox[{"nm", "-", "1"}]}], "}"}], ",", 
       RowBox[{"F", "[", 
        RowBox[{"mF", ",", "es", ",", "af", ",", "am"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"af", ",", "0", ",", 
         RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"am", ",", "0", ",", "nm"}], "}"}]}], "]"}]}], "}"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.616067556434452*^9, 3.6160677181677637`*^9, 3.6160686479862413`*^9, 
   3.6161343529083633`*^9, 3.616134676042843*^9, 3.6161419605156937`*^9, 
   3.616142171402214*^9, 3.6161537915837717`*^9, 3.6161602659852133`*^9, 
   3.616160863134075*^9, {3.616231963620351*^9, 3.616231990158581*^9}, 
   3.616233008295287*^9, 3.617963576593986*^9, 3.617964858304078*^9, 
   3.6185622369187813`*^9, 3.624346257806141*^9}]
}, Open  ]],

Cell[TextData[StyleBox["Numerical solving of relatedness equations",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.593445660381074*^9, 3.593445670548917*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans3test", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "ms_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p1s_", ",", "p2s_"}], "}"}], ",", "ks_", ",", "Qs_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "ans2out", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ans2out", "=", 
      RowBox[{"ans2", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"s1s", ",", "s2s"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"c1s", ",", "c2s"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"q1s", ",", "q2s"}], "}"}], ",", 
        RowBox[{"{", "ms", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p1s", ",", "p2s"}], "}"}], ",", "ks", ",", "Qs"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"reltab", "/.", "replacerel"}], "/.", "ans2out"}], "/.", 
       "relsubsvals"}], "/.", 
      RowBox[{"Join", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
         RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
         RowBox[{"k", "\[Rule]", "ks"}], ",", 
         RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
         RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
         RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
         RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
         RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
         RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
         RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
         RowBox[{"mt", "\[Rule]", "ms"}], ",", 
         RowBox[{"p1", "\[Rule]", "p1s"}], ",", 
         RowBox[{"p2", "\[Rule]", "p2s"}]}], "}"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.501837018190094*^9, 3.501837023679632*^9}, {
  3.50183720898388*^9, 3.501837217030787*^9}, {3.505137630604842*^9, 
  3.505137672689906*^9}, {3.505137724298099*^9, 3.505137725093664*^9}, {
  3.50513786911785*^9, 3.505137871782151*^9}, {3.505138291497983*^9, 
  3.505138301863115*^9}, {3.508161120480796*^9, 3.508161127365771*^9}, {
  3.524555086466839*^9, 3.524555095395934*^9}, {3.590832971798708*^9, 
  3.59083297406511*^9}, {3.592544839100576*^9, 3.592544857754291*^9}, {
  3.608716022758548*^9, 3.608716062912607*^9}, {3.608723666448043*^9, 
  3.6087237128692503`*^9}, {3.6087237780983753`*^9, 3.6087238362794456`*^9}, {
  3.608723975350193*^9, 3.608723978954783*^9}, {3.608817901186801*^9, 
  3.6088179046777353`*^9}, {3.608818013721566*^9, 3.6088180362235947`*^9}, {
  3.608819864326297*^9, 3.6088198721744537`*^9}, {3.608824618900054*^9, 
  3.6088246209531727`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans3", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "ms_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p1s_", ",", "p2s_"}], "}"}], ",", "ks_", ",", "Qs_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "ans2out", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ans2out", "=", 
      RowBox[{"ans2", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"s1s", ",", "s2s"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"c1s", ",", "c2s"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"q1s", ",", "q2s"}], "}"}], ",", 
        RowBox[{"{", "ms", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p1s", ",", "p2s"}], "}"}], ",", "ks", ",", "Qs"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"reltab", "/.", "replacerel"}], "/.", "ans2out"}], "/.", 
          RowBox[{"Join", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
             RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
             RowBox[{"k", "\[Rule]", "ks"}], ",", 
             RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
             RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
             RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
             RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
             RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
             RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
             RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
             RowBox[{"mt", "\[Rule]", "ms"}], ",", 
             RowBox[{"p1", "\[Rule]", "p1s"}], ",", 
             RowBox[{"p2", "\[Rule]", "p2s"}]}], "}"}], "]"}]}], ",", 
         "relstartvals"}], "]"}], ",", "ans2out"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.501837018190094*^9, 3.501837023679632*^9}, {
  3.50183720898388*^9, 3.501837217030787*^9}, {3.505137630604842*^9, 
  3.505137672689906*^9}, {3.505137724298099*^9, 3.505137725093664*^9}, {
  3.50513786911785*^9, 3.505137871782151*^9}, {3.505138291497983*^9, 
  3.505138301863115*^9}, {3.508161120480796*^9, 3.508161127365771*^9}, {
  3.524555086466839*^9, 3.524555095395934*^9}, {3.590832971798708*^9, 
  3.59083297406511*^9}, {3.592544839100576*^9, 3.592544857754291*^9}, {
  3.608716022758548*^9, 3.608716062912607*^9}, {3.608723666448043*^9, 
  3.6087237128692503`*^9}, {3.6087237780983753`*^9, 3.6087238362794456`*^9}, {
  3.608723975350193*^9, 3.608723978954783*^9}, {3.6088179063236313`*^9, 
  3.608817906603421*^9}, {3.6088199041554193`*^9, 3.608819904381402*^9}, {
  3.608824611648243*^9, 3.608824614732347*^9}, {3.616067638049119*^9, 
  3.616067643656845*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ans3", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.4604307", ",", "0.234759"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.0", ",", "0.0"}], "}"}], ",", 
   RowBox[{"{", "0.812412", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.366029", ",", "0.0144154"}], "}"}], ",", "0.1", ",", "0.01"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.590832954724578*^9, 3.590832955228262*^9}, {
   3.591583611880354*^9, 3.5915836124884043`*^9}, {3.5925449076672163`*^9, 
   3.592544924428237*^9}, {3.608818046539587*^9, 3.6088180476516867`*^9}, 
   3.616135388104212*^9, {3.616235055386627*^9, 3.6162350621854258`*^9}, {
   3.616235093378756*^9, 3.616235140714388*^9}, {3.6162352753924828`*^9, 
   3.616235365528983*^9}, {3.616236375055539*^9, 3.616236403422186*^9}, {
   3.616236900698138*^9, 3.6162369327698917`*^9}, {3.617963554182996*^9, 
   3.6179635542225657`*^9}, {3.617963584626789*^9, 3.6179636375678864`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Table", "::", "iterb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Iterator \[NoBreak]\\!\\({xi, \
\\(\\(Table[\\(\\(\\(\\(r[\\(\\(aF, aF, es, af, am\\)\\)]\\)\\), \\(\\({es, \
1, 2}\\)\\), \\(\\({af, 2, nf}\\)\\), \\(\\({am, 0, nm}\\)\\), \
\\(\\(r[\\(\\(aF, mF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \
\\(\\({af, 1, \\(\\(nf - 1\\)\\)}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(r[\\(\
\\(mF, mF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, \\(\
\\(nf - 2\\)\\)}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(r[\\(\\(aF, aM, es, \
af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 1, nf}\\)\\), \
\\(\\({am, 1, nm}\\)\\), \\(\\(r[\\(\\(aF, mM, es, af, am\\)\\)]\\)\\), \
\\(\\({es, 1, 2}\\)\\), \\(\\({af, 1, nf}\\)\\), \\(\\({am, 0, \\(\\(nm - \
1\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 12 \[RightSkeleton]\\)\\), \
\\(\\(r[\\(\\(aM, mM, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \
\\(\\({af, 0, nf}\\)\\), \\(\\({am, 1, \\(\\(nm - 1\\)\\)}\\)\\), \\(\\(r[\\(\
\\(mM, mM, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, nf}\
\\)\\), \\(\\({am, 0, \\(\\(nm - 2\\)\\)}\\)\\), \\(\\(F[\\(\\(aM, es, af, am\
\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, nf}\\)\\), \\(\\({am, 1, \
nm}\\)\\), \\(\\(F[\\(\\(aF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \
\\(\\({af, 1, nf}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(F[\\(\\(mM, es, af, \
am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\(\[LeftSkeleton] 6 \
\[RightSkeleton]\\)\\)\\)\\)]\\)\\)}\\)\[NoBreak] does not have appropriate \
bounds. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/iterb\\\", ButtonNote -> \
\\\"Table::iterb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346257923945*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindRoot", "::", "fdss"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Search specification \
\[NoBreak]\\!\\(Table[\\(\\(\\(\\({xi, 0.1`}\\)\\), \\(\\({xi, \
\\(\\(Table[\\(\\(\\(\\(r[\\(\\(aF, aF, es, af, am\\)\\)]\\)\\), \\(\\({es, \
1, 2}\\)\\), \\(\\({af, 2, nf}\\)\\), \\(\\({am, 0, nm}\\)\\), \
\\(\\(r[\\(\\(aF, mF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \
\\(\\({af, 1, \\(\\(nf - 1\\)\\)}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(r[\\(\
\\(mF, mF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, \\(\
\\(nf - 2\\)\\)}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(r[\\(\\(aF, aM, es, \
af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 1, nf}\\)\\), \
\\(\\({am, 1, nm}\\)\\), \\(\\(r[\\(\\(aF, mM, es, af, am\\)\\)]\\)\\), \
\\(\\({es, 1, 2}\\)\\), \\(\\({af, 1, nf}\\)\\), \\(\\(\[LeftSkeleton] 14 \
\[RightSkeleton]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, nf}\\)\\), \
\\(\\({am, 1, \\(\\(nm - 1\\)\\)}\\)\\), \\(\\(r[\\(\\(mM, mM, es, af, \
am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, nf}\\)\\), \\(\\({am, \
0, \\(\\(nm - 2\\)\\)}\\)\\), \\(\\(F[\\(\\(aM, es, af, am\\)\\)]\\)\\), \
\\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, nf}\\)\\), \\(\\({am, 1, nm}\\)\\), \\(\
\\(F[\\(\\(aF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 1, \
nf}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(F[\\(\\(mM, es, af, \
am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\(\[LeftSkeleton] 6 \
\[RightSkeleton]\\)\\)\\)\\)]\\)\\)}\\)\\)\\)\\)]\\)\[NoBreak] should be a \
list with 1 to 5 elements. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindRoot/fdss\\\", ButtonNote -> \
\\\"FindRoot::fdss\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346257986383*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Join", "::", "heads"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Heads \[NoBreak]\\!\\(FindRoot\\)\[NoBreak] and \[NoBreak]\
\\!\\(ans2\\)\[NoBreak] at positions \[NoBreak]\\!\\(1\\)\[NoBreak] and \
\[NoBreak]\\!\\(2\\)\[NoBreak] are expected to be the same. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/heads\\\", \
ButtonNote -> \\\"Join::heads\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346257991006*^9}],

Cell[BoxData[
 RowBox[{"Join", "[", 
  RowBox[{
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"reltab", "/.", "\[VeryThinSpace]", "replacerel"}], "/.", 
       "\[VeryThinSpace]", "ans2out$34588"}], "/.", "\[VeryThinSpace]", 
      RowBox[{"Join", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"s1", "\[Rule]", "1.4604307`"}], ",", 
         RowBox[{"s2", "\[Rule]", "0.234759`"}], ",", 
         RowBox[{"k", "\[Rule]", "0.1`"}], ",", 
         RowBox[{"q1", "\[Rule]", "0.`"}], ",", 
         RowBox[{"q2", "\[Rule]", "0.`"}], ",", 
         RowBox[{"c1", "\[Rule]", "0.5`"}], ",", 
         RowBox[{"c2", "\[Rule]", "0.5`"}], ",", 
         RowBox[{"Q", "\[Rule]", "0.01`"}], ",", 
         RowBox[{"q1", "\[Rule]", "0.`"}], ",", 
         RowBox[{"q2", "\[Rule]", "0.`"}], ",", 
         RowBox[{"mt", "\[Rule]", "0.812412`"}], ",", 
         RowBox[{"p1", "\[Rule]", "0.366029`"}], ",", 
         RowBox[{"p2", "\[Rule]", "0.0144154`"}]}], "}"}], "]"}]}], ",", 
     "relstartvals"}], "]"}], ",", 
   RowBox[{"ans2", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.4604307`", ",", "0.234759`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5`", ",", "0.5`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", "0.812412`", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.366029`", ",", "0.0144154`"}], "}"}], ",", "0.1`", ",", 
     "0.01`"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.616235141522985*^9, {3.6162352771905403`*^9, 3.6162353664006567`*^9}, 
   3.616236404328638*^9, {3.616236902251206*^9, 3.616236933774022*^9}, {
   3.617963577033092*^9, 3.6179636387156363`*^9}, 3.617964858812612*^9, 
   3.61856223786057*^9, 3.624346257993881*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ans3", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{".5", ",", ".5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.0", ",", "0.0"}], "}"}], ",", 
   RowBox[{"{", "0.5", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5"}], "}"}], ",", "0.1", ",", "0.02"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.616155620463221*^9, 3.616155638210314*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindRoot", "::", "fdss"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Search specification \
\[NoBreak]\\!\\(Table[\\(\\(\\(\\({xi, 0.1`}\\)\\), \\(\\({xi, \
\\(\\(Table[\\(\\(\\(\\(r[\\(\\(aF, aF, es, af, am\\)\\)]\\)\\), \\(\\({es, \
1, 2}\\)\\), \\(\\({af, 2, nf}\\)\\), \\(\\({am, 0, nm}\\)\\), \
\\(\\(r[\\(\\(aF, mF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \
\\(\\({af, 1, \\(\\(nf - 1\\)\\)}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(r[\\(\
\\(mF, mF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, \\(\
\\(nf - 2\\)\\)}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(r[\\(\\(aF, aM, es, \
af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 1, nf}\\)\\), \
\\(\\({am, 1, nm}\\)\\), \\(\\(r[\\(\\(aF, mM, es, af, am\\)\\)]\\)\\), \
\\(\\({es, 1, 2}\\)\\), \\(\\({af, 1, nf}\\)\\), \\(\\(\[LeftSkeleton] 14 \
\[RightSkeleton]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, nf}\\)\\), \
\\(\\({am, 1, \\(\\(nm - 1\\)\\)}\\)\\), \\(\\(r[\\(\\(mM, mM, es, af, \
am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, nf}\\)\\), \\(\\({am, \
0, \\(\\(nm - 2\\)\\)}\\)\\), \\(\\(F[\\(\\(aM, es, af, am\\)\\)]\\)\\), \
\\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, nf}\\)\\), \\(\\({am, 1, nm}\\)\\), \\(\
\\(F[\\(\\(aF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 1, \
nf}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(F[\\(\\(mM, es, af, \
am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\(\[LeftSkeleton] 6 \
\[RightSkeleton]\\)\\)\\)\\)]\\)\\)}\\)\\)\\)\\)]\\)\[NoBreak] should be a \
list with 1 to 5 elements. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindRoot/fdss\\\", ButtonNote -> \
\\\"FindRoot::fdss\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346258063904*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Join", "::", "heads"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Heads \[NoBreak]\\!\\(FindRoot\\)\[NoBreak] and \[NoBreak]\
\\!\\(ans2\\)\[NoBreak] at positions \[NoBreak]\\!\\(1\\)\[NoBreak] and \
\[NoBreak]\\!\\(2\\)\[NoBreak] are expected to be the same. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/heads\\\", \
ButtonNote -> \\\"Join::heads\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6243462581243668`*^9}],

Cell[BoxData[
 RowBox[{"Join", "[", 
  RowBox[{
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"reltab", "/.", "\[VeryThinSpace]", "replacerel"}], "/.", 
       "\[VeryThinSpace]", "ans2out$35389"}], "/.", "\[VeryThinSpace]", 
      RowBox[{"Join", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"s1", "\[Rule]", "0.5`"}], ",", 
         RowBox[{"s2", "\[Rule]", "0.5`"}], ",", 
         RowBox[{"k", "\[Rule]", "0.1`"}], ",", 
         RowBox[{"q1", "\[Rule]", "0.`"}], ",", 
         RowBox[{"q2", "\[Rule]", "0.`"}], ",", 
         RowBox[{"c1", "\[Rule]", "0.5`"}], ",", 
         RowBox[{"c2", "\[Rule]", "0.5`"}], ",", 
         RowBox[{"Q", "\[Rule]", "0.02`"}], ",", 
         RowBox[{"q1", "\[Rule]", "0.`"}], ",", 
         RowBox[{"q2", "\[Rule]", "0.`"}], ",", 
         RowBox[{"mt", "\[Rule]", "0.5`"}], ",", 
         RowBox[{"p1", "\[Rule]", "0.5`"}], ",", 
         RowBox[{"p2", "\[Rule]", "0.5`"}]}], "}"}], "]"}]}], ",", 
     "relstartvals"}], "]"}], ",", 
   RowBox[{"ans2", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.5`", ",", "0.5`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5`", ",", "0.5`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", "0.5`", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5`", ",", "0.5`"}], "}"}], ",", "0.1`", ",", "0.02`"}], 
    "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.616155640599015*^9, 3.6161571351024323`*^9, 3.616160267633854*^9, 
   3.616160864800119*^9, {3.616231965241374*^9, 3.616231991907321*^9}, 
   3.616233009877392*^9, 3.617963577356551*^9, 3.6179648591998167`*^9, 
   3.618562238831709*^9, 3.624346258126094*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ans3", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{".3", ",", ".1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.05", ",", "0.05"}], "}"}], ",", 
   RowBox[{"{", "0.85", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3", ",", "0.4"}], "}"}], ",", "0.1", ",", "0.05"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.590832954724578*^9, 3.590832955228262*^9}, {
  3.590832987597384*^9, 3.590832987876445*^9}, {3.59158361598437*^9, 
  3.591583616528049*^9}, {3.5925449099957457`*^9, 3.59254492731636*^9}, {
  3.608819827505082*^9, 3.608819828815631*^9}, {3.6088204794522457`*^9, 
  3.608820484350499*^9}, {3.608827600505228*^9, 3.608827607718952*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindRoot", "::", "fdss"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Search specification \
\[NoBreak]\\!\\(Table[\\(\\(\\(\\({xi, 0.1`}\\)\\), \\(\\({xi, \
\\(\\(Table[\\(\\(\\(\\(r[\\(\\(aF, aF, es, af, am\\)\\)]\\)\\), \\(\\({es, \
1, 2}\\)\\), \\(\\({af, 2, nf}\\)\\), \\(\\({am, 0, nm}\\)\\), \
\\(\\(r[\\(\\(aF, mF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \
\\(\\({af, 1, \\(\\(nf - 1\\)\\)}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(r[\\(\
\\(mF, mF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, \\(\
\\(nf - 2\\)\\)}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(r[\\(\\(aF, aM, es, \
af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 1, nf}\\)\\), \
\\(\\({am, 1, nm}\\)\\), \\(\\(r[\\(\\(aF, mM, es, af, am\\)\\)]\\)\\), \
\\(\\({es, 1, 2}\\)\\), \\(\\({af, 1, nf}\\)\\), \\(\\(\[LeftSkeleton] 14 \
\[RightSkeleton]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, nf}\\)\\), \
\\(\\({am, 1, \\(\\(nm - 1\\)\\)}\\)\\), \\(\\(r[\\(\\(mM, mM, es, af, \
am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, nf}\\)\\), \\(\\({am, \
0, \\(\\(nm - 2\\)\\)}\\)\\), \\(\\(F[\\(\\(aM, es, af, am\\)\\)]\\)\\), \
\\(\\({es, 1, 2}\\)\\), \\(\\({af, 0, nf}\\)\\), \\(\\({am, 1, nm}\\)\\), \\(\
\\(F[\\(\\(aF, es, af, am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\({af, 1, \
nf}\\)\\), \\(\\({am, 0, nm}\\)\\), \\(\\(F[\\(\\(mM, es, af, \
am\\)\\)]\\)\\), \\(\\({es, 1, 2}\\)\\), \\(\\(\[LeftSkeleton] 6 \
\[RightSkeleton]\\)\\)\\)\\)]\\)\\)}\\)\\)\\)\\)]\\)\[NoBreak] should be a \
list with 1 to 5 elements. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindRoot/fdss\\\", ButtonNote -> \
\\\"FindRoot::fdss\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.62434625818729*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Join", "::", "heads"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Heads \[NoBreak]\\!\\(FindRoot\\)\[NoBreak] and \[NoBreak]\
\\!\\(ans2\\)\[NoBreak] at positions \[NoBreak]\\!\\(1\\)\[NoBreak] and \
\[NoBreak]\\!\\(2\\)\[NoBreak] are expected to be the same. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/heads\\\", \
ButtonNote -> \\\"Join::heads\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624346258242474*^9}],

Cell[BoxData[
 RowBox[{"Join", "[", 
  RowBox[{
   RowBox[{"FindRoot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"reltab", "/.", "\[VeryThinSpace]", "replacerel"}], "/.", 
       "\[VeryThinSpace]", "ans2out$35869"}], "/.", "\[VeryThinSpace]", 
      RowBox[{"Join", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"s1", "\[Rule]", "0.3`"}], ",", 
         RowBox[{"s2", "\[Rule]", "0.1`"}], ",", 
         RowBox[{"k", "\[Rule]", "0.1`"}], ",", 
         RowBox[{"q1", "\[Rule]", "0.05`"}], ",", 
         RowBox[{"q2", "\[Rule]", "0.05`"}], ",", 
         RowBox[{"c1", "\[Rule]", "0"}], ",", 
         RowBox[{"c2", "\[Rule]", "0"}], ",", 
         RowBox[{"Q", "\[Rule]", "0.05`"}], ",", 
         RowBox[{"q1", "\[Rule]", "0.05`"}], ",", 
         RowBox[{"q2", "\[Rule]", "0.05`"}], ",", 
         RowBox[{"mt", "\[Rule]", "0.85`"}], ",", 
         RowBox[{"p1", "\[Rule]", "0.3`"}], ",", 
         RowBox[{"p2", "\[Rule]", "0.4`"}]}], "}"}], "]"}]}], ",", 
     "relstartvals"}], "]"}], ",", 
   RowBox[{"ans2", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.3`", ",", "0.1`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.05`", ",", "0.05`"}], "}"}], ",", 
     RowBox[{"{", "0.85`", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.3`", ",", "0.4`"}], "}"}], ",", "0.1`", ",", "0.05`"}], 
    "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.608723762693358*^9, {3.608723803656619*^9, 3.608723840425029*^9}, 
   3.608723884755657*^9, {3.608723967946336*^9, 3.608723982648509*^9}, 
   3.608724045239945*^9, 3.6088164080718946`*^9, 3.608816647427847*^9, 
   3.608817564065515*^9, 3.608817647756055*^9, 3.608817710446084*^9, {
   3.60881802919075*^9, 3.608818041544417*^9}, 3.6088181545612297`*^9, 
   3.608818324190074*^9, 3.6088183790458937`*^9, 3.6088184691620693`*^9, 
   3.608818550912957*^9, {3.608819647674634*^9, 3.608819676444187*^9}, 
   3.60881982978141*^9, 3.6088199083336153`*^9, 3.608820508271352*^9, {
   3.608822498403163*^9, 3.6088225183779793`*^9}, 3.608822646731245*^9, 
   3.6088227564463863`*^9, 3.608822849022997*^9, 3.6088229988207607`*^9, 
   3.608823095937476*^9, 3.608823261539196*^9, 3.608824631227149*^9, 
   3.608825212315135*^9, {3.608827120595338*^9, 3.608827165002727*^9}, {
   3.608827602376822*^9, 3.608827608391127*^9}, 3.6088281336418753`*^9, 
   3.608866505536003*^9, 3.615894750649845*^9, 3.615896886536517*^9, 
   3.615896997019946*^9, 3.6158971932496243`*^9, 3.6158977214223557`*^9, 
   3.6158993372576427`*^9, 3.6158994213797693`*^9, 3.6158996026513443`*^9, 
   3.615900064255142*^9, 3.615900219510414*^9, 3.616066695608917*^9, 
   3.616066891883862*^9, 3.6160674413641233`*^9, 3.616067558268366*^9, 
   3.616067647433568*^9, 3.6160677199032793`*^9, 3.616068649745864*^9, 
   3.616134354636383*^9, 3.61613467770126*^9, 3.6161419624350986`*^9, 
   3.6161421730217743`*^9, 3.616153793291485*^9, 3.6161571316209307`*^9, 
   3.6161602679625597`*^9, 3.616160865154417*^9, {3.616231965596142*^9, 
   3.616231992305969*^9}, 3.616233010219562*^9, 3.61796357782539*^9, 
   3.617964859589851*^9, 3.618562239635223*^9, 3.62434625824487*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Selection differentials for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["p", "1"], ",", 
    SubscriptBox["p", "2"]}], TraditionalForm]]],
 ": the proportion of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "1"], TraditionalForm]]],
 "-offspring produced by ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "1"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "2"], TraditionalForm]]],
 " parents respectively"
}], "Section",
 CellChangeTimes->{{3.593494268186329*^9, 3.5934943131688232`*^9}, {
  3.59377825225355*^9, 3.593778254989624*^9}, {3.6161394928332644`*^9, 
  3.616139503089116*^9}, {3.616139553057475*^9, 3.61613955433675*^9}}],

Cell[CellGroupData[{

Cell["\<\
Functions to calculate the selection differential in females\
\>", "Subsection",
 CellChangeTimes->{{3.616139532800646*^9, 3.616139548897303*^9}, {
  3.61613958445751*^9, 3.616139584864347*^9}}],

Cell["\<\
Probability nonfocal produces adapted or maladapted offspring\
\>", "Text",
 CellChangeTimes->{{3.5934456838213387`*^9, 3.59344568989388*^9}, {
  3.593445721973733*^9, 3.593445734493628*^9}, {3.593494246140113*^9, 
  3.593494261530838*^9}, {3.593494444481636*^9, 3.59349445421741*^9}, {
  3.593494493568993*^9, 3.593494497672474*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"apotherdp", "[", 
   RowBox[{"es_", ",", "afother_", ",", "aself_", ",", "amother_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"m", "[", 
         RowBox[{"es", ",", "1"}], "]"}]}], ")"}], "/", 
      RowBox[{"localcomptotal", "[", 
       RowBox[{"es", ",", 
        RowBox[{"afother", "+", "aself"}]}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"afother", "/", "nf"}], ")"}], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"es", ",", "1"}], "]"}], "+", 
        RowBox[{
         FractionBox[
          RowBox[{"r", "[", 
           RowBox[{"mF", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"aself", "\[Equal]", "0"}], ",", "mF", ",", "aF"}], 
             "]"}], ",", "es", ",", 
            RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}], 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"F", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"aself", "\[Equal]", "0"}], ",", "mF", ",", "aF"}], 
                "]"}], ",", "es", ",", 
               RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}]}], 
            ")"}]}]], " ", 
         RowBox[{"dp", "[", 
          RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"m", "[", 
         RowBox[{"es", ",", "0"}], "]"}]}], ")"}], "/", 
      RowBox[{"localcomptotal", "[", 
       RowBox[{"es", ",", 
        RowBox[{"afother", "+", "aself"}]}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"nf", "-", "1", "-", "afother"}], ")"}], "/", "nf"}], ")"}], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "0"}], "]"}], "+", 
      RowBox[{
       FractionBox[
        RowBox[{"r", "[", 
         RowBox[{"mF", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"aself", "\[Equal]", "0"}], ",", "mF", ",", "aF"}], "]"}],
           ",", "es", ",", 
          RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}], 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"F", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"aself", "\[Equal]", "0"}], ",", "mF", ",", "aF"}], 
              "]"}], ",", "es", ",", 
             RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}]}], 
          ")"}]}]], " ", 
       RowBox[{"dp", "[", 
        RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"dispad", "[", "es", "]"}], "/", 
    RowBox[{"localcomptotal", "[", 
     RowBox[{"es", ",", 
      RowBox[{"afother", "+", "aself"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzjtIQgEAhWGVqKDByOiJgZkQQSCYlCbYXdp0sNUUfETWYKCYQjUlFCSE
SQVZSGYmgT0gsYYyLIeiMCLRCgdb7CpFNyICi+5xOHzb4efpzCoji8FgtNCD
Mkdy08AmiXGq2g/tbamMpJEk9ObnJxg6rBBJaUWr02W7Ax4JpGxrUmg/iahg
ovd6CFYlA5PQ/Lk7BZUWahZeGeRzMFavdUFemr0EN7JH3vLPOt8HdeGeACyJ
WUGYF0YtA7SXLyU7zKajCiNtx7JBCTXOHyOstN+MQKHVNwZ9t/IJmLcdWKFC
aHHASK7vd5R239PENNG6TQtqJ5ck7k16Dezasfr/pCThmt8LQir2Xcfsp/sE
RQ5sbwipZRckwdDxh+Hb68pWTYIkwimyrMBdOIW1cfEZzDi8zZwPkigWcq3w
OM7thD4vRwwDj+8a6D1XauHiF/tukHZ7hvsA/wFv8skD
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"mpotherdp", "[", 
   RowBox[{"es_", ",", "afother_", ",", "aself_", ",", "amother_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"m", "[", 
         RowBox[{"es", ",", "1"}], "]"}]}], ")"}], "/", 
      RowBox[{"localcomptotal", "[", 
       RowBox[{"es", ",", 
        RowBox[{"afother", "+", "aself"}]}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"afother", "/", "nf"}], ")"}], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "1"}], "]"}], "+", " ", 
      RowBox[{
       FractionBox[
        RowBox[{"r", "[", 
         RowBox[{"aF", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"aself", "\[Equal]", "0"}], ",", "mF", ",", "aF"}], "]"}],
           ",", "es", ",", 
          RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}], 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"F", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"aself", "\[Equal]", "0"}], ",", "mF", ",", "aF"}], 
              "]"}], ",", "es", ",", 
             RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}]}], 
          ")"}]}]], " ", 
       RowBox[{"dp", "[", 
        RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}]}], "+", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"m", "[", 
         RowBox[{"es", ",", "0"}], "]"}]}], ")"}], "/", 
      RowBox[{"localcomptotal", "[", 
       RowBox[{"es", ",", 
        RowBox[{"afother", "+", "aself"}]}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"nf", "-", "1", "-", "afother"}], ")"}], "/", "nf"}], ")"}], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"es", ",", "0"}], "]"}], "+", 
        RowBox[{
         FractionBox[
          RowBox[{"r", "[", 
           RowBox[{"mF", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"aself", "\[Equal]", "0"}], ",", "mF", ",", "aF"}], 
             "]"}], ",", "es", ",", 
            RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}], 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"F", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"aself", "\[Equal]", "0"}], ",", "mF", ",", "aF"}], 
                "]"}], ",", "es", ",", 
               RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}]}], 
            ")"}]}]], " ", 
         RowBox[{"dp", "[", 
          RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"dispmad", "[", "es", "]"}], "/", 
    RowBox[{"localcomptotal", "[", 
     RowBox[{"es", ",", 
      RowBox[{"afother", "+", "aself"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.4977313575163937`*^9, 3.497731360074568*^9}, {
   3.501839641578721*^9, 3.501839645247612*^9}, {3.501839684134495*^9, 
   3.50183971770653*^9}, {3.501851619555985*^9, 3.501851659503312*^9}, {
   3.5019270167028*^9, 3.5019270199093723`*^9}, {3.501927388745659*^9, 
   3.5019274823554783`*^9}, {3.501934616641917*^9, 3.501934660676333*^9}, {
   3.505138422164023*^9, 3.505138435307042*^9}, {3.520591176365972*^9, 
   3.520591199050509*^9}, {3.52059612927109*^9, 3.520596132676881*^9}, {
   3.592545004004702*^9, 3.5925450064017057`*^9}, {3.593493803618656*^9, 
   3.593493815980609*^9}, {3.6160539934882517`*^9, 3.616054102941695*^9}, 
   3.616142670582468*^9, {3.616159903963251*^9, 3.616159913302924*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Selection differential of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["p", "1"], ",", 
    SubscriptBox["p", "2"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " in females"
}], "Subsection",
 CellChangeTimes->{{3.616139562944502*^9, 3.6161395806080923`*^9}}],

Cell[TextData[{
 "Table of selection gradients for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "i"], TraditionalForm]]],
 " for different environments and adaptedness of focal and nonfocal \
breeders:"
}], "Text",
 CellChangeTimes->{{3.5934945027603397`*^9, 3.593494538079492*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdptabF", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"environmental", " ", "change"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", "es", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"F", ",", 
           RowBox[{"3", "-", "es"}], ",", 
           RowBox[{"1", "-", "aself"}], ",", 
           RowBox[{"nf", "-", "1", "-", "afother"}], ",", 
           RowBox[{"nm", "-", "amother"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"focal", " ", "female", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "daughter", " ", "of", " ", 
         "the", " ", "same", " ", "type"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself"}], "]"}], "+", 
           RowBox[{"dp", "[", 
            RowBox[{"es", ",", "aself"}], "]"}]}], ")"}]}], ")"}], 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "aself"}], "]"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", 
          RowBox[{"afother", "+", "aself"}]}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Zeta]f", "-", "1"}], ")"}], " ", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"focal", " ", "female", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "daughter", " ", "of", " ", 
         "a", " ", "different", " ", "type"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "aself"}], "]"}], "+", 
         RowBox[{"dp", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "aself"}], "]"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", 
          RowBox[{"afother", "+", "aself"}]}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Zeta]f", " ", 
          RowBox[{"v", "[", 
           RowBox[{"F", ",", "es", ",", 
            RowBox[{"1", "-", "aself"}], ",", "afother", ",", "amother"}], 
           "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"focal", " ", "female", " ", "dies"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", "nonfocal", " ", "daughter"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nf"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
           RowBox[{
            RowBox[{"g", "[", 
             RowBox[{"es", ",", "aself"}], "]"}], "/", 
            RowBox[{"localcomptotal", "[", 
             RowBox[{"es", ",", 
              RowBox[{"afother", "+", "aself"}]}], "]"}]}]}], ")"}]}], ")"}], 
       
       RowBox[{"(", 
        RowBox[{"-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "maladapted", " ", "female", " ", "dies"}], ",",
         " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "daughter", " ", "of", " ", 
         "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"afother", "<", 
          RowBox[{"nf", "-", "1"}]}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nf", "-", "1", "-", "afother"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself"}], "]"}], "+", 
           RowBox[{"dp", "[", 
            RowBox[{"es", ",", "aself"}], "]"}]}], ")"}]}], ")"}], 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "aself"}], "]"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", 
          RowBox[{"afother", "+", "aself"}]}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Zeta]f"}], ")"}], 
          RowBox[{"v", "[", 
           RowBox[{"F", ",", "es", ",", "aself", ",", 
            RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "maladapted", " ", "female", " ", "dies"}], ",",
         " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "daughter", " ", "of", " ", 
         "a", " ", "different", " ", "type", " ", "as", " ", "focal"}]}], " ",
        "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"afother", "<", 
          RowBox[{"nf", "-", "1"}]}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nf", "-", "1", "-", "afother"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "aself"}], "]"}], "+", 
         RowBox[{"dp", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "aself"}], "]"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", 
          RowBox[{"afother", "+", "aself"}]}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "aself", ",", 
           RowBox[{"afother", "+", 
            RowBox[{"(", 
             RowBox[{"1", "-", "aself"}], ")"}]}], ",", "amother"}], "]"}], 
         "+", 
         RowBox[{"\[Zeta]f", " ", 
          RowBox[{"v", "[", 
           RowBox[{"F", ",", "es", ",", 
            RowBox[{"1", "-", "aself"}], ",", 
            RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "maladapted", " ", "female", " ", "dies"}], ",",
         " ", 
        RowBox[{
        "replaced", " ", "by", " ", "nonfocal", " ", "daughter", " ", "that", 
         " ", "is", " ", "adapted"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"afother", "<", 
          RowBox[{"nf", "-", "1"}]}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nf", "-", "1", "-", "afother"}], ")"}], 
       RowBox[{"apotherdp", "[", 
        RowBox[{"es", ",", "afother", ",", "aself", ",", "amother"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "aself", ",", 
           RowBox[{"afother", "+", "1"}], ",", "amother"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "adapted", " ", "female", " ", "dies"}], ",", 
        " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "daughter", " ", "of", " ", 
         "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"afother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "afother", 
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself"}], "]"}], "+", 
           RowBox[{"dp", "[", 
            RowBox[{"es", ",", "aself"}], "]"}]}], ")"}]}], ")"}], 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "aself"}], "]"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", 
          RowBox[{"afother", "+", "aself"}]}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Zeta]f"}], ")"}], 
          RowBox[{"v", "[", 
           RowBox[{"F", ",", "es", ",", "aself", ",", 
            RowBox[{"afother", "-", "1", "+", "aself"}], ",", "amother"}], 
           "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "adapted", " ", "female", " ", "dies"}], ",", 
        " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "daughter", " ", "of", " ", 
         "a", " ", "different", " ", "type", " ", "than", " ", "focal"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"afother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "afother", 
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "aself"}], "]"}], "+", 
         RowBox[{"dp", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "aself"}], "]"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", 
          RowBox[{"afother", "+", "aself"}]}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "aself", ",", 
           RowBox[{"afother", "-", "1", "+", 
            RowBox[{"(", 
             RowBox[{"1", "-", "aself"}], ")"}]}], ",", "amother"}], "]"}], 
         "+", 
         RowBox[{"\[Zeta]f", " ", 
          RowBox[{"v", "[", 
           RowBox[{"F", ",", "es", ",", 
            RowBox[{"1", "-", "aself"}], ",", 
            RowBox[{"afother", "-", "1", "+", "aself"}], ",", "amother"}], 
           "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "adapted", " ", "female", " ", "dies"}], ",", 
        " ", 
        RowBox[{
        "replaced", " ", "by", " ", "nonfocal", " ", "daughter", " ", "that", 
         " ", "is", " ", "maladapted"}]}], " ", "*)"}], "\[IndentingNewLine]",
       "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"afother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "afother", " ", 
       RowBox[{"mpotherdp", "[", 
        RowBox[{"es", ",", "afother", ",", "aself", ",", "amother"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "aself", ",", 
           RowBox[{"afother", "-", "1"}], ",", "amother"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"maladapted", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "son", " ", "of", " ", 
         "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", "<", "nm"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nm", "-", "amother"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself"}], "]"}], "+", 
           RowBox[{"dp", "[", 
            RowBox[{"es", ",", "aself"}], "]"}]}], ")"}]}], ")"}], 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "aself"}], "]"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", 
          RowBox[{"afother", "+", "aself"}]}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Zeta]f", " ", 
          RowBox[{"v", "[", 
           RowBox[{"M", ",", "es", ",", "aself", ",", 
            RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}]}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "aself", ",", "afother", ",", 
           RowBox[{"amother", "+", "aself"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"maladapted", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "son", " ", "of", " ", "a", 
         " ", "different", " ", "type", " ", "than", " ", "focal"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", "<", "nm"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nm", "-", "amother"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "aself"}], "]"}], "+", 
         RowBox[{"dp", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "aself"}], "]"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", 
          RowBox[{"afother", "+", "aself"}]}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Zeta]f", " ", 
          RowBox[{"v", "[", 
           RowBox[{"M", ",", "es", ",", 
            RowBox[{"1", "-", "aself"}], ",", 
            RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}]}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "aself", ",", "afother", ",", 
           RowBox[{"amother", "+", "1", "-", "aself"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"maladapted", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "nonfocal", " ", "offspring", " ", "that",
          " ", "is", " ", "adapted"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", "<", "nm"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nm", "-", "amother"}], ")"}], 
       RowBox[{"apotherdp", "[", 
        RowBox[{"es", ",", "afother", ",", "aself", ",", "amother"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "aself", ",", "afother", ",", 
           RowBox[{"amother", "+", "1"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"adapted", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "son", " ", "of", " ", 
         "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "amother", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself"}], "]"}], "+", 
           RowBox[{"dp", "[", 
            RowBox[{"es", ",", "aself"}], "]"}]}], ")"}]}], ")"}], 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "aself"}], "]"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", 
          RowBox[{"afother", "+", "aself"}]}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Zeta]f", " ", 
          RowBox[{"v", "[", 
           RowBox[{"M", ",", "es", ",", "aself", ",", 
            RowBox[{"afother", "+", "aself"}], ",", 
            RowBox[{"amother", "-", "1"}]}], "]"}]}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "aself", ",", "afother", ",", 
           RowBox[{"amother", "-", "1", "+", "aself"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"adapted", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "son", " ", "of", " ", "a", 
         " ", "different", " ", "type", " ", "than", " ", "focal"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "amother", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "aself"}], "]"}], "+", 
         RowBox[{"dp", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "aself"}], "]"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", 
          RowBox[{"afother", "+", "aself"}]}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Zeta]f", " ", 
          RowBox[{"v", "[", 
           RowBox[{"M", ",", "es", ",", 
            RowBox[{"1", "-", "aself"}], ",", 
            RowBox[{"afother", "+", "aself"}], ",", 
            RowBox[{"amother", "-", "1"}]}], "]"}]}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "aself", ",", "afother", ",", 
           RowBox[{"amother", "-", "1", "+", "1", "-", "aself"}]}], "]"}], 
         "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"adapted", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "nonfocal", " ", "offspring", " ", "that",
          " ", "is", " ", "maladapted"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "amother", " ", 
       RowBox[{"mpotherdp", "[", 
        RowBox[{"es", ",", "afother", ",", "aself", ",", "amother"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "aself", ",", "afother", ",", 
           RowBox[{"amother", "-", "1"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "contribution", " ", "through", " ", "dispersing", " ", "daughters"}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "k"}], ")"}], 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"nes", ",", "naf", ",", "nam"}], "]"}], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "on", " ", "other", " ", "patch", " ", "maladapted", " ", 
              "female", " ", "dies"}], ",", " ", 
             RowBox[{"replaced", " ", "by", " ", "focal", " ", "daughter"}]}],
             " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"nf", "-", "naf"}], ">", "0"}], ",", "1", ",", "0"}], 
              "]"}], 
             RowBox[{"(", 
              RowBox[{"nf", "-", "naf"}], ")"}], 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself"}], "]"}]}], ")"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "naf"}], "]"}]}], "\[Zeta]f", " ", 
                RowBox[{"v", "[", 
                 RowBox[{"F", ",", "nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "naf", ",", 
                  "nam"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself"}], "]"}], "+", 
                   RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "naf"}], "]"}]}], "\[Zeta]f", " ", 
                RowBox[{"v", "[", 
                 RowBox[{"F", ",", "nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "naf", ",", "nam"}], "]"}]}]}], ")"}]}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "on", " ", "other", " ", "patch", " ", "adapted", " ", "female",
                " ", "dies"}], ",", " ", 
              RowBox[{
              "replaced", " ", "by", " ", "focal", " ", "daughter"}]}], " ", 
             "*)"}], "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"naf", ">", "0"}], ",", "1", ",", "0"}], "]"}], "naf", 
             " ", 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself"}], "]"}]}], ")"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "naf"}], "]"}]}], "\[Zeta]f", " ", 
                RowBox[{"v", "[", 
                 RowBox[{"F", ",", "nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", 
                  RowBox[{"naf", "-", "1"}], ",", "nam"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself"}], "]"}], "+", 
                   RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "naf"}], "]"}]}], "\[Zeta]f", " ", 
                RowBox[{"v", "[", 
                 RowBox[{"F", ",", "nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  RowBox[{"naf", "-", "1"}], ",", "nam"}], "]"}]}]}], ")"}]}],
             "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "on", " ", "other", " ", "patch", " ", "maladapted", " ", 
               "male", " ", "dies"}], ",", " ", 
              RowBox[{"replaced", " ", "by", " ", 
               RowBox[{"focal", "'"}], "s", " ", "son"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"nm", "-", "nam"}], ">", "0"}], ",", "1", ",", "0"}], 
              "]"}], 
             RowBox[{"(", 
              RowBox[{"nm", "-", "nam"}], ")"}], 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself"}], "]"}]}], ")"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "naf"}], "]"}]}], "\[Zeta]f", " ", 
                RowBox[{"v", "[", 
                 RowBox[{"M", ",", "nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "naf", ",", 
                  "nam"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself"}], "]"}], "+", 
                   RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "naf"}], "]"}]}], "\[Zeta]f", " ", 
                RowBox[{"v", "[", 
                 RowBox[{"M", ",", "nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "naf", ",", "nam"}], "]"}]}]}], ")"}]}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "on", " ", "other", " ", "patch", " ", "adapted", " ", "male", 
               " ", "dies"}], ",", " ", 
              RowBox[{"replaced", " ", "by", " ", 
               RowBox[{"focal", "'"}], "s", " ", "son"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"nam", ">", "0"}], ",", "1", ",", "0"}], "]"}], "nam", 
             " ", 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself"}], "]"}]}], ")"}]}], ")"}], 
                 "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "naf"}], "]"}]}], "\[Zeta]f", " ", 
                RowBox[{"v", "[", 
                 RowBox[{"M", ",", "nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "naf", ",", 
                  RowBox[{"nam", "-", "1"}]}], "]"}]}], "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself"}], "]"}], "+", 
                   RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "naf"}], "]"}]}], "\[Zeta]f", " ", 
                RowBox[{"v", "[", 
                 RowBox[{"M", ",", "nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "naf", ",", 
                  RowBox[{"nam", "-", "1"}]}], "]"}]}]}], ")"}]}]}], 
           "\[IndentingNewLine]", ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"nes", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"naf", ",", "0", ",", "nf"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"nam", ",", "0", ",", "nm"}], "}"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"afother", ",", "0", ",", 
       RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"amother", ",", "0", ",", "nm"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.607710024159892*^9, 3.6077100622289877`*^9}, {
   3.6077101035077*^9, 3.607710449682431*^9}, {3.607710525042615*^9, 
   3.607710551932008*^9}, {3.607711060288571*^9, 3.607711203761673*^9}, {
   3.6077118540809097`*^9, 3.607712102663315*^9}, {3.6077121332014112`*^9, 
   3.607712188455039*^9}, {3.607712431740385*^9, 3.607712584187216*^9}, {
   3.607712638319611*^9, 3.607712779762582*^9}, {3.6077128159191523`*^9, 
   3.607712863149374*^9}, {3.607712918654314*^9, 3.60771303816463*^9}, {
   3.607713108008183*^9, 3.607713367018127*^9}, {3.607746457814937*^9, 
   3.607746625258058*^9}, {3.6077466998129683`*^9, 3.607746778708292*^9}, {
   3.607746851756618*^9, 3.60774689259164*^9}, {3.6077469228011*^9, 
   3.607746991319029*^9}, {3.607747093942842*^9, 3.607747269606563*^9}, {
   3.60774731790816*^9, 3.607747353437495*^9}, {3.607747576428068*^9, 
   3.607747699551612*^9}, {3.607747768329611*^9, 3.6077482430245037`*^9}, {
   3.607748307203107*^9, 3.6077483085551367`*^9}, {3.6077483960963917`*^9, 
   3.6077484401872168`*^9}, {3.607748506517583*^9, 3.607748509629672*^9}, {
   3.607748547313942*^9, 3.6077485594956827`*^9}, {3.607748595888028*^9, 
   3.607748769530881*^9}, {3.607748815341617*^9, 3.6077488324068117`*^9}, {
   3.607748866417753*^9, 3.6077489100306883`*^9}, 3.60774903661935*^9, {
   3.607749102247521*^9, 3.607749108223583*^9}, 3.607754882280727*^9, {
   3.607768129775573*^9, 3.607768147462255*^9}, {3.607773815186453*^9, 
   3.607773816360799*^9}, {3.607783855006694*^9, 3.6077839548463593`*^9}, {
   3.607786352865641*^9, 3.607786383729803*^9}, {3.607786511144271*^9, 
   3.607786575445613*^9}, {3.607786913989482*^9, 3.60778693081234*^9}, {
   3.607786994964107*^9, 3.6077869952230167`*^9}, {3.607787084676858*^9, 
   3.60778708817706*^9}, {3.6077883672104883`*^9, 3.60778837186108*^9}, {
   3.6077984337233686`*^9, 3.607798446703948*^9}, {3.607798526840399*^9, 
   3.607798526998168*^9}, {3.608386003969925*^9, 3.6083860981595373`*^9}, 
   3.608467028591148*^9, {3.608470136774881*^9, 3.6084701463755093`*^9}, {
   3.608470291385417*^9, 3.608470296746908*^9}, {3.608470396212286*^9, 
   3.60847039902967*^9}, {3.6084704331465607`*^9, 3.608470438788924*^9}, {
   3.6084876311787567`*^9, 3.608487634757777*^9}, 3.6085256769962482`*^9, {
   3.608621465153825*^9, 3.608621473132889*^9}, {3.616052607993672*^9, 
   3.616052631277698*^9}, {3.616053207771772*^9, 3.616053214748473*^9}, {
   3.6160532696082497`*^9, 3.6160532729455147`*^9}, {3.6160533231526823`*^9, 
   3.616053329617548*^9}, {3.616053378938492*^9, 3.616053388263289*^9}, {
   3.616053444456094*^9, 3.616053444563608*^9}, {3.616054293183058*^9, 
   3.616054376804119*^9}, {3.616054418639605*^9, 3.6160544602341137`*^9}, {
   3.616055217518074*^9, 3.616055378285541*^9}, {3.616068393525023*^9, 
   3.616068400195424*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Selection differential of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["p", "1"], ",", 
    SubscriptBox["p", "2"]}], TraditionalForm]]],
 " in males"
}], "Subsection",
 CellChangeTimes->{{3.616139629352222*^9, 3.616139649026832*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdptabM", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"environmental", " ", "change"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", "es", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"M", ",", 
           RowBox[{"3", "-", "es"}], ",", 
           RowBox[{"1", "-", "aself"}], ",", 
           RowBox[{"nf", "-", "afother"}], ",", 
           RowBox[{"nm", "-", "1", "-", "amother"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"focal", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focally", " ", "sired", " ", "son", " ", 
         "that", " ", "is", " ", "adapted"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"afother", "/", "nf"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"es", ",", "1"}], "]"}], "+", 
               RowBox[{
                FractionBox[
                 RowBox[{"r", "[", 
                  RowBox[{"aF", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                   RowBox[{"aself", "+", "amother"}]}], "]"}], 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                RowBox[{"dp", "[", 
                 RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "nm"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nf", "-", "afother"}], ")"}], "/", "nf"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "0"}], "]"}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"mF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"aself", "+", "amother"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dp", "[", 
               RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", "afother"}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"v", "[", 
           RowBox[{"M", ",", "es", ",", "1", ",", "afother", ",", "amother"}],
            "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"focal", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focally", " ", "sired", " ", "son", " ", 
         "that", " ", "is", " ", "maladapted"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           FractionBox["afother", "nf"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "1"}], "]"}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"aF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"aself", "+", "amother"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dp", "[", 
               RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           FractionBox[
            RowBox[{"(", 
             RowBox[{"nf", "-", "afother"}], ")"}], "nf"], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"es", ",", "0"}], "]"}], "+", 
               RowBox[{
                FractionBox[
                 RowBox[{"r", "[", 
                  RowBox[{"mF", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                   RowBox[{"aself", "+", "amother"}]}], "]"}], 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                RowBox[{"dp", "[", 
                 RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", "afother"}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"v", "[", 
           RowBox[{"M", ",", "es", ",", "0", ",", "afother", ",", "amother"}],
            "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"focal", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", "nonfocal", " ", "offspring"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", "nm"}], ")"}], 
              FractionBox["afother", "nf"], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "1"}], "]"}]}], ")"}], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "1"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", "nm"}], ")"}], 
              FractionBox[
               RowBox[{"(", 
                RowBox[{"nf", "-", "afother"}], ")"}], "nf"], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "0"}], "]"}]}], ")"}], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "afother"}], "]"}]}], ")"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "maladapted", " ", "male", " ", "dies"}], ",", 
        " ", 
        RowBox[{
        "replaced", " ", "by", " ", "adapted", " ", "focal", " ", "son"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", "<", 
          RowBox[{"nm", "-", "1"}]}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nm", "-", "1", "-", "amother"}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"afother", "/", "nf"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"es", ",", "1"}], "]"}], "+", 
               RowBox[{
                FractionBox[
                 RowBox[{"r", "[", 
                  RowBox[{"aF", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                   RowBox[{"aself", "+", "amother"}]}], "]"}], 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                RowBox[{"dp", "[", 
                 RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "nm"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nf", "-", "afother"}], ")"}], "/", "nf"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "0"}], "]"}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"mF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"aself", "+", "amother"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dp", "[", 
               RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", "afother"}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"v", "[", 
           RowBox[{"M", ",", "es", ",", "1", ",", "afother", ",", 
            RowBox[{"amother", "+", "aself"}]}], "]"}]}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"M", ",", "es", ",", "aself", ",", "afother", ",", 
           RowBox[{"amother", "+", "1"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "maladapted", " ", "male", " ", "dies"}], ",", 
        " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "focal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", "<", 
          RowBox[{"nm", "-", "1"}]}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nm", "-", "1", "-", "amother"}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"afother", "/", "nf"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "1"}], "]"}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"aF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"aself", "+", "amother"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dp", "[", 
               RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "nm"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nf", "-", "afother"}], ")"}], "/", "nf"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"es", ",", "0"}], "]"}], "+", 
               RowBox[{
                FractionBox[
                 RowBox[{"r", "[", 
                  RowBox[{"mF", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                   RowBox[{"aself", "+", "amother"}]}], "]"}], 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                RowBox[{"dp", "[", 
                 RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", "afother"}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"v", "[", 
          RowBox[{"M", ",", "es", ",", "0", ",", "afother", ",", 
           RowBox[{"amother", "+", "aself"}]}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "maladapted", " ", "male", " ", "dies"}], ",", 
        " ", 
        RowBox[{
        "replaced", " ", "by", " ", "adapted", " ", "nonfocal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", "<", 
          RowBox[{"nm", "-", "1"}]}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nm", "-", "1", "-", "amother"}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"(", 
             RowBox[{"nm", "-", "1"}], ")"}], "nm"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["afother", "nf"], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "1"}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"p", "[", 
                   RowBox[{"es", ",", "1"}], "]"}], "+", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"r", "[", 
                    RowBox[{"aF", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}], 
                    RowBox[{
                    FractionBox["1", "2"], 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                   RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "1"}], "]"}]}], ")"}]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"nf", "-", "afother"}], "nf"], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "0"}], "]"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"es", ",", "0"}], "]"}], "+", 
                RowBox[{
                 FractionBox[
                  RowBox[{"r", "[", 
                   RowBox[{"mF", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}], 
                  RowBox[{
                   FractionBox["1", "2"], 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                 RowBox[{"dp", "[", 
                  RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "0"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"dispad", "[", "es", "]"}]}], ")"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", "afother"}], "]"}]}], "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"M", ",", "es", ",", "aself", ",", "afother", ",", 
           RowBox[{"amother", "+", "1"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "adapted", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "amother", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"afother", "/", "nf"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"es", ",", "1"}], "]"}], "+", 
               RowBox[{
                FractionBox[
                 RowBox[{"r", "[", 
                  RowBox[{"aF", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                   RowBox[{"aself", "+", "amother"}]}], "]"}], 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                RowBox[{"dp", "[", 
                 RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "nm"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nf", "-", "afother"}], ")"}], "/", "nf"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "0"}], "]"}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"mF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"aself", "+", "amother"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dp", "[", 
               RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", "afother"}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"v", "[", 
          RowBox[{"M", ",", "es", ",", "1", ",", "afother", ",", 
           RowBox[{"amother", "-", "1", "+", "aself"}]}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "adapted", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "focal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "amother", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"afother", "/", "nf"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "1"}], "]"}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"aF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"aself", "+", "amother"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dp", "[", 
               RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "nm"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nf", "-", "afother"}], ")"}], "/", "nf"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"es", ",", "0"}], "]"}], "+", 
               RowBox[{
                FractionBox[
                 RowBox[{"r", "[", 
                  RowBox[{"mF", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                   RowBox[{"aself", "+", "amother"}]}], "]"}], 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                RowBox[{"dp", "[", 
                 RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", "afother"}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"v", "[", 
           RowBox[{"M", ",", "es", ",", "0", ",", "afother", ",", 
            RowBox[{"amother", "-", "1", "+", "aself"}]}], "]"}]}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"M", ",", "es", ",", "aself", ",", "afother", ",", 
           RowBox[{"amother", "-", "1"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", " ", "amother"}],
           "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "adapted", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "nonfocal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "amother", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"nm", "-", "1"}], "nm"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["afother", "nf"], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "1"}], "]"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"es", ",", "1"}], "]"}], "+", 
                RowBox[{
                 FractionBox[
                  RowBox[{"r", "[", 
                   RowBox[{"aF", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}], 
                  RowBox[{
                   FractionBox["1", "2"], 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                 RowBox[{"dp", "[", 
                  RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "1"}], "]"}]}], ")"}]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"nf", "-", "afother"}], "nf"], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "0"}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"p", "[", 
                   RowBox[{"es", ",", "0"}], "]"}], "+", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"r", "[", 
                    RowBox[{"mF", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}], 
                    RowBox[{
                    FractionBox["1", "2"], 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                   RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "0"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"dispmad", "[", "es", "]"}]}], ")"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", "afother"}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"M", ",", "es", ",", "aself", ",", "afother", ",", 
           RowBox[{"amother", "-", "1"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"maladapted", " ", "female", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"nf", "-", "afother"}], ">", "0"}], ",", "1", ",", "0"}], 
        "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nf", "-", "afother"}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"afother", "/", "nf"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"es", ",", "1"}], "]"}], "+", 
               RowBox[{
                FractionBox[
                 RowBox[{"r", "[", 
                  RowBox[{"aF", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                   RowBox[{"aself", "+", "amother"}]}], "]"}], 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                RowBox[{"dp", "[", 
                 RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "nm"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nf", "-", "afother"}], ")"}], "/", "nf"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "0"}], "]"}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"mF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"aself", "+", "amother"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dp", "[", 
               RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", "afother"}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"v", "[", 
           RowBox[{"F", ",", "es", ",", "1", ",", "afother", ",", 
            RowBox[{"amother", "+", "aself"}]}], "]"}]}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"M", ",", "es", ",", "aself", ",", 
           RowBox[{"afother", "+", "1"}], ",", "amother"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"maladapted", " ", "female", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "focal", " ", 
         "daughter"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"nf", "-", "afother"}], ">", "0"}], ",", "1", ",", "0"}], 
        "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nf", "-", "afother"}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"afother", "/", "nf"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "1"}], "]"}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"aF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"aself", "+", "amother"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dp", "[", 
               RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "nm"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nf", "-", "afother"}], ")"}], "/", "nf"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"es", ",", "0"}], "]"}], "+", 
               RowBox[{
                FractionBox[
                 RowBox[{"r", "[", 
                  RowBox[{"mF", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                   RowBox[{"aself", "+", "amother"}]}], "]"}], 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                RowBox[{"dp", "[", 
                 RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", "afother"}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "0", ",", "afother", ",", 
           RowBox[{"amother", "+", "aself"}]}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"maladapted", " ", "female", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "adapted", " ", "nonfocal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"nf", "-", "afother"}], ">", "0"}], ",", "1", ",", "0"}], 
        "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nf", "-", "afother"}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"(", 
             RowBox[{"nm", "-", "1"}], ")"}], "nm"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["afother", "nf"], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "1"}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"p", "[", 
                   RowBox[{"es", ",", "1"}], "]"}], "+", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"r", "[", 
                    RowBox[{"aF", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}], 
                    RowBox[{
                    FractionBox["1", "2"], 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                   RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "1"}], "]"}]}], ")"}]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"nf", "-", "afother"}], "nf"], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "0"}], "]"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"es", ",", "0"}], "]"}], "+", 
                RowBox[{
                 FractionBox[
                  RowBox[{"r", "[", 
                   RowBox[{"mF", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}], 
                  RowBox[{
                   FractionBox["1", "2"], 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                 RowBox[{"dp", "[", 
                  RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "0"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"dispad", "[", "es", "]"}]}], ")"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", "afother"}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"M", ",", "es", ",", "aself", ",", 
           RowBox[{"afother", "+", "1"}], ",", "amother"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"adapted", " ", "female", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
         "daughter"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"afother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "afother", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"afother", "/", "nf"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"es", ",", "1"}], "]"}], "+", 
               RowBox[{
                FractionBox[
                 RowBox[{"r", "[", 
                  RowBox[{"aF", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                   RowBox[{"aself", "+", "amother"}]}], "]"}], 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                RowBox[{"dp", "[", 
                 RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "nm"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nf", "-", "afother"}], ")"}], "/", "nf"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "0"}], "]"}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"mF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"aself", "+", "amother"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dp", "[", 
               RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", "afother"}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "1", ",", 
           RowBox[{"afother", "-", "1"}], ",", 
           RowBox[{"amother", "+", "aself"}]}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"adapted", " ", "female", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "focal", " ", 
         "daughter"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"afother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "afother", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"afother", "/", "nf"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "1"}], "]"}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"aF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"aself", "+", "amother"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dp", "[", 
               RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "nm"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nf", "-", "afother"}], ")"}], "/", "nf"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"es", ",", "0"}], "]"}], "+", 
               RowBox[{
                FractionBox[
                 RowBox[{"r", "[", 
                  RowBox[{"mF", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                   RowBox[{"aself", "+", "amother"}]}], "]"}], 
                 RowBox[{
                  FractionBox["1", "2"], 
                  RowBox[{"(", 
                   RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                RowBox[{"dp", "[", 
                 RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", "afother"}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"v", "[", 
           RowBox[{"F", ",", "es", ",", "0", ",", 
            RowBox[{"afother", "-", "1"}], ",", 
            RowBox[{"amother", "+", "aself"}]}], "]"}]}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"M", ",", "es", ",", "aself", ",", 
           RowBox[{"afother", "-", "1"}], ",", "amother"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"adapted", " ", "female", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "nonfocal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"afother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "afother", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"(", 
             RowBox[{"nm", "-", "1"}], ")"}], "nm"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["afother", "nf"], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "1"}], "]"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"es", ",", "1"}], "]"}], "+", 
                RowBox[{
                 FractionBox[
                  RowBox[{"r", "[", 
                   RowBox[{"aF", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}], 
                  RowBox[{
                   FractionBox["1", "2"], 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                 RowBox[{"dp", "[", 
                  RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "1"}], "]"}]}], ")"}]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"nf", "-", "afother"}], "nf"], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "0"}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"p", "[", 
                   RowBox[{"es", ",", "0"}], "]"}], "+", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"r", "[", 
                    RowBox[{"mF", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}], 
                    RowBox[{
                    FractionBox["1", "2"], 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                   RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "0"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"dispmad", "[", "es", "]"}]}], ")"}], "/", 
        RowBox[{"localcomptotal", "[", 
         RowBox[{"es", ",", "afother"}], "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"M", ",", "es", ",", "aself", ",", 
           RowBox[{"afother", "-", "1"}], ",", "amother"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "contribution", " ", "through", " ", "adapted", " ", "dispersing", " ",
         "offspring"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "nm"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["afother", "nf"], 
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "1"}], "]"}], 
          RowBox[{"m", "[", 
           RowBox[{"es", ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"es", ",", "1"}], "]"}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"r", "[", 
                 RowBox[{"aF", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                  RowBox[{"aself", "+", "amother"}]}], "]"}], 
                RowBox[{
                 FractionBox["1", "2"], 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
               RowBox[{"dp", "[", 
                RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}]}], ")"}]}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"nf", "-", "afother"}], "nf"], 
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "0"}], "]"}], 
          RowBox[{"m", "[", 
           RowBox[{"es", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "0"}], "]"}], "+", 
            RowBox[{
             FractionBox[
              RowBox[{"r", "[", 
               RowBox[{"mF", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}], 
                 "]"}], ",", "es", ",", "afother", ",", 
                RowBox[{"aself", "+", "amother"}]}], "]"}], 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"F", "[", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                   RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "k"}], ")"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"nes", ",", "naf", ",", "nam"}], "]"}], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "on", " ", "other", " ", "patch", " ", "maladapted", " ", 
              "female", " ", "dies"}], ",", " ", 
             RowBox[{
             "replaced", " ", "by", " ", "locally", " ", "adapted", " ", 
              "dispersing", " ", "focal", " ", "daughter"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"nf", "-", "naf"}], ">", "0"}], ",", "1", ",", "0"}], 
              "]"}], 
             RowBox[{"(", 
              RowBox[{"nf", "-", "naf"}], ")"}], 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"localcomptotal", "[", 
                RowBox[{"nes", ",", "naf"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"v", "[", 
                RowBox[{"F", ",", "nes", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"nes", "\[Equal]", "es"}], ",", "1", ",", "0"}], 
                  "]"}], ",", "naf", ",", "nam"}], "]"}]}], ")"}]}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "on", " ", "other", " ", "patch", " ", "adapted", " ", "female",
                " ", "dies"}], ",", " ", 
              RowBox[{
              "replaced", " ", "by", " ", "locally", " ", "adapted", " ", 
               "dispersing", " ", "focal", " ", "daughter"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"naf", ">", "0"}], ",", "1", ",", "0"}], "]"}], "naf", 
             " ", 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"localcomptotal", "[", 
                RowBox[{"nes", ",", "naf"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"v", "[", 
                RowBox[{"F", ",", "nes", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"nes", "\[Equal]", "es"}], ",", "1", ",", "0"}], 
                  "]"}], ",", 
                 RowBox[{"naf", "-", "1"}], ",", "nam"}], "]"}]}], ")"}]}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "on", " ", "other", " ", "patch", " ", "maladapted", " ", 
               "male", " ", "dies"}], ",", " ", 
              RowBox[{
              "replaced", " ", "by", " ", "locally", " ", "adapted", " ", 
               "dispersing", " ", "focal", " ", "son"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"nm", "-", "nam"}], ">", "0"}], ",", "1", ",", "0"}], 
              "]"}], 
             RowBox[{"(", 
              RowBox[{"nm", "-", "nam"}], ")"}], 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"localcomptotal", "[", 
                RowBox[{"nes", ",", "naf"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"v", "[", 
                RowBox[{"M", ",", "nes", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"nes", "\[Equal]", "es"}], ",", "1", ",", "0"}], 
                  "]"}], ",", "naf", ",", "nam"}], "]"}]}], ")"}]}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "on", " ", "other", " ", "patch", " ", "adapted", " ", "male", 
               " ", "dies"}], ",", " ", 
              RowBox[{
              "replaced", " ", "by", " ", "locally", " ", "adapted", " ", 
               "dispersing", " ", "focal", " ", "son"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"nam", ">", "0"}], ",", "1", ",", "0"}], "]"}], "nam", 
             " ", 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"localcomptotal", "[", 
                RowBox[{"nes", ",", "naf"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"v", "[", 
                RowBox[{"M", ",", "nes", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"nes", "\[Equal]", "es"}], ",", "1", ",", "0"}], 
                  "]"}], ",", "naf", ",", 
                 RowBox[{"nam", "-", "1"}]}], "]"}]}], ")"}]}]}], 
           "\[IndentingNewLine]", ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"nes", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"naf", ",", "0", ",", "nf"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"nam", ",", "0", ",", "nm"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "contribution", " ", "through", " ", "maladapted", " ", "dispersing", 
        " ", "offspring"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "nm"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["afother", "nf"], 
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "1"}], "]"}], 
          RowBox[{"m", "[", 
           RowBox[{"es", ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "1"}], "]"}], "+", 
            RowBox[{
             FractionBox[
              RowBox[{"r", "[", 
               RowBox[{"aF", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}], 
                 "]"}], ",", "es", ",", "afother", ",", 
                RowBox[{"aself", "+", "amother"}]}], "]"}], 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"F", "[", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                   RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"nf", "-", "afother"}], "nf"], 
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "0"}], "]"}], 
          RowBox[{"m", "[", 
           RowBox[{"es", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"es", ",", "0"}], "]"}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"r", "[", 
                 RowBox[{"mF", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                  RowBox[{"aself", "+", "amother"}]}], "]"}], 
                RowBox[{
                 FractionBox["1", "2"], 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
               RowBox[{"dp", "[", 
                RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}]}], ")"}]}]}], 
        ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "k"}], ")"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"nes", ",", "naf", ",", "nam"}], "]"}], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "on", " ", "other", " ", "patch", " ", "maladapted", " ", 
              "female", " ", "dies"}], ",", " ", 
             RowBox[{
             "replaced", " ", "by", " ", "locally", " ", "maladapted", " ", 
              "dispersing", " ", "focal", " ", "daughter"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"nf", "-", "naf"}], ">", "0"}], ",", "1", ",", "0"}], 
              "]"}], 
             RowBox[{"(", 
              RowBox[{"nf", "-", "naf"}], ")"}], 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"localcomptotal", "[", 
                RowBox[{"nes", ",", "naf"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"v", "[", 
                RowBox[{"F", ",", "nes", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"nes", "\[Equal]", "es"}], ",", "0", ",", "1"}], 
                  "]"}], ",", "naf", ",", "nam"}], "]"}]}], ")"}]}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "on", " ", "other", " ", "patch", " ", "adapted", " ", "female",
                " ", "dies"}], ",", " ", 
              RowBox[{
              "replaced", " ", "by", " ", "locally", " ", "maladapted", " ", 
               "dispersing", " ", "focal", " ", "daughter"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"naf", ">", "0"}], ",", "1", ",", "0"}], "]"}], "naf", 
             " ", 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"localcomptotal", "[", 
                RowBox[{"nes", ",", "naf"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"v", "[", 
                RowBox[{"F", ",", "nes", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"nes", "\[Equal]", "es"}], ",", "0", ",", "1"}], 
                  "]"}], ",", 
                 RowBox[{"naf", "-", "1"}], ",", "nam"}], "]"}]}], ")"}]}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "on", " ", "other", " ", "patch", " ", "maladapted", " ", 
               "male", " ", "dies"}], ",", " ", 
              RowBox[{
              "replaced", " ", "by", " ", "locally", " ", "maladapted", " ", 
               "dispersing", " ", "focal", " ", "son"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"nm", "-", "nam"}], ">", "0"}], ",", "1", ",", "0"}], 
              "]"}], 
             RowBox[{"(", 
              RowBox[{"nm", "-", "nam"}], ")"}], 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"localcomptotal", "[", 
                RowBox[{"nes", ",", "naf"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"v", "[", 
                RowBox[{"M", ",", "nes", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"nes", "\[Equal]", "es"}], ",", "0", ",", "1"}], 
                  "]"}], ",", "naf", ",", "nam"}], "]"}]}], ")"}]}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "on", " ", "other", " ", "patch", " ", "adapted", " ", "male", 
               " ", "dies"}], ",", " ", 
              RowBox[{
              "replaced", " ", "by", " ", "locally", " ", "maladapted", " ", 
               "dispersing", " ", "focal", " ", "son"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"nam", ">", "0"}], ",", "1", ",", "0"}], "]"}], "nam", 
             " ", 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"localcomptotal", "[", 
                RowBox[{"nes", ",", "naf"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"v", "[", 
                RowBox[{"M", ",", "nes", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"nes", "\[Equal]", "es"}], ",", "0", ",", "1"}], 
                  "]"}], ",", "naf", ",", 
                 RowBox[{"nam", "-", "1"}]}], "]"}]}], ")"}]}]}], 
           "\[IndentingNewLine]", ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"nes", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"naf", ",", "0", ",", "nf"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"nam", ",", "0", ",", "nm"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"afother", ",", "0", ",", "nf"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"amother", ",", "0", ",", 
       RowBox[{"nm", "-", "1"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.607749080845442*^9, 3.607749278134346*^9}, {
   3.607749417512814*^9, 3.60774965480284*^9}, 3.607752708926364*^9, {
   3.607752747073036*^9, 3.6077528347738047`*^9}, {3.607752888253538*^9, 
   3.607752895456485*^9}, {3.607752976387184*^9, 3.607753010354801*^9}, {
   3.607753299583436*^9, 3.607753366631905*^9}, {3.6077534214214363`*^9, 
   3.607753655373757*^9}, {3.607753709939036*^9, 3.607753798932526*^9}, {
   3.60775393802028*^9, 3.607754036711198*^9}, {3.607754343625559*^9, 
   3.6077545342212973`*^9}, {3.607754575234049*^9, 3.607754697016541*^9}, {
   3.607754744881271*^9, 3.607754808086377*^9}, {3.6077548602643223`*^9, 
   3.6077548667368727`*^9}, {3.6077549348192873`*^9, 3.607754967919413*^9}, {
   3.607755200360134*^9, 3.607755247123167*^9}, {3.607755411290081*^9, 
   3.6077558164365807`*^9}, {3.6077560397220163`*^9, 3.607756151166535*^9}, {
   3.6077561959926558`*^9, 3.6077563642050743`*^9}, {3.607756394853545*^9, 
   3.6077566458061953`*^9}, 3.607756750957654*^9, {3.607773860013817*^9, 
   3.6077738610305977`*^9}, {3.60777399109801*^9, 3.6077739932004766`*^9}, {
   3.607774024157963*^9, 3.607774024331231*^9}, {3.607774226492058*^9, 
   3.607774251729384*^9}, 3.6077742907718143`*^9, {3.607774334832057*^9, 
   3.607774335394311*^9}, {3.607774380131329*^9, 3.607774399510552*^9}, {
   3.607775335434561*^9, 3.6077753618786993`*^9}, {3.607775538603858*^9, 
   3.607775574523509*^9}, {3.607784002242929*^9, 3.6077840755411*^9}, {
   3.607787357999858*^9, 3.6077873591871223`*^9}, {3.607787392058552*^9, 
   3.607787428810658*^9}, {3.607787488723486*^9, 3.6077874908684072`*^9}, {
   3.607787639990876*^9, 3.607787640461546*^9}, {3.607787670982884*^9, 
   3.607787679062139*^9}, {3.607787713117484*^9, 3.6077877527572002`*^9}, 
   3.607787809496438*^9, {3.607787848202323*^9, 3.607787880129773*^9}, 
   3.6077879589694138`*^9, {3.6077880002674932`*^9, 3.607788037583931*^9}, {
   3.607788075797366*^9, 3.607788083386612*^9}, 3.607788137284708*^9, 
   3.6077881991628437`*^9, 3.607788331653124*^9, {3.607788971513145*^9, 
   3.6077889779538183`*^9}, {3.607797679516232*^9, 3.607797679974475*^9}, {
   3.607801509655448*^9, 3.6078015097677402`*^9}, {3.607801539779004*^9, 
   3.607801560477684*^9}, {3.608474394376128*^9, 3.608474445604845*^9}, {
   3.6084745617745256`*^9, 3.608474692604041*^9}, {3.608474724544179*^9, 
   3.608474750370428*^9}, {3.608474832334064*^9, 3.608474845834807*^9}, {
   3.60847512350177*^9, 3.608475125953286*^9}, {3.6084883163236628`*^9, 
   3.608488376320362*^9}, 3.608525677002192*^9, 3.6085260539750023`*^9, {
   3.615999612510981*^9, 3.6159996276520557`*^9}, {3.615999804684945*^9, 
   3.615999822829233*^9}, {3.616000704617737*^9, 3.616000707905291*^9}, {
   3.61600164561875*^9, 3.616001702001153*^9}, {3.616001890312467*^9, 
   3.616001894167672*^9}, {3.616045970015386*^9, 3.616045979696434*^9}, {
   3.6160472162288227`*^9, 3.616047259866927*^9}, {3.6160484975495853`*^9, 
   3.6160485390235786`*^9}, {3.61604863807401*^9, 3.61604863876516*^9}, {
   3.616049333150598*^9, 3.6160493542483597`*^9}, {3.616049434216571*^9, 
   3.616049434323537*^9}, {3.6160494732729273`*^9, 3.616049507963722*^9}, {
   3.616049834779104*^9, 3.616049897372734*^9}, {3.616050257105153*^9, 
   3.616050262579425*^9}, {3.6160502999499407`*^9, 3.616050358101055*^9}, {
   3.616050474398443*^9, 3.616050482371727*^9}, 3.616050534001792*^9, 
   3.616050574928587*^9, {3.61605112667347*^9, 3.61605119190327*^9}, {
   3.6160513049836807`*^9, 3.616051355724963*^9}, {3.616159937726345*^9, 
   3.616160042198649*^9}, {3.6161601737462797`*^9, 3.616160254810392*^9}, {
   3.616160633524826*^9, 3.6161606991591043`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Evaluation of both selection differentials\
\>", "Subsection",
 CellChangeTimes->{3.616139686679941*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dpsublist", "=", 
  RowBox[{"Thread", "[", 
   RowBox[{"varlistdP", "\[Rule]", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.505155683348345*^9, 3.505155686225337*^9}, {
  3.50721469122375*^9, 3.507214735381866*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dp1", "\[Rule]", "0"}], ",", 
   RowBox[{"dp2", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.616066727452614*^9, 3.616066935559095*^9, 3.616067442097954*^9, 
   3.616067720648232*^9, 3.6160686504997807`*^9, 3.616134355313846*^9, 
   3.616134678396718*^9, 3.6161419633837633`*^9, 3.616142173604439*^9, 
   3.616153794114395*^9, 3.616160268655364*^9, 3.6161608658806257`*^9, {
   3.6162319663400507`*^9, 3.6162319931764517`*^9}, 3.6162330109303713`*^9, 
   3.6185622422615623`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dveqdptM", "[", "dpval_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"dvdptabM", "[", 
         RowBox[{"[", 
          RowBox[{"es", ",", 
           RowBox[{"1", "+", "aself"}], ",", 
           RowBox[{"1", "+", "afother"}], ",", 
           RowBox[{"1", "+", "amother"}]}], "]"}], "]"}], ",", "dpval"}], 
       "]"}], "/.", "dpsublist"}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"afother", ",", "0", ",", "nf"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"amother", ",", "0", ",", 
       RowBox[{"nm", "-", "1"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.501843432551832*^9, 3.50184343360995*^9}, {
   3.501843944380341*^9, 3.501843964281032*^9}, 3.501844040723341*^9, {
   3.505138889414682*^9, 3.50513890024374*^9}, {3.505140339692244*^9, 
   3.505140380980634*^9}, {3.505155691794249*^9, 3.505155696978383*^9}, {
   3.616055864194425*^9, 3.616055877835294*^9}, {3.616063327990137*^9, 
   3.616063364094*^9}, 3.616063435500227*^9, {3.6160671442790537`*^9, 
   3.616067144632298*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dveqdptF", "[", "dpval_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"dvdptabF", "[", 
         RowBox[{"[", 
          RowBox[{"es", ",", 
           RowBox[{"1", "+", "aself"}], ",", 
           RowBox[{"1", "+", "afother"}], ",", 
           RowBox[{"1", "+", "amother"}]}], "]"}], "]"}], ",", "dpval"}], 
       "]"}], "/.", "dpsublist"}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"afother", ",", "0", ",", 
       RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"amother", ",", "0", ",", "nm"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.501843432551832*^9, 3.50184343360995*^9}, {
   3.501843944380341*^9, 3.501843964281032*^9}, 3.501844040723341*^9, {
   3.505138889414682*^9, 3.50513890024374*^9}, {3.505140339692244*^9, 
   3.505140380980634*^9}, {3.505155691794249*^9, 3.505155696978383*^9}, {
   3.616055864194425*^9, 3.616055877835294*^9}, {3.616063327990137*^9, 
   3.616063364094*^9}, {3.616063435500227*^9, 3.616063458838635*^9}, {
   3.616067146423418*^9, 3.616067146822135*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dveqdp", "[", "dpval_", "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"es", ",", "af", ",", "am"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"af", ">", "0"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"af", "/", "nf"}], ")"}], 
          RowBox[{
           RowBox[{"dveqdptF", "[", "dpval", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"es", ",", 
             RowBox[{"1", "+", "1"}], ",", 
             RowBox[{"1", "+", "af", "-", "1"}], ",", 
             RowBox[{"1", "+", "am"}]}], "]"}], "]"}]}], ",", "0"}], "]"}], 
       "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"af", "<", "nf"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nf", "-", "af"}], ")"}], "/", "nf"}], ")"}], 
          RowBox[{
           RowBox[{"dveqdptF", "[", "dpval", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"es", ",", 
             RowBox[{"1", "+", "0"}], ",", 
             RowBox[{"1", "+", "af"}], ",", 
             RowBox[{"1", "+", "am"}]}], "]"}], "]"}]}], ",", "0"}], "]"}], 
       "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"am", ">", "0"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"am", "/", "nm"}], ")"}], 
          RowBox[{
           RowBox[{"dveqdptM", "[", "dpval", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"es", ",", 
             RowBox[{"1", "+", "1"}], ",", 
             RowBox[{"1", "+", "af"}], ",", 
             RowBox[{"1", "+", "am", "-", "1"}]}], "]"}], "]"}]}], ",", "0"}],
         "]"}], "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"am", "<", "nm"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm", "-", "am"}], ")"}], "/", "nm"}], ")"}], 
          RowBox[{
           RowBox[{"dveqdptM", "[", "dpval", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"es", ",", 
             RowBox[{"1", "+", "0"}], ",", 
             RowBox[{"1", "+", "af"}], ",", 
             RowBox[{"1", "+", "am"}]}], "]"}], "]"}]}], ",", "0"}], "]"}]}], 
      ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"am", ",", "0", ",", "nm"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.501844024430171*^9, 3.5018440511114883`*^9}, {
  3.50514040533693*^9, 3.505140411037161*^9}, {3.505140552660536*^9, 
  3.50514055349495*^9}, {3.520590601347611*^9, 3.520590621759652*^9}, {
  3.52060189014863*^9, 3.520601890770993*^9}, {3.616064097243224*^9, 
  3.616064209353109*^9}, {3.6160642428914337`*^9, 3.616064259530616*^9}, {
  3.6160643008162413`*^9, 3.616064308762124*^9}, {3.6160645859989443`*^9, 
  3.6160646083037777`*^9}, {3.616064653848179*^9, 3.616064699312509*^9}, {
  3.6160647296151867`*^9, 3.616064738409442*^9}, {3.61606543024749*^9, 
  3.616065460163162*^9}, {3.616067357339373*^9, 3.616067410496578*^9}, {
  3.6161420819076777`*^9, 3.616142089063945*^9}}],

Cell["\<\
Numerical value of the selection gradient\
\>", "Text",
 CellChangeTimes->{{3.593494549744481*^9, 3.5934945648160954`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"selgradP", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "arglistM", "}"}], ",", 
    RowBox[{"{", "arglistP", "}"}], ",", "ks_", ",", "Qs_", ",", "theP_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{"dveqdp", "[", "theP", "]"}], "/.", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
           RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
           RowBox[{"k", "\[Rule]", "ks"}], ",", 
           RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
           RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
           RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
           RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
           RowBox[{"Q", "\[Rule]", "Qs"}]}], "}"}], ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"varlistM", "\[Rule]", 
           RowBox[{"List", "[", "ms", "]"}]}], "]"}], ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"varlistP", "\[Rule]", 
           RowBox[{"List", "[", "ps", "]"}]}], "]"}], ",", 
         RowBox[{"ans3", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s1s", ",", "s2s"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c1s", ",", "c2s"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"q1s", ",", "q2s"}], "}"}], ",", 
           RowBox[{"{", "ms", "}"}], ",", 
           RowBox[{"{", "ps", "}"}], ",", "ks", ",", "Qs"}], "]"}]}], "]"}]}],
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"selgradPalt", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1s_", ",", "c2s_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
     RowBox[{"{", "arglistM", "}"}], ",", 
     RowBox[{"{", "arglistP", "}"}], ",", "ks_", ",", "Qs_", ",", "theP_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"dveqdp", "[", "theP", "]"}], "/.", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
            RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
            RowBox[{"k", "\[Rule]", "ks"}], ",", 
            RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
            RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
            RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
            RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
            RowBox[{"Q", "\[Rule]", "Qs"}]}], "}"}], ",", 
          RowBox[{"Thread", "[", 
           RowBox[{"varlistM", "\[Rule]", 
            RowBox[{"List", "[", "ms", "]"}]}], "]"}], ",", 
          RowBox[{"Thread", "[", 
           RowBox[{"varlistP", "\[Rule]", 
            RowBox[{"List", "[", "ps", "]"}]}], "]"}], ",", 
          RowBox[{"ans3alt", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"s1s", ",", "s2s"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"c1s", ",", "c2s"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"q1s", ",", "q2s"}], "}"}], ",", 
            RowBox[{"{", "ms", "}"}], ",", 
            RowBox[{"{", "ps", "}"}], ",", "ks", ",", "Qs"}], "]"}]}], 
         "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"selgradP", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.031", ",", "3.1464"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.85", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3", ",", "0.6"}], "}"}], ",", "0.1", ",", "0.005", ",", 
   "dp1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.505140560825174*^9, 3.50514064385368*^9}, {
   3.505140714222675*^9, 3.505140746631989*^9}, 3.505141681810299*^9, {
   3.505141739370999*^9, 3.505141741390123*^9}, {3.5051417786037*^9, 
   3.505141823518378*^9}, {3.505162181348971*^9, 3.50516229325249*^9}, {
   3.5051623715172*^9, 3.505162376920246*^9}, {3.505162433552815*^9, 
   3.505162434058462*^9}, {3.505657684657195*^9, 3.505657708798037*^9}, {
   3.505815579213955*^9, 3.505815579839667*^9}, {3.505815706057299*^9, 
   3.505815706748337*^9}, {3.505836524337347*^9, 3.50583653604466*^9}, {
   3.505900621331135*^9, 3.50590062168389*^9}, {3.505900681816407*^9, 
   3.505900681925982*^9}, {3.505903100412446*^9, 3.505903105178415*^9}, {
   3.505903306382735*^9, 3.505903306450782*^9}, {3.505903337466215*^9, 
   3.505903337554181*^9}, {3.505903376116904*^9, 3.505903414205284*^9}, {
   3.507215441586883*^9, 3.507215441864266*^9}, {3.507217233968476*^9, 
   3.507217235012242*^9}, {3.507219035704643*^9, 3.507219036006999*^9}, 
   3.5072271240964108`*^9, {3.507445896704231*^9, 3.507445928564635*^9}, 
   3.507883896637253*^9, {3.507883963552722*^9, 3.507883964325812*^9}, {
   3.507884602887243*^9, 3.507884668140694*^9}, {3.508160912305312*^9, 
   3.508160916273239*^9}, {3.508161178047368*^9, 3.508161178663356*^9}, {
   3.520242444905705*^9, 3.520242462811362*^9}, {3.520242515256281*^9, 
   3.520242515537557*^9}, {3.520421764721227*^9, 3.520421771770569*^9}, {
   3.520421841855568*^9, 3.520421849321148*^9}, {3.520421888600866*^9, 
   3.520421892326528*^9}, {3.520422109210228*^9, 3.520422167950575*^9}, {
   3.520422201023795*^9, 3.520422205047305*^9}, {3.520422337344874*^9, 
   3.520422421071539*^9}, {3.520590680092812*^9, 3.520590711893722*^9}, {
   3.520590781521338*^9, 3.520590795966717*^9}, {3.520591226195406*^9, 
   3.520591240038307*^9}, {3.520601881307502*^9, 3.520601882092852*^9}, {
   3.524044511624154*^9, 3.52404451492298*^9}, {3.524044547404213*^9, 
   3.524044549627349*^9}, {3.524044778104684*^9, 3.524044795280702*^9}, 
   3.524555244523746*^9, {3.524555288584175*^9, 3.524555315808396*^9}, {
   3.524555363910387*^9, 3.524555377781718*^9}, {3.524555784594505*^9, 
   3.524555809327095*^9}, {3.52455601312634*^9, 3.52455602076801*^9}, {
   3.53177023662048*^9, 3.531770242557644*^9}, {3.59254503518889*^9, 
   3.59254507172961*^9}, {3.592545222393182*^9, 3.592545256670334*^9}, {
   3.616067762699471*^9, 3.6160677765635633`*^9}, {3.616067892099621*^9, 
   3.616067923768708*^9}}],

Cell[BoxData["0.4397337991664992`"], "Output",
 CellChangeTimes->{
  3.616067955683441*^9, 3.6160686513224154`*^9, 3.616134356078285*^9, 
   3.6161346790854483`*^9, 3.616141964171479*^9, 3.616142174389387*^9, 
   3.6161537949431887`*^9, 3.616160269333968*^9, 3.616160866599716*^9, {
   3.616231967039793*^9, 3.61623199391387*^9}, 3.61623301164435*^9, 
   3.618562244293478*^9}],

Cell[BoxData[
 RowBox[{"selgradP", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.031", ",", "3.1464"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.85", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3", ",", "0.6"}], "}"}], ",", "0.1", ",", "0.005", ",", 
   "dp2"}], "]"}]], "Input",
 CellChangeTimes->{{3.616067951680587*^9, 3.616067951856653*^9}}],

Cell[BoxData["0.3097826042105041`"], "Output",
 CellChangeTimes->{{3.616067943259294*^9, 3.616067953121747*^9}, 
   3.616068652028452*^9, 3.6161343567343493`*^9, 3.616134679738353*^9, 
   3.6161419650422907`*^9, 3.616142175027875*^9, 3.616153795646207*^9, 
   3.61616027009741*^9, 3.616160867462325*^9, {3.616231967818842*^9, 
   3.616231994775345*^9}, 3.616233012409555*^9, 3.618562246081571*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"selgradP", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3.1464", ",", "0.031"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.85", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3", ",", "0.6"}], "}"}], ",", "0.1", ",", "0.005", ",", 
   "dp1"}], "]"}]], "Input",
 CellChangeTimes->{{3.616067934721418*^9, 3.61606796045702*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.23447670264961418`"}]], "Output",
 CellChangeTimes->{
  3.616067972052676*^9, 3.6160686528606453`*^9, 3.616134357450276*^9, 
   3.616134680454282*^9, 3.6161419657358007`*^9, 3.616142175844554*^9, 
   3.6161537964762897`*^9, 3.616160270762651*^9, 3.616160868368554*^9, {
   3.6162319684655046`*^9, 3.616231995409103*^9}, 3.616233013047392*^9, 
   3.618562247655509*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"selgradP", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3.1464", ",", "0.031"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.85", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3", ",", "0.6"}], "}"}], ",", "0.1", ",", "0.005", ",", 
   "dp2"}], "]"}]], "Input",
 CellChangeTimes->{{3.616067965603386*^9, 3.616067966426915*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.45287406631526833`"}]], "Output",
 CellChangeTimes->{
  3.616066728343573*^9, 3.616067442903553*^9, 3.616067721391263*^9, {
   3.616067764150296*^9, 3.6160677778201313`*^9}, {3.616067893390036*^9, 
   3.616067967526703*^9}, 3.616068653610759*^9, 3.616134358324648*^9, 
   3.616134681106838*^9, 3.616141966505818*^9, 3.6161421765304403`*^9, 
   3.616153797134035*^9, 3.6161602714668217`*^9, 3.616160869118482*^9, {
   3.6162319691353817`*^9, 3.6162319961410847`*^9}, 3.616233013724317*^9, 
   3.618562249239028*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Selection gradients for the migration rate, ",
 StyleBox["m",
  FontSlant->"Italic"]
}], "Section",
 CellChangeTimes->{{3.501844825699147*^9, 3.5018448260221663`*^9}, {
  3.593777661084167*^9, 3.593777663884243*^9}}],

Cell[TextData[{
 "We calculate the selection gradient in a similar fashion as for ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["p", "1"], ",", 
    SubscriptBox["p", "2"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ". See there for details."
}], "Text",
 CellChangeTimes->{{3.5937776421476583`*^9, 3.59377768823563*^9}}],

Cell[CellGroupData[{

Cell["\<\
Functions to calculate the selection differential in females\
\>", "Subsection",
 CellChangeTimes->{{3.616133815385255*^9, 3.616133826153467*^9}, {
  3.616134356955174*^9, 3.6161343572912273`*^9}}],

Cell["\<\
Probability of producing a locally born, adapted (and maladapted) juveniles \
by nonfocal females\
\>", "Text",
 CellChangeTimes->{{3.616133903575583*^9, 3.616133968279377*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"localaddm", "[", 
   RowBox[{"es_", ",", "aself_", ",", "afother_", ",", "amother_"}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     FractionBox["afother", "nf"], 
     RowBox[{"g", "[", 
      RowBox[{"es", ",", "1"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"p", "[", 
        RowBox[{"es", ",", "1"}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "1"}], "]"}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"r", "[", 
            RowBox[{"aF", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"aself", "\[Equal]", "0"}], ",", "mF", ",", "aF"}], 
              "]"}], ",", "es", ",", 
             RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}], 
           RowBox[{
            FractionBox["1", "2"], 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"F", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"aself", "\[Equal]", "0"}], ",", "mF", ",", "aF"}], 
                 "]"}], ",", "es", ",", 
                RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}]}], 
             ")"}]}]], 
          RowBox[{"dm", "[", 
           RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"nf", "-", "afother", "-", "1"}], "nf"], 
     RowBox[{"g", "[", 
      RowBox[{"es", ",", "0"}], "]"}], 
     RowBox[{"p", "[", 
      RowBox[{"es", ",", "0"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "0"}], "]"}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"r", "[", 
            RowBox[{"mF", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"aself", "\[Equal]", "0"}], ",", "mF", ",", "aF"}], 
              "]"}], ",", "es", ",", 
             RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}], 
           RowBox[{
            FractionBox["1", "2"], 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"F", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"aself", "\[Equal]", "0"}], ",", "mF", ",", "aF"}], 
                 "]"}], ",", "es", ",", 
                RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}]}], 
             ")"}]}]], 
          RowBox[{"dm", "[", 
           RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}]}], ")"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localmaddm", "[", 
   RowBox[{"es_", ",", "aself_", ",", "afother_", ",", "amother_"}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     FractionBox["afother", "nf"], 
     RowBox[{"g", "[", 
      RowBox[{"es", ",", "1"}], "]"}], 
     RowBox[{"p", "[", 
      RowBox[{"es", ",", "1"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "1"}], "]"}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"r", "[", 
            RowBox[{"aF", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"aself", "\[Equal]", "0"}], ",", "mF", ",", "aF"}], 
              "]"}], ",", "es", ",", 
             RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}], 
           RowBox[{
            FractionBox["1", "2"], 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"F", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"aself", "\[Equal]", "0"}], ",", "mF", ",", "aF"}], 
                 "]"}], ",", "es", ",", 
                RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}]}], 
             ")"}]}]], 
          RowBox[{"dm", "[", 
           RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}]}], ")"}]}], "+", 
    RowBox[{
     FractionBox[
      RowBox[{"nf", "-", "afother", "-", "1"}], "nf"], 
     RowBox[{"g", "[", 
      RowBox[{"es", ",", "0"}], "]"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"p", "[", 
        RowBox[{"es", ",", "0"}], "]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "0"}], "]"}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"r", "[", 
            RowBox[{"mF", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"aself", "\[Equal]", "0"}], ",", "mF", ",", "aF"}], 
              "]"}], ",", "es", ",", 
             RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}], 
           RowBox[{
            FractionBox["1", "2"], 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"F", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"aself", "\[Equal]", "0"}], ",", "mF", ",", "aF"}], 
                 "]"}], ",", "es", ",", 
                RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}]}], 
             ")"}]}]], 
          RowBox[{"dm", "[", 
           RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}]}], ")"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localcomptotaldm", "[", 
   RowBox[{"es_", ",", "aself_", ",", "afother_", ",", "amother_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"localaddm", "[", 
      RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], "]"}], 
     "+", 
     RowBox[{"localmaddm", "[", 
      RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], "]"}], 
     "+", 
     RowBox[{"dispad", "[", "es", "]"}], "+", 
     RowBox[{"dispmad", "[", "es", "]"}]}], "]"}], "+", 
   RowBox[{
    FractionBox["1", "nf"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "aself"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "aself"}], "]"}], "-", 
      RowBox[{"dm", "[", 
       RowBox[{"es", ",", "aself"}], "]"}]}], ")"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.500120873674243*^9, 3.5001210355847692`*^9}, {
   3.500121143974712*^9, 3.5001211891721582`*^9}, {3.5001254507449503`*^9, 
   3.5001254895331507`*^9}, {3.5001255395065823`*^9, 3.50012556780807*^9}, {
   3.50012559895665*^9, 3.500125609305683*^9}, 3.500125734437594*^9, {
   3.500125795420335*^9, 3.500125838193928*^9}, {3.5001260925815897`*^9, 
   3.50012619653481*^9}, {3.500126318936735*^9, 3.500126490780538*^9}, {
   3.500126522241294*^9, 3.500126614249658*^9}, {3.5001266560703173`*^9, 
   3.500126692145039*^9}, {3.50012679804455*^9, 3.500126865625854*^9}, {
   3.5001269598438177`*^9, 3.500127010728797*^9}, {3.500127066746924*^9, 
   3.500127075242776*^9}, 3.500127168349073*^9, {3.500127799012751*^9, 
   3.50012794447775*^9}, {3.500127989244396*^9, 3.500128053011385*^9}, {
   3.500128120681616*^9, 3.5001281869125023`*^9}, {3.500128273678108*^9, 
   3.500128282830265*^9}, {3.500128331005128*^9, 3.500128412672514*^9}, {
   3.500128485970336*^9, 3.5001285037885857`*^9}, {3.500128604416666*^9, 
   3.500128654695407*^9}, {3.500128793134313*^9, 3.500128821190743*^9}, {
   3.500128924224536*^9, 3.500128962612554*^9}, {3.500129044296741*^9, 
   3.500129059197551*^9}, {3.500189795589278*^9, 3.500189809037795*^9}, {
   3.500191120480218*^9, 3.500191135144388*^9}, {3.500192700247055*^9, 
   3.5001927267342463`*^9}, {3.5007274959643087`*^9, 
   3.5007274971650257`*^9}, {3.500727569917247*^9, 3.5007275729396*^9}, {
   3.500728699556571*^9, 3.500728740477393*^9}, {3.500728835717046*^9, 
   3.500728850269268*^9}, {3.5007290429903793`*^9, 3.50072910127816*^9}, {
   3.5007291775293827`*^9, 3.5007291977631283`*^9}, {3.500732760953953*^9, 
   3.5007327631378593`*^9}, {3.5007330148648577`*^9, 3.500733037851882*^9}, {
   3.501846094121965*^9, 3.5018460942257643`*^9}, {3.501846158299007*^9, 
   3.501846158913698*^9}, {3.501846347155262*^9, 3.501846388497177*^9}, {
   3.501846436796281*^9, 3.501846463816641*^9}, {3.501846742296793*^9, 
   3.501846746275839*^9}, {3.501846787810392*^9, 3.501846932705696*^9}, {
   3.501846975907382*^9, 3.501846996345832*^9}, {3.501847050831903*^9, 
   3.501847080045858*^9}, {3.501859740923667*^9, 3.501859745437942*^9}, {
   3.5019348395744047`*^9, 3.50193484439249*^9}, {3.505140784660262*^9, 
   3.505140808173125*^9}, {3.507219084852496*^9, 3.507219110468522*^9}, {
   3.61606954922871*^9, 3.616069585729457*^9}, {3.61608158005033*^9, 
   3.616081740189238*^9}, {3.6160820270012417`*^9, 3.616082126357069*^9}, {
   3.616098240215023*^9, 3.616098250678396*^9}, 3.616128387330999*^9, {
   3.616132784041933*^9, 3.616132784156382*^9}, {3.616132936732849*^9, 
   3.616132950538389*^9}, {3.61613519645243*^9, 3.616135242500566*^9}, {
   3.6161604335481167`*^9, 3.61616044380171*^9}, {3.616160708975363*^9, 
   3.616160736909317*^9}}],

Cell["\<\
Total probability of producing an adapted (and maladapted) individual by a \
nonfocal (both local and global)\
\>", "Text",
 CellChangeTimes->{{3.616133972575243*^9, 3.616133993143341*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"apotherdm", "[", 
   RowBox[{"es_", ",", "aself_", ",", "afother_", ",", "amother_"}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   FractionBox[
    RowBox[{
     RowBox[{"localaddm", "[", 
      RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], "]"}], 
     "+", 
     RowBox[{"dispad", "[", "es", "]"}]}], 
    RowBox[{"localcomptotaldm", "[", 
     RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], "]"}]], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"mpotherdm", "[", 
   RowBox[{"es_", ",", "aself_", ",", "afother_", ",", "amother_"}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   FractionBox[
    RowBox[{
     RowBox[{"localmaddm", "[", 
      RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], "]"}], 
     "+", 
     RowBox[{"dispmad", "[", "es", "]"}]}], 
    RowBox[{"localcomptotaldm", "[", 
     RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], "]"}]], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.501847178118002*^9, 3.5018471902769527`*^9}, {
   3.501847232767535*^9, 3.501847242143415*^9}, {3.501847354203311*^9, 
   3.501847461876791*^9}, {3.501848059287427*^9, 3.501848081228677*^9}, 
   3.501859702416522*^9, {3.507219136655927*^9, 3.507219168562763*^9}, {
   3.616069407863365*^9, 3.616069446898527*^9}, {3.616082294732812*^9, 
   3.6160823061380863`*^9}, {3.616082455781973*^9, 3.61608245890865*^9}, {
   3.616128397550148*^9, 3.616128438584291*^9}, {3.6161352245817823`*^9, 
   3.616135238932588*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Functions to calculate the selection differential in males\
\>", "Subsection",
 CellChangeTimes->{{3.616139429618469*^9, 3.616139437138102*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"localcomptotalMdm", "[", 
   RowBox[{"es_", ",", "aself_", ",", "afother_", ",", "amother_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"dispad", "[", "es", "]"}], "+", 
     RowBox[{"dispmad", "[", "es", "]"}]}], "]"}], "+", 
   RowBox[{
    FractionBox["afother", "nf"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "1"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"m", "[", 
         RowBox[{"es", ",", "1"}], "]"}], "+", 
        RowBox[{
         FractionBox[
          RowBox[{"r", "[", 
           RowBox[{"aF", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}], 
             "]"}], ",", "es", ",", "afother", ",", 
            RowBox[{"amother", "+", "aself"}]}], "]"}], 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"F", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}], 
                "]"}], ",", "es", ",", "afother", ",", 
               RowBox[{"amother", "+", "aself"}]}], "]"}]}], ")"}]}]], 
         RowBox[{"dm", "[", 
          RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"nf", "-", "afother"}], "nf"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0"}], "]"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"m", "[", 
         RowBox[{"es", ",", "0"}], "]"}], "+", 
        RowBox[{
         FractionBox[
          RowBox[{"r", "[", 
           RowBox[{"mF", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}], 
             "]"}], ",", "es", ",", "afother", ",", 
            RowBox[{"amother", "+", "aself"}]}], "]"}], 
          RowBox[{
           FractionBox["1", "2"], 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"F", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}], 
                "]"}], ",", "es", ",", "afother", ",", 
               RowBox[{"amother", "+", "aself"}]}], "]"}]}], ")"}]}]], 
         RowBox[{"dm", "[", 
          RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}]}], ")"}]}]}]}]], "Input",\

 CellChangeTimes->{{3.6161354977270117`*^9, 3.616135512884603*^9}, {
  3.61613555759838*^9, 3.616135572629499*^9}, {3.616138410091823*^9, 
  3.616138453936701*^9}, {3.616138587456224*^9, 3.616138591325626*^9}, {
  3.616138996194759*^9, 3.6161389993969707`*^9}, {3.616160464028799*^9, 
  3.616160490056745*^9}, {3.6161607502742653`*^9, 3.616160778637842*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Selection differential on m in females\
\>", "Subsection",
 CellChangeTimes->{{3.616133780705731*^9, 3.616133786505067*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdmtabF", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"environmental", " ", "change"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", "es", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"F", ",", 
           RowBox[{"3", "-", "es"}], ",", 
           RowBox[{"1", "-", "aself"}], ",", 
           RowBox[{"nf", "-", "1", "-", "afother"}], ",", 
           RowBox[{"nm", "-", "amother"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"focal", " ", "female", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "daughter", " ", "of", " ", 
         "the", " ", "same", " ", "type"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}], "-", 
         RowBox[{"dm", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "aself"}], "]"}], "/", 
        RowBox[{"localcomptotaldm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Zeta]f", "-", "1"}], ")"}], " ", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"focal", " ", "female", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "daughter", " ", "of", " ", 
         "a", " ", "different", " ", "type"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}], "-", 
         RowBox[{"dm", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"p", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "aself"}], "]"}], "/", 
        RowBox[{"localcomptotaldm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Zeta]f", " ", 
          RowBox[{"v", "[", 
           RowBox[{"F", ",", "es", ",", 
            RowBox[{"1", "-", "aself"}], ",", "afother", ",", "amother"}], 
           "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"focal", " ", "female", " ", "dies"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", "nonfocal", " ", "daughter"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nf"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself"}], "]"}], "-", 
             RowBox[{"dm", "[", 
              RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
           RowBox[{
            RowBox[{"g", "[", 
             RowBox[{"es", ",", "aself"}], "]"}], "/", 
            RowBox[{"localcomptotaldm", "[", 
             RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
             "]"}]}]}], ")"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "maladapted", " ", "female", " ", "dies"}], ",",
         " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "daughter", " ", "of", " ", 
         "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"afother", "<", 
          RowBox[{"nf", "-", "1"}]}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nf", "-", "1", "-", "afother"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}], "-", 
         RowBox[{"dm", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "aself"}], "]"}], "/", 
        RowBox[{"localcomptotaldm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Zeta]f"}], ")"}], 
          RowBox[{"v", "[", 
           RowBox[{"F", ",", "es", ",", "aself", ",", 
            RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "maladapted", " ", "female", " ", "dies"}], ",",
         " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "daughter", " ", "of", " ", 
         "a", " ", "different", " ", "type", " ", "as", " ", "focal"}]}], " ",
        "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"afother", "<", 
          RowBox[{"nf", "-", "1"}]}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nf", "-", "1", "-", "afother"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}], "-", 
         RowBox[{"dm", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"p", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "aself"}], "]"}], "/", 
        RowBox[{"localcomptotaldm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "aself", ",", 
           RowBox[{"afother", "+", 
            RowBox[{"(", 
             RowBox[{"1", "-", "aself"}], ")"}]}], ",", "amother"}], "]"}], 
         "+", 
         RowBox[{"\[Zeta]f", " ", 
          RowBox[{"v", "[", 
           RowBox[{"F", ",", "es", ",", 
            RowBox[{"1", "-", "aself"}], ",", 
            RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "maladapted", " ", "female", " ", "dies"}], ",",
         " ", 
        RowBox[{
        "replaced", " ", "by", " ", "nonfocal", " ", "daughter", " ", "that", 
         " ", "is", " ", "adapted"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"afother", "<", 
          RowBox[{"nf", "-", "1"}]}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nf", "-", "1", "-", "afother"}], ")"}], 
       RowBox[{"apotherdm", "[", 
        RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "aself", ",", 
           RowBox[{"afother", "+", "1"}], ",", "amother"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "adapted", " ", "female", " ", "dies"}], ",", 
        " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "daughter", " ", "of", " ", 
         "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"afother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "afother", 
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}], "-", 
         RowBox[{"dm", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "aself"}], "]"}], "/", 
        RowBox[{"localcomptotaldm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Zeta]f"}], ")"}], 
          RowBox[{"v", "[", 
           RowBox[{"F", ",", "es", ",", "aself", ",", 
            RowBox[{"afother", "-", "1", "+", "aself"}], ",", "amother"}], 
           "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "adapted", " ", "female", " ", "dies"}], ",", 
        " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "daughter", " ", "of", " ", 
         "a", " ", "different", " ", "type", " ", "than", " ", "focal"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"afother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "afother", 
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}], "-", 
         RowBox[{"dm", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"p", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "aself"}], "]"}], "/", 
        RowBox[{"localcomptotaldm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "aself", ",", 
           RowBox[{"afother", "-", "1", "+", 
            RowBox[{"(", 
             RowBox[{"1", "-", "aself"}], ")"}]}], ",", "amother"}], "]"}], 
         "+", 
         RowBox[{"\[Zeta]f", " ", 
          RowBox[{"v", "[", 
           RowBox[{"F", ",", "es", ",", 
            RowBox[{"1", "-", "aself"}], ",", 
            RowBox[{"afother", "-", "1", "+", "aself"}], ",", "amother"}], 
           "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "adapted", " ", "female", " ", "dies"}], ",", 
        " ", 
        RowBox[{
        "replaced", " ", "by", " ", "nonfocal", " ", "daughter", " ", "that", 
         " ", "is", " ", "maladapted"}]}], " ", "*)"}], "\[IndentingNewLine]",
       "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"afother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "afother", " ", 
       RowBox[{"mpotherdm", "[", 
        RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "aself", ",", 
           RowBox[{"afother", "-", "1"}], ",", "amother"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"maladapted", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "son", " ", "of", " ", 
         "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", "<", "nm"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nm", "-", "amother"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}], "-", 
         RowBox[{"dm", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "aself"}], "]"}], "/", 
        RowBox[{"localcomptotaldm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Zeta]f", " ", 
          RowBox[{"v", "[", 
           RowBox[{"M", ",", "es", ",", "aself", ",", 
            RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}]}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "aself", ",", "afother", ",", 
           RowBox[{"amother", "+", "aself"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"maladapted", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "son", " ", "of", " ", "a", 
         " ", "different", " ", "type", " ", "than", " ", "focal"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", "<", "nm"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nm", "-", "amother"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}], "-", 
         RowBox[{"dm", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"p", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "aself"}], "]"}], "/", 
        RowBox[{"localcomptotaldm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Zeta]f", " ", 
          RowBox[{"v", "[", 
           RowBox[{"M", ",", "es", ",", 
            RowBox[{"1", "-", "aself"}], ",", 
            RowBox[{"afother", "+", "aself"}], ",", "amother"}], "]"}]}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "aself", ",", "afother", ",", 
           RowBox[{"amother", "+", "1", "-", "aself"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"maladapted", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "nonfocal", " ", "offspring", " ", "that",
          " ", "is", " ", "adapted"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", "<", "nm"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nm", "-", "amother"}], ")"}], 
       RowBox[{"apotherdm", "[", 
        RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "aself", ",", "afother", ",", 
           RowBox[{"amother", "+", "1"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"adapted", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "son", " ", "of", " ", 
         "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "amother", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}], "-", 
         RowBox[{"dm", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "aself"}], "]"}], "/", 
        RowBox[{"localcomptotaldm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Zeta]f", " ", 
          RowBox[{"v", "[", 
           RowBox[{"M", ",", "es", ",", "aself", ",", 
            RowBox[{"afother", "+", "aself"}], ",", 
            RowBox[{"amother", "-", "1"}]}], "]"}]}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "aself", ",", "afother", ",", 
           RowBox[{"amother", "-", "1", "+", "aself"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"adapted", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focal", " ", "son", " ", "of", " ", "a", 
         " ", "different", " ", "type", " ", "than", " ", "focal"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "amother", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}], "-", 
         RowBox[{"dm", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"p", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"es", ",", "aself"}], "]"}], "/", 
        RowBox[{"localcomptotaldm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Zeta]f", " ", 
          RowBox[{"v", "[", 
           RowBox[{"M", ",", "es", ",", 
            RowBox[{"1", "-", "aself"}], ",", 
            RowBox[{"afother", "+", "aself"}], ",", 
            RowBox[{"amother", "-", "1"}]}], "]"}]}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "aself", ",", "afother", ",", 
           RowBox[{"amother", "-", "1", "+", "1", "-", "aself"}]}], "]"}], 
         "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"adapted", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "nonfocal", " ", "offspring", " ", "that",
          " ", "is", " ", "maladapted"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "amother", " ", 
       RowBox[{"mpotherdm", "[", 
        RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "aself", ",", "afother", ",", 
           RowBox[{"amother", "-", "1"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "F", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "contribution", " ", "through", " ", "dispersing", " ", "daughters"}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "nf"}], ")"}], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "k"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself"}], "]"}], "+", 
         RowBox[{"dm", "[", 
          RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"nes", ",", "naf", ",", "nam"}], "]"}], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "on", " ", "other", " ", "patch", " ", "maladapted", " ", 
              "female", " ", "dies"}], ",", " ", 
             RowBox[{"replaced", " ", "by", " ", "focal", " ", "daughter"}]}],
             " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"nf", "-", "naf"}], ">", "0"}], ",", "1", ",", "0"}], 
              "]"}], 
             RowBox[{"(", 
              RowBox[{"nf", "-", "naf"}], ")"}], 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "naf"}], "]"}]}], "\[Zeta]f", " ", 
                RowBox[{"v", "[", 
                 RowBox[{"F", ",", "nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "naf", ",", 
                  "nam"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"es", ",", "aself"}], "]"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "naf"}], "]"}]}], "\[Zeta]f", " ", 
                RowBox[{"v", "[", 
                 RowBox[{"F", ",", "nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "naf", ",", "nam"}], "]"}]}]}], ")"}]}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "on", " ", "other", " ", "patch", " ", "adapted", " ", "female",
                " ", "dies"}], ",", " ", 
              RowBox[{
              "replaced", " ", "by", " ", "focal", " ", "daughter"}]}], " ", 
             "*)"}], "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"naf", ">", "0"}], ",", "1", ",", "0"}], "]"}], "naf", 
             " ", 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "naf"}], "]"}]}], "\[Zeta]f", " ", 
                RowBox[{"v", "[", 
                 RowBox[{"F", ",", "nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", 
                  RowBox[{"naf", "-", "1"}], ",", "nam"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"es", ",", "aself"}], "]"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "naf"}], "]"}]}], "\[Zeta]f", " ", 
                RowBox[{"v", "[", 
                 RowBox[{"F", ",", "nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  RowBox[{"naf", "-", "1"}], ",", "nam"}], "]"}]}]}], ")"}]}],
             "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "on", " ", "other", " ", "patch", " ", "maladapted", " ", 
               "male", " ", "dies"}], ",", " ", 
              RowBox[{"replaced", " ", "by", " ", 
               RowBox[{"focal", "'"}], "s", " ", "son"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"nm", "-", "nam"}], ">", "0"}], ",", "1", ",", "0"}], 
              "]"}], 
             RowBox[{"(", 
              RowBox[{"nm", "-", "nam"}], ")"}], 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "naf"}], "]"}]}], "\[Zeta]f", " ", 
                RowBox[{"v", "[", 
                 RowBox[{"M", ",", "nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "naf", ",", 
                  "nam"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"es", ",", "aself"}], "]"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "naf"}], "]"}]}], "\[Zeta]f", " ", 
                RowBox[{"v", "[", 
                 RowBox[{"M", ",", "nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "naf", ",", "nam"}], "]"}]}]}], ")"}]}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "on", " ", "other", " ", "patch", " ", "adapted", " ", "male", 
               " ", "dies"}], ",", " ", 
              RowBox[{"replaced", " ", "by", " ", 
               RowBox[{"focal", "'"}], "s", " ", "son"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"nam", ">", "0"}], ",", "1", ",", "0"}], "]"}], "nam", 
             " ", 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself"}], "]"}]}], ")"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "naf"}], "]"}]}], "\[Zeta]f", " ", 
                RowBox[{"v", "[", 
                 RowBox[{"M", ",", "nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "naf", ",", 
                  RowBox[{"nam", "-", "1"}]}], "]"}]}], "+", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"es", ",", "aself"}], "]"}], "/", 
                 RowBox[{"localcomptotal", "[", 
                  RowBox[{"nes", ",", "naf"}], "]"}]}], "\[Zeta]f", " ", 
                RowBox[{"v", "[", 
                 RowBox[{"M", ",", "nes", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"nes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                  "naf", ",", 
                  RowBox[{"nam", "-", "1"}]}], "]"}]}]}], ")"}]}]}], 
           "\[IndentingNewLine]", ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"nes", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"naf", ",", "0", ",", "nf"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"nam", ",", "0", ",", "nm"}], "}"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"afother", ",", "0", ",", 
       RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"amother", ",", "0", ",", "nm"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.607710024159892*^9, 3.6077100622289877`*^9}, {
   3.6077101035077*^9, 3.607710449682431*^9}, {3.607710525042615*^9, 
   3.607710551932008*^9}, {3.607711060288571*^9, 3.607711203761673*^9}, {
   3.6077118540809097`*^9, 3.607712102663315*^9}, {3.6077121332014112`*^9, 
   3.607712188455039*^9}, {3.607712431740385*^9, 3.607712584187216*^9}, {
   3.607712638319611*^9, 3.607712779762582*^9}, {3.6077128159191523`*^9, 
   3.607712863149374*^9}, {3.607712918654314*^9, 3.60771303816463*^9}, {
   3.607713108008183*^9, 3.607713367018127*^9}, {3.607746457814937*^9, 
   3.607746625258058*^9}, {3.6077466998129683`*^9, 3.607746778708292*^9}, {
   3.607746851756618*^9, 3.60774689259164*^9}, {3.6077469228011*^9, 
   3.607746991319029*^9}, {3.607747093942842*^9, 3.607747269606563*^9}, {
   3.60774731790816*^9, 3.607747353437495*^9}, {3.607747576428068*^9, 
   3.607747699551612*^9}, {3.607747768329611*^9, 3.6077482430245037`*^9}, {
   3.607748307203107*^9, 3.6077483085551367`*^9}, {3.6077483960963917`*^9, 
   3.6077484401872168`*^9}, {3.607748506517583*^9, 3.607748509629672*^9}, {
   3.607748547313942*^9, 3.6077485594956827`*^9}, {3.607748595888028*^9, 
   3.607748769530881*^9}, {3.607748815341617*^9, 3.6077488324068117`*^9}, {
   3.607748866417753*^9, 3.6077489100306883`*^9}, 3.60774903661935*^9, {
   3.607749102247521*^9, 3.607749108223583*^9}, 3.607754882280727*^9, {
   3.607768129775573*^9, 3.607768147462255*^9}, {3.607773815186453*^9, 
   3.607773816360799*^9}, {3.607783855006694*^9, 3.6077839548463593`*^9}, {
   3.607786352865641*^9, 3.607786383729803*^9}, {3.607786511144271*^9, 
   3.607786575445613*^9}, {3.607786913989482*^9, 3.60778693081234*^9}, {
   3.607786994964107*^9, 3.6077869952230167`*^9}, {3.607787084676858*^9, 
   3.60778708817706*^9}, {3.6077883672104883`*^9, 3.60778837186108*^9}, {
   3.6077984337233686`*^9, 3.607798446703948*^9}, {3.607798526840399*^9, 
   3.607798526998168*^9}, {3.608386003969925*^9, 3.6083860981595373`*^9}, 
   3.608467028591148*^9, {3.608470136774881*^9, 3.6084701463755093`*^9}, {
   3.608470291385417*^9, 3.608470296746908*^9}, {3.608470396212286*^9, 
   3.60847039902967*^9}, {3.6084704331465607`*^9, 3.608470438788924*^9}, {
   3.6084876311787567`*^9, 3.608487634757777*^9}, 3.6085256769962482`*^9, {
   3.608621465153825*^9, 3.608621473132889*^9}, {3.6160689421089993`*^9, 
   3.616068944689309*^9}, {3.616069044649983*^9, 3.6160691372241497`*^9}, {
   3.61612855910222*^9, 3.616128612686975*^9}, {3.6161286457301903`*^9, 
   3.616128655959372*^9}, {3.616128711686036*^9, 3.61612875854392*^9}, {
   3.616135251621022*^9, 3.616135343760747*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Selection differential on m in males\
\>", "Subsection",
 CellChangeTimes->{{3.616133755034012*^9, 3.616133761321154*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdmtabM", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"environmental", " ", "change"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"s", "[", "es", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"M", ",", 
           RowBox[{"3", "-", "es"}], ",", 
           RowBox[{"1", "-", "aself"}], ",", 
           RowBox[{"nf", "-", "afother"}], ",", 
           RowBox[{"nm", "-", "1", "-", "amother"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"focal", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focally", " ", "sired", " ", "son", " ", 
         "that", " ", "is", " ", "adapted"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"afother", "/", "nf"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "1"}], "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"aF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"amother", "+", "aself"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dm", "[", 
               RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "nm"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nf", "-", "afother"}], ")"}], "/", "nf"}]}], ")"}], 
           " ", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "0"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "0"}], "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"mF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"amother", "+", "aself"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dm", "[", 
               RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"localcomptotalMdm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"v", "[", 
           RowBox[{"M", ",", "es", ",", "1", ",", "afother", ",", "amother"}],
            "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"focal", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "focally", " ", "sired", " ", "son", " ", 
         "that", " ", "is", " ", "maladapted"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           FractionBox["afother", "nf"], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "1"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "1"}], "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"aF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"amother", "+", "aself"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dm", "[", 
               RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           FractionBox[
            RowBox[{"(", 
             RowBox[{"nf", "-", "afother"}], ")"}], "nf"], 
           RowBox[{"(", 
            RowBox[{"1", "-", " ", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "0"}], "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"mF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"amother", "+", "aself"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dm", "[", 
               RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"localcomptotalMdm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"v", "[", 
           RowBox[{"M", ",", "es", ",", "0", ",", "afother", ",", "amother"}],
            "]"}]}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"focal", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{"replaced", " ", "by", " ", "nonfocal", " ", "offspring"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", "nm"}], ")"}], 
              FractionBox["afother", "nf"], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "1"}], "]"}], "-", 
                RowBox[{
                 FractionBox[
                  RowBox[{"r", "[", 
                   RowBox[{"aF", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}]
                    , "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"amother", "+", "aself"}]}], "]"}], 
                  RowBox[{
                   FractionBox["1", "2"], 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                 RowBox[{"dm", "[", 
                  RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "1"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "/", "nm"}], ")"}], 
              FractionBox[
               RowBox[{"(", 
                RowBox[{"nf", "-", "afother"}], ")"}], "nf"], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "0"}], "]"}], "-", 
                RowBox[{
                 FractionBox[
                  RowBox[{"r", "[", 
                   RowBox[{"mF", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"amother", "+", "aself"}]}], "]"}], 
                  RowBox[{
                   FractionBox["1", "2"], 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                 RowBox[{"dm", "[", 
                  RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
           RowBox[{"localcomptotalMdm", "[", 
            RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
            "]"}]}], ")"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "maladapted", " ", "male", " ", "dies"}], ",", 
        " ", 
        RowBox[{
        "replaced", " ", "by", " ", "adapted", " ", "focal", " ", "son"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", "<", 
          RowBox[{"nm", "-", "1"}]}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nm", "-", "1", "-", "amother"}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"afother", "/", "nf"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "1"}], "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"aF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"amother", "+", "aself"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dm", "[", 
               RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "nm"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nf", "-", "afother"}], ")"}], "/", "nf"}]}], ")"}], 
           " ", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "0"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "0"}], "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"mF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"amother", "+", "aself"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dm", "[", 
               RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"localcomptotalMdm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"v", "[", 
           RowBox[{"M", ",", "es", ",", "1", ",", "afother", ",", 
            RowBox[{"amother", "+", "aself"}]}], "]"}]}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"M", ",", "es", ",", "aself", ",", "afother", ",", 
           RowBox[{"amother", "+", "1"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "maladapted", " ", "male", " ", "dies"}], ",", 
        " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "focal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", "<", 
          RowBox[{"nm", "-", "1"}]}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nm", "-", "1", "-", "amother"}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"afother", "/", "nf"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "1"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "1"}], "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"aF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"amother", "+", "aself"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dm", "[", 
               RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "nm"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nf", "-", "afother"}], ")"}], "/", "nf"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "0"}], "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"mF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"amother", "+", "aself"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dm", "[", 
               RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"localcomptotalMdm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"v", "[", 
          RowBox[{"M", ",", "es", ",", "0", ",", "afother", ",", 
           RowBox[{"amother", "+", "aself"}]}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "maladapted", " ", "male", " ", "dies"}], ",", 
        " ", 
        RowBox[{
        "replaced", " ", "by", " ", "adapted", " ", "nonfocal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", "<", 
          RowBox[{"nm", "-", "1"}]}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nm", "-", "1", "-", "amother"}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"(", 
             RowBox[{"nm", "-", "1"}], ")"}], "nm"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["afother", "nf"], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "1"}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"p", "[", 
                 RowBox[{"es", ",", "1"}], "]"}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "1"}], "]"}], "-", 
                RowBox[{
                 FractionBox[
                  RowBox[{"r", "[", 
                   RowBox[{"aF", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"amother", "+", "aself"}]}], "]"}], 
                  RowBox[{
                   FractionBox["1", "2"], 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                 RowBox[{"dm", "[", 
                  RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"nf", "-", "afother"}], "nf"], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "0"}], "]"}], 
              RowBox[{"p", "[", 
               RowBox[{"es", ",", "0"}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "0"}], "]"}], "-", 
                RowBox[{
                 FractionBox[
                  RowBox[{"r", "[", 
                   RowBox[{"mF", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"amother", "+", "aself"}]}], "]"}], 
                  RowBox[{
                   FractionBox["1", "2"], 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                 RowBox[{"dm", "[", 
                  RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"dispad", "[", "es", "]"}]}], ")"}], "/", 
        RowBox[{"localcomptotalMdm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"M", ",", "es", ",", "aself", ",", "afother", ",", 
           RowBox[{"amother", "+", "1"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "adapted", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "amother", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"afother", "/", "nf"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "1"}], "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"aF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"amother", "+", "aself"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dm", "[", 
               RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "nm"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nf", "-", "afother"}], ")"}], "/", "nf"}]}], ")"}], 
           " ", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "0"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "0"}], "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"mF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"amother", "+", "aself"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dm", "[", 
               RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"localcomptotalMdm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"v", "[", 
          RowBox[{"M", ",", "es", ",", "1", ",", "afother", ",", 
           RowBox[{"amother", "-", "1", "+", "aself"}]}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "adapted", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "focal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "amother", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"afother", "/", "nf"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "1"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "1"}], "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"aF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"amother", "+", "aself"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dm", "[", 
               RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "nm"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nf", "-", "afother"}], ")"}], "/", "nf"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "0"}], "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"mF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"amother", "+", "aself"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dm", "[", 
               RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"localcomptotalMdm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"v", "[", 
           RowBox[{"M", ",", "es", ",", "0", ",", "afother", ",", 
            RowBox[{"amother", "-", "1", "+", "aself"}]}], "]"}]}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"M", ",", "es", ",", "aself", ",", "afother", ",", 
           RowBox[{"amother", "-", "1"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", " ", "amother"}],
           "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"other", " ", "adapted", " ", "male", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "nonfocal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"amother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "amother", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"nm", "-", "1"}], "nm"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["afother", "nf"], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "1"}], "]"}], 
              RowBox[{"p", "[", 
               RowBox[{"es", ",", "1"}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "1"}], "]"}], "-", 
                RowBox[{
                 FractionBox[
                  RowBox[{"r", "[", 
                   RowBox[{"aF", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"amother", "+", "aself"}]}], "]"}], 
                  RowBox[{
                   FractionBox["1", "2"], 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                 RowBox[{"dm", "[", 
                  RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"nf", "-", "afother"}], "nf"], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "0"}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"p", "[", 
                 RowBox[{"es", ",", "0"}], "]"}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "0"}], "]"}], "-", 
                RowBox[{
                 FractionBox[
                  RowBox[{"r", "[", 
                   RowBox[{"mF", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"amother", "+", "aself"}]}], "]"}], 
                  RowBox[{
                   FractionBox["1", "2"], 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                 RowBox[{"dm", "[", 
                  RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"dispmad", "[", "es", "]"}]}], ")"}], "/", 
        RowBox[{"localcomptotalMdm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"M", ",", "es", ",", "aself", ",", "afother", ",", 
           RowBox[{"amother", "-", "1"}]}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"maladapted", " ", "female", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"nf", "-", "afother"}], ">", "0"}], ",", "1", ",", "0"}], 
        "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nf", "-", "afother"}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"afother", "/", "nf"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "1"}], "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"aF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"amother", "+", "aself"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dm", "[", 
               RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "nm"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nf", "-", "afother"}], ")"}], "/", "nf"}]}], ")"}], 
           " ", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "0"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "0"}], "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"mF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"amother", "+", "aself"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dm", "[", 
               RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"localcomptotalMdm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"v", "[", 
           RowBox[{"F", ",", "es", ",", "1", ",", "afother", ",", 
            RowBox[{"amother", "+", "aself"}]}], "]"}]}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"M", ",", "es", ",", "aself", ",", 
           RowBox[{"afother", "+", "1"}], ",", "amother"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"maladapted", " ", "female", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "focal", " ", 
         "daughter"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"nf", "-", "afother"}], ">", "0"}], ",", "1", ",", "0"}], 
        "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nf", "-", "afother"}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"afother", "/", "nf"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "1"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "1"}], "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"aF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"amother", "+", "aself"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dm", "[", 
               RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "nm"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nf", "-", "afother"}], ")"}], "/", "nf"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "0"}], "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"mF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"amother", "+", "aself"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dm", "[", 
               RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"localcomptotalMdm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "0", ",", "afother", ",", 
           RowBox[{"amother", "+", "aself"}]}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"maladapted", " ", "female", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "adapted", " ", "nonfocal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"nf", "-", "afother"}], ">", "0"}], ",", "1", ",", "0"}], 
        "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"nf", "-", "afother"}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"(", 
             RowBox[{"nm", "-", "1"}], ")"}], "nm"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["afother", "nf"], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "1"}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"p", "[", 
                 RowBox[{"es", ",", "1"}], "]"}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "1"}], "]"}], "-", 
                RowBox[{
                 FractionBox[
                  RowBox[{"r", "[", 
                   RowBox[{"aF", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"amother", "+", "aself"}]}], "]"}], 
                  RowBox[{
                   FractionBox["1", "2"], 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                 RowBox[{"dm", "[", 
                  RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"nf", "-", "afother"}], "nf"], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "0"}], "]"}], 
              RowBox[{"p", "[", 
               RowBox[{"es", ",", "0"}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "0"}], "]"}], "-", 
                RowBox[{
                 FractionBox[
                  RowBox[{"r", "[", 
                   RowBox[{"mF", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"amother", "+", "aself"}]}], "]"}], 
                  RowBox[{
                   FractionBox["1", "2"], 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                 RowBox[{"dm", "[", 
                  RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"dispad", "[", "es", "]"}]}], ")"}], "/", 
        RowBox[{"localcomptotalMdm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"M", ",", "es", ",", "aself", ",", 
           RowBox[{"afother", "+", "1"}], ",", "amother"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"adapted", " ", "female", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
         "daughter"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"afother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "afother", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"afother", "/", "nf"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "1"}], "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"aF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"amother", "+", "aself"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dm", "[", 
               RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "nm"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nf", "-", "afother"}], ")"}], "/", "nf"}]}], ")"}], 
           " ", 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "0"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "0"}], "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"mF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"amother", "+", "aself"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dm", "[", 
               RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"localcomptotalMdm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"v", "[", 
          RowBox[{"F", ",", "es", ",", "1", ",", 
           RowBox[{"afother", "-", "1"}], ",", 
           RowBox[{"amother", "+", "aself"}]}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"adapted", " ", "female", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "focal", " ", 
         "daughter"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"afother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "afother", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "nm"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"afother", "/", "nf"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "1"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "1"}], "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"aF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"amother", "+", "aself"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dm", "[", 
               RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "1"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "nm"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nf", "-", "afother"}], ")"}], "/", "nf"}]}], ")"}], 
           " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "0"}], "]"}], "-", 
             RowBox[{
              FractionBox[
               RowBox[{"r", "[", 
                RowBox[{"mF", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}],
                   "]"}], ",", "es", ",", "afother", ",", 
                 RowBox[{"amother", "+", "aself"}]}], "]"}], 
               RowBox[{
                FractionBox["1", "2"], 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"F", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
              RowBox[{"dm", "[", 
               RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"localcomptotalMdm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"v", "[", 
           RowBox[{"F", ",", "es", ",", "0", ",", 
            RowBox[{"afother", "-", "1"}], ",", 
            RowBox[{"amother", "+", "aself"}]}], "]"}]}], "+", 
         RowBox[{"v", "[", 
          RowBox[{"M", ",", "es", ",", "aself", ",", 
           RowBox[{"afother", "-", "1"}], ",", "amother"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"adapted", " ", "female", " ", "dies"}], ",", " ", 
        RowBox[{
        "replaced", " ", "by", " ", "maladapted", " ", "nonfocal", " ", 
         "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"afother", ">", "0"}], ",", "1", ",", "0"}], "]"}], 
       RowBox[{"d", "[", 
        RowBox[{"es", ",", "1"}], "]"}], "afother", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"(", 
             RowBox[{"nm", "-", "1"}], ")"}], "nm"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["afother", "nf"], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "1"}], "]"}], 
              RowBox[{"p", "[", 
               RowBox[{"es", ",", "1"}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "1"}], "]"}], "-", 
                RowBox[{
                 FractionBox[
                  RowBox[{"r", "[", 
                   RowBox[{"aF", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"amother", "+", "aself"}]}], "]"}], 
                  RowBox[{
                   FractionBox["1", "2"], 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                 RowBox[{"dm", "[", 
                  RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"nf", "-", "afother"}], "nf"], 
              RowBox[{"g", "[", 
               RowBox[{"es", ",", "0"}], "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"p", "[", 
                 RowBox[{"es", ",", "0"}], "]"}]}], ")"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"m", "[", 
                 RowBox[{"es", ",", "0"}], "]"}], "-", 
                RowBox[{
                 FractionBox[
                  RowBox[{"r", "[", 
                   RowBox[{"mF", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"amother", "+", "aself"}]}], "]"}], 
                  RowBox[{
                   FractionBox["1", "2"], 
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"F", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                    RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
                 RowBox[{"dm", "[", 
                  RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"dispmad", "[", "es", "]"}]}], ")"}], "/", 
        RowBox[{"localcomptotalMdm", "[", 
         RowBox[{"es", ",", "aself", ",", "afother", ",", "amother"}], 
         "]"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"M", ",", "es", ",", "aself", ",", 
           RowBox[{"afother", "-", "1"}], ",", "amother"}], "]"}], "-", 
         RowBox[{"v", "[", 
          RowBox[{
          "M", ",", "es", ",", "aself", ",", "afother", ",", "amother"}], 
          "]"}]}], ")"}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "contribution", " ", "through", " ", "adapted", " ", "dispersing", " ",
         "offspring"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "nm"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["afother", "nf"], 
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"es", ",", "1"}], "]"}], "+", 
            RowBox[{
             FractionBox[
              RowBox[{"r", "[", 
               RowBox[{"aF", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}], 
                 "]"}], ",", "es", ",", "afother", ",", 
                RowBox[{"amother", "+", "aself"}]}], "]"}], 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"F", "[", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                   RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
             RowBox[{"dm", "[", 
              RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "1"}], "]"}]}], ")"}]}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"nf", "-", "afother"}], "nf"], 
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"es", ",", "0"}], "]"}], "+", 
            RowBox[{
             FractionBox[
              RowBox[{"r", "[", 
               RowBox[{"mF", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}], 
                 "]"}], ",", "es", ",", "afother", ",", 
                RowBox[{"amother", "+", "aself"}]}], "]"}], 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"F", "[", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                   RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
             RowBox[{"dm", "[", 
              RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
          RowBox[{"p", "[", 
           RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "k"}], ")"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"nes", ",", "naf", ",", "nam"}], "]"}], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "on", " ", "other", " ", "patch", " ", "maladapted", " ", 
              "female", " ", "dies"}], ",", " ", 
             RowBox[{
             "replaced", " ", "by", " ", "locally", " ", "adapted", " ", 
              "dispersing", " ", "focal", " ", "daughter"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"nf", "-", "naf"}], ">", "0"}], ",", "1", ",", "0"}], 
              "]"}], 
             RowBox[{"(", 
              RowBox[{"nf", "-", "naf"}], ")"}], 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"localcomptotal", "[", 
                RowBox[{"nes", ",", "naf"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"v", "[", 
                RowBox[{"F", ",", "nes", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"nes", "\[Equal]", "es"}], ",", "1", ",", "0"}], 
                  "]"}], ",", "naf", ",", "nam"}], "]"}]}], ")"}]}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "on", " ", "other", " ", "patch", " ", "adapted", " ", "female",
                " ", "dies"}], ",", " ", 
              RowBox[{
              "replaced", " ", "by", " ", "locally", " ", "adapted", " ", 
               "dispersing", " ", "focal", " ", "daughter"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"naf", ">", "0"}], ",", "1", ",", "0"}], "]"}], "naf", 
             " ", 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"localcomptotal", "[", 
                RowBox[{"nes", ",", "naf"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"v", "[", 
                RowBox[{"F", ",", "nes", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"nes", "\[Equal]", "es"}], ",", "1", ",", "0"}], 
                  "]"}], ",", 
                 RowBox[{"naf", "-", "1"}], ",", "nam"}], "]"}]}], ")"}]}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "on", " ", "other", " ", "patch", " ", "maladapted", " ", 
               "male", " ", "dies"}], ",", " ", 
              RowBox[{
              "replaced", " ", "by", " ", "locally", " ", "adapted", " ", 
               "dispersing", " ", "focal", " ", "son"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"nm", "-", "nam"}], ">", "0"}], ",", "1", ",", "0"}], 
              "]"}], 
             RowBox[{"(", 
              RowBox[{"nm", "-", "nam"}], ")"}], 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"localcomptotal", "[", 
                RowBox[{"nes", ",", "naf"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"v", "[", 
                RowBox[{"M", ",", "nes", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"nes", "\[Equal]", "es"}], ",", "1", ",", "0"}], 
                  "]"}], ",", "naf", ",", "nam"}], "]"}]}], ")"}]}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "on", " ", "other", " ", "patch", " ", "adapted", " ", "male", 
               " ", "dies"}], ",", " ", 
              RowBox[{
              "replaced", " ", "by", " ", "locally", " ", "adapted", " ", 
               "dispersing", " ", "focal", " ", "son"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"nam", ">", "0"}], ",", "1", ",", "0"}], "]"}], "nam", 
             " ", 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"localcomptotal", "[", 
                RowBox[{"nes", ",", "naf"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"v", "[", 
                RowBox[{"M", ",", "nes", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"nes", "\[Equal]", "es"}], ",", "1", ",", "0"}], 
                  "]"}], ",", "naf", ",", 
                 RowBox[{"nam", "-", "1"}]}], "]"}]}], ")"}]}]}], 
           "\[IndentingNewLine]", ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"nes", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"naf", ",", "0", ",", "nf"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"nam", ",", "0", ",", "nm"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "contribution", " ", "through", " ", "maladapted", " ", "dispersing", 
        " ", "offspring"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "nm"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["afother", "nf"], 
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "1"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"es", ",", "1"}], "]"}], "+", 
            RowBox[{
             FractionBox[
              RowBox[{"r", "[", 
               RowBox[{"aF", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}], 
                 "]"}], ",", "es", ",", "afother", ",", 
                RowBox[{"amother", "+", "aself"}]}], "]"}], 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"F", "[", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                   RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
             RowBox[{"dm", "[", 
              RowBox[{"es", ",", "1"}], "]"}]}]}], ")"}], 
          RowBox[{"p", "[", 
           RowBox[{"es", ",", "1"}], "]"}]}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"nf", "-", "afother"}], "nf"], 
          RowBox[{"g", "[", 
           RowBox[{"es", ",", "0"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m", "[", 
             RowBox[{"es", ",", "0"}], "]"}], "+", 
            RowBox[{
             FractionBox[
              RowBox[{"r", "[", 
               RowBox[{"mF", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", "aM"}], 
                 "]"}], ",", "es", ",", "afother", ",", 
                RowBox[{"amother", "+", "aself"}]}], "]"}], 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 RowBox[{"F", "[", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"aself", "\[Equal]", "0"}], ",", "mM", ",", 
                    "aM"}], "]"}], ",", "es", ",", "afother", ",", 
                   RowBox[{"aself", "+", "amother"}]}], "]"}]}], ")"}]}]], 
             RowBox[{"dm", "[", 
              RowBox[{"es", ",", "0"}], "]"}]}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"p", "[", 
             RowBox[{"es", ",", "0"}], "]"}]}], ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "k"}], ")"}], 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"nes", ",", "naf", ",", "nam"}], "]"}], 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "on", " ", "other", " ", "patch", " ", "maladapted", " ", 
              "female", " ", "dies"}], ",", " ", 
             RowBox[{
             "replaced", " ", "by", " ", "locally", " ", "maladapted", " ", 
              "dispersing", " ", "focal", " ", "daughter"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"nf", "-", "naf"}], ">", "0"}], ",", "1", ",", "0"}], 
              "]"}], 
             RowBox[{"(", 
              RowBox[{"nf", "-", "naf"}], ")"}], 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"localcomptotal", "[", 
                RowBox[{"nes", ",", "naf"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"v", "[", 
                RowBox[{"F", ",", "nes", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"nes", "\[Equal]", "es"}], ",", "0", ",", "1"}], 
                  "]"}], ",", "naf", ",", "nam"}], "]"}]}], ")"}]}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "on", " ", "other", " ", "patch", " ", "adapted", " ", "female",
                " ", "dies"}], ",", " ", 
              RowBox[{
              "replaced", " ", "by", " ", "locally", " ", "maladapted", " ", 
               "dispersing", " ", "focal", " ", "daughter"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"naf", ">", "0"}], ",", "1", ",", "0"}], "]"}], "naf", 
             " ", 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"localcomptotal", "[", 
                RowBox[{"nes", ",", "naf"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"v", "[", 
                RowBox[{"F", ",", "nes", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"nes", "\[Equal]", "es"}], ",", "0", ",", "1"}], 
                  "]"}], ",", 
                 RowBox[{"naf", "-", "1"}], ",", "nam"}], "]"}]}], ")"}]}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "on", " ", "other", " ", "patch", " ", "maladapted", " ", 
               "male", " ", "dies"}], ",", " ", 
              RowBox[{
              "replaced", " ", "by", " ", "locally", " ", "maladapted", " ", 
               "dispersing", " ", "focal", " ", "son"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"nm", "-", "nam"}], ">", "0"}], ",", "1", ",", "0"}], 
              "]"}], 
             RowBox[{"(", 
              RowBox[{"nm", "-", "nam"}], ")"}], 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "0"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"localcomptotal", "[", 
                RowBox[{"nes", ",", "naf"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"v", "[", 
                RowBox[{"M", ",", "nes", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"nes", "\[Equal]", "es"}], ",", "0", ",", "1"}], 
                  "]"}], ",", "naf", ",", "nam"}], "]"}]}], ")"}]}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "on", " ", "other", " ", "patch", " ", "adapted", " ", "male", 
               " ", "dies"}], ",", " ", 
              RowBox[{
              "replaced", " ", "by", " ", "locally", " ", "maladapted", " ", 
               "dispersing", " ", "focal", " ", "son"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", "+", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"nam", ">", "0"}], ",", "1", ",", "0"}], "]"}], "nam", 
             " ", 
             RowBox[{"d", "[", 
              RowBox[{"nes", ",", "1"}], "]"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"localcomptotal", "[", 
                RowBox[{"nes", ",", "naf"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"v", "[", 
                RowBox[{"M", ",", "nes", ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"nes", "\[Equal]", "es"}], ",", "0", ",", "1"}], 
                  "]"}], ",", "naf", ",", 
                 RowBox[{"nam", "-", "1"}]}], "]"}]}], ")"}]}]}], 
           "\[IndentingNewLine]", ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"nes", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"naf", ",", "0", ",", "nf"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"nam", ",", "0", ",", "nm"}], "}"}]}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"afother", ",", "0", ",", "nf"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"amother", ",", "0", ",", 
       RowBox[{"nm", "-", "1"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.607749080845442*^9, 3.607749278134346*^9}, {
   3.607749417512814*^9, 3.60774965480284*^9}, 3.607752708926364*^9, {
   3.607752747073036*^9, 3.6077528347738047`*^9}, {3.607752888253538*^9, 
   3.607752895456485*^9}, {3.607752976387184*^9, 3.607753010354801*^9}, {
   3.607753299583436*^9, 3.607753366631905*^9}, {3.6077534214214363`*^9, 
   3.607753655373757*^9}, {3.607753709939036*^9, 3.607753798932526*^9}, {
   3.60775393802028*^9, 3.607754036711198*^9}, {3.607754343625559*^9, 
   3.6077545342212973`*^9}, {3.607754575234049*^9, 3.607754697016541*^9}, {
   3.607754744881271*^9, 3.607754808086377*^9}, {3.6077548602643223`*^9, 
   3.6077548667368727`*^9}, {3.6077549348192873`*^9, 3.607754967919413*^9}, {
   3.607755200360134*^9, 3.607755247123167*^9}, {3.607755411290081*^9, 
   3.6077558164365807`*^9}, {3.6077560397220163`*^9, 3.607756151166535*^9}, {
   3.6077561959926558`*^9, 3.6077563642050743`*^9}, {3.607756394853545*^9, 
   3.6077566458061953`*^9}, 3.607756750957654*^9, {3.607773860013817*^9, 
   3.6077738610305977`*^9}, {3.60777399109801*^9, 3.6077739932004766`*^9}, {
   3.607774024157963*^9, 3.607774024331231*^9}, {3.607774226492058*^9, 
   3.607774251729384*^9}, 3.6077742907718143`*^9, {3.607774334832057*^9, 
   3.607774335394311*^9}, {3.607774380131329*^9, 3.607774399510552*^9}, {
   3.607775335434561*^9, 3.6077753618786993`*^9}, {3.607775538603858*^9, 
   3.607775574523509*^9}, {3.607784002242929*^9, 3.6077840755411*^9}, {
   3.607787357999858*^9, 3.6077873591871223`*^9}, {3.607787392058552*^9, 
   3.607787428810658*^9}, {3.607787488723486*^9, 3.6077874908684072`*^9}, {
   3.607787639990876*^9, 3.607787640461546*^9}, {3.607787670982884*^9, 
   3.607787679062139*^9}, {3.607787713117484*^9, 3.6077877527572002`*^9}, 
   3.607787809496438*^9, {3.607787848202323*^9, 3.607787880129773*^9}, 
   3.6077879589694138`*^9, {3.6077880002674932`*^9, 3.607788037583931*^9}, {
   3.607788075797366*^9, 3.607788083386612*^9}, 3.607788137284708*^9, 
   3.6077881991628437`*^9, 3.607788331653124*^9, {3.607788971513145*^9, 
   3.6077889779538183`*^9}, {3.607797679516232*^9, 3.607797679974475*^9}, {
   3.607801509655448*^9, 3.6078015097677402`*^9}, {3.607801539779004*^9, 
   3.607801560477684*^9}, {3.608474394376128*^9, 3.608474445604845*^9}, {
   3.6084745617745256`*^9, 3.608474692604041*^9}, {3.608474724544179*^9, 
   3.608474750370428*^9}, {3.608474832334064*^9, 3.608474845834807*^9}, {
   3.60847512350177*^9, 3.608475125953286*^9}, {3.6084883163236628`*^9, 
   3.608488376320362*^9}, 3.608525677002192*^9, 3.6085260539750023`*^9, {
   3.616129549762425*^9, 3.616129591709671*^9}, {3.616132797975533*^9, 
   3.6161328314707108`*^9}, {3.616132866357044*^9, 3.6161328707574787`*^9}, {
   3.616133048329423*^9, 3.616133121098177*^9}, {3.6161331694244947`*^9, 
   3.616133433704607*^9}, 3.6161334719257793`*^9, {3.616133539844034*^9, 
   3.616133570429949*^9}, {3.616138561373603*^9, 3.61613875266206*^9}, {
   3.6161602895218983`*^9, 3.61616041778935*^9}, {3.616160512006199*^9, 
   3.6161605193480673`*^9}, {3.616160553296854*^9, 3.616160623409203*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Evaluation of both selection differentials\
\>", "Subsection",
 CellChangeTimes->{{3.616134014759881*^9, 3.616134021678982*^9}}],

Cell["\<\
Make a substitution list to set the mutant values to the resident\
\[CloseCurlyQuote]s value\
\>", "Text",
 CellChangeTimes->{{3.6161340261751537`*^9, 3.6161340446313553`*^9}, {
  3.6161343701017847`*^9, 3.6161343746849403`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dmsublist", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dm", "[", 
        RowBox[{"es", ",", "aself"}], "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"aself", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.505142464302843*^9, 3.505142544056463*^9}}],

Cell[TextData[{
 "Calculate selection differentials for each entry in the table of ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"\[DifferentialD]", 
     SubscriptBox["v", 
      RowBox[{
       SubscriptBox["e", "i"], 
       SubscriptBox["state", "focal"], 
       SubscriptBox[
        OverscriptBox["n", "~"], "fa"], 
       SubscriptBox[
        OverscriptBox["n", "~"], "ma"]}]]}], 
    RowBox[{"\[DifferentialD]", "\[Delta]m"}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " for the male and female reproductive values:"
}], "Text",
 CellChangeTimes->{{3.6161340557503*^9, 3.616134140016531*^9}, {
  3.6161343952062817`*^9, 3.61613447535045*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dveqdmtM", "[", "dmval_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"dvdmtabM", "[", 
         RowBox[{"[", 
          RowBox[{"es", ",", 
           RowBox[{"1", "+", "aself"}], ",", 
           RowBox[{"1", "+", "afother"}], ",", 
           RowBox[{"1", "+", "amother"}]}], "]"}], "]"}], ",", "dmval"}], 
       "]"}], "/.", "dmsublist"}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"afother", ",", "0", ",", "nf"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"amother", ",", "0", ",", 
       RowBox[{"nm", "-", "1"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.501843432551832*^9, 3.50184343360995*^9}, {
   3.501843944380341*^9, 3.501843964281032*^9}, 3.501844040723341*^9, {
   3.505138889414682*^9, 3.50513890024374*^9}, {3.505140339692244*^9, 
   3.505140380980634*^9}, {3.505155691794249*^9, 3.505155696978383*^9}, {
   3.616055864194425*^9, 3.616055877835294*^9}, {3.616063327990137*^9, 
   3.616063364094*^9}, 3.616063435500227*^9, {3.6160671442790537`*^9, 
   3.616067144632298*^9}, {3.61613371959548*^9, 3.616133722610806*^9}, {
   3.6161341443851624`*^9, 3.6161341637203693`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dveqdmtF", "[", "dmval_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"dvdmtabF", "[", 
         RowBox[{"[", 
          RowBox[{"es", ",", 
           RowBox[{"1", "+", "aself"}], ",", 
           RowBox[{"1", "+", "afother"}], ",", 
           RowBox[{"1", "+", "amother"}]}], "]"}], "]"}], ",", "dmval"}], 
       "]"}], "/.", "dmsublist"}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"afother", ",", "0", ",", 
       RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"amother", ",", "0", ",", "nm"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.501843432551832*^9, 3.50184343360995*^9}, {
   3.501843944380341*^9, 3.501843964281032*^9}, 3.501844040723341*^9, {
   3.505138889414682*^9, 3.50513890024374*^9}, {3.505140339692244*^9, 
   3.505140380980634*^9}, {3.505155691794249*^9, 3.505155696978383*^9}, {
   3.616055864194425*^9, 3.616055877835294*^9}, {3.616063327990137*^9, 
   3.616063364094*^9}, {3.616063435500227*^9, 3.616063458838635*^9}, {
   3.616067146423418*^9, 3.616067146822135*^9}, {3.6161337209395103`*^9, 
   3.616133723874791*^9}, {3.6161341457038317`*^9, 3.616134166317842*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dveqdm", "[", "dmval_", "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"es", ",", "af", ",", "am"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"af", ">", "0"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"af", "/", "nf"}], ")"}], 
          RowBox[{
           RowBox[{"dveqdmtF", "[", "dmval", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"es", ",", 
             RowBox[{"1", "+", "1"}], ",", 
             RowBox[{"1", "+", "af", "-", "1"}], ",", 
             RowBox[{"1", "+", "am"}]}], "]"}], "]"}]}], ",", "0"}], "]"}], 
       "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"af", "<", "nf"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nf", "-", "af"}], ")"}], "/", "nf"}], ")"}], 
          RowBox[{
           RowBox[{"dveqdmtF", "[", "dmval", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"es", ",", 
             RowBox[{"1", "+", "0"}], ",", 
             RowBox[{"1", "+", "af"}], ",", 
             RowBox[{"1", "+", "am"}]}], "]"}], "]"}]}], ",", "0"}], "]"}], 
       "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"am", ">", "0"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"am", "/", "nm"}], ")"}], 
          RowBox[{
           RowBox[{"dveqdmtM", "[", "dmval", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"es", ",", 
             RowBox[{"1", "+", "1"}], ",", 
             RowBox[{"1", "+", "af"}], ",", 
             RowBox[{"1", "+", "am", "-", "1"}]}], "]"}], "]"}]}], ",", "0"}],
         "]"}], "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"am", "<", "nm"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm", "-", "am"}], ")"}], "/", "nm"}], ")"}], 
          RowBox[{
           RowBox[{"dveqdmtM", "[", "dmval", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"es", ",", 
             RowBox[{"1", "+", "0"}], ",", 
             RowBox[{"1", "+", "af"}], ",", 
             RowBox[{"1", "+", "am"}]}], "]"}], "]"}]}], ",", "0"}], "]"}]}], 
      ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"am", ",", "0", ",", "nm"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.501844024430171*^9, 3.5018440511114883`*^9}, {
   3.50514040533693*^9, 3.505140411037161*^9}, {3.505140552660536*^9, 
   3.50514055349495*^9}, {3.520590601347611*^9, 3.520590621759652*^9}, {
   3.52060189014863*^9, 3.520601890770993*^9}, {3.616064097243224*^9, 
   3.616064209353109*^9}, {3.6160642428914337`*^9, 3.616064259530616*^9}, {
   3.6160643008162413`*^9, 3.616064308762124*^9}, {3.6160645859989443`*^9, 
   3.6160646083037777`*^9}, {3.616064653848179*^9, 3.616064699312509*^9}, {
   3.6160647296151867`*^9, 3.616064738409442*^9}, {3.61606543024749*^9, 
   3.616065460163162*^9}, {3.616067357339373*^9, 3.616067410496578*^9}, {
   3.616134154916647*^9, 3.616134203118572*^9}, 3.616142108044128*^9}],

Cell["Numerical value of the selection gradient", "Text",
 CellChangeTimes->{{3.593494549744481*^9, 3.5934945648160954`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"selgradM", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "arglistM", "}"}], ",", 
    RowBox[{"{", "arglistP", "}"}], ",", "ks_", ",", "Qs_", ",", "theP_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{"dveqdm", "[", "theP", "]"}], "/.", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
           RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
           RowBox[{"k", "\[Rule]", "ks"}], ",", 
           RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
           RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
           RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
           RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
           RowBox[{"Q", "\[Rule]", "Qs"}]}], "}"}], ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"varlistM", "\[Rule]", 
           RowBox[{"List", "[", "ms", "]"}]}], "]"}], ",", 
         RowBox[{"Thread", "[", 
          RowBox[{"varlistP", "\[Rule]", 
           RowBox[{"List", "[", "ps", "]"}]}], "]"}], ",", 
         RowBox[{"ans3", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s1s", ",", "s2s"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c1s", ",", "c2s"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"q1s", ",", "q2s"}], "}"}], ",", 
           RowBox[{"{", "ms", "}"}], ",", 
           RowBox[{"{", "ps", "}"}], ",", "ks", ",", "Qs"}], "]"}]}], "]"}]}],
       "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"selgradMalt", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1s_", ",", "c2s_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
     RowBox[{"{", "arglistM", "}"}], ",", 
     RowBox[{"{", "arglistP", "}"}], ",", "ks_", ",", "Qs_", ",", "theP_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"dveqdm", "[", "theP", "]"}], "/.", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
            RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
            RowBox[{"k", "\[Rule]", "ks"}], ",", 
            RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
            RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
            RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
            RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
            RowBox[{"Q", "\[Rule]", "Qs"}]}], "}"}], ",", 
          RowBox[{"Thread", "[", 
           RowBox[{"varlistM", "\[Rule]", 
            RowBox[{"List", "[", "ms", "]"}]}], "]"}], ",", 
          RowBox[{"Thread", "[", 
           RowBox[{"varlistP", "\[Rule]", 
            RowBox[{"List", "[", "ps", "]"}]}], "]"}], ",", 
          RowBox[{"ans3alt", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"s1s", ",", "s2s"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"c1s", ",", "c2s"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"q1s", ",", "q2s"}], "}"}], ",", 
            RowBox[{"{", "ms", "}"}], ",", 
            RowBox[{"{", "ps", "}"}], ",", "ks", ",", "Qs"}], "]"}]}], 
         "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"selgradM", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.031", ",", "3.1464"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.80", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3", ",", "0.6"}], "}"}], ",", "0.1", ",", "0.005", ",", 
   "dmt"}], "]"}]}], "Input",
 CellChangeTimes->{{3.505140560825174*^9, 3.50514064385368*^9}, {
   3.505140714222675*^9, 3.505140746631989*^9}, 3.505141681810299*^9, {
   3.505141739370999*^9, 3.505141741390123*^9}, {3.5051417786037*^9, 
   3.505141823518378*^9}, {3.505162181348971*^9, 3.50516229325249*^9}, {
   3.5051623715172*^9, 3.505162376920246*^9}, {3.505162433552815*^9, 
   3.505162434058462*^9}, {3.505657684657195*^9, 3.505657708798037*^9}, {
   3.505815579213955*^9, 3.505815579839667*^9}, {3.505815706057299*^9, 
   3.505815706748337*^9}, {3.505836524337347*^9, 3.50583653604466*^9}, {
   3.505900621331135*^9, 3.50590062168389*^9}, {3.505900681816407*^9, 
   3.505900681925982*^9}, {3.505903100412446*^9, 3.505903105178415*^9}, {
   3.505903306382735*^9, 3.505903306450782*^9}, {3.505903337466215*^9, 
   3.505903337554181*^9}, {3.505903376116904*^9, 3.505903414205284*^9}, {
   3.507215441586883*^9, 3.507215441864266*^9}, {3.507217233968476*^9, 
   3.507217235012242*^9}, {3.507219035704643*^9, 3.507219036006999*^9}, 
   3.5072271240964108`*^9, {3.507445896704231*^9, 3.507445928564635*^9}, 
   3.507883896637253*^9, {3.507883963552722*^9, 3.507883964325812*^9}, {
   3.507884602887243*^9, 3.507884668140694*^9}, {3.508160912305312*^9, 
   3.508160916273239*^9}, {3.508161178047368*^9, 3.508161178663356*^9}, {
   3.520242444905705*^9, 3.520242462811362*^9}, {3.520242515256281*^9, 
   3.520242515537557*^9}, {3.520421764721227*^9, 3.520421771770569*^9}, {
   3.520421841855568*^9, 3.520421849321148*^9}, {3.520421888600866*^9, 
   3.520421892326528*^9}, {3.520422109210228*^9, 3.520422167950575*^9}, {
   3.520422201023795*^9, 3.520422205047305*^9}, {3.520422337344874*^9, 
   3.520422421071539*^9}, {3.520590680092812*^9, 3.520590711893722*^9}, {
   3.520590781521338*^9, 3.520590795966717*^9}, {3.520591226195406*^9, 
   3.520591240038307*^9}, {3.520601881307502*^9, 3.520601882092852*^9}, {
   3.524044511624154*^9, 3.52404451492298*^9}, {3.524044547404213*^9, 
   3.524044549627349*^9}, {3.524044778104684*^9, 3.524044795280702*^9}, 
   3.524555244523746*^9, {3.524555288584175*^9, 3.524555315808396*^9}, {
   3.524555363910387*^9, 3.524555377781718*^9}, {3.524555784594505*^9, 
   3.524555809327095*^9}, {3.52455601312634*^9, 3.52455602076801*^9}, {
   3.53177023662048*^9, 3.531770242557644*^9}, {3.59254503518889*^9, 
   3.59254507172961*^9}, {3.592545222393182*^9, 3.592545256670334*^9}, {
   3.616067762699471*^9, 3.6160677765635633`*^9}, {3.616067892099621*^9, 
   3.616067923768708*^9}, {3.616134489718408*^9, 3.616134519480385*^9}, {
   3.6161346202927637`*^9, 3.6161346512425737`*^9}, {3.616134766902728*^9, 
   3.6161347687898407`*^9}, {3.6162350157663794`*^9, 3.616235015933156*^9}}],

Cell[BoxData["0.129792511473182`"], "Output",
 CellChangeTimes->{
  3.616134683100688*^9, 3.616134770973866*^9, {3.616138845808014*^9, 
   3.616138868303244*^9}, 3.6161390051937523`*^9, 3.6161419691327477`*^9, 
   3.616142178683898*^9, {3.616142239095242*^9, 3.6161422428243027`*^9}, 
   3.6161537993981743`*^9, 3.616160273708446*^9, 3.616160871422876*^9, 
   3.61623199838811*^9, 3.616233015885844*^9, 3.616233310274456*^9, 
   3.618562255383664*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["relvals"], "Input",
 CellChangeTimes->{{3.616138899612133*^9, 3.616138900355266*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"r", "[", 
    RowBox[{"aF", ",", "aM", ",", "1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"aF", ",", "aM", ",", "2", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"aF", ",", "mM", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"aF", ",", "mM", ",", "2", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"mF", ",", "aM", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"mF", ",", "aM", ",", "2", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"mF", ",", "mM", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"mF", ",", "mM", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"aM", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"aM", ",", "1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"aM", ",", "2", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"aM", ",", "2", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"aF", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"aF", ",", "1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"aF", ",", "2", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"aF", ",", "2", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"mM", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"mM", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"mM", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"mM", ",", "2", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"mF", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"mF", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"mF", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"mF", ",", "2", ",", "0", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.616138900856975*^9, 3.616139005230659*^9, 
  3.616141969299378*^9, 3.61614217878855*^9, 3.616153799575569*^9, 
  3.6161602738609133`*^9, 3.616160871545897*^9, 3.616231998548864*^9, 
  3.616233016013542*^9, 3.6162333103098307`*^9, 3.618562255510988*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"selgradM", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.05", ",", "0.01"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", "mx", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.3", ",", "0.6"}], "}"}], ",", "0.1", ",", "0.005", ",", 
      "dmt"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"mx", ",", "0", ",", "1", ",", "0.025"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6161347833178883`*^9, 3.616134808038447*^9}, {
   3.6161348417806587`*^9, 3.6161348505885143`*^9}, {3.6161349839942617`*^9, 
   3.616134994241521*^9}, 3.616139130925342*^9, {3.616142030812484*^9, 
   3.6161420321005*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindRoot", "::", "lstol"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The line search decreased the step size to within \
tolerance specified by AccuracyGoal and PrecisionGoal but was unable to find \
a sufficient decrease in the merit function. You may need more than \
\[NoBreak]\\!\\(MachinePrecision\\)\[NoBreak] digits of working precision to \
meet these tolerances. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindRoot/lstol\\\", ButtonNote -> \
\\\"FindRoot::lstol\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6161348095172977`*^9, 3.616134852659127*^9, 
  3.6161350094589577`*^9, 3.61613885058703*^9, 3.6161390101573553`*^9, 
  3.6161391361887693`*^9, 3.61614197505733*^9, 3.6161420370406647`*^9, 
  3.6161421825618677`*^9, 3.61615380346427*^9, 3.6161602777083282`*^9, 
  3.616160875668927*^9, 3.61623200516476*^9, 3.616232125948537*^9, 
  3.61623302252057*^9, 3.616233317073658*^9, 3.6185622710023947`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2.3156685843608704`", ",", "2.1025187677343182`", ",", 
   "1.9187107997677721`", ",", "1.7589887159276496`", ",", 
   "1.6192668129036702`", ",", "1.4962576818495574`", ",", 
   "1.3872778808302406`", ",", "1.290117466171071`", ",", 
   "1.2029442175045775`", ",", "1.1242305835819593`", ",", 
   "1.0526968022130676`", ",", "0.9872660191125643`", ",", 
   "0.927028521329452`", ",", "0.8712130034329096`", ",", 
   "0.8191633234092686`", ",", "0.7703195838951276`", ",", 
   "0.7242026483678761`", ",", "0.6804014041875172`", ",", 
   "0.6385622359537555`", ",", "0.5983802875734787`", ",", 
   "0.559592179448678`", ",", "0.521969915175742`", ",", 
   "0.4853157650536325`", ",", "0.44945795515616205`", ",", 
   "0.41424702341410813`", ",", "0.37955273007973384`", ",", 
   "0.34526143061990355`", ",", "0.31127383565191796`", ",", 
   "0.277503095876816`", ",", "0.2438731607548821`", ",", 
   "0.21031736843207355`", ",", "0.17677723157290223`", ",", 
   "0.14320138960576245`", ",", "0.10954470269314971`", ",", 
   "0.07576746670178569`", ",", "0.04183473172525035`", ",", 
   "0.007715709431383874`", ",", 
   RowBox[{"-", "0.026616743229738907`"}], ",", 
   RowBox[{"-", "0.06118657453205382`"}], ",", 
   RowBox[{"-", "0.09601493168714743`"}], ",", 
   RowBox[{"-", "0.13112050543102763`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.616134839582399*^9, 3.616134894207436*^9, 
  3.6161350470034533`*^9, 3.616138864148676*^9, 3.616139046474476*^9, 
  3.616139173443606*^9, 3.616142010777279*^9, 3.616142074742551*^9, 
  3.61614222103008*^9, 3.61615381081555*^9, 3.616160284628036*^9, 
  3.616160914387331*^9, 3.616232042322632*^9, 3.616232161265729*^9, 
  3.616233057360971*^9, 3.61623335325171*^9, 3.618562353334044*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"out", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.616135064588778*^9, 3.6161350773750362`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {RGBColor[0.24720000000000014`, 0.24, 0.6], PointBox[CompressedData["
1:eJwtyWtIkwEUxvEXS5DMTFq0IirbKh1L2pZbmvY+mwYxLHBOkLGIVpPMcEFE
fQlbLVnShcKSZlTYRUoyaHQhxJljMfwSI6i5bkZZb87WMi0cIyr2HDgcfudf
6HBZnFmCIBT/2/83M0kx0a3BkbYs8AFd8UL7dESgc/B28JB8jv+PmPF8XFmQ
b4so07QMEw+21XqkGVqO7IllY73J3/RSBGXtZrP2F70Cc1Gnt9yYoldi6tg5
l0n8SSuhs9tKR9I/6NWQDRT6oq+SdBF21RRIfZ3faRXUhvuPDHe+0Wpsn+1f
lBqN0yVIzPIIF/Xj9Drs8Z40Hrwl0RqMW7fm9Kq/0FrsbNqtGgmN0TocLksX
LHF9otfj/I6HexOrPtKl6G9/8nqt9IHWw3HViZR/lDbA9i4ca8p/T2/AZE9H
TTz4hi6DKuaezD4eo8sR0Pq9neYovRFbzJsbg/KXdAVyW+bJv8Zf0JVoWVzf
cHkoQm+CsVJqqDA8p0WUFF2avhsfpoED5crP3deeZXwUCHedsuyzDrEbkefw
KJbn9rMb4R24sKbV6Wc3IeTT3LY332Q3Yf/ZUMrta2Wvgsw93Nhs7ApkehXq
TyueRuvuZSxUI0/RJro6HrNXY+a69cSZ8GDgLzfouUk=
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  Method->{},
  PlotRange->{{0, 41.}, {0, 1}},
  PlotRangeClipping->True,
  PlotRangePadding->{{0.8200000000000001, 0.8200000000000001}, {0., 
   0.}}]], "Output",
 CellChangeTimes->{{3.616135069311088*^9, 3.616135077743238*^9}, 
   3.6161390465286417`*^9, 3.616139180707983*^9, 3.616142010962912*^9, 
   3.616142221208398*^9, {3.6161609145530577`*^9, 3.6161609270601377`*^9}, 
   3.616232042554062*^9, 3.61623217430126*^9, 3.616233057521806*^9, 
   3.616233353309929*^9, 3.618562353635865*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Iterations in C", "Section",
 CellChangeTimes->{{3.593777767922825*^9, 3.593777769731084*^9}}],

Cell[TextData[{
 StyleBox["Iterations using C\n",
  FontWeight->"Bold"],
 "We export the above expressions for the patch frequencies, reproductive \
values and relatedness coefficients to as well as the selection gradients for \
",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["p", "1"], ",", 
    SubscriptBox["p", "2"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 StyleBox["m ",
  FontSlant->"Italic"],
 "to C, to allow computation on a computer cluster.\nDuring each timestep, we \
iterate the values of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["p", "1"], ",", " ", 
    SubscriptBox["p", "2"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 StyleBox["m. ",
  FontSlant->"Italic"],
 "During each successive iteration, we solve for the novel values of the \
patch frequencies, reproductive values and relatedness coefficients. \n\
Iteration continues until the selection gradients vanish.\nC Code can be \
requested from the authors: a.kuijper@ucl.ac.uk"
}], "Text",
 CellChangeTimes->{{3.593777694387035*^9, 3.593777754699216*^9}, {
  3.593777831330688*^9, 3.593777924969914*^9}, {3.593778037024809*^9, 
  3.5937781875823383`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.593777706521871*^9, 3.59377770733974*^9}}],

Cell[CellGroupData[{

Cell["Export to C: functions", "Subsection",
 CellChangeTimes->{{3.616144378570518*^9, 3.61614438147453*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"exportDiffRecur", "[", 
   RowBox[{
   "file_", ",", "sys_", ",", "lhs1_", ",", "lhs2_", ",", "step_", ",", 
    "Tend_", ",", "delta_", ",", "boundfunc_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mainstr", ",", "iter"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mainstr", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"initialize", " ", "the", " ", "xtplus1", " ", "lhs"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "<=", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", "\"\<double \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\< = 0;\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "now", " ", "print", " ", "the", " ", "for", " ", "loop", " ", "to", 
       " ", "iterate", " ", "the", " ", "system"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"mainstr", "=", 
      RowBox[{
      "mainstr", "<>", "\"\<\\n\\n for (int rtime = 0; rtime < \>\"", "<>", 
       RowBox[{"ToString", "[", "Tend", "]"}], "<>", 
       "\"\<; ++rtime)\\n{\\n\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "<=", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\< = \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<+\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", "step", "]"}], "]"}], "<>", "\"\<*(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"sys", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "now", " ", "print", " ", "the", " ", "delta", " ", "checking"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mainstr", "=", 
      RowBox[{"mainstr", "<>", "\"\<\\nif(\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", "\"\<fabs(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<-\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<)<\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", "delta", "]"}], "]"}], "<>", 
          "\"\<\\n\\t\\t&& \>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"erase", " ", "last"}], " ", "&&", " ", 
       RowBox[{"and", " ", "close", " ", "if", " ", "parentheses"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mainstr", "=", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"mainstr", ",", 
         RowBox[{
          RowBox[{"StringLength", "[", "mainstr", "]"}], "-", "3"}]}], "]"}], 
       "<>", "\"\<)\\n{\\n\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "put", " ", "values", " ", "from", " ", "tplus1", " ", "to", " ", "t"}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<=\>\"", "<>", 
          RowBox[{"ToString", "[", "boundfunc", "]"}], "<>", "\"\<(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"end", " ", "if", " ", "statement"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"mainstr", "=", 
      RowBox[{"mainstr", "<>", "\"\<\\n\\t break;\\n}\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "put", " ", "values", " ", "from", " ", "tplus1", " ", "to", " ", "t"}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<=\>\"", "<>", 
          RowBox[{"ToString", "[", "boundfunc", "]"}], "<>", "\"\<(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"end", " ", "for", " ", "loop"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"mainstr", "=", 
      RowBox[{"mainstr", "<>", "\"\<\\n}\\n\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", "\"\<gsl_vector_set(f,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"iter", "-", "1"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"file", ",", "mainstr"}], "]"}], ";"}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.590824494031481*^9, 3.5908244987542067`*^9}, {
   3.590824688049684*^9, 3.590824689177642*^9}, {3.590824726077338*^9, 
   3.590824819049809*^9}, {3.5908248739935303`*^9, 3.590824925754787*^9}, {
   3.590825036561387*^9, 3.590825126234809*^9}, {3.5908251802423697`*^9, 
   3.590825320995825*^9}, {3.5908253647951612`*^9, 3.5908256308482227`*^9}, 
   3.590825724885985*^9, {3.5908296671027403`*^9, 3.590829904284482*^9}, {
   3.590829936121765*^9, 3.590829970644486*^9}, {3.590830008219141*^9, 
   3.59083026925244*^9}, {3.5908308454160967`*^9, 3.5908309406084223`*^9}, {
   3.590831297981771*^9, 3.590831310679865*^9}, {3.5908313621671124`*^9, 
   3.590831374759654*^9}, {3.590831405453176*^9, 3.59083140577787*^9}, {
   3.590831442824209*^9, 3.5908314475484037`*^9}, {3.590831495257579*^9, 
   3.590831590063092*^9}, {3.590831621644826*^9, 3.590831704009104*^9}, 
   3.590835167612055*^9, {3.590835215286303*^9, 3.590835229648106*^9}, {
   3.59083564362383*^9, 3.5908356616050367`*^9}, {3.5908408172483*^9, 
   3.590840819363501*^9}, {3.590899281419011*^9, 3.590899286902195*^9}, {
   3.590899344670518*^9, 3.5908993451548643`*^9}, {3.618551711710661*^9, 
   3.618551744661623*^9}, {3.618562173863214*^9, 3.61856218450172*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"export", " ", "all", " ", "the", " ", "variables", " ", "used"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"exportvarStruct", "[", 
     RowBox[{"file_", ",", "vars_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"str", ",", "iter"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"str", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"iter", "=", "1"}], ",", 
         RowBox[{"iter", "\[LessEqual]", 
          RowBox[{"Length", "[", "vars", "]"}]}], ",", 
         RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"str", "=", 
           RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"CForm", "[", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
            "\"\<;\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"file", ",", 
         RowBox[{"str", "<>", "\"\<\\n\\n\>\""}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "export", " ", "those", " ", "variables", " ", "that", " ", "are", " ", 
     "also", " ", "parameters"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"exportParamStruct", "[", 
     RowBox[{"file_", ",", "vars_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"str", ",", "iter"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"str", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"iter", "=", "1"}], ",", 
         RowBox[{"iter", "\[LessEqual]", 
          RowBox[{"Length", "[", "vars", "]"}]}], ",", 
         RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"str", "=", 
           RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"CForm", "[", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
            "\"\<;\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"file", ",", 
         RowBox[{"str", "<>", "\"\<\\n\\n\>\""}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Export patch frequency recursions\
\>", "Subsection",
 CellChangeTimes->{{3.61614647174916*^9, 3.616146478678782*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"lhs1patch", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ftplus1", "[", 
      RowBox[{"es", ",", "nfa", ",", "nma"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nfa", ",", "0", ",", "nf"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nma", ",", "0", ",", "nm"}], "}"}]}], "]"}], "//", 
   "Flatten"}]}], "\[IndentingNewLine]", 
 RowBox[{"lhs2patch", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"es", ",", "nfa", ",", "nma"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nfa", ",", "0", ",", "nf"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nma", ",", "0", ",", "nm"}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]}], "Input",
 CellChangeTimes->{{3.590830995553282*^9, 3.590831019103163*^9}, {
  3.6161446655805807`*^9, 3.616144722214224*^9}, {3.61614707137897*^9, 
  3.616147076003533*^9}, {3.616149076674119*^9, 3.616149079831545*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.590831013239851*^9, 3.590831021033671*^9}, 
   3.5908315007820053`*^9, 3.590831629980961*^9, 3.590831678076036*^9, 
   3.5908353068794823`*^9, 3.590837291922063*^9, 3.5908408308911467`*^9, 
   3.590841046106442*^9, 3.590899363949039*^9, 3.590906448500978*^9, 
   3.5912549927166357`*^9, 3.591255384520417*^9, 3.5912555097576313`*^9, 
   3.592647997300377*^9, {3.616144718748001*^9, 3.616144722813964*^9}, 
   3.616144816699142*^9, 3.616147119545724*^9, 3.616149081280114*^9, 
   3.616149114890017*^9, 3.616151109799511*^9, 3.616153350042171*^9, 
   3.616153825934106*^9, 3.616156352759272*^9, 3.616160914612722*^9, 
   3.616232042695236*^9, 3.616233057594314*^9, 3.616233379762006*^9, 
   3.618562353737617*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.590831013239851*^9, 3.590831021033671*^9}, 
   3.5908315007820053`*^9, 3.590831629980961*^9, 3.590831678076036*^9, 
   3.5908353068794823`*^9, 3.590837291922063*^9, 3.5908408308911467`*^9, 
   3.590841046106442*^9, 3.590899363949039*^9, 3.590906448500978*^9, 
   3.5912549927166357`*^9, 3.591255384520417*^9, 3.5912555097576313`*^9, 
   3.592647997300377*^9, {3.616144718748001*^9, 3.616144722813964*^9}, 
   3.616144816699142*^9, 3.616147119545724*^9, 3.616149081280114*^9, 
   3.616149114890017*^9, 3.616151109799511*^9, 3.616153350042171*^9, 
   3.616153825934106*^9, 3.616156352759272*^9, 3.616160914612722*^9, 
   3.616232042695236*^9, 3.616233057594314*^9, 3.616233379762006*^9, 
   3.6185623537433767`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"exportDiffRecur", "[", 
  RowBox[{
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/Transgeneration/msparentaleffects1/src/patchrecurs.txt\>\"\
"}], ",", "feqtabPlain", ",", "lhs1patch", ",", "lhs2patch", ",", "0.01", ",",
    "1000000", ",", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{"-", "7"}], ")"}]}], ",", "bound01"}], "]"}]], "Input",
 CellChangeTimes->{{3.5908309445698223`*^9, 3.590830987989614*^9}, {
   3.590831024917672*^9, 3.590831027357374*^9}, {3.590831061334312*^9, 
   3.590831088158276*^9}, {3.590831209437612*^9, 3.590831264862075*^9}, {
   3.590831313478467*^9, 3.5908313146115007`*^9}, {3.59083509430632*^9, 
   3.590835102985559*^9}, {3.616144605589267*^9, 3.616144655791149*^9}, {
   3.616144692479392*^9, 3.616144693115016*^9}, {3.616144730622141*^9, 
   3.616144731284387*^9}, {3.6161447763167143`*^9, 3.616144796734088*^9}, 
   3.6161448341091843`*^9, 3.6161448958686*^9, {3.616147078850782*^9, 
   3.616147082721192*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Export reproductive value recursions\
\>", "Subsection",
 CellChangeTimes->{{3.616146491918007*^9, 3.6161464986308193`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vvecFlhs1", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"vtplus1", "[", 
       RowBox[{"F", ",", "es", ",", "state", ",", "af", ",", "am"}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"state", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"af", ",", "0", ",", 
        RowBox[{"nf", "-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"am", ",", "0", ",", "nm"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vvecMlhs1", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"vtplus1", "[", 
       RowBox[{"M", ",", "es", ",", "state", ",", "af", ",", "am"}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"state", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"af", ",", "0", ",", "nf"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"am", ",", "0", ",", 
        RowBox[{"nm", "-", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"vveclhs1", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"vvecFlhs1", ",", "vvecMlhs1"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5018622698079367`*^9, 3.501862289606407*^9}, {
   3.5018623307386227`*^9, 3.501862365664167*^9}, {3.5018624304785347`*^9, 
   3.501862533405551*^9}, {3.520429173721002*^9, 3.520429174705935*^9}, {
   3.607780712660212*^9, 3.607780797907065*^9}, {3.607780853756072*^9, 
   3.60778090351499*^9}, {3.607781329896625*^9, 3.607781331232204*^9}, 
   3.608525677009054*^9, {3.616145929973526*^9, 3.616145948376938*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"vtplus1", "[", 
    RowBox[{"F", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"F", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"F", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"F", ",", "1", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"F", ",", "2", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"F", ",", "2", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"F", ",", "2", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"F", ",", "2", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"M", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"M", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"M", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"M", ",", "1", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"M", ",", "2", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"M", ",", "2", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"M", ",", "2", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"M", ",", "2", ",", "1", ",", "1", ",", "0"}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6161460674787817`*^9, 3.616148458847658*^9, 
  3.616149114978701*^9, 3.616151109872408*^9, 3.616153350118532*^9, 
  3.616153825989588*^9, 3.6161563528971148`*^9, 3.616160914683053*^9, 
  3.6162320427991657`*^9, 3.616233057666757*^9, 3.616233379828315*^9, 
  3.6185623538823442`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"exportDiffRecur", "[", 
  RowBox[{
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/Transgeneration/msparentaleffects1/src/repvals.txt\>\""}], 
   ",", 
   RowBox[{"Flatten", "[", "veqtabPlain", "]"}], ",", "vveclhs1", ",", "vvec",
    ",", "0.01", ",", "1000000", ",", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{"-", "7"}], ")"}]}], ",", "bound0"}], "]"}]], "Input",
 CellChangeTimes->{{3.5908309445698223`*^9, 3.590830987989614*^9}, {
   3.590831024917672*^9, 3.590831027357374*^9}, {3.590831061334312*^9, 
   3.590831088158276*^9}, {3.590831209437612*^9, 3.590831264862075*^9}, {
   3.590831313478467*^9, 3.5908313146115007`*^9}, {3.5908327135275373`*^9, 
   3.590832716378105*^9}, {3.590832814910838*^9, 3.5908328204897003`*^9}, {
   3.5908328629264383`*^9, 3.590832875870335*^9}, {3.5908351115946827`*^9, 
   3.590835117824935*^9}, {3.590841018849063*^9, 3.590841021297264*^9}, {
   3.616146075849708*^9, 3.6161460953045187`*^9}, 3.6161463633446093`*^9, 
   3.6161535749796047`*^9, 3.616153782123399*^9}]
}, Open  ]],

Cell["Export relatedness recursions", "Subsection",
 CellChangeTimes->{{3.616146515038537*^9, 3.616146529997208*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs2relatedness", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"x", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "reltab"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.616146668675852*^9, 3.616146689608177*^9}, 
   3.616146730586933*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"r", "[", 
    RowBox[{"aF", ",", "aM", ",", "1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"aF", ",", "aM", ",", "2", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"aF", ",", "mM", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"aF", ",", "mM", ",", "2", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"mF", ",", "aM", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"mF", ",", "aM", ",", "2", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"mF", ",", "mM", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"mF", ",", "mM", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"aM", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"aM", ",", "1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"aM", ",", "2", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"aM", ",", "2", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"mM", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"mM", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"mM", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"mM", ",", "2", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"aF", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"aF", ",", "1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"aF", ",", "2", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"aF", ",", "2", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"mF", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"mF", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"mF", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"F", "[", 
    RowBox[{"mF", ",", "2", ",", "0", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6161466901741*^9, 3.616146731820459*^9, 
  3.616149115152246*^9, 3.616151110088896*^9, 3.616153350329299*^9, 
  3.61615382618569*^9, 3.6161563530884027`*^9, 3.616160914915352*^9, 
  3.616232043021791*^9, 3.6162330578622837`*^9, 3.616233380023488*^9, 
  3.618562354514427*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs1relatedness", "=", 
  RowBox[{"lhs2relatedness", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "\[Rule]", "rtplus1"}], ",", 
     RowBox[{"F", "\[Rule]", "Ftplus1"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.61614675329016*^9, 3.616146772785482*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"rtplus1", "[", 
    RowBox[{"aF", ",", "aM", ",", "1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"aF", ",", "aM", ",", "2", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"aF", ",", "mM", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"aF", ",", "mM", ",", "2", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"mF", ",", "aM", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"mF", ",", "aM", ",", "2", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"mF", ",", "mM", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"mF", ",", "mM", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"Ftplus1", "[", 
    RowBox[{"aM", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"Ftplus1", "[", 
    RowBox[{"aM", ",", "1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"Ftplus1", "[", 
    RowBox[{"aM", ",", "2", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"Ftplus1", "[", 
    RowBox[{"aM", ",", "2", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"Ftplus1", "[", 
    RowBox[{"mM", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"Ftplus1", "[", 
    RowBox[{"mM", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"Ftplus1", "[", 
    RowBox[{"mM", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"Ftplus1", "[", 
    RowBox[{"mM", ",", "2", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"Ftplus1", "[", 
    RowBox[{"aF", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"Ftplus1", "[", 
    RowBox[{"aF", ",", "1", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"Ftplus1", "[", 
    RowBox[{"aF", ",", "2", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"Ftplus1", "[", 
    RowBox[{"aF", ",", "2", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"Ftplus1", "[", 
    RowBox[{"mF", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"Ftplus1", "[", 
    RowBox[{"mF", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"Ftplus1", "[", 
    RowBox[{"mF", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"Ftplus1", "[", 
    RowBox[{"mF", ",", "2", ",", "0", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.616146773307131*^9, 3.616149115204747*^9, 
  3.616151110132444*^9, 3.6161533503346043`*^9, 3.6161538261915607`*^9, 
  3.616156353146809*^9, 3.61616091496098*^9, 3.616232043071595*^9, 
  3.616233057869644*^9, 3.616233380055859*^9, 3.6185623545776567`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"exportDiffRecur", "[", 
  RowBox[{
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/Transgeneration/msparentaleffects1/src/relatedness.txt\>\"\
"}], ",", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", 
       RowBox[{"x", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "reltab"}], "}"}]}], "]"}], "/.", "replacerel"}], 
   ",", "lhs1relatedness", ",", "lhs2relatedness", ",", "0.01", ",", 
   "1000000", ",", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{"-", "7"}], ")"}]}], ",", "bound01"}], "]"}]], "Input",
 CellChangeTimes->{{3.5908309445698223`*^9, 3.590830987989614*^9}, {
   3.590831024917672*^9, 3.590831027357374*^9}, {3.590831061334312*^9, 
   3.590831088158276*^9}, {3.590831209437612*^9, 3.590831264862075*^9}, {
   3.590831313478467*^9, 3.5908313146115007`*^9}, {3.5908327135275373`*^9, 
   3.590832716378105*^9}, {3.590832814910838*^9, 3.5908328204897003`*^9}, {
   3.5908328629264383`*^9, 3.590832875870335*^9}, {3.5908332487393913`*^9, 
   3.5908332656018467`*^9}, {3.590835124242126*^9, 3.590835130286148*^9}, 
   3.616146413440015*^9, {3.616146816090658*^9, 3.6161468570101633`*^9}, {
   3.616151104417499*^9, 3.616151105032502*^9}, 3.616156118688468*^9, {
   3.616156345540195*^9, 3.616156347621196*^9}, 3.616156495283565*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mainrecursion", "[", 
   RowBox[{
   "file_", ",", "lhs1_", ",", "lhs2_", ",", "sys_", ",", "step_", ",", 
    "boundfunc_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mainstr", ",", "iter"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mainstr", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", "\"\<double \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<;\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "<=", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\< = \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", "boundfunc", "]"}], "]"}], "<>", "\"\<(\>\"",
           "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<+\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", "step", "]"}], "]"}], "<>", "\"\<*(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"sys", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<));\\n\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", "\"\<gsl_vector_set(f,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"iter", "-", "1"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"file", ",", "mainstr"}], "]"}], ";"}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.590834528268754*^9, 3.5908345406910887`*^9}, {
  3.5908345731626368`*^9, 3.590834675056554*^9}, {3.59083471597438*^9, 
  3.590834821120158*^9}, {3.590834853928339*^9, 3.5908348608410273`*^9}, {
  3.590835771695839*^9, 3.59083578825672*^9}, {3.5908359289600773`*^9, 
  3.590835932990438*^9}, {3.590840618567021*^9, 3.590840672227709*^9}, {
  3.590840711466693*^9, 3.590840786098345*^9}, {3.590840866972934*^9, 
  3.5908408676441708`*^9}, {3.590906715159862*^9, 3.590906758199222*^9}}],

Cell[BoxData[
 RowBox[{"mainrecursion", "[", 
  RowBox[{
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/Transgeneration/msparentaleffects1/src2/selgrad.txt\>\""}],
    ",", 
   RowBox[{"{", 
    RowBox[{"p1tplus1", ",", "p2tplus1", ",", "mtplus1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2", ",", "mt"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dveqdp", "[", "dp1", "]"}], ",", 
     RowBox[{"dveqdp", "[", "dp2", "]"}], ",", 
     RowBox[{"dveqdm", "[", "dmt", "]"}]}], "}"}], ",", "eul", ",", 
   "bound01"}], "]"}]], "Input",
 CellChangeTimes->{{3.590834863067157*^9, 3.5908348659045677`*^9}, {
   3.5908350208710938`*^9, 3.590835056118764*^9}, {3.590835395027761*^9, 
   3.5908354700620193`*^9}, {3.590835813388159*^9, 3.5908358193860083`*^9}, {
   3.590835893242031*^9, 3.590835938161178*^9}, {3.59083721166047*^9, 
   3.590837216588141*^9}, {3.5908372506434507`*^9, 3.590837278979712*^9}, 
   3.5908408426915493`*^9, {3.591255327965082*^9, 3.591255373916926*^9}, 
   3.616146922897832*^9, {3.6161469595074797`*^9, 3.616146960530655*^9}, {
   3.618562198797748*^9, 3.618562218757862*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "export", " ", "all", " ", "the", " ", "variables", " ", "including", " ", 
   "the", " ", "parameters"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.5908246701104927`*^9, 3.5908246765370817`*^9}}],

Cell[BoxData[
 RowBox[{"exportvarStruct", "[", 
  RowBox[{
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/Transgeneration/msparentaleffects1/src2/variables.txt\>\""}\
], ",", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "c1", ",", "c2", ",", "q1", ",", "q2", ",", "k", ",", "mt", ",", "p1", 
       ",", "p2", ",", "s1", ",", "s2", ",", "i", ",", "t", ",", "Q", ",", 
       "eul"}], "}"}], ",", "vvec", ",", "lhs2patch", ",", 
     "lhs2relatedness"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.590824508033992*^9, 3.590824510035123*^9}, {
   3.590836149589223*^9, 3.59083615739601*^9}, {3.5908363596734037`*^9, 
   3.5908363664583187`*^9}, {3.590837303024035*^9, 3.590837303763467*^9}, {
   3.590837354515375*^9, 3.590837425506982*^9}, {3.590837476699024*^9, 
   3.5908375182256727`*^9}, 3.5908405283010883`*^9, {3.591254984752503*^9, 
   3.591254986592825*^9}, {3.616147024812277*^9, 3.6161470275681047`*^9}, {
   3.616147105767652*^9, 3.616147149281129*^9}, {3.616148985745578*^9, 
   3.6161489872816753`*^9}, {3.6185622102946167`*^9, 3.618562222422887*^9}}],

Cell[BoxData[
 RowBox[{"exportParamStruct", "[", 
  RowBox[{
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/Transgeneration/msparentaleffects1/src2/params.txt\>\""}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
    "c1", ",", "c2", ",", "q1", ",", "q2", ",", "k", ",", "s1", ",", "s2", 
     ",", "i", ",", "t", ",", "Q", ",", "eul"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.590824508033992*^9, 3.590824510035123*^9}, {
   3.590836149589223*^9, 3.59083615739601*^9}, {3.5908363596734037`*^9, 
   3.5908363664583187`*^9}, {3.590837303024035*^9, 3.590837303763467*^9}, {
   3.590837354515375*^9, 3.590837470002576*^9}, 3.616147043513319*^9, 
   3.6161472084803543`*^9, {3.6161489797128077`*^9, 3.616148981712535*^9}, {
   3.618562214140094*^9, 3.618562224756199*^9}}]
}, Closed]]
},
CellGrouping->Manual,
WindowSize->{2487, 1573},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
DockedCells->(FrontEndExecute[{
   FrontEnd`NotebookApply[
    FrontEnd`InputNotebook[], #, Placeholder]}]& ),
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> True}},
Magnification->1.5,
FrontEndVersion->"9.0 for Linux x86 (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 68, 1, 44, "Input"],
Cell[628, 23, 301, 4, 108, "Title"],
Cell[932, 29, 152, 2, 52, "Text"],
Cell[CellGroupData[{
Cell[1109, 35, 116, 1, 110, "Section"],
Cell[1228, 38, 94, 1, 100, "Text"],
Cell[1325, 41, 384, 6, 100, "Input"],
Cell[1712, 49, 1259, 41, 378, "Text"],
Cell[2974, 92, 477, 9, 100, "Input"],
Cell[3454, 103, 669, 21, 258, "Text"],
Cell[4126, 126, 322, 9, 168, "Input"],
Cell[4451, 137, 133, 3, 100, "Text"],
Cell[4587, 142, 460, 9, 231, "Text"],
Cell[5050, 153, 3844, 93, 487, "Input"],
Cell[8897, 248, 2068, 54, 567, "Text"],
Cell[10968, 304, 7049, 185, 1579, "Input"],
Cell[18020, 491, 496, 14, 238, "Text"],
Cell[18519, 507, 1543, 41, 256, "Input"],
Cell[20065, 550, 642, 16, 175, "Text"],
Cell[20710, 568, 2055, 49, 262, "Input"],
Cell[22768, 619, 155, 2, 103, "Text"],
Cell[CellGroupData[{
Cell[22948, 625, 166, 3, 100, "Input"],
Cell[23117, 630, 280, 4, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[23446, 640, 67, 0, 63, "Section"],
Cell[23516, 642, 5761, 135, 279, "Input"],
Cell[29280, 779, 482, 10, 75, "Text"],
Cell[29765, 791, 11494, 270, 1178, "Input"],
Cell[41262, 1063, 238, 3, 103, "Text"],
Cell[41503, 1068, 543, 12, 99, "Input"],
Cell[42049, 1082, 385, 11, 100, "Text"],
Cell[42437, 1095, 1053, 19, 186, "Input"],
Cell[43493, 1116, 450, 9, 75, "Text"],
Cell[43946, 1127, 17275, 404, 885, "Input"],
Cell[61224, 1533, 124, 1, 45, "Text"],
Cell[CellGroupData[{
Cell[61373, 1538, 135, 2, 44, "Input"],
Cell[61511, 1542, 179, 3, 44, "Output"]
}, Open  ]],
Cell[61705, 1548, 481, 13, 44, "Input"],
Cell[CellGroupData[{
Cell[62211, 1565, 152, 3, 44, "Input"],
Cell[62366, 1570, 808, 21, 65, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63211, 1596, 892, 25, 44, "Input"],
Cell[64106, 1623, 2080, 48, 73, "Output"]
}, Open  ]],
Cell[66201, 1674, 856, 21, 73, "Input"],
Cell[67060, 1697, 555, 13, 44, "Input"],
Cell[CellGroupData[{
Cell[67640, 1714, 556, 13, 44, "Input"],
Cell[68199, 1729, 3614, 107, 167, "Output"]
}, Open  ]],
Cell[71828, 1839, 231, 4, 46, "Text"],
Cell[72062, 1845, 3074, 57, 73, "Input"],
Cell[75139, 1904, 3185, 60, 73, "Input"],
Cell[78327, 1966, 3191, 60, 73, "Input"],
Cell[CellGroupData[{
Cell[81543, 2030, 587, 15, 44, "Input"],
Cell[82133, 2047, 3205, 88, 101, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85375, 2140, 1169, 23, 44, "Input"],
Cell[86547, 2165, 3420, 90, 101, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[90016, 2261, 38, 0, 63, "Section"],
Cell[90057, 2263, 774, 27, 172, "Text"],
Cell[90834, 2292, 356, 5, 103, "Text"],
Cell[91193, 2299, 3532, 107, 636, "Input"],
Cell[94728, 2408, 222, 6, 168, "Text"],
Cell[CellGroupData[{
Cell[94975, 2418, 169, 2, 132, "Subsection"],
Cell[95147, 2422, 42464, 948, 6133, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137648, 3375, 115, 1, 132, "Subsection"],
Cell[137766, 3378, 44321, 967, 6297, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182124, 4350, 148, 2, 132, "Subsection"],
Cell[182275, 4354, 1920, 40, 243, "Input"],
Cell[CellGroupData[{
Cell[184220, 4398, 1049, 24, 99, "Input"],
Cell[185272, 4424, 7670, 234, 70, "Output"]
}, Open  ]]
}, Open  ]],
Cell[192969, 4662, 165, 3, 100, "Text"],
Cell[193137, 4667, 253, 7, 99, "Input"],
Cell[193393, 4676, 100, 1, 100, "Text"],
Cell[193496, 4679, 967, 23, 163, "Input"],
Cell[CellGroupData[{
Cell[194488, 4706, 134, 2, 99, "Input"],
Cell[194625, 4710, 164, 3, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[194826, 4718, 2796, 58, 226, "Input"],
Cell[197625, 4778, 3768, 102, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[201430, 4885, 97, 1, 99, "Input"],
Cell[201530, 4888, 3737, 102, 70, "Output"]
}, Open  ]],
Cell[205282, 4993, 92, 1, 99, "Input"],
Cell[205377, 4996, 110, 2, 100, "Text"],
Cell[CellGroupData[{
Cell[205512, 5002, 685, 15, 163, "Input"],
Cell[206200, 5019, 5586, 166, 70, "Output"],
Cell[211789, 5187, 8846, 266, 70, "Output"]
}, Open  ]],
Cell[220650, 5456, 361, 11, 99, "Input"],
Cell[CellGroupData[{
Cell[221036, 5471, 103, 1, 99, "Input"],
Cell[221142, 5474, 4812, 133, 70, "Output"]
}, Open  ]],
Cell[225969, 5610, 457, 13, 99, "Input"],
Cell[CellGroupData[{
Cell[226451, 5627, 100, 1, 99, "Input"],
Cell[226554, 5630, 2742, 85, 70, "Output"]
}, Open  ]],
Cell[229311, 5718, 180, 3, 103, "Text"],
Cell[229494, 5723, 1503, 36, 163, "Input"],
Cell[231000, 5761, 1587, 39, 226, "Input"],
Cell[232590, 5802, 2395, 50, 226, "Input"],
Cell[CellGroupData[{
Cell[235010, 5856, 2164, 37, 99, "Input"],
Cell[237177, 5895, 8268, 215, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[245482, 6115, 2182, 37, 99, "Input"],
Cell[247667, 6154, 8273, 215, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[255989, 6375, 96, 1, 63, "Section"],
Cell[256088, 6378, 155, 3, 45, "Text"],
Cell[CellGroupData[{
Cell[256268, 6385, 107, 1, 59, "Subsection"],
Cell[256378, 6388, 478, 8, 45, "Text"],
Cell[256859, 6398, 1265, 30, 44, "Input"],
Cell[258127, 6430, 1211, 28, 44, "Input"],
Cell[259341, 6460, 1365, 32, 44, "Input"],
Cell[260709, 6494, 1346, 32, 44, "Input"],
Cell[262058, 6528, 1261, 29, 44, "Input"],
Cell[263322, 6559, 1314, 31, 44, "Input"],
Cell[264639, 6592, 1360, 30, 44, "Input"],
Cell[266002, 6624, 1399, 34, 44, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[267438, 6663, 185, 2, 59, "Subsection"],
Cell[267626, 6667, 123, 2, 44, "Input"],
Cell[267752, 6671, 37487, 867, 1754, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[305276, 7543, 140, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[305441, 7548, 47421, 1059, 1894, "Input"],
Cell[352865, 8609, 469, 10, 66, "Message"],
Cell[353337, 8621, 467, 10, 66, "Message"],
Cell[353807, 8633, 511, 10, 33, "Message"],
Cell[354321, 8645, 467, 10, 66, "Message"],
Cell[354791, 8657, 550, 11, 33, "Message"],
Cell[355344, 8670, 509, 10, 33, "Message"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[355902, 8686, 148, 3, 59, "Subsection"],
Cell[356053, 8691, 46786, 1059, 2444, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[402876, 9755, 149, 3, 59, "Subsection"],
Cell[403028, 9760, 35859, 843, 1907, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[438924, 10608, 155, 3, 59, "Subsection"],
Cell[439082, 10613, 40661, 910, 2006, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[479780, 11528, 146, 3, 59, "Subsection"],
Cell[479929, 11533, 36928, 858, 1899, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[516894, 12396, 154, 3, 45, "Subsection"],
Cell[517051, 12401, 37448, 868, 1907, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[554536, 13274, 206, 4, 45, "Subsection"],
Cell[554745, 13280, 38536, 884, 2006, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[593318, 14169, 139, 3, 45, "Subsection"],
Cell[593460, 14174, 29410, 684, 1248, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[622907, 14863, 196, 4, 45, "Subsection"],
Cell[623106, 14869, 29960, 696, 1287, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[653103, 15570, 242, 5, 45, "Subsection"],
Cell[653348, 15577, 29513, 685, 1248, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[682898, 16267, 171, 2, 45, "Subsection"],
Cell[683072, 16271, 137, 3, 45, "Text"],
Cell[CellGroupData[{
Cell[683234, 16278, 8064, 204, 269, "Input"],
Cell[691301, 16484, 467, 10, 33, "Message"],
Cell[691771, 16496, 481, 10, 33, "Message"],
Cell[692255, 16508, 483, 10, 33, "Message"],
Cell[692741, 16520, 529, 11, 33, "Message"],
Cell[693273, 16533, 2594, 40, 115, "Message"],
Cell[695870, 16575, 3809, 56, 161, "Message"],
Cell[699682, 16633, 3811, 56, 161, "Message"],
Cell[703496, 16691, 464, 10, 33, "Message"],
Cell[703963, 16703, 480, 10, 33, "Message"],
Cell[704446, 16715, 480, 10, 33, "Message"],
Cell[704929, 16727, 529, 11, 33, "Message"],
Cell[705461, 16740, 548, 11, 33, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[706046, 16756, 546, 14, 44, "Input"],
Cell[706595, 16772, 2594, 40, 115, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[709226, 16817, 129, 2, 44, "Input"],
Cell[709358, 16821, 3809, 56, 161, "Message"],
Cell[713170, 16879, 11454, 271, 265, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[724661, 17155, 101, 1, 44, "Input"],
Cell[724765, 17158, 5291, 134, 157, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[730093, 17297, 345, 9, 44, "Input"],
Cell[730441, 17308, 1851, 29, 115, "Message"],
Cell[732295, 17339, 1853, 29, 115, "Message"],
Cell[734151, 17370, 7007, 165, 157, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[741195, 17540, 2701, 71, 157, "Input"],
Cell[743899, 17613, 482, 10, 33, "Message"],
Cell[744384, 17625, 480, 10, 33, "Message"],
Cell[744867, 17637, 463, 10, 33, "Message"],
Cell[745333, 17649, 529, 11, 33, "Message"],
Cell[745865, 17662, 616, 12, 33, "Message"],
Cell[746484, 17676, 2922, 68, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[749443, 17749, 301, 8, 44, "Input"],
Cell[749747, 17759, 550, 11, 73, "Message"],
Cell[750300, 17772, 1850, 29, 115, "Message"],
Cell[752153, 17803, 1851, 29, 115, "Message"],
Cell[754007, 17834, 5807, 148, 157, "Output"]
}, Open  ]],
Cell[759829, 17985, 165, 2, 46, "Text"],
Cell[759997, 17989, 2813, 64, 157, "Input"],
Cell[762813, 18055, 2967, 67, 157, "Input"],
Cell[CellGroupData[{
Cell[765805, 18126, 995, 20, 44, "Input"],
Cell[766803, 18148, 1851, 29, 115, "Message"],
Cell[768657, 18179, 1839, 29, 115, "Message"],
Cell[770499, 18210, 570, 11, 33, "Message"],
Cell[771072, 18223, 1779, 42, 101, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[772888, 18270, 440, 13, 44, "Input"],
Cell[773331, 18285, 1839, 29, 115, "Message"],
Cell[775173, 18316, 572, 11, 33, "Message"],
Cell[775748, 18329, 1719, 42, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[777504, 18376, 729, 17, 44, "Input"],
Cell[778236, 18395, 1838, 29, 115, "Message"],
Cell[780077, 18426, 570, 11, 33, "Message"],
Cell[780650, 18439, 3188, 62, 73, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[783899, 18508, 704, 23, 110, "Section"],
Cell[CellGroupData[{
Cell[784628, 18535, 204, 4, 532, "Subsection"],
Cell[784835, 18541, 344, 6, 192240, "Text"],
Cell[785182, 18549, 3738, 105, 1330128, "Input"],
Cell[788923, 18656, 3984, 106, 1330128, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[792944, 18767, 302, 10, 397, "Subsection"],
Cell[793249, 18779, 287, 8, 192240, "Text"],
Cell[793539, 18789, 37533, 922, 8176464, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[831109, 19716, 265, 9, 397, "Subsection"],
Cell[831377, 19727, 84184, 2073, 25155792, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[915598, 21805, 114, 3, 397, "Subsection"],
Cell[CellGroupData[{
Cell[915737, 21812, 242, 5, 397, "Input"],
Cell[915982, 21819, 548, 11, 397, "Output"]
}, Open  ]],
Cell[916545, 21833, 1291, 31, 654, "Input"],
Cell[917839, 21866, 1316, 32, 654, "Input"],
Cell[919158, 21900, 3277, 85, 1404, "Input"],
Cell[922438, 21987, 133, 3, 397, "Text"],
Cell[CellGroupData[{
Cell[922596, 21994, 6673, 146, 2652, "Input"],
Cell[929272, 22142, 377, 6, 397, "Output"],
Cell[929652, 22150, 462, 13, 397, "Input"],
Cell[930117, 22165, 397, 5, 397, "Output"],
Cell[CellGroupData[{
Cell[930539, 22174, 461, 13, 397, "Input"],
Cell[931003, 22189, 399, 7, 397, "Output"]
}, Open  ]],
Cell[931417, 22199, 462, 13, 397, "Input"],
Cell[931882, 22214, 545, 9, 397, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[932488, 22230, 234, 6, 63, "Section"],
Cell[932725, 22238, 346, 10, 397, "Text"],
Cell[CellGroupData[{
Cell[933096, 22252, 207, 4, 532, "Subsection"],
Cell[933306, 22258, 187, 4, 397, "Text"],
Cell[933496, 22264, 9203, 221, 5068, "Input"],
Cell[942702, 22487, 199, 4, 397, "Text"],
Cell[942904, 22493, 1505, 34, 1282, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[944446, 22532, 154, 3, 532, "Subsection"],
Cell[944603, 22537, 3137, 85, 2301, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[947777, 22627, 134, 3, 126144, "Subsection"],
Cell[947914, 22632, 35611, 868, 8056368, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[983562, 23505, 132, 3, 99792, "Subsection"],
Cell[983697, 23510, 84075, 2071, 26541216, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1067809, 25586, 138, 3, 99792, "Subsection"],
Cell[1067950, 25591, 239, 5, 97200, "Text"],
Cell[1068192, 25598, 485, 14, 97200, "Input"],
Cell[1068680, 25614, 676, 19, 158112, "Text"],
Cell[1069359, 25635, 1390, 32, 97200, "Input"],
Cell[1070752, 25669, 1416, 33, 97200, "Input"],
Cell[1072171, 25704, 3306, 85, 288144, "Input"],
Cell[1075480, 25791, 125, 1, 97200, "Text"],
Cell[CellGroupData[{
Cell[1075630, 25796, 6873, 148, 661392, "Input"],
Cell[1082506, 25946, 451, 7, 97200, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1082994, 25958, 99, 1, 97200, "Input"],
Cell[1083096, 25961, 2455, 54, 163296, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1085588, 26020, 831, 22, 97200, "Input"],
Cell[1086422, 26044, 1066, 18, 139968, "Message"],
Cell[1087491, 26064, 1773, 31, 163296, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1089301, 26100, 243, 6, 97200, "Input"],
Cell[1089547, 26108, 1397, 28, 832032, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1091005, 26143, 100, 1, 63, "Section"],
Cell[1091108, 26146, 1202, 33, 1410, "Text"],
Cell[1092313, 26181, 91, 1, 397, "Input"],
Cell[CellGroupData[{
Cell[1092429, 26186, 109, 1, 532, "Subsection"],
Cell[1092541, 26189, 9193, 207, 9396, "Input"],
Cell[1101737, 26398, 2663, 65, 1035936, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1104437, 26468, 128, 3, 126144, "Subsection"],
Cell[CellGroupData[{
Cell[1104590, 26475, 1096, 29, 163296, "Input"],
Cell[1105689, 26506, 1427, 29, 97200, "Output"],
Cell[1107119, 26537, 1389, 29, 97200, "Output"]
}, Open  ]],
Cell[1108523, 26569, 994, 19, 97200, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1109554, 26593, 134, 3, 126144, "Subsection"],
Cell[CellGroupData[{
Cell[1109713, 26600, 1788, 45, 224208, "Input"],
Cell[1111504, 26647, 1960, 40, 163296, "Output"]
}, Open  ]],
Cell[1113479, 26690, 1055, 20, 97200, "Input"]
}, Open  ]],
Cell[1114549, 26713, 117, 1, 126144, "Subsection"],
Cell[CellGroupData[{
Cell[1114691, 26718, 323, 9, 78192, "Input"],
Cell[1115017, 26729, 2478, 55, 163296, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1117532, 26789, 291, 7, 97200, "Input"],
Cell[1117826, 26798, 2601, 54, 224208, "Output"]
}, Open  ]],
Cell[1120442, 26855, 1434, 31, 163296, "Input"],
Cell[1121879, 26888, 3638, 83, 848016, "Input"],
Cell[1125520, 26973, 1139, 24, 163296, "Input"],
Cell[1126662, 26999, 247, 5, 97200, "Input"],
Cell[1126912, 27006, 1114, 22, 97200, "Input"],
Cell[1128029, 27030, 782, 16, 97200, "Input"]
}, Closed]]
}
]
*)

(* End of internal cache information *)
