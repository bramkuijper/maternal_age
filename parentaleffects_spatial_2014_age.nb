(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[   1073707,      25579]
NotebookOptionsPosition[   1060736,      25183]
NotebookOutlinePosition[   1061302,      25204]
CellTagsIndexPosition[   1061259,      25201]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[" "], "Input",
 CellChangeTimes->{3.60895692267762*^9}],

Cell[TextData[StyleBox["Maternal Effects and Maternal Age",
 FontSize->24]], "Title",
 CellChangeTimes->{{3.593494666799176*^9, 3.593494707374599*^9}, {
  3.5937783195816603`*^9, 3.5937783301250973`*^9}, {3.608870866174801*^9, 
  3.608870867597124*^9}, {3.6240267916373568`*^9, 3.624026811995323*^9}}],

Cell[TextData[StyleBox["Bram Kuijper & Rufus A. Johnstone",
 FontSize->16]], "Text",
 CellChangeTimes->{{3.593778276437594*^9, 3.5937782840517187`*^9}}],

Cell[CellGroupData[{

Cell["Parameters and initialization", "Section",
 CellChangeTimes->{{3.5925369193881607`*^9, 3.592536949051231*^9}}],

Cell["Clear memory:", "Text",
 CellChangeTimes->{{3.59344239283613*^9, 3.593442395379766*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.500128427684636*^9, 3.500128451258902*^9}, 
   3.50073299731535*^9, {3.5018611272843018`*^9, 3.501861128504798*^9}, 
   3.501861166978281*^9, {3.505125110823873*^9, 3.505125111480598*^9}, {
   3.509288972748003*^9, 3.509288973397145*^9}, {3.509608637730192*^9, 
   3.509608638396096*^9}}],

Cell[TextData[{
 StyleBox["- Patch frequncies ",
  FontWeight->"Bold"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["f", 
    RowBox[{"x", ",", "i", ",", "j", ",", "k"}]], TraditionalForm]],
  FontWeight->"Bold"],
 StyleBox["\n",
  FontWeight->"Bold"],
 StyleBox["x",
  FontSlant->"Italic"],
 ": environment ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "1"], TraditionalForm]]],
 " or ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "2"], TraditionalForm]]],
 " (here annotated as ",
 StyleBox["a",
  FontSlant->"Italic"],
 ", ",
 StyleBox["b",
  FontSlant->"Italic"],
 ")\n",
 StyleBox["i",
  FontSlant->"Italic"],
 ": number of young breeders adapted to local environment\n",
 StyleBox["j",
  FontSlant->"Italic"],
 ": number of young breeders maladapted to local environment\n",
 StyleBox["k",
  FontSlant->"Italic"],
 ": number of old breeders adapted to local environment"
}], "Text",
 CellChangeTimes->{{3.500116732616866*^9, 3.5001167713959846`*^9}, {
  3.592536638246684*^9, 3.592536709381946*^9}, {3.5925368332856894`*^9, 
  3.5925368556518803`*^9}, {3.5934424013557873`*^9, 3.59344240478764*^9}, {
  3.5934435772716312`*^9, 3.5934435786830397`*^9}, {3.607685242639638*^9, 
  3.607685289006283*^9}, {3.618922101159214*^9, 3.618922178073358*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{"e_", ",", "a1_", ",", "m1_", ",", "a2_", ",", "m2_"}], "]"}], ":=", 
  RowBox[{"fx", "[", 
   RowBox[{"e", ",", "a1", ",", "m1", ",", "a2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.607685424645199*^9, 3.607685465832694*^9}, {
  3.60768549794396*^9, 3.607685520058104*^9}, {3.607699744787403*^9, 
  3.607699752073833*^9}, {3.618922362359199*^9, 3.6189223804237757`*^9}, {
  3.624048493487925*^9, 3.624048494451849*^9}}],

Cell[TextData[{
 StyleBox["- Switching rates\n",
  FontWeight->"Bold"],
 Cell[BoxData[{
  FormBox[
   RowBox[{
    SubscriptBox["s", "1"], "=", 
    SubscriptBox["s", 
     RowBox[{
      SubscriptBox["e", "1"], "\[Rule]", 
      SubscriptBox["e", "2"]}]]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    SubscriptBox["s", "2"], "=", 
    SubscriptBox["s", 
     RowBox[{
      SubscriptBox["e", "2"], "\[Rule]", 
      SubscriptBox["e", "1"]}]]}], TraditionalForm]}]]
}], "Text",
 CellChangeTimes->{{3.500116778255621*^9, 3.500116786939053*^9}, {
  3.5925373284084177`*^9, 3.5925373751662283`*^9}, {3.593443566867229*^9, 
  3.5934435669632*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"st", "=", 
   RowBox[{"{", 
    RowBox[{"s1", ",", "s2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "[", "es_", "]"}], ":=", 
  RowBox[{"st", "[", 
   RowBox[{"[", "es", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5925373087718763`*^9, 3.5925373233792*^9}}],

Cell["\<\
Specification of the evolutionary variables\
\>", "Text",
 CellChangeTimes->{{3.592537654940291*^9, 3.592537660676259*^9}}],

Cell[TextData[{
 StyleBox["- Dispersal locus",
  FontWeight->"Bold"],
 "\nmx: resident dispersal rates\ndmx: \[Delta], slight difference between \
mutant and resident dispersal rates"
}], "Text",
 CellChangeTimes->{{3.5925374540299177`*^9, 3.592537454998452*^9}, {
  3.592537662916122*^9, 3.5925376632683887`*^9}, {3.592537720779931*^9, 
  3.592537797507066*^9}, {3.5934435603070107`*^9, 3.593443589964015*^9}, {
  3.593443687619841*^9, 3.593443689099412*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mx", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mt", ",", "mt"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mt", ",", "mt"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mt", ",", "mt"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"mt", ",", "mt"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dmx", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dmt", ",", "dmt"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dmt", ",", "dmt"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dmt", ",", "dmt"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"dmt", ",", "dmt"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m", "[", 
    RowBox[{"es_", ",", "state_", ",", "age_"}], "]"}], ":=", 
   RowBox[{"mx", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"age", "+", "1"}], ",", "es", ",", 
      RowBox[{"1", "+", "state"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dm", "[", 
    RowBox[{"es_", ",", "state_", ",", "age_"}], "]"}], ":=", 
   RowBox[{"dmx", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"age", "+", "1"}], ",", "es", ",", 
      RowBox[{"1", "+", "state"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"varlistM", ":=", 
    RowBox[{"{", "mt", "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "definitions", " ", "needed", " ", "later", " ", "for", " ", "function", 
    " ", "specification"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varlistdM", ":=", 
   RowBox[{"{", "dmt", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"arglistM", ":=", "ms__Real"}], ";"}]}], "Input",
 CellChangeTimes->{{3.500118773163447*^9, 3.500118910263569*^9}, {
   3.500119087597973*^9, 3.500119090980617*^9}, {3.5001195528530283`*^9, 
   3.500119593468643*^9}, {3.500120092623599*^9, 3.500120092748851*^9}, {
   3.500136368745949*^9, 3.500136374906622*^9}, {3.5001423795874243`*^9, 
   3.500142397835494*^9}, {3.5001910544408283`*^9, 3.5001910707255917`*^9}, {
   3.505128236491838*^9, 3.505128288704921*^9}, {3.505133288973331*^9, 
   3.505133296177403*^9}, {3.505133522438445*^9, 3.505133549659513*^9}, {
   3.505134014352137*^9, 3.50513403905585*^9}, {3.505134240579132*^9, 
   3.505134241767873*^9}, {3.505139351314415*^9, 3.505139372086256*^9}, {
   3.5051558273320293`*^9, 3.505155855600602*^9}, {3.50539467615995*^9, 
   3.505394676982449*^9}, {3.505463244026674*^9, 3.505463257417686*^9}, {
   3.505463307333784*^9, 3.505463321253703*^9}, {3.50546575267028*^9, 
   3.505465768233089*^9}, {3.505484976325813*^9, 3.505484983948823*^9}, {
   3.50548503239085*^9, 3.505485033454481*^9}, {3.505558270883147*^9, 
   3.505558284187843*^9}, {3.505571015107941*^9, 3.505571047863003*^9}, {
   3.505581160740476*^9, 3.50558117287267*^9}, {3.505583355345198*^9, 
   3.505583361715997*^9}, {3.505583682927802*^9, 3.505583683359265*^9}, 
   3.50558371668095*^9, {3.505654692054782*^9, 3.505654715998914*^9}, {
   3.505654759113348*^9, 3.505654761139649*^9}, {3.50565724255633*^9, 
   3.505657273309394*^9}, {3.505661781217031*^9, 3.505661845410152*^9}, {
   3.505661877847231*^9, 3.505661889520056*^9}, {3.505751661144566*^9, 
   3.505751681752979*^9}, {3.505751745355992*^9, 3.505751753278463*^9}, {
   3.507884037673462*^9, 3.507884044308074*^9}, {3.515223764045479*^9, 
   3.515223766960201*^9}, {3.59344329997761*^9, 3.5934433141234093`*^9}, {
   3.6240488182675467`*^9, 3.624048882538862*^9}, 3.6240491606050177`*^9, 
   3.624082038492394*^9}],

Cell[TextData[{
 StyleBox["- Phenotype-dependent switching",
  FontWeight->"Bold"],
 "\npx: table of probabilities that females with a particular phenotype \
produce offspring of a different phenotype than their own. \ndpx: same, but \
now as a function of a slight mutant difference relative to resident\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["p", "1"], ",", 
    SubscriptBox["p", "2"]}], TraditionalForm]]],
 ": probability of producing ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "1"], TraditionalForm]]],
 "-offspring  for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "1"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "2"], TraditionalForm]]],
 " parents respectively\nQ: `trembling hand\[CloseCurlyQuote] error to avoid \
local maxima (sensu Selten 1975 Int J Game Theor 4: 25-55)\n\np[es,ad]: \
lookup function connecting a female\[CloseCurlyQuote]s environment ",
 StyleBox["es",
  FontSlant->"Italic"],
 " and her adapted/maladapted state ",
 StyleBox["ad",
  FontSlant->"Italic"],
 " to values of px \nFor example, p[1,0] reflects a female living in \
environment ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "1"], TraditionalForm]]],
 " with \[OpenCurlyQuote]adaptedness\[CloseCurlyQuote]=0 (i.e., maladapted). \
In other words, this is a ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", 
    RowBox[{"2", " "}]], TraditionalForm]]],
 "-female (which is adapted to environment ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", "2"], TraditionalForm]]],
 "). See main text."
}], "Text",
 CellChangeTimes->{{3.592537529829274*^9, 3.592537608764773*^9}, {
  3.592537665787866*^9, 3.592537666036079*^9}, {3.592537805202849*^9, 
  3.592537830338646*^9}, {3.592543662226894*^9, 3.592543678923498*^9}, {
  3.593442422212388*^9, 3.593442485691265*^9}, {3.593443236238962*^9, 
  3.5934432559978437`*^9}, {3.593443341806076*^9, 3.5934435210194693`*^9}, {
  3.593443562188596*^9, 3.593443683563737*^9}, {3.607685567541914*^9, 
  3.607685570004575*^9}, {3.607685652396105*^9, 3.607685680059689*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"px", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "p20"}], "+", 
          RowBox[{"Q", 
           RowBox[{"(", 
            RowBox[{"1", "-", "p20"}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "p10"}], ")"}]}], "+", 
          RowBox[{"Q", " ", "p10"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "p10"}], ")"}]}], "+", 
          RowBox[{"Q", " ", "p10"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "p20"}], "+", 
          RowBox[{"Q", 
           RowBox[{"(", 
            RowBox[{"1", "-", "p20"}], ")"}]}]}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "p21"}], "+", 
          RowBox[{"Q", 
           RowBox[{"(", 
            RowBox[{"1", "-", "p21"}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "p11"}], ")"}]}], "+", 
          RowBox[{"Q", " ", "p11"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "p11"}], ")"}]}], "+", 
          RowBox[{"Q", " ", "p11"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "p21"}], "+", 
          RowBox[{"Q", 
           RowBox[{"(", 
            RowBox[{"1", "-", "p21"}], ")"}]}]}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dpx", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "p20"}], "-", 
          RowBox[{"Q", " ", "dp20"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}]}], "dp10"}], "+", 
          RowBox[{"Q", " ", "dp10"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}]}], "dp10"}], "+", 
          RowBox[{"Q", " ", "dp10"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "dp20"}], "+", 
          RowBox[{
           RowBox[{"-", "dp20"}], " ", "Q"}]}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "dp21"}], "+", 
          RowBox[{
           RowBox[{"-", "dp21"}], " ", "Q"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "dp11"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}]}], "+", 
          RowBox[{"Q", " ", "dp11"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"1", "-", "Q"}], ")"}]}], "dp11"}], "+", 
          RowBox[{"Q", " ", "dp11"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "Q"}], ")"}], "dp21"}], "+", 
          RowBox[{
           RowBox[{"-", "dp21"}], " ", "Q"}]}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"p", "[", 
    RowBox[{"es_", ",", "ad_", ",", "age_"}], "]"}], ":=", 
   RowBox[{"px", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"age", "+", "1"}], ",", "es", ",", 
      RowBox[{"1", "+", "ad"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dp", "[", 
   RowBox[{"es_", ",", "ad_", ",", "age_"}], "]"}], ":=", 
  RowBox[{"dpx", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"age", "+", "1"}], ",", "es", ",", 
     RowBox[{"1", "+", "ad"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.517038062927934*^9, 3.51703816854226*^9}, {
   3.51905182898097*^9, 3.519051833116747*^9}, {3.520238431048418*^9, 
   3.520238433809459*^9}, {3.520241987657432*^9, 3.520242003026947*^9}, {
   3.520242820378682*^9, 3.520242825954704*^9}, {3.520243764786285*^9, 
   3.520243764836133*^9}, 3.52024391190013*^9, {3.520244311149429*^9, 
   3.520244311961317*^9}, {3.52024449388923*^9, 3.520244495018912*^9}, {
   3.520244741108325*^9, 3.520244741844243*^9}, {3.520244856084298*^9, 
   3.520244860756021*^9}, {3.520253380519802*^9, 3.520253380863543*^9}, {
   3.520414422134022*^9, 3.520414425613311*^9}, {3.520414525684128*^9, 
   3.520414527662351*^9}, {3.520434069244433*^9, 3.520434072029148*^9}, {
   3.520586789091575*^9, 3.52058679184248*^9}, {3.521874430981219*^9, 
   3.521874431323632*^9}, {3.52257859226308*^9, 3.52257859675019*^9}, {
   3.524043568339653*^9, 3.52404359269764*^9}, {3.524553556495103*^9, 
   3.524553606251944*^9}, {3.524553918507112*^9, 3.5245539506721*^9}, {
   3.525850588866333*^9, 3.525850590761015*^9}, {3.525850874608904*^9, 
   3.52585088449899*^9}, {3.525850951689707*^9, 3.525850953593128*^9}, {
   3.526018821964699*^9, 3.526018825526871*^9}, {3.529061426773059*^9, 
   3.529061432864193*^9}, {3.531769959557863*^9, 3.531769961986011*^9}, {
   3.531813417393294*^9, 3.531813426256126*^9}, {3.532112898613368*^9, 
   3.532112901190764*^9}, {3.591254623425433*^9, 3.591254674241444*^9}, {
   3.591254782320562*^9, 3.591254807306346*^9}, {3.591255456850945*^9, 
   3.591255467228277*^9}, {3.59253752077489*^9, 3.592537526295137*^9}, {
   3.593443320155177*^9, 3.593443320604072*^9}, {3.6240280850117617`*^9, 
   3.6240280882261267`*^9}, {3.62402812107955*^9, 3.624028237540576*^9}, {
   3.624028271040254*^9, 3.6240283051777687`*^9}, {3.6240283471418543`*^9, 
   3.624028446581362*^9}, {3.624028481492853*^9, 3.624028507960659*^9}}],

Cell[TextData[{
 StyleBox["- Mortality selection parameters",
  FontWeight->"Bold"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["c", "1"], ",", 
    SubscriptBox["c", "2"]}], TraditionalForm]]],
 ": mortality parameters for maladapted individuals (mortality for adapted \
individuals = 1)\nFor examp"
}], "Text",
 CellChangeTimes->{{3.592537851082424*^9, 3.592537857386005*^9}, {
  3.59253793334632*^9, 3.592537965257461*^9}, {3.593443533412225*^9, 
  3.5934435640436087`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dx", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"1", "-", "c1"}]], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"1", "-", "c2"}]], ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"1", "-", "c3"}]], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", 
          RowBox[{"1", "-", "c4"}]], ",", "1"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d", "[", 
   RowBox[{"es_", ",", "state_", ",", "age_"}], "]"}], ":=", 
  RowBox[{"dx", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"age", "+", "1"}], ",", "es", ",", 
     RowBox[{"1", "+", "state"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5001332396173964`*^9, 3.500133281520371*^9}, {
   3.500136200146578*^9, 3.500136210329666*^9}, {3.50019263291833*^9, 
   3.500192634364931*^9}, {3.501930681155058*^9, 3.501930688304488*^9}, {
   3.529063162916232*^9, 3.529063180835222*^9}, {3.531745922364476*^9, 
   3.531745923930574*^9}, {3.531753845404137*^9, 3.531753847069844*^9}, 
   3.592537868033029*^9, {3.624027670912199*^9, 3.624027672199456*^9}, {
   3.624027776542458*^9, 3.624027777806684*^9}, {3.624027817031006*^9, 
   3.624027909607691*^9}, {3.624027945293303*^9, 3.624027949438402*^9}}],

Cell[TextData[{
 StyleBox["- Fecundity selection,",
  FontWeight->"Bold"],
 "\n(will be considered in a follow-up paper, Kuijper & Johnstone, in \
preparation). In the current paper ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["q", "1"], "=", 
    RowBox[{
     SubscriptBox["q", "2"], "=", "0"}]}], TraditionalForm]]],
 " (i.e., no fecundity selection)"
}], "Text",
 CellChangeTimes->{{3.592537996952724*^9, 3.592538031208852*^9}, 
   3.5925381100882196`*^9, {3.592542916506803*^9, 3.59254293150633*^9}, {
   3.593443695890839*^9, 3.5934437229465857`*^9}, {3.6240276653933*^9, 
   3.6240276679135942`*^9}, 3.624027773542657*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gx", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         FractionBox["1", 
          RowBox[{"1", "-", "q1"}]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         FractionBox["1", 
          RowBox[{"1", "-", "q2"}]]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         FractionBox["1", 
          RowBox[{"1", "-", "q1"}]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         FractionBox["1", 
          RowBox[{"1", "-", "q2"}]]}], "}"}]}], "}"}]}], "}"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "[", 
   RowBox[{"es_", ",", "state_", ",", "age_"}], "]"}], ":=", 
  RowBox[{"gx", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"age", "+", "1"}], ",", "es", ",", 
     RowBox[{"1", "+", "state"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.5001362469952993`*^9, {3.5001363089459*^9, 3.500136374034523*^9}, {
   3.500137044277297*^9, 3.500137056632866*^9}, {3.500192628905581*^9, 
   3.50019263010264*^9}, {3.515223772880254*^9, 3.515223784680871*^9}, 
   3.515223924473187*^9, {3.515224082129158*^9, 3.515224083857226*^9}, {
   3.515657870386673*^9, 3.515657873587348*^9}, {3.522140274375248*^9, 
   3.522140279087269*^9}, {3.522140310086524*^9, 3.522140341051928*^9}, {
   3.522578386308506*^9, 3.522578410393209*^9}, {3.526018481416929*^9, 
   3.526018487167841*^9}, {3.526018802116892*^9, 3.526018803063705*^9}, {
   3.52664437543906*^9, 3.526644382349394*^9}, {3.529063122319402*^9, 
   3.529063155149573*^9}, {3.53175382627929*^9, 3.531753836680533*^9}, {
   3.532110552853554*^9, 3.532110558952022*^9}, {3.591583551770855*^9, 
   3.591583556601612*^9}, {3.592537975488604*^9, 3.592537995359036*^9}, {
   3.592538034198379*^9, 3.592538044079611*^9}, {3.592538094340519*^9, 
   3.592538105045054*^9}, {3.592542908180541*^9, 3.592542912944188*^9}, {
   3.6240950822297*^9, 3.624095100838315*^9}}],

Cell[TextData[StyleBox["- Number of breeders per patch",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.593443728066662*^9, 3.5934437360340567`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"n", "=", "2"}]], "Input",
 CellChangeTimes->{{3.6240951692045107`*^9, 3.624095170528673*^9}, {
  3.624280986194656*^9, 3.624280986660377*^9}}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.6240953313148327`*^9, 3.624100989177085*^9, 
  3.6241174114769487`*^9, 3.62420398088582*^9, 3.624280933724107*^9, 
  3.624280989717226*^9, 3.624282706912945*^9, 3.624301572009207*^9, 
  3.624346228161007*^9, 3.624365908606504*^9, 3.624369638337841*^9, 
  3.6244358217538357`*^9, 3.6244359968170223`*^9, 3.624442862903637*^9, 
  3.624549121034892*^9, 3.624549434761889*^9, 3.6245656351636744`*^9, 
  3.624875248483287*^9, 3.624882092709331*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Patch frequencies", "Section"]], "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"localad", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["a1", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["a2", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["m1", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"n", "-", "a2", "-", "a1", "-", "m1"}], "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], 
     ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localmad", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    FractionBox["a1", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["a2", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["m1", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"n", "-", "a2", "-", "a1", "-", "m1"}], "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.500120873674243*^9, 3.5001210355847692`*^9}, {
   3.500121143974712*^9, 3.5001211891721582`*^9}, {3.5001254507449503`*^9, 
   3.5001254895331507`*^9}, {3.5001255395065823`*^9, 3.50012556780807*^9}, {
   3.50012559895665*^9, 3.500125609305683*^9}, 3.500125734437594*^9, {
   3.500125795420335*^9, 3.500125838193928*^9}, {3.5001260925815897`*^9, 
   3.50012619653481*^9}, {3.500126318936735*^9, 3.500126490780538*^9}, {
   3.500126522241294*^9, 3.500126614249658*^9}, {3.5001266560703173`*^9, 
   3.500126692145039*^9}, {3.50012679804455*^9, 3.500126865625854*^9}, {
   3.5001269598438177`*^9, 3.500127010728797*^9}, {3.500127066746924*^9, 
   3.500127075242776*^9}, 3.500127168349073*^9, {3.500127799012751*^9, 
   3.50012794447775*^9}, {3.500127989244396*^9, 3.500128053011385*^9}, {
   3.500128120681616*^9, 3.5001281869125023`*^9}, {3.500128273678108*^9, 
   3.500128282830265*^9}, {3.500128331005128*^9, 3.500128412672514*^9}, {
   3.500128485970336*^9, 3.5001285037885857`*^9}, {3.500128604416666*^9, 
   3.500128654695407*^9}, {3.500128793134313*^9, 3.500128821190743*^9}, {
   3.500128924224536*^9, 3.500128962612554*^9}, {3.500129044296741*^9, 
   3.500129059197551*^9}, {3.500189795589278*^9, 3.500189809037795*^9}, {
   3.500191120480218*^9, 3.500191135144388*^9}, {3.500192700247055*^9, 
   3.5001927267342463`*^9}, {3.5007274959643087`*^9, 
   3.5007274971650257`*^9}, {3.500727569917247*^9, 3.5007275729396*^9}, {
   3.500728699556571*^9, 3.500728740477393*^9}, {3.500728835717046*^9, 
   3.500728850269268*^9}, {3.5007290429903793`*^9, 3.50072910127816*^9}, {
   3.5007291775293827`*^9, 3.5007291977631283`*^9}, {3.500732760953953*^9, 
   3.5007327631378593`*^9}, {3.5007330148648577`*^9, 3.500733037851882*^9}, {
   3.5018653388124866`*^9, 3.501865368880773*^9}, {3.502634529232007*^9, 
   3.502634563110133*^9}, {3.5026347197756767`*^9, 3.5026348117526073`*^9}, {
   3.502634899986861*^9, 3.5026349004268627`*^9}, {3.503042079156918*^9, 
   3.50304208574548*^9}, {3.503042184532455*^9, 3.503042189260453*^9}, {
   3.505128467356586*^9, 3.505128474487809*^9}, {3.505128506618724*^9, 
   3.505128554696378*^9}, {3.505815927928623*^9, 3.505815929681814*^9}, {
   3.507037958421404*^9, 3.507038012491966*^9}, {3.507218416099026*^9, 
   3.507218426680966*^9}, {3.507218486766817*^9, 3.507218528077397*^9}, 
   3.592538400160944*^9, 3.592538470702742*^9, 3.592538512268461*^9, {
   3.592538604446601*^9, 3.592538607212532*^9}, {3.592543613859783*^9, 
   3.592543624398034*^9}, {3.62409267422051*^9, 3.6240926975096073`*^9}, {
   3.62409274038883*^9, 3.624092856324395*^9}}],

Cell[TextData[{
 StyleBox["- Migrant juveniles arriving in an environment to which they are \
adapted (dispad) or maladapted (dispmad)\n",
  FontWeight->"Bold"],
 StyleBox["k",
  FontSlant->"Italic"],
 ": cost of dispersal. Calculations below are  derived in the same fashion as \
calculations involving philopatric juveniles. See also in-line comments"
}], "Text",
 CellChangeTimes->{{3.592538529147274*^9, 3.5925385842660847`*^9}, {
  3.593443761786683*^9, 3.593443844378488*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dispad", "[", "es_", "]"}], ":=", 
   RowBox[{"(*", " ", 
    RowBox[{
    "probability", " ", "that", " ", "a", " ", "migrant", " ", "migrates", 
     " ", "into", " ", "environment", " ", "es", " ", "where", " ", "it", " ",
      "is", " ", "adapted"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "k"}], ")"}], "*", 
     RowBox[{"Sum", "[", 
      RowBox[{"(*", " ", 
       RowBox[{"sum", " ", "over", " ", "environments"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{"(*", " ", 
         RowBox[{
         "sum", " ", "over", " ", "number", " ", "of", " ", "adapted", " ", 
          "breeders"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"es", "\[Equal]", "esSum"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"esSum", ",", "a1", ",", "m1", ",", "a2", ",", 
              RowBox[{"n", "-", "a1", "-", "m1", "-", "a2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["a1", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "1", ",", "0"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["m1", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["a2", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "1", ",", "1"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"n", "-", "a2", "-", "a1", "-", "m1"}], "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}]}]}], ")"}]}], 
           ",", 
           RowBox[{"(*", " ", 
            RowBox[{"environment", " ", "same", " ", "as", " ", "target"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"esSum", ",", "a1", ",", "m1", ",", "a2", ",", 
              RowBox[{"n", "-", "a1", "-", "m1", "-", "a2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["a1", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["m1", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "0", ",", "0"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["a2", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"n", "-", "a2", "-", "a1", "-", "m1"}], "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "0", ",", "1"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}]}]}], ")"}]}]}], 
          " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "environment", " ", "different", " ", "from", " ", "target"}], " ",
            "*)"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"{", 
          RowBox[{"a1", ",", "0", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m1", ",", "0", ",", 
           RowBox[{"n", "-", "a1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a2", ",", "0", ",", 
           RowBox[{"n", "-", "a1", "-", "m1"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"esSum", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dispmad", "[", "es_", "]"}], ":=", 
   RowBox[{"(*", " ", 
    RowBox[{
    "probability", " ", "that", " ", "a", " ", "migrant", " ", "migrates", 
     " ", "into", " ", "environment", " ", "es", " ", "where", " ", "it", " ",
      "is", " ", "maladapted"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "k"}], ")"}], "*", 
     RowBox[{"Sum", "[", 
      RowBox[{"(*", " ", 
       RowBox[{"sum", " ", "over", " ", "environments"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{"(*", " ", 
         RowBox[{
         "sum", " ", "over", " ", "number", " ", "of", " ", "adapted", " ", 
          "breeders"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"es", "\[Equal]", "esSum"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"esSum", ",", "a1", ",", "m1", ",", "a2", ",", 
              RowBox[{"n", "-", "a1", "-", "m1", "-", "a2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["a1", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["m1", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "0", ",", "0"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["a2", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"n", "-", "a2", "-", "a1", "-", "m1"}], "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "0", ",", "1"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}]}]}], ")"}]}], 
           " ", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"environment", " ", "same", " ", "as", " ", "target"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"esSum", ",", "a1", ",", "m1", ",", "a2", ",", 
              RowBox[{"n", "-", "a1", "-", "m1", "-", "a2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["a1", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "1", ",", "0"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["m1", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "0"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["a2", "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"p", "[", 
                  RowBox[{"esSum", ",", "1", ",", "1"}], "]"}]}], ")"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "1", ",", "1"}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"n", "-", "a2", "-", "a1", "-", "m1"}], "n"], 
               RowBox[{"g", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}], 
               RowBox[{"p", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}], 
               RowBox[{"m", "[", 
                RowBox[{"esSum", ",", "0", ",", "1"}], "]"}]}]}], ")"}]}]}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "environment", " ", "different", " ", "from", " ", "target"}], " ",
            "*)"}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"{", 
          RowBox[{"a1", ",", "0", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"m1", ",", "0", ",", 
           RowBox[{"n", "-", "a1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a2", ",", "0", ",", 
           RowBox[{"n", "-", "a1", "-", "m1"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"esSum", ",", "1", ",", "2"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.624092914352302*^9, 3.6240930822533493`*^9}, {
  3.6240931420025187`*^9, 3.624093225122897*^9}}],

Cell[TextData[StyleBox["- Total number of locally competing juveniles:",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.59253861564257*^9, 3.592538624986649*^9}, 
   3.592542341792898*^9, {3.59344384898559*^9, 3.59344384910559*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"localcomptotal", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"localad", "[", 
    RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
   RowBox[{"localmad", "[", 
    RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
   RowBox[{"dispad", "[", "es", "]"}], "+", 
   RowBox[{"dispmad", "[", "es", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.624093238440284*^9, 3.624093256143965*^9}, {
  3.6242810234661503`*^9, 3.624281024489506*^9}}],

Cell[TextData[{
 "ap[es,a]: Probability that any adapted juvenile will win competition over \
breeding spots in an environment of type ",
 StyleBox["es",
  FontSlant->"Italic"],
 " with ",
 StyleBox["a",
  FontSlant->"Italic"],
 " adapted adult breeders."
}], "Text",
 CellChangeTimes->{{3.5925423472402363`*^9, 3.592542367063136*^9}, {
  3.5934439214345818`*^9, 3.59344395112869*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ap", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_", ",", "m2_"}], "]"}], ":=", 
  FractionBox[
   RowBox[{
    RowBox[{"localad", "[", 
     RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
    RowBox[{"dispad", "[", "es", "]"}]}], 
   RowBox[{"localcomptotal", "[", 
    RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}]]}]], "Input",
 CellChangeTimes->{{3.50011871566383*^9, 3.5001187192399063`*^9}, {
  3.500118749446988*^9, 3.5001187498715553`*^9}, {3.50011898132974*^9, 
  3.500119107117433*^9}, {3.500120259137155*^9, 3.5001202933416452`*^9}, {
  3.500120354606805*^9, 3.500120418327129*^9}, {3.500126699926446*^9, 
  3.500126706681553*^9}, {3.500126764548074*^9, 3.500126768982004*^9}, {
  3.500126872493771*^9, 3.500126901933896*^9}, {3.5001280981944838`*^9, 
  3.5001280987513313`*^9}, {3.507218430517244*^9, 3.507218462584997*^9}, {
  3.507218821963867*^9, 3.507218824172164*^9}, {3.624093269615767*^9, 
  3.6240932941936913`*^9}, {3.624281017342733*^9, 3.624281018309783*^9}}],

Cell[TextData[{
 StyleBox["- Differential equations for the patch frequencies\n",
  FontWeight->"Bold"],
 "Each event (switching, mortality of different types of breeders) is \
highlighted by an in-line comment. Table contains right hand side of \
differential equations:"
}], "Text",
 CellChangeTimes->{{3.592538865120399*^9, 3.592538880359948*^9}, {
  3.593443853610029*^9, 3.593443888705567*^9}, {3.5934439714013977`*^9, 
  3.593443992009426*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tablerecPlain", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m2", "=", 
         RowBox[{"n", "-", "a1", "-", "a2", "-", "m1"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"3", "-", "es"}], "]"}], " ", 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", "m1", ",", "a1", ",", "m2", ",", 
           "a2"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"s", "[", "es", "]"}], " ", 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", "m2"}], "]"}]}],
         " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "change", " ", "due", " ", "to", " ", "environmental", " ", 
          "switching"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"a1", "-", "1"}], "\[GreaterEqual]", "0"}], "&&", 
           RowBox[{
            RowBox[{"m1", "+", "1"}], "\[LessEqual]", "n"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1", "-", "1"}], ",", 
             RowBox[{"m1", "+", "1"}], ",", "a2", ",", "m2"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1", "-", "1"}], ",", 
             RowBox[{"m1", "+", "1"}], ",", "a2", ",", "m2"}], "]"}]}], ",", 
          "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "maladapted", " ", "juvenile", " ", "breeder", " ", "dies"}], ",", 
          " ", 
          RowBox[{
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "juvenile", " ", 
            "breeder", " ", "on", " ", "a", " ", "m1"}], "+", "1"}], ",", 
          RowBox[{"a1", "-", 
           RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "-", 
        RowBox[{"m1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", "m2"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", "m2"}], "]"}]}],
         "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "maladapted", " ", "juvenile", " ", "breeder", " ", "dies"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "an", " ", "adapted", " ", "juvenile", 
           " ", "breeder", " ", "on", " ", "a", " ", "m1"}], ",", 
          RowBox[{"a1", " ", "patch"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"m1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"m2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "a1", ",", 
             RowBox[{"m1", "+", "1"}], ",", "a2", ",", 
             RowBox[{"m2", "-", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "maladapted", " ", "juvenile", " ", "breeder", " ", "survives", 
            " ", "to", " ", "become", " ", "a", " ", "maladapted", " ", 
            "adult", " ", "breeder", " ", "on", " ", "a", " ", "m1"}], "+", 
           "1"}], ",", 
          RowBox[{"m2", "-", 
           RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "-", 
        RowBox[{"m1", " ", 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", "m2"}], "]"}]}],
         "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "maladapted", " ", "juvenile", " ", "breeder", " ", "survives", " ",
            "to", " ", "become", " ", "a", " ", "maladapted", " ", "adult", 
           " ", "breeder", " ", "on", " ", "a", " ", "m1"}], ",", 
          RowBox[{"m2", " ", "patch"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"a1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"m1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"a1", "+", "1"}], ",", 
               RowBox[{"m1", "-", "1"}], ",", "a2", ",", "m2"}], "]"}]}], 
            ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1", "+", "1"}], ",", 
             RowBox[{"m1", "-", "1"}], ",", "a2", ",", "m2"}], "]"}]}], ",", 
          "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "adapted", " ", "juvenile", " ", "breeder", " ", "dies", " ", 
            "and", " ", "is", " ", "replaced", " ", "by", " ", "a", " ", 
            "maladapted", " ", "breeder", " ", "on", " ", "a", " ", "a1"}], 
           "+", "1"}], ",", 
          RowBox[{"m1", "-", 
           RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "-", 
        RowBox[{"a1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", "m2"}], 
            "]"}]}], ")"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", "m2"}], "]"}]}],
         "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "adapted", " ", "juvenile", " ", "breeder", " ", "dies", " ", "and",
            " ", "is", " ", "replaced", " ", "by", " ", "a", " ", 
           "maladapted", " ", "breeder", " ", "on", " ", "a", " ", "a1"}], 
          ",", 
          RowBox[{"m1", " ", "patch"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"a1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"a2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1", "+", "1"}], ",", "m1", ",", 
             RowBox[{"a2", "-", "1"}], ",", "m2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "adapted", " ", "juvenile", " ", "breeder", " ", "survives", " ", 
            "and", " ", "becomes", " ", "an", " ", "adapted", " ", "adult", 
            " ", "breeder", " ", "on", " ", "a", " ", "a1"}], "+", "1"}], ",", 
          RowBox[{"a2", "-", 
           RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "-", 
        RowBox[{"a1", " ", 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", "m2"}], "]"}]}],
         "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "adapted", " ", "juvenile", " ", "breeder", " ", "survives", " ", 
           "and", " ", "becomes", " ", "an", " ", "adapted", " ", "adult", 
           " ", "breeder", " ", "on", " ", "a", " ", "a1"}], ",", 
          RowBox[{"a2", " ", "patch"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"m2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"a1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1", "-", "1"}], ",", "m1", ",", "a2", ",", 
             RowBox[{"m2", "+", "1"}]}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1", "-", "1"}], ",", "m1", ",", "a2", ",", 
             RowBox[{"m2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "maladapted", " ", "adult", " ", "breeder", " ", "dies", " ", 
            "and", " ", "is", " ", "replaced", " ", "by", " ", "an", " ", 
            "adapted", " ", "juvenile", " ", "breeder", " ", "on", " ", "a", 
            " ", "a1"}], "-", "1"}], ",", 
          RowBox[{"m2", "+", 
           RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"m2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"m1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "a1", ",", 
               RowBox[{"m1", "-", "1"}], ",", "a2", ",", 
               RowBox[{"m2", "+", "1"}]}], "]"}]}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "a1", ",", 
             RowBox[{"m1", "-", "1"}], ",", "a2", ",", 
             RowBox[{"m2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "maladapted", " ", "adult", " ", "breeder", " ", "dies", " ", 
            "and", " ", "is", " ", "replaced", " ", "by", " ", "a", " ", 
            "maladapted", " ", "juvenile", " ", "breeder", " ", "on", " ", 
            "a", " ", "m1"}], "-", "1"}], ",", 
          RowBox[{"m2", "+", 
           RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "-", 
        RowBox[{"m2", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", "m2"}], "]"}]}],
         "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "maladapted", " ", "adult", " ", "breeder", " ", "dies", " ", "and",
            " ", "is", " ", "replaced", " ", "by", " ", "a", " ", "juvenile", 
           " ", "breeder", " ", "on", " ", "a", " ", "a1"}], ",", "m1", ",", 
          RowBox[{"m2", " ", "patch"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"a2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"a1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1", "-", "1"}], ",", "m1", ",", 
             RowBox[{"a2", "+", "1"}], ",", "m2"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1", "-", "1"}], ",", "m1", ",", 
             RowBox[{"a2", "+", "1"}], ",", "m2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "adapted", " ", "adult", " ", "breeder", " ", "dies", " ", "and", 
            " ", "is", " ", "replaced", " ", "by", " ", "an", " ", "adapted", 
            " ", "juvenile", " ", "breeder", " ", "on", " ", "a", " ", "a1"}],
            "-", "1"}], ",", 
          RowBox[{"a2", "+", 
           RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"a2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"m1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "a1", ",", 
               RowBox[{"m1", "-", "1"}], ",", 
               RowBox[{"a2", "+", "1"}], ",", "m2"}], "]"}]}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "a1", ",", 
             RowBox[{"m1", "-", "1"}], ",", 
             RowBox[{"a2", "+", "1"}], ",", "m2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "adapted", " ", "adult", " ", "breeder", " ", "dies", " ", "and", 
            " ", "is", " ", "replaced", " ", "by", " ", "a", " ", 
            "maladapted", " ", "juvenile", " ", "breeder", " ", "on", " ", 
            "a", " ", "m1"}], "-", "1"}], ",", 
          RowBox[{"a2", "+", 
           RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "-", 
        RowBox[{"a2", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", "m2"}], 
          "]"}]}]}]}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "adapted", " ", "adult", " ", "breeder", " ", "dies", " ", "and", " ",
          "is", " ", "replaced", " ", "by", " ", "a", " ", "juvenile", " ", 
         "breeder", " ", "on", " ", "a", " ", "a1"}], ",", "m1", ",", 
        RowBox[{"a2", " ", "patch"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", "0", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m1", ",", "0", ",", 
       RowBox[{"n", "-", "a1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2", ",", "0", ",", 
       RowBox[{"n", "-", "a1", "-", "m1"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.497725665398181*^9, 3.49772567455873*^9}, {
   3.500117613263631*^9, 3.500117643761853*^9}, {3.5001177516223183`*^9, 
   3.500117752501072*^9}, {3.500117857030566*^9, 3.5001178583488903`*^9}, {
   3.500118014156376*^9, 3.500118014555167*^9}, {3.500130682127385*^9, 
   3.500130682910915*^9}, {3.500130968751739*^9, 3.500130981782063*^9}, {
   3.5001310118326597`*^9, 3.5001310308665447`*^9}, {3.500132758531279*^9, 
   3.500132775509473*^9}, {3.500132946361661*^9, 3.5001329748220167`*^9}, {
   3.500133041546383*^9, 3.5001330657380753`*^9}, {3.500133148259763*^9, 
   3.500133160687606*^9}, {3.5001331990639763`*^9, 3.5001332041244717`*^9}, {
   3.500133307447483*^9, 3.5001333237167377`*^9}, {3.5001333725271587`*^9, 
   3.500133372617695*^9}, {3.500133404973748*^9, 3.50013341486411*^9}, {
   3.500133481452409*^9, 3.500133576453206*^9}, {3.500133771813458*^9, 
   3.500133812116024*^9}, 3.5001338580403643`*^9, {3.500137409431617*^9, 
   3.500137429291832*^9}, {3.500192977665819*^9, 3.500192977715926*^9}, {
   3.500732820820187*^9, 3.500732826027463*^9}, {3.5007330519650593`*^9, 
   3.500733052006358*^9}, {3.501861096205023*^9, 3.501861098564929*^9}, {
   3.5018611968794737`*^9, 3.501861214539522*^9}, {3.503234220521749*^9, 
   3.5032342488826036`*^9}, {3.520244802903954*^9, 3.520244815359407*^9}, {
   3.59253889449739*^9, 3.592538895255055*^9}, {3.592542374414714*^9, 
   3.592542378840889*^9}, {3.624093325141708*^9, 3.624093774057206*^9}, {
   3.624093861127411*^9, 3.624093928395637*^9}, {3.62409396215143*^9, 
   3.624093981781871*^9}, {3.624094016820443*^9, 3.6240942573261003`*^9}, {
   3.624094361056925*^9, 3.624094451925911*^9}, {3.62409469792808*^9, 
   3.6240947216628523`*^9}, {3.624094768681231*^9, 3.62409487167994*^9}, {
   3.624094966722213*^9, 3.6240950695613537`*^9}, {3.6241009450660887`*^9, 
   3.624100974581635*^9}}],

Cell["Table specification for numerical solving:", "Text",
 CellChangeTimes->{{3.593443894024782*^9, 3.593443905705183*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.624565786058749*^9, 3.624565787757181*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tablerec", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"H", "\[Equal]", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{"H", ",", 
        RowBox[{"Flatten", "[", "tablerecPlain", "]"}]}], "}"}]}], "]"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5032342341741734`*^9, 3.503234266926181*^9}, {
  3.503247680722105*^9, 3.503247687323996*^9}, {3.503247759915304*^9, 
  3.503247762951304*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tablerec", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.624096486441481*^9, 3.6240964885424433`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"fx", "[", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}]}], 
     RowBox[{"1", "-", "c3"}]]}], "-", 
   RowBox[{"s1", " ", 
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}]}], "+", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], "+", 
   RowBox[{"s2", " ", 
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}]}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{3.624096488894251*^9, 3.6241009963901567`*^9, 
  3.6241174190801*^9, 3.624203988186748*^9, 3.62428094075799*^9, 
  3.6242810325490837`*^9, 3.624282708016877*^9, 3.624301598679536*^9, 
  3.624346228514627*^9, 3.624365912576889*^9, 3.624369642306477*^9, 
  3.624435825775875*^9, 3.6244359979554853`*^9, 3.6244428640266*^9, 
  3.624549122400999*^9, 3.6245494359350157`*^9, 3.624565636868381*^9, 
  3.6248752595817623`*^9, 3.6248820937180643`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ftab", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m2", "=", 
         RowBox[{"n", "-", "a1", "-", "m1", "-", "a2"}]}], "}"}], ",", 
       RowBox[{"f", "[", 
        RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", "m2"}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", "0", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m1", ",", "0", ",", 
       RowBox[{"n", "-", "a1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2", ",", "0", ",", 
       RowBox[{"n", "-", "a1", "-", "m1"}]}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.624095309280492*^9, 3.6240953230676394`*^9}, {
  3.624095370514904*^9, 3.624095373547062*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.624095323576385*^9, {3.624095367978516*^9, 3.624095375418024*^9}, 
   3.624095639816987*^9, 3.624100996440538*^9, 3.624117419119975*^9, 
   3.624203988253417*^9, 3.624280940795124*^9, 3.624281032697885*^9, 
   3.624282708057701*^9, 3.624301598761321*^9, 3.624346228562113*^9, 
   3.624365912634502*^9, 3.62436964237125*^9, 3.624435825831539*^9, 
   3.624435998006196*^9, 3.6244428640507507`*^9, 3.62454912248909*^9, 
   3.624549436051174*^9, 3.6245656369455357`*^9, 3.624875259657715*^9, 
   3.624882093750849*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"feqtabPlain", "[", 
  RowBox[{"[", "2", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.624564288330366*^9, 3.624564314686709*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(feqtabPlain \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\[NoBreak] is longer than \
depth of object. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\
\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partd\\\", ButtonNote -> \
\\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.624565637027669*^9, 3.624875259776455*^9, 
  3.624882093808548*^9}],

Cell[BoxData[
 RowBox[{"feqtabPlain", "\[LeftDoubleBracket]", "2", 
  "\[RightDoubleBracket]"}]], "Output",
 CellChangeTimes->{{3.62456429260611*^9, 3.624564315252928*^9}, 
   3.624565637030732*^9, 3.6248752597783937`*^9, 3.624882093809066*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"feqtab", "=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "tablerec", "]"}], ",", 
     RowBox[{
      RowBox[{"Total", "[", "ftab", "]"}], "\[Equal]", "1"}], ",", "1"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"feqtabalt", "=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "tablerec", "]"}], ",", 
     RowBox[{
      RowBox[{"Total", "[", "ftab", "]"}], "\[Equal]", "1"}], ",", "5"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.500137431453726*^9, 3.500137463701515*^9}, {
  3.590817338397416*^9, 3.590817338508321*^9}, {3.624095219684259*^9, 
  3.624095253596705*^9}, {3.6240952841351213`*^9, 3.6240953070375147`*^9}, {
  3.6240953865240593`*^9, 3.624095404243273*^9}, {3.6240959635961742`*^9, 
  3.624095963788168*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"feqtabPlain", "=", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", "tablerecPlain", "]"}], ",", 
      RowBox[{
       RowBox[{"Total", "[", "ftab", "]"}], "-", "1"}], ",", "1"}], "]"}]}], 
   ";"}], " "}]], "Input",
 CellChangeTimes->{{3.503234279738905*^9, 3.5032343436360292`*^9}, {
  3.51938949377985*^9, 3.519389511821157*^9}, {3.519389622676245*^9, 
  3.519389655947711*^9}, {3.520253572315612*^9, 3.520253574751763*^9}, {
  3.6240955235582857`*^9, 3.624095526070043*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"frootstartvals", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xi", ",", 
      RowBox[{"1", "/", 
       RowBox[{"Length", "[", "ftab", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"xi", ",", "ftab"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.501861533592969*^9, 3.501861653264894*^9}, {
  3.5018617247356167`*^9, 3.501861876017569*^9}, {3.501861977500671*^9, 
  3.501862034852276*^9}, {3.501862081796956*^9, 3.5018620886297607`*^9}, {
  3.624095532349883*^9, 3.624095560878952*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.62409556159268*^9, 3.624095639874612*^9, 
  3.624095967388462*^9, 3.624100996529471*^9, 3.624117419214882*^9, 
  3.624203988363365*^9, 3.6242809408396673`*^9, 3.624281032802898*^9, 
  3.624282708111437*^9, 3.6243015988579197`*^9, 3.6243462286169767`*^9, 
  3.624365912705229*^9, 3.624369642470036*^9, 3.6244358259104853`*^9, 
  3.624435998067442*^9, 3.6244428640870743`*^9, 3.624549122585331*^9, 
  3.624549436190576*^9, 3.624565637188652*^9, 3.6248752598702497`*^9, 
  3.6248820938444*^9}]
}, Open  ]],

Cell[TextData[StyleBox["- Numerically solve for the equilibrium patch \
frequencies",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.592543108024868*^9, 3.592543126136325*^9}, {
  3.593443910410306*^9, 3.593443910521289*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans1test", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "m_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p10s_", ",", "p11s_", ",", "p20s_", ",", "p21s_"}], "}"}], ",", 
    "ks_", ",", "Qs_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"feqtab", "/.", 
   RowBox[{"Join", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
      RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
      RowBox[{"k", "\[Rule]", "ks"}], ",", 
      RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
      RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
      RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
      RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
      RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
      RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
      RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
      RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
      RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
      RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
      RowBox[{"p21", "\[Rule]", "p21s"}], ",", 
      RowBox[{"mt", "\[Rule]", "m"}]}], "}"}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.497727309947049*^9, {3.4977274499343033`*^9, 3.4977274554810753`*^9}, {
   3.497727542910244*^9, 3.497727564845056*^9}, 3.497731404139268*^9, {
   3.500136022461656*^9, 3.5001360651617203`*^9}, {3.500136107964839*^9, 
   3.5001361178544693`*^9}, {3.500136168298623*^9, 3.500136171192801*^9}, {
   3.500136226922933*^9, 3.500136236150736*^9}, {3.500136382914144*^9, 
   3.5001363834540253`*^9}, 3.5001365520437107`*^9, {3.5001366530355577`*^9, 
   3.500136672281103*^9}, {3.500136703690104*^9, 3.5001367436671047`*^9}, {
   3.500137064431172*^9, 3.500137084372213*^9}, {3.500137506604393*^9, 
   3.500137521481576*^9}, {3.500137577253257*^9, 3.500137620562414*^9}, {
   3.500138253541423*^9, 3.500138292548037*^9}, {3.5001383371273537`*^9, 
   3.5001383946806183`*^9}, {3.5001385957662697`*^9, 3.50013875313482*^9}, {
   3.500139018540197*^9, 3.500139046280306*^9}, {3.501862116832633*^9, 
   3.5018621477327423`*^9}, {3.505129786476176*^9, 3.50512979545977*^9}, {
   3.505130396736271*^9, 3.505130403469315*^9}, {3.505133566876094*^9, 
   3.5051337047295*^9}, {3.505133939247291*^9, 3.505133966224418*^9}, {
   3.505134048274804*^9, 3.505134112717098*^9}, {3.505134277245621*^9, 
   3.505134289377655*^9}, {3.505134391490318*^9, 3.505134403065894*^9}, {
   3.508161024692579*^9, 3.508161040735461*^9}, {3.520242615818755*^9, 
   3.520242618482863*^9}, {3.520242802887409*^9, 3.520242810353731*^9}, {
   3.52455396640682*^9, 3.524553988441077*^9}, {3.592542961010631*^9, 
   3.5925429876260843`*^9}, 3.592543052726901*^9, {3.592543085831949*^9, 
   3.59254308655621*^9}, {3.6240955654269857`*^9, 3.6240956285476837`*^9}, {
   3.624095666433518*^9, 3.624095672818058*^9}, {3.6240957736684*^9, 
   3.624095811862276*^9}, {3.624095842065344*^9, 3.624095864456068*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans1", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "m_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p10s_", ",", "p11s_", ",", "p20s_", ",", "p21s_"}], "}"}], ",", 
    "ks_", ",", "Qs_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{"feqtab", "/.", 
     RowBox[{"Join", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
        RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
        RowBox[{"k", "\[Rule]", "ks"}], ",", 
        RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
        RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
        RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
        RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
        RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
        RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
        RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
        RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
        RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
        RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
        RowBox[{"p21", "\[Rule]", "p21s"}], ",", 
        RowBox[{"mt", "\[Rule]", "m"}]}], "}"}], "]"}]}], ",", 
    "frootstartvals"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.497727309947049*^9, {3.4977274499343033`*^9, 3.4977274554810753`*^9}, {
   3.497727542910244*^9, 3.497727564845056*^9}, 3.497731404139268*^9, {
   3.500136022461656*^9, 3.5001360651617203`*^9}, {3.500136107964839*^9, 
   3.5001361178544693`*^9}, {3.500136168298623*^9, 3.500136171192801*^9}, {
   3.500136226922933*^9, 3.500136236150736*^9}, {3.500136382914144*^9, 
   3.5001363834540253`*^9}, 3.5001365520437107`*^9, {3.5001366530355577`*^9, 
   3.500136672281103*^9}, {3.500136703690104*^9, 3.5001367436671047`*^9}, {
   3.500137064431172*^9, 3.500137084372213*^9}, {3.500137506604393*^9, 
   3.500137521481576*^9}, {3.500137577253257*^9, 3.500137620562414*^9}, {
   3.500138253541423*^9, 3.500138292548037*^9}, {3.5001383371273537`*^9, 
   3.5001383946806183`*^9}, {3.5001385957662697`*^9, 3.50013875313482*^9}, {
   3.500139018540197*^9, 3.500139046280306*^9}, {3.501862116832633*^9, 
   3.5018621477327423`*^9}, {3.505129786476176*^9, 3.50512979545977*^9}, {
   3.505130396736271*^9, 3.505130403469315*^9}, {3.505133566876094*^9, 
   3.5051337047295*^9}, {3.505133939247291*^9, 3.505133966224418*^9}, {
   3.505134048274804*^9, 3.505134112717098*^9}, {3.505134277245621*^9, 
   3.505134289377655*^9}, {3.505134391490318*^9, 3.505134403065894*^9}, {
   3.508161024692579*^9, 3.508161040735461*^9}, {3.520242615818755*^9, 
   3.520242618482863*^9}, {3.520242802887409*^9, 3.520242810353731*^9}, {
   3.52455396640682*^9, 3.524553988441077*^9}, {3.592542961010631*^9, 
   3.5925429876260843`*^9}, 3.592543052726901*^9, {3.592543085831949*^9, 
   3.59254308655621*^9}, {3.6240955654269857`*^9, 3.6240956285476837`*^9}, {
   3.624095666433518*^9, 3.624095672818058*^9}, {3.6240957736684*^9, 
   3.624095811862276*^9}, {3.624095842065344*^9, 3.624095919188507*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans1alt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "m_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p10s_", ",", "p11s_", ",", "p20s_", ",", "p21s_"}], "}"}], ",", 
    "ks_", ",", "Qs_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{"feqtabalt", "/.", 
     RowBox[{"Join", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
        RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
        RowBox[{"k", "\[Rule]", "ks"}], ",", 
        RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
        RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
        RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
        RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
        RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
        RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
        RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
        RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
        RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
        RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
        RowBox[{"p21", "\[Rule]", "p21s"}], ",", 
        RowBox[{"mt", "\[Rule]", "m"}]}], "}"}], "]"}]}], ",", 
    "frootstartvals"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.497727309947049*^9, {3.4977274499343033`*^9, 3.4977274554810753`*^9}, {
   3.497727542910244*^9, 3.497727564845056*^9}, 3.497731404139268*^9, {
   3.500136022461656*^9, 3.5001360651617203`*^9}, {3.500136107964839*^9, 
   3.5001361178544693`*^9}, {3.500136168298623*^9, 3.500136171192801*^9}, {
   3.500136226922933*^9, 3.500136236150736*^9}, {3.500136382914144*^9, 
   3.5001363834540253`*^9}, 3.5001365520437107`*^9, {3.5001366530355577`*^9, 
   3.500136672281103*^9}, {3.500136703690104*^9, 3.5001367436671047`*^9}, {
   3.500137064431172*^9, 3.500137084372213*^9}, {3.500137506604393*^9, 
   3.500137521481576*^9}, {3.500137577253257*^9, 3.500137620562414*^9}, {
   3.500138253541423*^9, 3.500138292548037*^9}, {3.5001383371273537`*^9, 
   3.5001383946806183`*^9}, {3.5001385957662697`*^9, 3.50013875313482*^9}, {
   3.500139018540197*^9, 3.500139046280306*^9}, {3.501862116832633*^9, 
   3.5018621477327423`*^9}, {3.505129786476176*^9, 3.50512979545977*^9}, {
   3.505130396736271*^9, 3.505130403469315*^9}, {3.505133566876094*^9, 
   3.5051337047295*^9}, {3.505133939247291*^9, 3.505133966224418*^9}, {
   3.505134048274804*^9, 3.505134112717098*^9}, {3.505134277245621*^9, 
   3.505134289377655*^9}, {3.505134391490318*^9, 3.505134403065894*^9}, {
   3.508161024692579*^9, 3.508161040735461*^9}, {3.520242615818755*^9, 
   3.520242618482863*^9}, {3.520242802887409*^9, 3.520242810353731*^9}, {
   3.52455396640682*^9, 3.524553988441077*^9}, {3.592542961010631*^9, 
   3.5925429876260843`*^9}, 3.592543052726901*^9, {3.592543085831949*^9, 
   3.59254308655621*^9}, {3.6240955654269857`*^9, 3.6240956285476837`*^9}, {
   3.624095666433518*^9, 3.624095672818058*^9}, {3.6240957736684*^9, 
   3.624095811862276*^9}, {3.624095842065344*^9, 3.624095942512992*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ans1", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.03162", ",", "0.03162"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", ".5", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", "0.95", 
   ",", "0.05"}], "]"}]], "Input",
 CellChangeTimes->{{3.624095984739854*^9, 3.624095985051387*^9}, {
  3.624096638144051*^9, 3.6240966562437162`*^9}, {3.624096830494413*^9, 
  3.624096831473947*^9}, {3.624875266096099*^9, 3.6248753107593307`*^9}, {
  3.624875357311779*^9, 3.6248753654232607`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.006917171006992455`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.03714439938544786`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", 
    "0.05374587315584135`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.026187960466022935`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.07301693120691255`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "0.025259760247599457`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.03841626694943106`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.10897246987362932`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.0747683591464554`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.055570808561670064`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.006917171006992302`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.0371443993854475`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", 
    "0.053745873155840854`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.02618796046602265`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.07301693120691187`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "0.025259760247599204`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.038416266949430636`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.1089724698736283`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.07476835914645466`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.055570808561669516`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6240959861558*^9, {3.624096639124889*^9, 3.624096664598081*^9}, 
   3.624096838859268*^9, 3.624100996622394*^9, 3.6241174193201027`*^9, 
   3.6242039885309*^9, 3.624280941037951*^9, 3.624281033245626*^9, 
   3.624282708630476*^9, 3.624301599356181*^9, 3.624346229067992*^9, 
   3.6243659131644707`*^9, 3.624369642945979*^9, 3.624435826329648*^9, 
   3.6244359984721527`*^9, 3.624442864551877*^9, 3.624549123038143*^9, 
   3.624549436708474*^9, 3.624565637926153*^9, 3.624875260362205*^9, {
   3.6248752927569017`*^9, 3.6248753162437897`*^9}, 3.624875366142539*^9, 
   3.6248820942064457`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ans1alt", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", ".3", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3", ",", "0.5", ",", "0.3", ",", "0.5"}], "}"}], ",", "0.1", 
   ",", "0.005"}], "]"}]], "Input",
 CellChangeTimes->{{3.508161640641067*^9, 3.508161641073309*^9}, {
  3.508161752322453*^9, 3.508161765951121*^9}, {3.508161799901812*^9, 
  3.508161800462989*^9}, {3.514211189150174*^9, 3.514211207453239*^9}, {
  3.524554160262734*^9, 3.524554164750863*^9}, {3.5908173106268053`*^9, 
  3.5908173275139637`*^9}, {3.590823477424436*^9, 3.5908235383263607`*^9}, {
  3.590823850204959*^9, 3.590823871661927*^9}, {3.59125483045569*^9, 
  3.591254834448448*^9}, {3.592543063033259*^9, 3.59254307403925*^9}, {
  3.608820230181753*^9, 3.60882023041466*^9}, {3.624095651263062*^9, 
  3.6240956577109537`*^9}, {3.624095946094096*^9, 3.62409594636499*^9}, {
  3.624096635840129*^9, 3.6240966596693163`*^9}, {3.62409683516304*^9, 
  3.624096836064969*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.019470724310211455`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.03865384500358827`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", 
    "0.026300224900787032`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.06159330845847883`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.06459101211514767`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "0.0550449612952228`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.05336069476279888`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.0616890063926502`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.08546577364552174`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.03383044911559311`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.008123111718634744`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.034673501269224756`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", 
    "0.052049901874945445`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.023403890283462833`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.060103753055883204`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "0.0156128147831304`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.0419265788846093`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.12038939253225789`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.06712505512432902`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.07659200047352226`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.608820225915379*^9, 3.608820234124021*^9}, 
   3.608820321494277*^9, 3.6088205280135927`*^9, {3.6240956399335833`*^9, 
   3.624095674839657*^9}, 3.624095742683869*^9, 3.624095775474194*^9, 
   3.624095946918483*^9, 3.624095988252405*^9, {3.6240966408610353`*^9, 
   3.624096660262941*^9}, 3.624096836587844*^9, 3.6241009966932087`*^9, 
   3.624117419385565*^9, 3.624203988615159*^9, 3.62428094110515*^9, 
   3.624281033590795*^9, 3.624282709152506*^9, 3.624301599839867*^9, 
   3.62434622954918*^9, 3.624365913484585*^9, 3.624369643279557*^9, 
   3.624435826664445*^9, 3.6244359988413267`*^9, 3.624442864918227*^9, 
   3.62454912337278*^9, 3.624549437247292*^9, 3.624565638532331*^9, 
   3.624875260677228*^9, 3.624882094566757*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Reproductive values", "Section"],

Cell[CellGroupData[{

Cell["Auxiliary functions", "Subsection",
 CellChangeTimes->{{3.624447464519895*^9, 3.624447467733796*^9}}],

Cell[TextData[StyleBox["- Adapted/Maladapted individuals produced by nonfocal \
individual on the patch",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.5001397535132713`*^9, 3.5001397607796917`*^9}, {
  3.500139829018998*^9, 3.5001398481950006`*^9}, {3.5018732640362577`*^9, 
  3.501873267079073*^9}, {3.5934440338407097`*^9, 3.593444049487831*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"localadother", "[", 
   RowBox[{"es_", ",", "a1other_", ",", "m1other_", ",", "a2other_"}], "]"}], 
  ":=", 
  RowBox[{
   RowBox[{
    FractionBox["a1other", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["m1other", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["a2other", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"n", "-", "1", "-", "a1other", "-", "m1other", "-", "a2other"}], 
     "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], 
     ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localmadother", "[", 
   RowBox[{"es_", ",", "a1other_", ",", "m1other_", ",", "a2other_"}], "]"}], 
  ":=", 
  RowBox[{
   RowBox[{
    FractionBox["a1other", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["m1other", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["a2other", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
    RowBox[{"p", "[", 
     RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"n", "-", "1", "-", "a1other", "-", "m1other", "-", "a2other"}], 
     "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"p", "[", 
       RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"m", "[", 
       RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}]}]}]}]}], "Input",
 CellChangeTimes->{
  3.59254363092905*^9, {3.6242016785281067`*^9, 3.624201707337722*^9}, {
   3.624202331530916*^9, 3.624202337928005*^9}, {3.624202384234132*^9, 
   3.624202419163906*^9}, {3.624202581312338*^9, 3.624202645379182*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Reproductive values: juveniles", "Subsection",
 CellChangeTimes->{{3.624194703418602*^9, 3.624194704634268*^9}, {
  3.624194744419376*^9, 3.6241947751070137`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"veqtabPlainJuv", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m2other", "=", 
         RowBox[{
         "n", "-", "1", "-", "a1other", "-", "m1other", "-", "a2other"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", "es", "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{
             RowBox[{"3", "-", "es"}], ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "m1other", ",", "a1other", ",",
              "m2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"a", ".", " ", "focal"}], " ", "juvenile", " ", "breeder", 
           " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "own", " ", "offspring", " ", "of", " ",
            "a", " ", "different", " ", "type"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", "n"}], ")"}], 
             RowBox[{"g", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
            RowBox[{"localcomptotal", "[", 
             RowBox[{"es", ",", 
              RowBox[{"a1other", "+", "aself"}], ",", 
              RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
             "]"}]]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"b", ".", " ", "focal"}], " ", "juvenile", " ", "breeder", 
           " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "other", " ", "offspring"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{
           "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}], "-", 
          RowBox[{"v", "[", 
           RowBox[{
           "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]}], ")"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"1", 
          RowBox[{"c", ".", " ", "focal"}], " ", "juvenile", " ", "adapted", 
          " ", "breeder", " ", "matures", " ", "to", " ", "the", " ", "next", 
          " ", "stage"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"v", "[", 
             RowBox[{"es", ",", "0", ",", "aself", ",", 
              RowBox[{"a1other", "-", "1", "+", "aself"}], ",", 
              RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
             "]"}]}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"a", ".", " ", "adapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", 
           "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", 
             RowBox[{"a1other", "-", "1", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", "a2other"}], "]"}], "-", 
           
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"b", ".", " ", "adapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", "a",
            " ", "different", " ", "type", " ", "as", " ", "focal"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1"}], ",", 
             RowBox[{"m1other", "+", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"c", ".", " ", "adapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "nonfocal", " ", "offspring", " ", 
           "that", " ", "is", " ", "maladapted"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "+", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"2", 
          RowBox[{"d", ".", " ", "adapted"}], " ", "nonfocal", " ", 
          "juvenile", " ", "matures", " ", "to", " ", "adult", " ", 
          "breedership"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"v", "[", 
             RowBox[{"es", ",", "0", ",", "aself", ",", 
              RowBox[{"a1other", "+", "aself"}], ",", 
              RowBox[{"m1other", "-", "1", "+", "1", "-", "aself"}], ",", 
              "a2other"}], "]"}]}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"a", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", 
           "the", " ", "same", " ", "phenotype", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "-", "1", "+", "1", "-", "aself"}], ",", 
             "a2other"}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "-", "1", "+", "aself"}], ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"b", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", "a",
            " ", "different", " ", "phenotype", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", 
             RowBox[{"m1other", "-", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"c", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "nonfocal", " ", "offspring", " ", 
           "that", " ", "is", " ", "adapted"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "-", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"3", 
          RowBox[{"d", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
          "juvenile", " ", "breeder", " ", "survives", " ", "to", " ", 
          "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"a", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "a", " ", "different", " ", "type", " ", "than", " ", 
           "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"v", "[", 
             RowBox[{"es", ",", "0", ",", "aself", ",", 
              RowBox[{"a1other", "+", "aself"}], ",", 
              RowBox[{"m1other", "+", "1", "-", "aself"}], ",", 
              RowBox[{"a2other", "-", "1"}]}], "]"}]}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"b", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"c", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "nonfocal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "+", "1"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"d", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "nonfocal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", "a2other"}], "]"}], "+", 
           
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"a", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "a", " ", "different", " ", "type", " ", "than", " ", 
           "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"v", "[", 
             RowBox[{"es", ",", "0", ",", "aself", ",", 
              RowBox[{"a1other", "+", "aself"}], ",", 
              RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
             "]"}]}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"b", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", "m1other", ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"c", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "+", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"d", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "n"}], ")"}], 
         RowBox[{"g", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", "k"}], ")"}], 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"zm2", "=", 
               RowBox[{"n", "-", "za1", "-", "zm1", "-", "za2"}]}], "}"}], 
             ",", 
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{
               "zes", ",", "za1", ",", "zm1", ",", "za2", ",", "zm2"}], "]"}], 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"za1", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "1", ",", "0"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", 
                    RowBox[{"za1", "-", "1"}], ",", "zm1", ",", "za2"}], 
                    "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    RowBox[{"za1", "-", "1"}], ",", "zm1", ",", "za2"}], 
                    "]"}]}]}], "\[IndentingNewLine]", ")"}]}], 
                "\[IndentingNewLine]", "+", 
                RowBox[{"zm1", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "0", ",", "0"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    RowBox[{"zm1", "-", "1"}], ",", "za2"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", 
                    RowBox[{"zm1", "-", "1"}], ",", "za2"}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "+", 
                
                RowBox[{"za2", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "1", ",", "1"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    "zm1", ",", 
                    RowBox[{"za2", "-", "1"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", "zm1", ",", 
                    RowBox[{"za2", "-", "1"}]}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "+", 
                
                RowBox[{"zm2", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "0", ",", "1"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    "zm1", ",", "za2"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", "zm1", ",", "za2"}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", 
               ")"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"zes", ",", "1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"za1", ",", "0", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zm1", ",", "0", ",", 
             RowBox[{"n", "-", "za1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"za2", ",", "0", ",", 
             RowBox[{"n", "-", "za1", "-", "zm1"}]}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a1other", ",", "0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m1other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other", "-", "m1other"}]}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.624105393315069*^9, 3.624105424785666*^9}, {
   3.624105542758597*^9, 3.624105550700832*^9}, {3.624105634651022*^9, 
   3.6241056558512907`*^9}, {3.624106910657282*^9, 3.624106951717827*^9}, {
   3.62410723426145*^9, 3.6241072952709713`*^9}, {3.6241073313493013`*^9, 
   3.6241074057358103`*^9}, {3.6241074645950747`*^9, 3.624107630937098*^9}, {
   3.624107672161605*^9, 3.624107696256287*^9}, {3.624107728743771*^9, 
   3.624107907116013*^9}, {3.624108519063383*^9, 3.624108589425164*^9}, {
   3.624108641315518*^9, 3.624108644553985*^9}, {3.624108833022855*^9, 
   3.624108864366914*^9}, {3.624108999412953*^9, 3.624109037338584*^9}, {
   3.624109757301538*^9, 3.624109816130487*^9}, {3.624110628383292*^9, 
   3.624110833628664*^9}, {3.624110908970429*^9, 3.624110929575144*^9}, {
   3.624110974936181*^9, 3.624111011867834*^9}, {3.624111075130018*^9, 
   3.624111098126931*^9}, {3.624111172158141*^9, 3.6241111756160097`*^9}, {
   3.624111247687255*^9, 3.624111290220771*^9}, {3.624111337718417*^9, 
   3.6241113929905357`*^9}, 3.624111459721759*^9, {3.624111503087812*^9, 
   3.624111567750102*^9}, {3.624111644629919*^9, 3.624111655607366*^9}, {
   3.624112058631222*^9, 3.624112177756599*^9}, 3.624112296789069*^9, {
   3.6241123277544823`*^9, 3.624112356208357*^9}, {3.624112476305134*^9, 
   3.624112495511964*^9}, {3.624112544110755*^9, 3.6241125623089447`*^9}, {
   3.624112634463889*^9, 3.6241126670311213`*^9}, {3.624112699002626*^9, 
   3.624112757417794*^9}, {3.624112800664715*^9, 3.624112811731379*^9}, {
   3.624114458578978*^9, 3.6241145110967503`*^9}, {3.6241156278447027`*^9, 
   3.624115676439664*^9}, {3.624115710006269*^9, 3.624115720724999*^9}, {
   3.624116126772534*^9, 3.624116143875856*^9}, {3.624117054944509*^9, 
   3.624117122909733*^9}, {3.624117232977274*^9, 3.624117233371319*^9}, {
   3.624117347738717*^9, 3.624117358275321*^9}, {3.624117388353952*^9, 
   3.6241173962020197`*^9}, {3.624117435590787*^9, 3.624117491493388*^9}, {
   3.6241179082263193`*^9, 3.624117919533782*^9}, 3.624121236873742*^9, {
   3.624121576678515*^9, 3.624121768038467*^9}, {3.624121818408928*^9, 
   3.62412184063608*^9}, {3.624122066672517*^9, 3.624122085633874*^9}, {
   3.624122146422144*^9, 3.624122210443741*^9}, {3.62412825762978*^9, 
   3.624128279184132*^9}, {3.6241349066411533`*^9, 3.624134935983481*^9}, {
   3.624134973365363*^9, 3.624135067662483*^9}, {3.624135275875266*^9, 
   3.624135304590047*^9}, {3.624135424804736*^9, 3.6241354794836073`*^9}, {
   3.624135537150897*^9, 3.624135551681814*^9}, {3.624136317804256*^9, 
   3.624136592868403*^9}, {3.624136623531128*^9, 3.624136666441414*^9}, {
   3.624136752200927*^9, 3.6241367920838137`*^9}, {3.6241368256210117`*^9, 
   3.624136916638122*^9}, {3.62418830554675*^9, 3.6241883064004908`*^9}, {
   3.6241886156711493`*^9, 3.624188616434956*^9}, {3.624197138929085*^9, 
   3.624197141443653*^9}, {3.624199077465385*^9, 3.6241990776535378`*^9}, {
   3.624201194317346*^9, 3.624201231631407*^9}, {3.624201533263768*^9, 
   3.624201560299189*^9}, {3.6242029666179333`*^9, 3.624203130670968*^9}, {
   3.624204116478397*^9, 3.624204116652637*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reproductive values: adults", "Subsection",
 CellChangeTimes->{{3.624194765851487*^9, 3.624194770611102*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"veqtabPlainAd", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m2other", "=", 
         RowBox[{
         "n", "-", "1", "-", "a1other", "-", "m1other", "-", "a2other"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", "es", "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{
             RowBox[{"3", "-", "es"}], ",", "1", ",", 
             RowBox[{"1", "-", "aself"}], ",", "m1other", ",", "a1other", ",",
              "m2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", 
             RowBox[{"a1other", "-", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", "a2other"}], "]"}], "-", 
           
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"a", ".", " ", "adapted"}], " ", "juvenile", " ", 
           "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "own", " ", "offspring", " ", "of", " ",
            "a", " ", "different", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"b", ".", " ", "adapted"}], " ", "juvenile", " ", 
           "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "own", " ", "offspring", " ", "of", " ",
            "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1"}], ",", 
             RowBox[{"m1other", "+", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"c", ".", " ", "adapted"}], " ", "juvenile", " ", 
           "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "nonfocal", " ", "maladapted", " ", 
           "juvenile", " ", "offspring"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "+", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"1", 
          RowBox[{"d", ".", " ", "focal"}], " ", "juvenile", " ", "adapted", 
          " ", "breeder", " ", "matures", " ", "to", " ", "the", " ", "next", 
          " ", "stage"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "-", "1"}], ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "-", "1", "+", "1", "-", "aself"}], ",", 
             "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"a", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", 
           "the", " ", "same", " ", "phenotype", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "a1other", ",", 
             RowBox[{"m1other", "-", "1"}], ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "-", "1", "+", "aself"}], ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"b", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", "a",
            " ", "different", " ", "phenotype", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", 
             RowBox[{"m1other", "-", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"c", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "nonfocal", " ", "offspring", " ", 
           "that", " ", "is", " ", "adapted"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "-", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"2", 
          RowBox[{"d", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
          "juvenile", " ", "breeder", " ", "survives", " ", "to", " ", 
          "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"a", ".", " ", "focal"}], " ", "adult", " ", "breeder", 
           " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "a", " ", "different", " ", "type", " ", "as", " ", 
           "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"b", ".", " ", "focal"}], " ", "adult", " ", "breeder", 
           " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", "n"}], ")"}], 
             RowBox[{"g", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
            RowBox[{"localcomptotal", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
              RowBox[{"a2other", "+", "aself"}]}], "]"}]]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"c", ".", " ", "focal"}], " ", "adult", " ", "breeder", 
           " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "nonfocal", " ", "offspring"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself", "-", "1"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"a", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "a", " ", "different", " ", "type", " ", "than", " ", 
           "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself", "-", "1"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"b", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"c", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "nonfocal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "+", "1"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"d", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "nonfocal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"a", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", "a2other"}], "]"}], "-", 
           
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"b", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", "m1other", ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"c", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadother", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", "a2other"}], 
             "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "+", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"d", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "n"}], ")"}], 
         RowBox[{"g", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", "k"}], ")"}], 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"zm2", "=", 
               RowBox[{"n", "-", "za1", "-", "zm1", "-", "za2"}]}], "}"}], 
             ",", 
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{
               "zes", ",", "za1", ",", "zm1", ",", "za2", ",", "zm2"}], "]"}], 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"za1", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "1", ",", "0"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", 
                    RowBox[{"za1", "-", "1"}], ",", "zm1", ",", "za2"}], 
                    "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    RowBox[{"za1", "-", "1"}], ",", "zm1", ",", "za2"}], 
                    "]"}]}]}], "\[IndentingNewLine]", ")"}]}], 
                "\[IndentingNewLine]", "+", 
                RowBox[{"zm1", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "0", ",", "0"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    RowBox[{"zm1", "-", "1"}], ",", "za2"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", 
                    RowBox[{"zm1", "-", "1"}], ",", "za2"}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "+", 
                
                RowBox[{"za2", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "1", ",", "1"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    "zm1", ",", 
                    RowBox[{"za2", "-", "1"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", "zm1", ",", 
                    RowBox[{"za2", "-", "1"}]}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "+", 
                
                RowBox[{"zm2", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "0", ",", "1"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    "zm1", ",", "za2"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", "zm1", ",", "za2"}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", 
               ")"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"zes", ",", "1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"za1", ",", "0", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zm1", ",", "0", ",", 
             RowBox[{"n", "-", "za1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"za2", ",", "0", ",", 
             RowBox[{"n", "-", "za1", "-", "zm1"}]}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a1other", ",", "0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m1other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other", "-", "m1other"}]}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.624105393315069*^9, 3.624105424785666*^9}, {
   3.624105542758597*^9, 3.624105550700832*^9}, {3.624105634651022*^9, 
   3.6241056558512907`*^9}, {3.624106910657282*^9, 3.624106951717827*^9}, {
   3.62410723426145*^9, 3.6241072952709713`*^9}, {3.6241073313493013`*^9, 
   3.6241074057358103`*^9}, {3.6241074645950747`*^9, 3.624107630937098*^9}, {
   3.624107672161605*^9, 3.624107696256287*^9}, {3.624107728743771*^9, 
   3.624107907116013*^9}, {3.624108519063383*^9, 3.624108589425164*^9}, {
   3.624108641315518*^9, 3.624108644553985*^9}, {3.624108833022855*^9, 
   3.624108864366914*^9}, {3.624108999412953*^9, 3.624109037338584*^9}, {
   3.624109757301538*^9, 3.624109816130487*^9}, {3.624110628383292*^9, 
   3.624110833628664*^9}, {3.624110908970429*^9, 3.624110929575144*^9}, {
   3.624110974936181*^9, 3.624111011867834*^9}, {3.624111075130018*^9, 
   3.624111098126931*^9}, {3.624111172158141*^9, 3.6241111756160097`*^9}, {
   3.624111247687255*^9, 3.624111290220771*^9}, {3.624111337718417*^9, 
   3.6241113929905357`*^9}, 3.624111459721759*^9, {3.624111503087812*^9, 
   3.624111567750102*^9}, {3.624111644629919*^9, 3.624111655607366*^9}, {
   3.624112058631222*^9, 3.624112177756599*^9}, 3.624112296789069*^9, {
   3.6241123277544823`*^9, 3.624112356208357*^9}, {3.624112476305134*^9, 
   3.624112495511964*^9}, {3.624112544110755*^9, 3.6241125623089447`*^9}, {
   3.624112634463889*^9, 3.6241126670311213`*^9}, {3.624112699002626*^9, 
   3.624112757417794*^9}, {3.624112800664715*^9, 3.624112811731379*^9}, {
   3.624114458578978*^9, 3.6241145110967503`*^9}, {3.6241156278447027`*^9, 
   3.624115676439664*^9}, {3.624115710006269*^9, 3.624115720724999*^9}, {
   3.624116126772534*^9, 3.624116143875856*^9}, {3.624117054944509*^9, 
   3.624117122909733*^9}, {3.624117232977274*^9, 3.624117233371319*^9}, {
   3.624117347738717*^9, 3.624117358275321*^9}, {3.624117388353952*^9, 
   3.6241173962020197`*^9}, {3.624117435590787*^9, 3.624117491493388*^9}, {
   3.6241179082263193`*^9, 3.624117919533782*^9}, 3.624121236873742*^9, {
   3.624121576678515*^9, 3.624121768038467*^9}, {3.624121818408928*^9, 
   3.62412184063608*^9}, {3.624122066672517*^9, 3.624122085633874*^9}, {
   3.624122146422144*^9, 3.624122210443741*^9}, {3.62412825762978*^9, 
   3.624128279184132*^9}, {3.6241349066411533`*^9, 3.624134935983481*^9}, {
   3.624134973365363*^9, 3.624135067662483*^9}, {3.624135275875266*^9, 
   3.624135304590047*^9}, {3.624135424804736*^9, 3.6241354794836073`*^9}, {
   3.624135537150897*^9, 3.624135551681814*^9}, {3.624136317804256*^9, 
   3.624136592868403*^9}, {3.624136623531128*^9, 3.624136666441414*^9}, {
   3.624136752200927*^9, 3.6241367920838137`*^9}, {3.6241368256210117`*^9, 
   3.624136916638122*^9}, {3.6241371119526377`*^9, 3.624137123015327*^9}, {
   3.6241374691646013`*^9, 3.624137482972671*^9}, {3.62413752011064*^9, 
   3.624137593860952*^9}, {3.624137635384986*^9, 3.624137709797246*^9}, 
   3.624188325910187*^9, {3.624195595519504*^9, 3.624195754485969*^9}, {
   3.624196895973914*^9, 3.624196947786957*^9}, {3.62419700975912*^9, 
   3.624197118941063*^9}, {3.624197187438719*^9, 3.624197221520343*^9}, {
   3.6241972550854397`*^9, 3.624197332028689*^9}, {3.6241973719157763`*^9, 
   3.624197420877294*^9}, {3.62419828534858*^9, 3.624198288802609*^9}, {
   3.624198319938748*^9, 3.6241983445530663`*^9}, {3.624198810897176*^9, 
   3.6241988875524607`*^9}, {3.6241989556213207`*^9, 
   3.6241990234801693`*^9}, {3.62419905426888*^9, 3.624199054363193*^9}, {
   3.62419911295243*^9, 3.624199113125098*^9}, {3.624199146457932*^9, 
   3.624199149804529*^9}, {3.624199184101955*^9, 3.624199204727675*^9}, {
   3.6241992966541157`*^9, 3.624199346002799*^9}, {3.624199431265285*^9, 
   3.624199444946371*^9}, {3.624199495212886*^9, 3.6241995219215612`*^9}, {
   3.624199566362286*^9, 3.624199684797461*^9}, {3.624199739365447*^9, 
   3.624199793268449*^9}, {3.624200115688655*^9, 3.624200116575446*^9}, {
   3.624200156439021*^9, 3.624200161419701*^9}, {3.624200195640967*^9, 
   3.624200293813195*^9}, {3.624200524231401*^9, 3.6242005507180767`*^9}, {
   3.624201033128936*^9, 3.6242010491402683`*^9}, {3.6242011314151993`*^9, 
   3.624201157681975*^9}, {3.6242013117409353`*^9, 3.624201401595797*^9}, {
   3.624203185613224*^9, 3.62420324017876*^9}, {3.62420331045933*^9, 
   3.624203338476714*^9}, {3.624203379360961*^9, 3.624203379451083*^9}, {
   3.624203414346799*^9, 3.624203450906179*^9}, {3.624203677437587*^9, 
   3.6242036997938766`*^9}, {3.624204133116194*^9, 3.6242041333410673`*^9}, {
   3.624280719591448*^9, 3.624280719701469*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Constraints (e.g., average reproductive value is constant)", \
"Subsection",
 CellChangeTimes->{{3.616146232386489*^9, 3.616146251171417*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rvCombinatorics", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    FractionBox["a1", "n"], 
    RowBox[{"v", "[", 
     RowBox[{"es", ",", "0", ",", "1", ",", 
      RowBox[{"a1", "-", "1"}], ",", "m1", ",", "a2"}], "]"}]}], "+", 
   RowBox[{
    FractionBox["m1", "n"], 
    RowBox[{"v", "[", 
     RowBox[{"es", ",", "0", ",", "0", ",", "a1", ",", 
      RowBox[{"m1", "-", "1"}], ",", "a2"}], "]"}]}], "+", 
   RowBox[{
    FractionBox["a2", "n"], 
    RowBox[{"v", "[", 
     RowBox[{"es", ",", "1", ",", "1", ",", "a1", ",", "m1", ",", 
      RowBox[{"a2", "-", "1"}]}], "]"}]}], "+", 
   RowBox[{
    FractionBox[
     RowBox[{"n", "-", "a1", "-", "m1", "-", "a2"}], "n"], 
    RowBox[{"v", "[", 
     RowBox[{"es", ",", "1", ",", "0", ",", "a1", ",", "m1", ",", "a2"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.607779020301613*^9, 3.6077790439808407`*^9}, {
   3.607779090483363*^9, 3.607779105510744*^9}, {3.6077791758543873`*^9, 
   3.6077791866359863`*^9}, {3.607779263018914*^9, 3.607779352213462*^9}, {
   3.607779497915346*^9, 3.6077795249713984`*^9}, {3.607779588010723*^9, 
   3.607779726837728*^9}, {3.607779937420652*^9, 3.607779948144641*^9}, {
   3.607779978921884*^9, 3.6077800286412163`*^9}, {3.607780159674581*^9, 
   3.607780212431211*^9}, {3.607780247742075*^9, 3.607780280206851*^9}, {
   3.607780321529426*^9, 3.607780333501069*^9}, {3.6077803642301407`*^9, 
   3.60778042543262*^9}, {3.608471296899273*^9, 3.608471327334947*^9}, 
   3.608525677003003*^9, {3.608621127598675*^9, 3.608621147479912*^9}, {
   3.62420456927682*^9, 3.624204685858012*^9}, {3.624204809735545*^9, 
   3.624204820222549*^9}, {3.624205065200027*^9, 3.624205079541525*^9}, {
   3.624207303276064*^9, 3.624207304966489*^9}, {3.624207373859433*^9, 
   3.624207373999675*^9}, 3.624280855696699*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rvtotal", "=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", 
       RowBox[{"n", "-", "a1", "-", "m1", "-", "a2"}]}], "]"}], 
     RowBox[{"rvCombinatorics", "[", 
      RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a1", ",", "0", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m1", ",", "0", ",", 
      RowBox[{"n", "-", "a1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a2", ",", "0", ",", 
      RowBox[{"n", "-", "a1", "-", "m1"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.607778816157462*^9, 3.607778821588315*^9}, {
   3.607778938661419*^9, 3.6077789716072493`*^9}, {3.607780446187346*^9, 
   3.607780452842698*^9}, {3.607780505772138*^9, 3.607780514899021*^9}, 
   3.607780572965794*^9, 3.607782028839376*^9, 3.608525677003538*^9, {
   3.6242050961629972`*^9, 3.624205168714857*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}]}], 
  "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}]}], 
  "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}]}], 
  "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}]}], 
  "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}]}], 
  "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}]}], 
  "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}]}], 
  "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], " ", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}]}], 
  "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], 
       "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], 
       "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"v", "[", 
       RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], 
       "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.624205100416065*^9, 3.624205169928602*^9, 
  3.624207307227707*^9, 3.624207376242751*^9, 3.6242809423829412`*^9, 
  3.624281057465014*^9, 3.624281960453722*^9, 3.624282723354959*^9, 
  3.624301629809804*^9, 3.624301866265417*^9, 3.6243462396792717`*^9, 
  3.624365923526335*^9, 3.624369653764092*^9, 3.624435837078977*^9, 
  3.624436010337092*^9, 3.6244428757895117`*^9, 3.624549133282226*^9, 
  3.624549447523561*^9, 3.62456564858064*^9, 3.624875479935351*^9, 
  3.62488210425426*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rvtotalrecur", "=", 
   RowBox[{
    RowBox[{"-", "2"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], " ", 
        RowBox[{"v", "[", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], 
         "]"}]}], "+", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
            "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
            "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], " ", 
        RowBox[{"v", "[", 
         RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], 
         "]"}]}], "+", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], " ", 
        RowBox[{"v", "[", 
         RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "]"}]}], "+", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"v", "[", 
           RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], 
           "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], 
            "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], 
            "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], 
            "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], 
            "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], " ", 
        RowBox[{"v", "[", 
         RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], 
         "]"}]}], "+", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
            "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], 
            "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], 
            "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], 
            "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], " ", 
        RowBox[{"v", "[", 
         RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], 
         "]"}]}], "+", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], 
            "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
            "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], " ", 
        RowBox[{"v", "[", 
         RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], 
         "]"}]}], "+", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], " ", 
        RowBox[{"v", "[", 
         RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "]"}]}], "+", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], 
            "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], 
            "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], 
            "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], 
            "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], 
            "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], " ", 
        RowBox[{"v", "[", 
         RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], 
         "]"}]}], "+", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
            "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], 
            "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], 
            "]"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"v", "[", 
            RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], 
            "]"}]}]}], ")"}]}]}], ")"}], "/", 
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.624880492794601*^9, 3.6248804998675756`*^9}, {
   3.624880943467677*^9, 3.624880963503079*^9}, {3.6248812960177727`*^9, 
   3.624881370948428*^9}, {3.6248815527554913`*^9, 3.6248815541914*^9}, 
   3.624881829297721*^9, {3.62488186797985*^9, 3.62488186936943*^9}}],

Cell[CellGroupData[{

Cell["\<\
Numerical evaluation of reproductive values\
\>", "Subsection",
 CellChangeTimes->{{3.624447417654372*^9, 3.6244474256223707`*^9}}],

Cell["\<\
Combine the systems of equations for juvenile and adult reproductive values\
\>", "Text",
 CellChangeTimes->{{3.624204505642796*^9, 3.624204524385427*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"veqtabPlain", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"veqtabPlainJuv", ",", "veqtabPlainAd"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.624204086223699*^9, 3.624204103888562*^9}, 
   3.624204219545186*^9}],

Cell["Specify ingredients for numerical solving:", "Text",
 CellChangeTimes->{3.593444110336153*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"veqtab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"x", "\[Equal]", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Flatten", "[", "veqtabPlain", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"veqtabPlain1", "=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "veqtabPlain", "]"}], ",", "rvtotalrecur", ",", 
     "1"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.505135127820217*^9, 3.505135205993911*^9}, {
   3.50513611034762*^9, 3.505136113075313*^9}, {3.507217456958711*^9, 
   3.5072174574988*^9}, {3.520430829666444*^9, 3.520430831170349*^9}, 
   3.520431566258815*^9, {3.525507803122896*^9, 3.525507813769655*^9}, {
   3.624204050869768*^9, 3.624204062405881*^9}, 3.624204102034343*^9, {
   3.624204140260621*^9, 3.624204143451494*^9}, {3.624280860536449*^9, 
   3.6242808625370913`*^9}, {3.6248820546724873`*^9, 3.624882063584239*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "veqtab", "]"}]], "Input",
 CellChangeTimes->{{3.624301837347498*^9, 3.624301846112699*^9}}],

Cell[BoxData[
 RowBox[{"{", "32", "}"}]], "Output",
 CellChangeTimes->{{3.624301846560603*^9, 3.62430186639149*^9}, 
   3.624346239735635*^9, 3.624365923619277*^9, 3.624369653927565*^9, 
   3.624435837146516*^9, 3.624436010417212*^9, 3.624442875857922*^9, 
   3.624549133392659*^9, 3.6245494476264133`*^9, 3.624565648672576*^9, 
   3.624875480030841*^9, 3.62488210433501*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"veqtab1", "=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "veqtab", "]"}], ",", 
     RowBox[{"rvtotal", "\[Equal]", "1"}], ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"veqtabalt", "=", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "veqtab", "]"}], ",", 
     RowBox[{"rvtotal", "\[Equal]", "1"}], ",", "25"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"rvals", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{
      "es", ",", "age", ",", "aself", ",", "a1other", ",", "m1other", ",", 
       "a2other"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"age", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a1other", ",", "0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m1other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other", "-", "m1other"}]}], "}"}]}], 
    "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.500191454064715*^9, 3.5001915301548977`*^9}, {
   3.503248155435731*^9, 3.503248184014865*^9}, {3.503248404174206*^9, 
   3.503248408037532*^9}, {3.5032484879944773`*^9, 3.503248564736147*^9}, {
   3.503248606455018*^9, 3.5032486443739347`*^9}, {3.503248907107168*^9, 
   3.503248941554319*^9}, {3.503248990797192*^9, 3.5032490177031803`*^9}, {
   3.503249052989256*^9, 3.503249058397912*^9}, {3.503249225456058*^9, 
   3.503249232572372*^9}, {3.52041981573889*^9, 3.520419815807377*^9}, {
   3.520419929199638*^9, 3.520419960348857*^9}, {3.520420386583107*^9, 
   3.52042039467243*^9}, {3.52042052102429*^9, 3.520420530710544*^9}, {
   3.520427661952775*^9, 3.520427687777916*^9}, {3.520428052792645*^9, 
   3.520428052841705*^9}, {3.520429085313047*^9, 3.520429135675322*^9}, {
   3.520429182985737*^9, 3.520429193252388*^9}, {3.524043766176027*^9, 
   3.524043808428645*^9}, {3.524043914020914*^9, 3.524043922558467*^9}, {
   3.524044206048073*^9, 3.524044207302169*^9}, {3.524044305100863*^9, 
   3.524044307940649*^9}, 3.524044728908094*^9, 3.52404481629412*^9, 
   3.524555029728461*^9, {3.531829251631015*^9, 3.531829276142815*^9}, {
   3.548672344448597*^9, 3.5486723446003237`*^9}, {3.624280876453071*^9, 
   3.624280957554735*^9}, {3.624281101001891*^9, 3.624281114428638*^9}, {
   3.62428194027269*^9, 3.624281945527236*^9}, {3.624282354714712*^9, 
   3.624282356482774*^9}, {3.62430185002206*^9, 3.624301850182891*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.624281105920567*^9, 3.624281115549718*^9}, {
   3.624281946855241*^9, 3.624281960582658*^9}, 3.624282357489018*^9, 
   3.6242827234968033`*^9, 3.624301629879539*^9, 3.6243018664951277`*^9, 
   3.624346239780632*^9, 3.624365923666636*^9, 3.624369653982662*^9, 
   3.624435837185268*^9, 3.6244360104806004`*^9, 3.624442875921335*^9, 
   3.62454913348667*^9, 3.624549447707067*^9, 3.62456564875486*^9, 
   3.6248754801065063`*^9, 3.624882104383131*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["rvals"], "Input",
 CellChangeTimes->{{3.624280958562119*^9, 3.624280959645495*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.62428096004163*^9, 3.624281057532894*^9, 
  3.624281118566571*^9, 3.624281960589666*^9, 3.624282723604632*^9, 
  3.624301629886148*^9, 3.6243018665949717`*^9, 3.6243462397857447`*^9, 
  3.62436592375327*^9, 3.624369653988613*^9, 3.6244358372380533`*^9, 
  3.62443601053953*^9, 3.624442875926257*^9, 3.624549133576023*^9, 
  3.624549447791432*^9, 3.6245656487604017`*^9, 3.6248754801910257`*^9, 
  3.624882104427464*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.624281767418119*^9, 3.624281783265133*^9}}],

Cell["", "Text",
 CellChangeTimes->{{3.5925439622482033`*^9, 3.592543972568615*^9}, 
   3.593444103127953*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"rvstartvals", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "1.0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "rvals"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"frootstartvals2", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"frootstartvals", ",", "rvstartvals"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5018622698079367`*^9, 3.501862289606407*^9}, {
  3.5018623307386227`*^9, 3.501862365664167*^9}, {3.5018624304785347`*^9, 
  3.501862533405551*^9}, {3.520429173721002*^9, 3.520429174705935*^9}, {
  3.6242810748702927`*^9, 3.6242810751956377`*^9}, {3.624281125383884*^9, 
  3.624281135718894*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6088203241493273`*^9, 3.608820529511283*^9, 
  3.624281057582263*^9, 3.624281136532633*^9, 3.624281960700596*^9, 
  3.624282723712644*^9, 3.624301629959219*^9, 3.624301866699524*^9, 
  3.6243462398361893`*^9, 3.624365923822468*^9, 3.6243696540778027`*^9, 
  3.6244358373233023`*^9, 3.624436010595854*^9, 3.62444287599014*^9, 
  3.624549133662013*^9, 3.6245494478885803`*^9, 3.62456564884595*^9, 
  3.624875480275919*^9, 3.624882104475891*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fx", "[", 
      RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
     FractionBox["1", "20"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
     ",", "1.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6088203241493273`*^9, 3.608820529511283*^9, 
  3.624281057582263*^9, 3.624281136532633*^9, 3.624281960700596*^9, 
  3.624282723712644*^9, 3.624301629959219*^9, 3.624301866699524*^9, 
  3.6243462398361893`*^9, 3.624365923822468*^9, 3.6243696540778027`*^9, 
  3.6244358373233023`*^9, 3.624436010595854*^9, 3.62444287599014*^9, 
  3.624549133662013*^9, 3.6245494478885803`*^9, 3.62456564884595*^9, 
  3.624875480275919*^9, 3.6248821044786453`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rvalstest", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", "\[Rule]", "1.0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "rvals"}], "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6242817185644503`*^9, 3.6242817346999693`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["rvalstest"], "Input",
 CellChangeTimes->{{3.624281918390265*^9, 3.6242819192337627`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.62428192262121*^9, 3.624281960841617*^9, 
  3.6242827238367453`*^9, 3.624301630033222*^9, 3.624301866813711*^9, 
  3.6243462398891907`*^9, 3.624365923878602*^9, 3.624369654167638*^9, 
  3.624435837406767*^9, 3.624436010667261*^9, 3.6244428760544863`*^9, 
  3.624549133759522*^9, 3.624549447974072*^9, 3.624565648935367*^9, 
  3.624875480404076*^9, 3.6248821045225487`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"fxtest", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", "\[Rule]", "0.1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "ftab"}], "}"}]}], "]"}], "//", "Flatten"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6242817567347097`*^9, 3.624281759690734*^9}, {
  3.624281796762117*^9, 3.6242818074677153`*^9}, {3.6242819022110987`*^9, 
  3.624281903635325*^9}}],

Cell[CellGroupData[{

Cell[BoxData["fxtest"], "Input",
 CellChangeTimes->{{3.6242818663108177`*^9, 3.624281866978546*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", "0.1`"}], 
   ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.1`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.624281867389296*^9, 3.6242819050214033`*^9, 
  3.6242819609571953`*^9, 3.624282723952879*^9, 3.6243016301070633`*^9, 
  3.624301866919903*^9, 3.624346239943775*^9, 3.624365923928866*^9, 
  3.6243696542664423`*^9, 3.624435837515226*^9, 3.624436010742229*^9, 
  3.624442876125771*^9, 3.624549133851695*^9, 3.6245494480744658`*^9, 
  3.6245656490224867`*^9, 3.624875480517798*^9, 3.624882104570374*^9}]
}, Open  ]],

Cell[TextData[StyleBox["Functions to solve for reproductive values \
numerically:",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.593444115376205*^9, 3.593444123951432*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ans2test", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
     RowBox[{"{", "m_", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p10s_", ",", "p11s_", ",", "p20s_", ",", "p21s_"}], "}"}], ",",
      "ks_", ",", "Qs_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"veqtab1", "/.", 
    RowBox[{"Join", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
       RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
       RowBox[{"k", "\[Rule]", "ks"}], ",", 
       RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
       RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
       RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
       RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
       RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
       RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
       RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
       RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
       RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
       RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
       RowBox[{"p21", "\[Rule]", "p21s"}], ",", 
       RowBox[{"mt", "\[Rule]", "m"}]}], "}"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.624281225718567*^9, 3.624281244454824*^9}, {
  3.6242812972831173`*^9, 3.624281308600658*^9}, {3.624281400046466*^9, 
  3.6242814016036997`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans2alt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "m_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p10s_", ",", "p11s_", ",", "p20s_", ",", "p21s_"}], "}"}], ",", 
    "ks_", ",", "Qs_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"feqtabalt", ",", "veqtabalt"}], "]"}], "/.", 
     RowBox[{"Join", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
        RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
        RowBox[{"k", "\[Rule]", "ks"}], ",", 
        RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
        RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
        RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
        RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
        RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
        RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
        RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
        RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
        RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
        RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
        RowBox[{"p21", "\[Rule]", "p21s"}], ",", 
        RowBox[{"mt", "\[Rule]", "m"}]}], "}"}], "]"}]}], ",", 
    "frootstartvals2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.624281225718567*^9, 3.624281244454824*^9}, {
  3.624282373037307*^9, 3.624282375920752*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans2", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "m_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p10s_", ",", "p11s_", ",", "p20s_", ",", "p21s_"}], "}"}], ",", 
    "ks_", ",", "Qs_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"feqtab", ",", "veqtab1"}], "]"}], "/.", 
     RowBox[{"Join", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
        RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
        RowBox[{"k", "\[Rule]", "ks"}], ",", 
        RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
        RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
        RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
        RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
        RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
        RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
        RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
        RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
        RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
        RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
        RowBox[{"p21", "\[Rule]", "p21s"}], ",", 
        RowBox[{"mt", "\[Rule]", "m"}]}], "}"}], "]"}]}], ",", 
    "frootstartvals2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5001916798996162`*^9, 3.500191697184021*^9}, {
   3.500191746661626*^9, 3.500191829605167*^9}, {3.5018625449943523`*^9, 
   3.501862553243379*^9}, {3.505134989076899*^9, 3.505135020740206*^9}, {
   3.505135294068394*^9, 3.505135298071993*^9}, {3.505135349357525*^9, 
   3.505135353720825*^9}, {3.505135717667018*^9, 3.505135718094597*^9}, {
   3.505135768611511*^9, 3.505135774783208*^9}, {3.505135830753673*^9, 
   3.505135873580983*^9}, {3.505135964949779*^9, 3.505136036881705*^9}, {
   3.505136141097201*^9, 3.505136150378752*^9}, {3.508161078184225*^9, 
   3.508161091740897*^9}, {3.520419842079061*^9, 3.520419844240124*^9}, {
   3.52455494510407*^9, 3.524554954808517*^9}, {3.5908239835408707`*^9, 
   3.590824013411441*^9}, {3.590824186979704*^9, 3.590824205987976*^9}, {
   3.5925440708761597`*^9, 3.5925440957750673`*^9}, {3.6242824975393476`*^9, 
   3.624282506760273*^9}, 3.6242826451232767`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"awh", "=", 
  RowBox[{"ans2alt", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0.3", ",", "0.1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0.5", ",", "0.1", ",", "0.8", ",", "0.8"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", "0.1", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0.5", ",", "0.7", ",", "0.3", ",", "0.5"}], "}"}], ",", "0.1", 
    ",", "0.05"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.500192029842957*^9, 3.500192032446335*^9}, {
   3.501923482525814*^9, 3.501923510215691*^9}, 3.5019239348204813`*^9, {
   3.50193133558246*^9, 3.501931358478292*^9}, {3.5032540622901*^9, 
   3.503254067378688*^9}, {3.505135027019304*^9, 3.505135031903424*^9}, {
   3.50513578285544*^9, 3.505135784285997*^9}, {3.505135894350724*^9, 
   3.505135895026915*^9}, {3.507217302061491*^9, 3.507217316708229*^9}, {
   3.508161095277032*^9, 3.508161096760681*^9}, {3.508161237183029*^9, 
   3.508161239674842*^9}, {3.508161319583596*^9, 3.508161323949635*^9}, {
   3.51566001997472*^9, 3.515660071679375*^9}, {3.520419450927335*^9, 
   3.520419468632097*^9}, {3.520419567807807*^9, 3.520419570324196*^9}, {
   3.520419750326867*^9, 3.520419756677986*^9}, {3.520420937695824*^9, 
   3.520420953180814*^9}, {3.520427627254544*^9, 3.520427638687585*^9}, {
   3.520429208593634*^9, 3.520429231674042*^9}, {3.524554969421171*^9, 
   3.524554973766278*^9}, {3.524555006868618*^9, 3.524555007460496*^9}, {
   3.524555062494341*^9, 3.524555063917426*^9}, {3.590823966331852*^9, 
   3.590823968139655*^9}, {3.590824274713768*^9, 3.590824276960957*^9}, {
   3.5925441110935087`*^9, 3.592544125601429*^9}, {3.5925442568585777`*^9, 
   3.59254426919372*^9}, {3.624281248446003*^9, 3.624281387064067*^9}, {
   3.6242816862150507`*^9, 3.624281701783063*^9}, {3.624281739061611*^9, 
   3.624281748125304*^9}, {3.6242818111965723`*^9, 3.624281812787917*^9}, {
   3.624281891044326*^9, 3.624281895012829*^9}, {3.6242822887443943`*^9, 
   3.624282322056324*^9}, {3.624282603871292*^9, 3.624282617925349*^9}, {
   3.624282744660499*^9, 3.624282745564041*^9}, {3.624301641222934*^9, 
   3.624301644921186*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.001835319902273984`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.0074531623890625644`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", 
    "0.02500862194099583`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.01142431606049275`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.0321512996435606`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "0.023658886533240196`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.012134388688026783`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.057126248819786514`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.04635398980790293`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.032853766214658034`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.003935816445038907`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.02669234719506774`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", 
    "0.0747947893292929`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.03224915951259422`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.13289869467404036`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "0.06974715138918018`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.027688674499154107`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.1565184616208329`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.1332927085088435`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.09218219682595505`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.0682512605983197`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.7366528630400017`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.9198415578562242`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.7222512670209996`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.330621640073225`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.0181721456722557`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.2083005560819267`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.9985097994798969`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.892577637879793`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.5912283221871062`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.7446093261616668`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.5788210389283975`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.318407039172898`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.9945266449216857`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.1933694989640953`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.9754510113943479`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.2231452259450173`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.8413774045150477`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.9734940648809921`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.8333163084414126`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.39983602443682`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.045788024780397`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.18161971138562`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.0357868097591747`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.9132986174750457`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.5777212363460232`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.6712751007566475`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.5720374523353908`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.3835393495074386`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.0287431668267721`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.1654438869188835`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.0187747460824954`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.624282328196806*^9, 3.624282384670986*^9, 3.624282523870741*^9, {
   3.6242826061148367`*^9, 3.6242826528276587`*^9}, {3.624282729768002*^9, 
   3.624282756160851*^9}, {3.624301636453946*^9, 3.624301651608383*^9}, 
   3.6243018732448587`*^9, 3.62434624622935*^9, 3.624365929899737*^9, 
   3.6243696603412743`*^9, 3.624435843838018*^9, 3.624436016936286*^9, 
   3.624442882675982*^9, 3.624549139425334*^9, 3.6245494541701403`*^9, 
   3.624565654946898*^9, 3.62487548653885*^9, 3.624882110838551*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"awh", "=", 
  RowBox[{"ans2", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0.3", ",", "0.1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0.5", ",", "0.1", ",", "0.8", ",", "0.8"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", "0.1", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0.5", ",", "0.7", ",", "0.3", ",", "0.5"}], "}"}], ",", "0.1", 
    ",", "0.05"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.500192029842957*^9, 3.500192032446335*^9}, {
   3.501923482525814*^9, 3.501923510215691*^9}, 3.5019239348204813`*^9, {
   3.50193133558246*^9, 3.501931358478292*^9}, {3.5032540622901*^9, 
   3.503254067378688*^9}, {3.505135027019304*^9, 3.505135031903424*^9}, {
   3.50513578285544*^9, 3.505135784285997*^9}, {3.505135894350724*^9, 
   3.505135895026915*^9}, {3.507217302061491*^9, 3.507217316708229*^9}, {
   3.508161095277032*^9, 3.508161096760681*^9}, {3.508161237183029*^9, 
   3.508161239674842*^9}, {3.508161319583596*^9, 3.508161323949635*^9}, {
   3.51566001997472*^9, 3.515660071679375*^9}, {3.520419450927335*^9, 
   3.520419468632097*^9}, {3.520419567807807*^9, 3.520419570324196*^9}, {
   3.520419750326867*^9, 3.520419756677986*^9}, {3.520420937695824*^9, 
   3.520420953180814*^9}, {3.520427627254544*^9, 3.520427638687585*^9}, {
   3.520429208593634*^9, 3.520429231674042*^9}, {3.524554969421171*^9, 
   3.524554973766278*^9}, {3.524555006868618*^9, 3.524555007460496*^9}, {
   3.524555062494341*^9, 3.524555063917426*^9}, {3.590823966331852*^9, 
   3.590823968139655*^9}, {3.590824274713768*^9, 3.590824276960957*^9}, {
   3.5925441110935087`*^9, 3.592544125601429*^9}, {3.5925442568585777`*^9, 
   3.59254426919372*^9}, {3.624281248446003*^9, 3.624281387064067*^9}, {
   3.6242816862150507`*^9, 3.624281701783063*^9}, {3.624281739061611*^9, 
   3.624281748125304*^9}, {3.6242818111965723`*^9, 3.624281812787917*^9}, {
   3.624281891044326*^9, 3.624281895012829*^9}, {3.6242822887443943`*^9, 
   3.624282322056324*^9}, {3.624282533118898*^9, 3.624282533389902*^9}, {
   3.624282609662045*^9, 3.624282615389073*^9}, {3.62428274722824*^9, 
   3.624282748493088*^9}, 3.624301659606031*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.001835319902273984`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.007453162389062558`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", 
    "0.02500862194099581`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.011424316060492747`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.032151299643560574`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "0.023658886533240185`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.012134388688026776`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.05712624881978648`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.04635398980790291`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.03285376621465802`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.003935816445038907`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.02669234719506775`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", 
    "0.07479478932929291`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.03224915951259422`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.1328986946740404`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "0.06974715138918018`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.027688674499154107`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.15651846162083294`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.13329270850884348`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.09218219682595505`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.068251260598321`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.7366528630400021`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.919841557856225`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.7222512670210001`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.3306216400732256`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.0181721456722563`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.2083005560819273`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.9985097994798974`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.8925776378797937`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.5912283221871065`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.7446093261616673`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.5788210389283979`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.3184070391728986`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.9945266449216861`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.193369498964096`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.9754510113943483`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.2231452259450177`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.841377404515048`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.9734940648809924`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.8333163084414129`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.3998360244368204`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.0457880247803972`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.1816197113856204`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.0357868097591751`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.9132986174750449`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.5777212363460235`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.6712751007566476`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.572037452335391`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.383539349507439`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.0287431668267724`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.1654438869188837`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.0187747460824956`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.624282328196806*^9, 3.624282384670986*^9, {3.624282523870741*^9, 
   3.6242825421501293`*^9}, {3.624282612198122*^9, 3.624282661220426*^9}, {
   3.6242827389589987`*^9, 3.6242827680932837`*^9}, 3.624301666672387*^9, 
   3.624301885398232*^9, 3.624346252322991*^9, 3.624365935985079*^9, 
   3.62436966653234*^9, 3.624435850405964*^9, 3.62443602330163*^9, 
   3.624442889211512*^9, 3.624549460607614*^9, 3.624565661323292*^9, 
   3.624875492587364*^9, 3.624882117280604*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ans2", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.03162", ",", "0.03162"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", ".5", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", "0.95", 
   ",", "0.05"}], "]"}]], "Input",
 CellChangeTimes->{{3.6248754987800703`*^9, 3.6248754994263563`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.006917171006992429`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.03714439938544784`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", 
    "0.053745873155841326`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.026187960466022904`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.07301693120691251`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "0.02525976024759943`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.03841626694943102`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.10897246987362927`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.07476835914645534`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.055570808561670015`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.006917171006992319`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.03714439938544752`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", 
    "0.05374587315584088`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.02618796046602267`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.0730169312069119`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "0.02525976024759922`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.038416266949430664`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.10897246987362837`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.07476835914645469`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.055570808561669544`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.9738941267341585`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.7736606229076879`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.9738941267341598`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.7736606229076879`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.2158059815348616`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.012368741647166`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.2158059815348616`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.012368741647166`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.9738941267341596`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.7736606229076878`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.9738941267341598`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.7736606229076878`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.2158059815348616`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.012368741647166`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.2158059815348616`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.012368741647166`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.9738941267341612`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.7736606229076889`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.9738941267341612`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.7736606229076889`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.2158059815348632`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.0123687416471672`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.2158059815348632`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.0123687416471672`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.9738941267341613`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.7736606229076889`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.9738941267341613`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.7736606229076888`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.2158059815348632`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.0123687416471672`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.2158059815348632`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.0123687416471672`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.624875503530383*^9, 3.624882121026259*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"iterateRv", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "m_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p10s_", ",", "p11s_", ",", "p20s_", ",", "p21s_"}], "}"}], ",", 
    "ks_", ",", "Qs_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Data", ",", "fxs", ",", "iter", ",", "rvalstart", ",", "DataNew"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Data", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"{", "1.0", "}"}], ",", 
        RowBox[{"Length", "[", "rvals", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DataNew", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{
        RowBox[{"{", "1.0", "}"}], ",", 
        RowBox[{"Length", "[", "rvals", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fxs", "=", 
      RowBox[{"ans1", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"s1s", ",", "s2s"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"c1s", ",", "c2s", ",", "c3s", ",", "c4s"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"q1s", ",", "q2s"}], "}"}], ",", 
        RowBox[{"{", "m", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p10s", ",", "p11s", ",", "p20s", ",", "p21s"}], "}"}], ",", 
        "ks", ",", "Qs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "2"}], ",", 
       RowBox[{"iter", "\[LessEqual]", "10"}], ",", 
       RowBox[{"++", "iter"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rvalstart", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"rvals", "[", 
               RowBox[{"[", "xi", "]"}], "]"}], "\[Rule]", 
              RowBox[{
               RowBox[{"Data", "[", 
                RowBox[{"[", "xi", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"iter", "-", "1"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"xi", ",", "1", ",", 
              RowBox[{"Length", "[", "rvals", "]"}]}], "}"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"DataNew", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Data", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"1", ";;", 
                 RowBox[{"Length", "[", "rvals", "]"}]}], ",", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "Data", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "+", 
             RowBox[{"0.001", "*", "veqtabPlain1"}]}], "/.", "rvalstart"}], "/.",
            "fxs"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
            RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
            RowBox[{"k", "\[Rule]", "ks"}], ",", 
            RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
            RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
            RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
            RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
            RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
            RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
            RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
            RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
            RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
            RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
            RowBox[{"p21", "\[Rule]", "p21s"}], ",", 
            RowBox[{"mt", "\[Rule]", "m"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Data", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{"Append", ",", 
           RowBox[{"{", 
            RowBox[{"Data", ",", "DataNew"}], "}"}]}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "Data", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.624893386174962*^9, 3.6248934215347767`*^9}, {
   3.624893721298765*^9, 3.6248937217225657`*^9}, {3.624903197536188*^9, 
   3.624903331783622*^9}, {3.624903398180982*^9, 3.6249034305348053`*^9}, {
   3.624903498645968*^9, 3.6249035071038857`*^9}, {3.624903580717144*^9, 
   3.624903655116963*^9}, 3.6249039581655416`*^9, {3.624904155616651*^9, 
   3.624904159984055*^9}, {3.6249041912325907`*^9, 3.624904197818523*^9}, {
   3.624904289733218*^9, 3.624904301971055*^9}, {3.6249045237666388`*^9, 
   3.624904527041841*^9}, {3.624904579590055*^9, 3.624904652260577*^9}, {
   3.624904685235609*^9, 3.6249047070556183`*^9}, {3.6249048561581173`*^9, 
   3.624904857743989*^9}, {3.624905048206881*^9, 3.6249050918845673`*^9}, {
   3.624905126540324*^9, 3.624905126657518*^9}, {3.624905172969727*^9, 
   3.624905173410508*^9}, {3.624905663323338*^9, 3.6249057020004807`*^9}, {
   3.624905810074469*^9, 3.624905891539818*^9}, {3.624905965760429*^9, 
   3.6249060326261187`*^9}, 3.624906115628228*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"iterateRv", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.03162", ",", "0.03162"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", ".5", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5", ",", "0.5", ",", "0.5"}], "}"}], ",", "0.95", 
   ",", "0.05"}], "]"}]], "Input",
 CellChangeTimes->{{3.6249059033610153`*^9, 3.624905908162622*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "1.0010000000000001`", ",", "1.0019999685750354`", ",", 
     "1.0029998994431955`", ",", "1.0039997863203933`", ",", 
     "1.0049996229203912`", ",", "1.005999402954827`", ",", 
     "1.00699912013324`", ",", "1.0079987681630977`", ",", 
     "1.0089983407498218`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.9994923845590538`", ",", "0.9989859263958323`", ",", 
     "0.9984806236285589`", ",", "0.9979764743758949`", ",", 
     "0.9974734767569512`", ",", "0.9969716288913003`", ",", 
     "0.9964709288989877`", ",", "0.9959713749005433`", ",", 
     "0.9954729650169932`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.9999685750352443`", ",", "0.9999382052592493`", ",", 
     "0.9999088864652107`", ",", "0.999880614457519`", ",", 
     "0.9998533850517017`", ",", "0.999827194074367`", ",", 
     "0.9998020373631465`", ",", "0.9997779107666389`", ",", 
     "0.9997548101443543`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.9994923845590538`", ",", "0.9989859263958323`", ",", 
     "0.9984806236207937`", ",", "0.9979764743448452`", ",", 
     "0.9974734766793546`", ",", "0.9969716287361625`", ",", 
     "0.9964709286275935`", ",", "0.9959713744664678`", ",", 
     "0.995472964366113`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "1.0004923845590539`", ",", "1.0009838868320498`", ",", 
     "1.0014745084957035`", ",", "1.001964251223062`", ",", 
     "1.0024531166835038`", ",", "1.0029411065427394`", ",", 
     "1.0034282224628124`", ",", "1.0039144661021`", ",", 
     "1.0043998391153133`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "1.0000161940828634`", ",", "1.0000323711404882`", ",", 
     "1.0000485312650622`", ",", "1.000064674549317`", ",", 
     "1.0000808010865228`", ",", "1.000096910970484`", ",", 
     "1.0001130042955346`", ",", "1.0001290811565324`", ",", 
     "1.0001451416488558`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "1.0004923845590539`", ",", "1.0009836412546773`", ",", 
     "1.0014737731994847`", ",", "1.0019627834970932`", ",", 
     "1.0024506752421503`", ",", "1.002937451520362`", ",", 
     "1.0034231154085216`", ",", "1.0039076699745368`", ",", 
     "1.004391118277458`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "1.0000161940828634`", ",", "1.0000323711404882`", ",", 
     "1.000048531216918`", ",", "1.0000646743569688`", ",", 
     "1.0000808006062205`", ",", "1.0000969100110126`", ",", 
     "1.0001130026184368`", ",", "1.000129078476331`", ",", 
     "1.0001451376332735`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.9999685750352443`", ",", "0.9999371738342845`", ",", 
     "0.9999057930656494`", ",", "0.9998744293989393`", ",", 
     "0.9998430795047885`", ",", "0.9998117400548273`", ",", 
     "0.9997804077216452`", ",", "0.9997490791787531`", ",", 
     "0.9997177511005458`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.9994923845590538`", ",", "0.9989859263958323`", ",", 
     "0.9984806224794437`", ",", "0.9979764697858609`", ",", 
     "0.9974734652979043`", ",", "0.9969716060052244`", ",", 
     "0.9964708889042846`", ",", "0.9959713109983438`", ",", 
     "0.9954728692974391`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.9999685750352443`", ",", "0.9999371738342845`", ",", 
     "0.9999057956772834`", ",", "0.9998744398429924`", ",", 
     "0.9998431056087778`", ",", "0.9998117922506475`", ",", 
     "0.9997804990432777`", ",", "0.9997492252600388`", ",", 
     "0.9997179701730223`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.9994923845590538`", ",", "0.9989859263958323`", ",", 
     "0.9984806224716786`", ",", "0.9979764697548927`", ",", 
     "0.997473465220715`", ",", "0.9969716058513077`", ",", 
     "0.9964708886357382`", ",", "0.995971310569961`", ",", 
     "0.995472868656801`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "1.0004923845590539`", ",", "1.0009836412546773`", ",", 
     "1.0014737721197857`", ",", "1.0019627791818957`", ",", 
     "1.0024506644631321`", ",", "1.0029374299802365`", ",", 
     "1.003423077744575`", ",", "1.0039076097621455`", ",", 
     "1.0043910280335866`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "1.0000161940828634`", ",", "1.0000324037541455`", ",", 
     "1.0000486291575565`", ",", "1.000064870437052`", ",", 
     "1.0000811277368298`", ",", "1.000097401201327`", ",", 
     "1.000113690975218`", ",", "1.0001299972034097`", ",", 
     "1.00014632003104`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "1.0004923845590539`", ",", "1.0009836412546773`", ",", 
     "1.0014737731800254`", ",", "1.001962783421814`", ",", 
     "1.0024506750603421`", ",", "1.0029374511695137`", ",", 
     "1.0034231148168613`", ",", "1.0039076690635673`", ",", 
     "1.004391116964487`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "1.0000161940828634`", ",", "1.0000323711404882`", ",", 
     "1.000048531350943`", ",", "1.000064674892233`", ",", 
     "1.0000808019422969`", ",", "1.0000969126790051`", ",", 
     "1.0001130072801585`", ",", "1.0001290859234861`", ",", 
     "1.0001451487866428`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.9999685750352443`", ",", "0.9999381561437748`", ",", 
     "0.9999087435627275`", ",", "0.9998803375344888`", ",", 
     "0.9998529383066913`", ",", "0.9998265461322098`", ",", 
     "0.9998011612691569`", ",", "0.9997767839808794`", ",", 
     "0.9997534145359553`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.9994923845590538`", ",", "0.9989861719732049`", ",", 
     "0.9984813596369523`", ",", "0.9979779449502101`", ",", 
     "0.9974759253182884`", ",", "0.9969752981518747`", ",", 
     "0.996476060867014`", ",", "0.9959782108850906`", ",", 
     "0.995481745632809`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.9999685750352443`", ",", "0.9999376649890297`", ",", 
     "0.9999072704989856`", ",", "0.9998773921965233`", ",", 
     "0.9998480307068474`", ",", "0.9998191866489681`", ",", 
     "0.9997908606357129`", ",", "0.9997630532737378`", ",", 
     "0.9997357651635389`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.9994923845590538`", ",", "0.9989861719732049`", ",", 
     "0.9984813596369523`", ",", "0.9979779449502092`", ",", 
     "0.9974759253182839`", ",", "0.9969752981518604`", ",", 
     "0.9964760608669789`", ",", "0.9959782108850173`", ",", 
     "0.9954817456326709`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "1.0004923845590539`", ",", "1.0009838868320498`", ",", 
     "1.001474509478013`", ",", "1.0019642551510166`", ",", 
     "1.0024531265001904`", ",", "1.00294112616973`", ",", 
     "1.0034282567989068`", ",", "1.003914521022076`", ",", 
     "1.004399921468686`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "1.0000161940828634`", ",", "1.0000323711404882`", ",", 
     "1.0000485311351293`", ",", "1.0000646740295311`", ",", 
     "1.000080799786924`", ",", "1.000096908371021`", ",", 
     "1.0001129997460136`", ",", "1.0001290738765705`", ",", 
     "1.0001451307278317`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "1.0004923845590539`", ",", "1.0009836412546773`", ",", 
     "1.0014737729461423`", ",", "1.00196278248433`", ",", 
     "1.0024506727117461`", ",", "1.0029374464625358`", ",", 
     "1.0034231065624992`", ",", "1.003907655829106`", ",", 
     "1.0043910970715109`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "1.0000161940828634`", ",", "1.0000323711404882`", ",", 
     "1.0000485312340015`", ",", "1.0000646744248916`", ",", 
     "1.0000808007750044`", ",", "1.0000969103465427`", ",", 
     "1.0001130032020626`", ",", "1.000129079404472`", ",", 
     "1.0001451390170275`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.9999685750352443`", ",", "0.9999371738342845`", ",", 
     "0.9999057976233815`", ",", "0.9998744476252069`", ",", 
     "0.9998431250588623`", ",", "0.9998118311398977`", ",", 
     "0.9997805670803305`", ",", "0.9997493340886642`", ",", 
     "0.9997181333699068`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.9994923845590538`", ",", "0.9989859263958323`", ",", 
     "0.9984806232687995`", ",", "0.9979764729419854`", ",", 
     "0.9974734731849741`", ",", "0.9969716217728918`", ",", 
     "0.9964709164863943`", ",", "0.9959713551116556`", ",", 
     "0.9954729354403555`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.9999685750352443`", ",", "0.9999371738342845`", ",", 
     "0.9999057972715254`", ",", "0.9998744462198402`", ",", 
     "0.999843121550572`", ",", "0.9998118241335351`", ",", 
     "0.9997805548370168`", ",", "0.9997493145277787`", ",", 
     "0.9997181040710581`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.9994923845590538`", ",", "0.9989859263958323`", ",", 
     "0.9984806232687995`", ",", "0.997976472942066`", ",", 
     "0.9974734731853768`", ",", "0.9969716217740984`", ",", 
     "0.9964709164892067`", ",", "0.9959713551172746`", ",", 
     "0.9954729354504593`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "1.0004923845590539`", ",", "1.0009836412546773`", ",", 
     "1.0014737731098604`", ",", "1.0019627831407163`", ",", 
     "1.002450674356498`", ",", "1.002937449759617`", ",", 
     "1.0034231123456607`", ",", "1.0039076651034102`", ",", 
     "1.0043911110148578`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "1.0000161940828634`", ",", "1.0000323711404882`", ",", 
     "1.0000485313183294`", ",", "1.0000646747616386`", ",", 
     "1.0000808016154632`", ",", "1.000096912024647`", ",", 
     "1.0001130061338308`", ",", "1.0001290840874522`", ",", 
     "1.0001451460297455`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "1.0004923845590539`", ",", "1.0009836412546773`", ",", 
     "1.001473772934448`", ",", "1.0019627824399167`", ",", 
     "1.002450672606617`", ",", "1.0029374462640768`", ",", 
     "1.0034231062358296`", ",", "1.0039076553394246`", ",", 
     "1.0043910963864375`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "1.0000161940828634`", ",", "1.0000323711404882`", ",", 
     "1.0000485313183294`", ",", "1.0000646747617445`", ",", 
     "1.000080801615993`", ",", "1.000096912026236`", ",", 
     "1.0001130061375358`", ",", "1.0001290840948565`", ",", 
     "1.0001451460430626`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.624905905131259*^9, 3.624905911502679*^9}, {
   3.624905979794482*^9, 3.62490602563892*^9}, 3.624906069488483*^9, 
   3.624906150700019*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}], ",", 
    RowBox[{"{", "1.`", "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.624905923860113*^9, 3.6249059248619757`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}], ",", 
   RowBox[{"{", "1.`", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.624905925208508*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Dimensions", "[", "out", "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.62490592591291*^9, 3.6249059503054113`*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.624905927503611*^9, 3.624905950700913*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6249057347628813`*^9, 3.62490573744694*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "Data", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.624905879968853*^9, 3.624905882501523*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.624905118866844*^9, 3.624905119510769*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"kj", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.5", ",", "0.8", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.9", ",", "0.3", ",", "0.5"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6249047640928497`*^9, 3.624904777195253*^9}, {
  3.624904864268619*^9, 3.624904875458067*^9}, {3.6249050278958263`*^9, 
  3.6249050338635597`*^9}, {3.624905774955893*^9, 3.624905777384131*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "kj", "]"}]], "Input",
 CellChangeTimes->{{3.624905768687509*^9, 3.624905771240144*^9}, {
  3.6249058014776897`*^9, 3.624905802183248*^9}, {3.624905954511879*^9, 
  3.624905958727906*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{{3.624905771632391*^9, 3.624905802642116*^9}, 
   3.624905959297297*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"kj", "[", 
  RowBox[{"[", 
   RowBox[{
    RowBox[{"1", ";;", "2"}], ",", "2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6249057416991453`*^9, 3.624905757401647*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8`", ",", "0.3`"}], "}"}]], "Output",
 CellChangeTimes->{{3.624905742479506*^9, 3.624905758082451*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"xj", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0.1", "}"}], ",", 
     RowBox[{"{", "0.2", "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6249048664151993`*^9, 3.624904880211215*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MapThread", "[", 
  RowBox[{"Join", ",", 
   RowBox[{"{", 
    RowBox[{"kj", ",", "xj"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6249048608285017`*^9, 3.6249048621364183`*^9}, {
  3.624904979863408*^9, 3.624905023479697*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.5`", ",", "0.8`", ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9`", ",", "0.3`", ",", "0.2`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.624904769417193*^9, 3.624904774211863*^9}, {
  3.6249050153494177`*^9, 3.624905036369461*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Relatedness", "Section",
 CellChangeTimes->{{3.497731804687118*^9, 3.497731811045567*^9}}],

Cell[CellGroupData[{

Cell["Auxiliary functions", "Subsection",
 CellChangeTimes->{{3.616139810278734*^9, 3.616139813358396*^9}}],

Cell["\<\
Probability that of all adapted young in the local patch, the  adapted young \
has been produced by locally adapted juvenile breeder (a1)\
\>", "Text",
 CellChangeTimes->{{3.608631523352783*^9, 3.608631573687293*^9}, {
  3.6086316072072887`*^9, 3.6086316242234077`*^9}, {3.60888007381842*^9, 
  3.608880075945784*^9}, {3.608880124216983*^9, 3.6088801256808243`*^9}, {
  3.617964554707355*^9, 3.6179645564181633`*^9}, {3.624368088160989*^9, 
  3.6243681009039717`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"afromlocala1", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"localad", "[", 
        RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
       RowBox[{"dispad", "[", "es", "]"}]}], ")"}]}], ")"}], 
   RowBox[{"g", "[", 
    RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"a1", "/", "n"}], ")"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"p", "[", 
      RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.501358842092887*^9, 3.501358895141707*^9}, {
   3.501359277817292*^9, 3.501359282714561*^9}, {3.501359349410309*^9, 
   3.501359357354445*^9}, {3.501359670871066*^9, 3.5013596839728622`*^9}, {
   3.505136185585985*^9, 3.505136185817593*^9}, {3.507218921148726*^9, 
   3.507218923212683*^9}, {3.50721899439552*^9, 3.507219004498115*^9}, 
   3.608631556734653*^9, {3.617964513154127*^9, 3.6179645717623262`*^9}, 
   3.624368077544115*^9, {3.62436813443001*^9, 3.624368184614644*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"afromlocalm1", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"localad", "[", 
        RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
       RowBox[{"dispad", "[", "es", "]"}]}], ")"}]}], ")"}], 
   RowBox[{"g", "[", 
    RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"m1", "/", "n"}], ")"}], 
   RowBox[{"p", "[", 
    RowBox[{"es", ",", "0", ",", "0"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.501358842092887*^9, 3.501358895141707*^9}, {
   3.501359277817292*^9, 3.501359282714561*^9}, {3.501359349410309*^9, 
   3.501359357354445*^9}, {3.501359670871066*^9, 3.5013596839728622`*^9}, {
   3.505136185585985*^9, 3.505136185817593*^9}, {3.507218921148726*^9, 
   3.507218923212683*^9}, {3.50721899439552*^9, 3.507219004498115*^9}, 
   3.608631556734653*^9, {3.617964513154127*^9, 3.6179645717623262`*^9}, 
   3.624368077544115*^9, {3.62436813443001*^9, 3.62436823237426*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"afromlocala2", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"localad", "[", 
        RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
       RowBox[{"dispad", "[", "es", "]"}]}], ")"}]}], ")"}], 
   RowBox[{"g", "[", 
    RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"a2", "/", "n"}], ")"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"p", "[", 
      RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.501358842092887*^9, 3.501358895141707*^9}, {
   3.501359277817292*^9, 3.501359282714561*^9}, {3.501359349410309*^9, 
   3.501359357354445*^9}, {3.501359670871066*^9, 3.5013596839728622`*^9}, {
   3.505136185585985*^9, 3.505136185817593*^9}, {3.507218921148726*^9, 
   3.507218923212683*^9}, {3.50721899439552*^9, 3.507219004498115*^9}, 
   3.608631556734653*^9, {3.617964513154127*^9, 3.6179645717623262`*^9}, 
   3.624368077544115*^9, {3.62436813443001*^9, 3.624368184614644*^9}, {
   3.624368252125638*^9, 3.624368262596404*^9}, {3.624368323228489*^9, 
   3.624368323357209*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"afromlocalm2", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"localad", "[", 
        RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
       RowBox[{"dispad", "[", "es", "]"}]}], ")"}]}], ")"}], 
   RowBox[{"g", "[", 
    RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "a1", "-", "a2", "-", "m1"}], ")"}], "/", "n"}], 
    ")"}], 
   RowBox[{"p", "[", 
    RowBox[{"es", ",", "0", ",", "1"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.501358842092887*^9, 3.501358895141707*^9}, {
   3.501359277817292*^9, 3.501359282714561*^9}, {3.501359349410309*^9, 
   3.501359357354445*^9}, {3.501359670871066*^9, 3.5013596839728622`*^9}, {
   3.505136185585985*^9, 3.505136185817593*^9}, {3.507218921148726*^9, 
   3.507218923212683*^9}, {3.50721899439552*^9, 3.507219004498115*^9}, 
   3.608631556734653*^9, {3.617964513154127*^9, 3.6179645717623262`*^9}, 
   3.624368077544115*^9, {3.62436813443001*^9, 3.624368184614644*^9}, {
   3.6243683264455833`*^9, 3.6243683617251387`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mfromlocala1", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"localmad", "[", 
        RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
       RowBox[{"dispmad", "[", "es", "]"}]}], ")"}]}], ")"}], 
   RowBox[{"g", "[", 
    RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"a1", "/", "n"}], ")"}], 
   RowBox[{"p", "[", 
    RowBox[{"es", ",", "1", ",", "0"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.501358842092887*^9, 3.501358895141707*^9}, {
   3.501359277817292*^9, 3.501359282714561*^9}, {3.501359349410309*^9, 
   3.501359357354445*^9}, {3.501359670871066*^9, 3.5013596839728622`*^9}, {
   3.505136185585985*^9, 3.505136185817593*^9}, {3.507218921148726*^9, 
   3.507218923212683*^9}, {3.50721899439552*^9, 3.507219004498115*^9}, 
   3.608631556734653*^9, {3.617964513154127*^9, 3.6179645717623262`*^9}, 
   3.624368077544115*^9, {3.62436813443001*^9, 3.624368184614644*^9}, {
   3.62436838627654*^9, 3.624368397643898*^9}, {3.62444290802919*^9, 
   3.624442923897883*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mfromlocalm1", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"localmad", "[", 
        RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
       RowBox[{"dispmad", "[", "es", "]"}]}], ")"}]}], ")"}], 
   RowBox[{"g", "[", 
    RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"m1", "/", "n"}], ")"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"p", "[", 
      RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.501358842092887*^9, 3.501358895141707*^9}, {
   3.501359277817292*^9, 3.501359282714561*^9}, {3.501359349410309*^9, 
   3.501359357354445*^9}, {3.501359670871066*^9, 3.5013596839728622`*^9}, {
   3.505136185585985*^9, 3.505136185817593*^9}, {3.507218921148726*^9, 
   3.507218923212683*^9}, {3.50721899439552*^9, 3.507219004498115*^9}, 
   3.608631556734653*^9, {3.617964513154127*^9, 3.6179645717623262`*^9}, 
   3.624368077544115*^9, {3.62436813443001*^9, 3.62436823237426*^9}, {
   3.624368388132432*^9, 3.624368401532116*^9}, {3.624442912094187*^9, 
   3.624442921667953*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mfromlocala2", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"localmad", "[", 
        RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
       RowBox[{"dispmad", "[", "es", "]"}]}], ")"}]}], ")"}], 
   RowBox[{"g", "[", 
    RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
   RowBox[{"(", 
    RowBox[{"a2", "/", "n"}], ")"}], 
   RowBox[{"p", "[", 
    RowBox[{"es", ",", "1", ",", "1"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.501358842092887*^9, 3.501358895141707*^9}, {
   3.501359277817292*^9, 3.501359282714561*^9}, {3.501359349410309*^9, 
   3.501359357354445*^9}, {3.501359670871066*^9, 3.5013596839728622`*^9}, {
   3.505136185585985*^9, 3.505136185817593*^9}, {3.507218921148726*^9, 
   3.507218923212683*^9}, {3.50721899439552*^9, 3.507219004498115*^9}, 
   3.608631556734653*^9, {3.617964513154127*^9, 3.6179645717623262`*^9}, 
   3.624368077544115*^9, {3.62436813443001*^9, 3.624368184614644*^9}, {
   3.624368252125638*^9, 3.624368262596404*^9}, {3.624368323228489*^9, 
   3.624368323357209*^9}, {3.6243683891162453`*^9, 3.624368404884116*^9}, {
   3.624442913921627*^9, 3.624442920405002*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mfromlocalm2", "[", 
   RowBox[{"es_", ",", "a1_", ",", "m1_", ",", "a2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"m", "[", 
        RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"localmad", "[", 
        RowBox[{"es", ",", "a1", ",", "m1", ",", "a2"}], "]"}], "+", 
       RowBox[{"dispmad", "[", "es", "]"}]}], ")"}]}], ")"}], 
   RowBox[{"g", "[", 
    RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"n", "-", "a1", "-", "a2", "-", "m1"}], ")"}], "/", "n"}], 
    ")"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"p", "[", 
      RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.501358842092887*^9, 3.501358895141707*^9}, {
   3.501359277817292*^9, 3.501359282714561*^9}, {3.501359349410309*^9, 
   3.501359357354445*^9}, {3.501359670871066*^9, 3.5013596839728622`*^9}, {
   3.505136185585985*^9, 3.505136185817593*^9}, {3.507218921148726*^9, 
   3.507218923212683*^9}, {3.50721899439552*^9, 3.507219004498115*^9}, 
   3.608631556734653*^9, {3.617964513154127*^9, 3.6179645717623262`*^9}, 
   3.624368077544115*^9, {3.62436813443001*^9, 3.624368184614644*^9}, {
   3.6243683264455833`*^9, 3.6243684079574947`*^9}, {3.6244429154695063`*^9, 
   3.624442917870327*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Relatedness between pairs of adapted juveniles", "Subsection",
 CellChangeTimes->{{3.624348323025687*^9, 3.624348332304028*^9}, {
  3.624363100131246*^9, 3.6243631054046087`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ra1a1tab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{
       "A1", ",", "A1", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
       "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}], ",", "na2"}], 
           "]"}], 
          RowBox[{"r", "[", 
           RowBox[{"M1", ",", "M1", ",", "es", ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]",
          "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"na1", "-", "2"}], "na1"], 
             RowBox[{"r", "[", 
              RowBox[{
              "A1", ",", "A1", ",", "es", ",", "na1", ",", "nm1", ",", 
               "na2"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["2", "na1"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"afromlocala1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox["1", "na1"], "+", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"na1", "-", "1"}], "na1"], 
                   RowBox[{"r", "[", 
                    RowBox[{
                    "A1", ",", "A1", ",", "es", ",", "na1", ",", "nm1", ",", 
                    "na2"}], "]"}]}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocalm1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocala2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocalm2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "A1", ",", "es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "death", " ", "adapted", " ", "juvenille", " ", "on", " ", 
             "na1"}], "+", 
            RowBox[{"1", " ", "patch"}]}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "A1", ",", "es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
            " ", "na1"}], "+", 
           RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}], 
          RowBox[{"r", "[", 
           RowBox[{
           "A1", ",", "A1", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
           "]"}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], " ",
           "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "2"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "A1", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", 
                 RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["2", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", 
                    RowBox[{"na1", "-", "1"}]], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na1", "-", "2"}], 
                    RowBox[{"na1", "-", "1"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "A1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], 
                   ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], 
                ")"}]}]}], ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{"replaced", " ", "by", " ", "adapted", " ", "juvenile"}]}],
           " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "A1", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to", 
           " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "2"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "A1", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                 RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
              RowBox[{
               FractionBox["2", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", 
                    RowBox[{"na1", "-", "1"}]], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na1", "-", "2"}], 
                    RowBox[{"na1", "-", "1"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "A1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "A1", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "2"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "A1", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], "]"}]}],
               "+", 
              RowBox[{
               FractionBox["2", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", 
                    RowBox[{"na1", "-", "1"}]], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na1", "-", "2"}], 
                    RowBox[{"na1", "-", "1"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "A1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                    "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}]}], ")"}]}]}], ")"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",",
            " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "A1", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}], ",", "na2"}], 
           "]"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
             RowBox[{
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
              "\[GreaterEqual]", "0"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nm1", "+", "1"}], ")"}], 
             RowBox[{"f", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", 
                RowBox[{"(", 
                 RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
              "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
             RowBox[{
              RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"na2", "+", "1"}], ")"}], " ", 
             RowBox[{"d", "[", 
              RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
             RowBox[{"f", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", 
                RowBox[{"(", 
                 RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", 
                RowBox[{"(", 
                 RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
           "]"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",",
            "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}]}], ",", "0"}], "]"}]}], ")"}]}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na1", ",", "2", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nm1", ",", "0", ",", 
       RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na2", ",", "0", ",", 
       RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.624302371333778*^9, 3.6243024125426188`*^9}, {
   3.6243028274912653`*^9, 3.6243029055041723`*^9}, {3.6243032547992907`*^9, 
   3.624303296552454*^9}, {3.624303439665804*^9, 3.624303469793705*^9}, {
   3.624303504597529*^9, 3.624303515626656*^9}, {3.624303953275794*^9, 
   3.624303955661152*^9}, {3.62430403571349*^9, 3.624304090734439*^9}, {
   3.624304482871949*^9, 3.624304526932238*^9}, {3.6243056584888372`*^9, 
   3.62430570335483*^9}, 3.6243058598933887`*^9, {3.624306251844326*^9, 
   3.624306258941802*^9}, 3.62430629883864*^9, {3.624306332641201*^9, 
   3.624306389842059*^9}, {3.6243071876723213`*^9, 3.624307204002542*^9}, {
   3.624340070721993*^9, 3.624340104658491*^9}, {3.624340160399*^9, 
   3.624340160625435*^9}, {3.624341285683601*^9, 3.624341285857761*^9}, {
   3.624341567202887*^9, 3.624341569656107*^9}, {3.624341876347229*^9, 
   3.62434205148129*^9}, {3.624342916533228*^9, 3.624342982335129*^9}, {
   3.624343065740284*^9, 3.624343210268524*^9}, {3.624343248999522*^9, 
   3.6243432707243023`*^9}, {3.6243433014432364`*^9, 
   3.6243433718271017`*^9}, {3.6243434581143*^9, 3.624343458965274*^9}, {
   3.624343562620357*^9, 3.6243435976830997`*^9}, {3.624343732188504*^9, 
   3.624344006726016*^9}, {3.624344126581244*^9, 3.624344199386602*^9}, {
   3.6243447499158297`*^9, 3.624344840488538*^9}, {3.6243450132092943`*^9, 
   3.624345431597501*^9}, {3.624345599240451*^9, 3.6243456481965647`*^9}, {
   3.624345934839198*^9, 3.624345936876704*^9}, {3.6243459721177387`*^9, 
   3.6243462106280823`*^9}, {3.624347591537723*^9, 3.624347755722567*^9}, {
   3.624348198007516*^9, 3.6243482179264708`*^9}, {3.6243482525398912`*^9, 
   3.624348266657654*^9}, {3.624356895198255*^9, 3.624356918300398*^9}, {
   3.6243569521886263`*^9, 3.624356985457391*^9}, {3.624368739362833*^9, 
   3.6243687671627483`*^9}, {3.624368799220381*^9, 3.6243688168881483`*^9}, {
   3.624369129654187*^9, 3.624369140775166*^9}, {3.624389381594438*^9, 
   3.6243893864006968`*^9}, {3.62443269897185*^9, 3.6244327276571827`*^9}, {
   3.624437527350671*^9, 3.624437568249481*^9}, {3.624437639305588*^9, 
   3.624437662421657*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Relatedness between adapted and maladapted juveniles", "Subsection",
 CellChangeTimes->{{3.624363130957767*^9, 3.624363143628471*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ra1m1tab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{
       "A1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
       "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}], ",", "na2"}], 
           "]"}], 
          RowBox[{"r", "[", 
           RowBox[{"A1", ",", "M1", ",", "es", ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]",
          "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"na1", "-", "1"}], "na1"], 
             RowBox[{"r", "[", 
              RowBox[{
              "A1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
               "na2"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["1", "na1"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"afromlocala1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocalm1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox["1", "nm1"], "+", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"nm1", "-", "1"}], "nm1"], 
                   RowBox[{"r", "[", 
                    RowBox[{
                    "M1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
                    "na2"}], "]"}]}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocala2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "M1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocalm2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "M1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"nm1", "-", "1"}], "nm1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M1", ",", "es", ",", 
                 RowBox[{"na1", "+", "1"}], ",", 
                 RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "nm1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"mfromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", "na1"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na1", "-", "1"}], "na1"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "A1", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                   ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                ")"}]}]}], ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "death", " ", "adapted", " ", "juvenille", " ", "on", " ", 
             "na1"}], "+", "1"}], ",", 
           RowBox[{"nm", "-", 
            RowBox[{"1", " ", "patch"}]}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "M1", ",", "es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
             " ", "na1"}], "+", "1"}], ",", 
           RowBox[{"na2", "-", 
            RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}]}], " ",
           "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"nm1", "-", "1"}], "nm1"], 
             RowBox[{"r", "[", 
              RowBox[{
              "A1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
               "na2"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["1", "nm1"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"mfromlocala1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox["1", "na1"], "+", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"na1", "-", "1"}], "na1"], 
                   RowBox[{"r", "[", 
                    RowBox[{
                    "A1", ",", "A1", ",", "es", ",", "na1", ",", "nm1", ",", 
                    "na2"}], "]"}]}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"mfromlocalm1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"mfromlocala2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A2", ",", "A1", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"mfromlocalm2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "M2", ",", "A1", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], " ",
           "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "1"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M1", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", 
                 RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", 
                    RowBox[{"nm1", "+", "1"}]], "+", 
                    RowBox[{
                    FractionBox["nm1", 
                    RowBox[{"nm1", "+", "1"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"M1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], 
                   ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], 
                ")"}]}]}], ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{
            RowBox[{
            "replaced", " ", "by", " ", "adapted", " ", "juvenile", " ", "on",
              " ", "a", " ", "na1"}], "-", "1"}], ",", 
           RowBox[{"nm1", "+", 
            RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to", 
           " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "1"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M1", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                 RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", "nm1"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"nm1", "-", "1"}], "nm1"], 
                    RowBox[{"r", "[", 
                    RowBox[{"M1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"nm1", "-", "1"}], "nm1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
                 RowBox[{"nm1", "-", "1"}], ",", 
                 RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "nm1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"mfromlocala1", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", "na1"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na1", "-", "1"}], "na1"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "A1", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm1", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocala2", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm2", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "1"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M1", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], "]"}]}],
               "+", 
              RowBox[{
               FractionBox["1", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", "nm1"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"nm1", "-", "1"}], "nm1"], 
                    RowBox[{"r", "[", 
                    RowBox[{"M1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                    "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}]}], ")"}]}]}], ")"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",",
            " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"nm1", "-", "1"}], "nm1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
                 RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "nm1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"mfromlocala1", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", "na1"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na1", "-", "1"}], "na1"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A1", ",", "A1", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                   ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm1", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocala2", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm2", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                ")"}]}]}], ")"}]}], ",", "0"}], "]"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}], ",", "na2"}], 
           "]"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",",
            "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}]}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
        ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na1", ",", "1", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nm1", ",", "1", ",", 
       RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na2", ",", "0", ",", 
       RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.624302371333778*^9, 3.6243024125426188`*^9}, {
   3.6243028274912653`*^9, 3.6243029055041723`*^9}, {3.6243032547992907`*^9, 
   3.624303296552454*^9}, {3.624303439665804*^9, 3.624303469793705*^9}, {
   3.624303504597529*^9, 3.624303515626656*^9}, {3.624303953275794*^9, 
   3.624303955661152*^9}, {3.62430403571349*^9, 3.624304090734439*^9}, {
   3.624304482871949*^9, 3.624304526932238*^9}, {3.6243056584888372`*^9, 
   3.62430570335483*^9}, 3.6243058598933887`*^9, {3.624306251844326*^9, 
   3.624306258941802*^9}, 3.62430629883864*^9, {3.624306332641201*^9, 
   3.624306389842059*^9}, {3.6243071876723213`*^9, 3.624307204002542*^9}, {
   3.624340070721993*^9, 3.624340104658491*^9}, {3.624340160399*^9, 
   3.624340160625435*^9}, {3.624341285683601*^9, 3.624341285857761*^9}, {
   3.624341567202887*^9, 3.624341569656107*^9}, {3.624341876347229*^9, 
   3.62434205148129*^9}, {3.624342916533228*^9, 3.624342982335129*^9}, {
   3.624343065740284*^9, 3.624343210268524*^9}, {3.624343248999522*^9, 
   3.6243432707243023`*^9}, {3.6243433014432364`*^9, 
   3.6243433718271017`*^9}, {3.6243434581143*^9, 3.624343458965274*^9}, {
   3.624343562620357*^9, 3.6243435976830997`*^9}, {3.624343732188504*^9, 
   3.624344006726016*^9}, {3.624344126581244*^9, 3.624344199386602*^9}, {
   3.6243447499158297`*^9, 3.624344840488538*^9}, {3.6243450132092943`*^9, 
   3.624345431597501*^9}, {3.624345599240451*^9, 3.6243456481965647`*^9}, {
   3.624345934839198*^9, 3.624345936876704*^9}, {3.6243459721177387`*^9, 
   3.6243462106280823`*^9}, {3.624347591537723*^9, 3.624347755722567*^9}, {
   3.624348198007516*^9, 3.6243482179264708`*^9}, {3.6243482525398912`*^9, 
   3.624348266657654*^9}, {3.62434836723208*^9, 3.624348392347834*^9}, {
   3.624350735285244*^9, 3.62435075443115*^9}, {3.6243507946082993`*^9, 
   3.624350885180558*^9}, {3.6243513356039047`*^9, 3.624351340749043*^9}, {
   3.624351668681178*^9, 3.624351669278874*^9}, {3.6243518488718348`*^9, 
   3.624351861366447*^9}, {3.624351935381558*^9, 3.624351980501761*^9}, {
   3.624352011642293*^9, 3.624352133423257*^9}, {3.624352547821821*^9, 
   3.6243525975310593`*^9}, {3.624352636178549*^9, 3.624352666408836*^9}, {
   3.6243528800667057`*^9, 3.6243528816098013`*^9}, {3.624355881047595*^9, 
   3.624356110924863*^9}, {3.624356157840003*^9, 3.624356158111594*^9}, {
   3.624356202494185*^9, 3.624356296354809*^9}, {3.624356389719812*^9, 
   3.624356580759553*^9}, {3.62435661523709*^9, 3.6243568742997627`*^9}, {
   3.624357009391694*^9, 3.624357030093951*^9}, {3.624357067486843*^9, 
   3.624357179330071*^9}, {3.624357272513235*^9, 3.624357531321918*^9}, {
   3.62435785211161*^9, 3.624357886430176*^9}, {3.624357924747765*^9, 
   3.624358034392644*^9}, {3.624358069863727*^9, 3.624358270370534*^9}, {
   3.6243590706496687`*^9, 3.6243590834029627`*^9}, {3.6243591639129877`*^9, 
   3.6243594029082212`*^9}, {3.624361102875093*^9, 3.624361103239318*^9}, 
   3.624369194685254*^9, {3.624369408285685*^9, 3.624369413229538*^9}, {
   3.6243887022329063`*^9, 3.6243887109322033`*^9}, {3.624388766232829*^9, 
   3.62438877177741*^9}, {3.624389074088356*^9, 3.624389098834138*^9}, {
   3.624437685699605*^9, 3.624437730989354*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Relatedness between adapted juvenile and adapted adult", "Subsection",
 CellChangeTimes->{{3.624363164646661*^9, 3.62436318040772*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ra1a2tab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{
       "A1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
       "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}], ",", "na2"}], 
           "]"}], 
          RowBox[{"r", "[", 
           RowBox[{"M1", ",", "M2", ",", "es", ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]",
          "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"na1", "-", "1"}], "na1"], 
             RowBox[{"r", "[", 
              RowBox[{
              "A1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
               "na2"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["1", "na1"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"afromlocala1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocalm1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "M1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocala2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox["1", "na2"], "+", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"na2", "-", "1"}], "na2"], 
                   RowBox[{"r", "[", 
                    RowBox[{
                    "A2", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
                    "na2"}], "]"}]}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocalm2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "A2", ",", "es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "death", " ", "adapted", " ", "juvenille", " ", "on", " ", 
             "na1"}], "+", "1"}], ",", 
           RowBox[{"nm", "-", 
            RowBox[{"1", " ", "patch"}]}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["1", "na2"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "A1", ",", "es", ",", 
                 RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
                 RowBox[{"na2", "-", "1"}]}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"na2", "-", "1"}], "na2"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "A2", ",", "es", ",", 
                 RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
                 RowBox[{"na2", "-", "1"}]}], "]"}]}]}], ")"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
             " ", "na1"}], "+", "1"}], ",", 
           RowBox[{"na2", "-", 
            RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}]}], " ",
           "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}], 
          RowBox[{"r", "[", 
           RowBox[{
           "A1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
           "]"}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], " ",
           "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "1"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "A2", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", 
                 RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", "na2"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na2", "-", "1"}], "na2"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A2", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], 
                   ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], 
                ")"}]}]}], ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{
            RowBox[{
            "replaced", " ", "by", " ", "adapted", " ", "juvenile", " ", "on",
              " ", "a", " ", "na1"}], "-", "1"}], ",", 
           RowBox[{"nm1", "+", 
            RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "A2", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to", 
           " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "1"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "A2", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                 RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", "na2"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na2", "-", "1"}], "na2"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A2", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "A2", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "1"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "A2", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], "]"}]}],
               "+", 
              RowBox[{
               FractionBox["1", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", "na2"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na2", "-", "1"}], "na2"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A2", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                    "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}]}], ")"}]}]}], ")"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",",
            " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "A2", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}], ",", "na2"}], 
           "]"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",",
            "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}]}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
        ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na1", ",", "1", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nm1", ",", "0", ",", 
       RowBox[{"n", "-", "na1", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na2", ",", "1", ",", 
       RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.624369430348342*^9, 3.624369453289847*^9}, {
  3.6243714725388536`*^9, 3.624371472675519*^9}, {3.624389104232874*^9, 
  3.6243891145308332`*^9}, {3.624389760031954*^9, 3.624389770457341*^9}, {
  3.624437751423497*^9, 3.6244377807639227`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Relatedness between adapted juvenile and maladapted adult", "Subsection",
 CellChangeTimes->{{3.6243632303277617`*^9, 3.624363238699778*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ra1m2tab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{
       "A1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
       "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}], ",", "na2"}], 
           "]"}], 
          RowBox[{"r", "[", 
           RowBox[{"M1", ",", "A2", ",", "es", ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]",
          "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"na1", "-", "1"}], "na1"], 
             RowBox[{"r", "[", 
              RowBox[{
              "A1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
               "na2"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["1", "na1"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"afromlocala1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocalm1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "M1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocala2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"afromlocalm2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox["1", 
                   RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], "+", 
                  RowBox[{
                   FractionBox[
                    RowBox[{
                    "n", "-", "na1", "-", "nm1", "-", "na2", "-", "1"}], 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
                   RowBox[{"r", "[", 
                    RowBox[{
                    "M2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                    "na2"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "M2", ",", "es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "death", " ", "adapted", " ", "juvenille", " ", "on", " ", 
             "na1"}], "+", "1"}], ",", 
           RowBox[{"nm", "-", 
            RowBox[{"1", " ", "patch"}]}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "M2", ",", "es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
             " ", "na1"}], "+", "1"}], ",", 
           RowBox[{"na2", "-", 
            RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}]}], " ",
           "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}], 
          RowBox[{"r", "[", 
           RowBox[{
           "A1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
           "]"}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], " ",
           "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "1"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M2", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", 
                 RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    "n", "-", "na1", "-", "nm1", "-", "na2", "-", "1"}], 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"M2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", 
                    RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], 
                   ")"}]}]}], ")"}]}]}], ")"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{
            RowBox[{
            "replaced", " ", "by", " ", "adapted", " ", "juvenile", " ", "on",
              " ", "a", " ", "na1"}], "-", "1"}], ",", 
           RowBox[{"nm1", "+", 
            RowBox[{"1", " ", "patch"}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "-", "1"}], 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M2", ",", "es", ",", "na1", ",", 
                 RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
                 RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], ")"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to", 
           " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "1"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M2", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                 RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    "n", "-", "na1", "-", "nm1", "-", "na2", "-", "1"}], 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"M2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}]}], 
                ")"}]}]}], ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "M2", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"na1", "-", "1"}], "na1"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M2", ",", "es", ",", 
                 RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], "]"}]}],
               "+", 
              RowBox[{
               FractionBox["1", "na1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"afromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"afromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], 
                   "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{
                    "n", "-", "na1", "-", "nm1", "-", "na2", "-", "1"}], 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"M2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}]}], 
                ")"}]}]}], ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",",
            " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", "M2", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}], ",", "na2"}], 
           "]"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",",
            "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}]}], ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
        ")"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na1", ",", "1", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nm1", ",", "0", ",", 
       RowBox[{"n", "-", "na1", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na2", ",", "0", ",", 
       RowBox[{"n", "-", "na1", "-", "nm1", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.624302371333778*^9, 3.6243024125426188`*^9}, {
   3.6243028274912653`*^9, 3.6243029055041723`*^9}, {3.6243032547992907`*^9, 
   3.624303296552454*^9}, {3.624303439665804*^9, 3.624303469793705*^9}, {
   3.624303504597529*^9, 3.624303515626656*^9}, {3.624303953275794*^9, 
   3.624303955661152*^9}, {3.62430403571349*^9, 3.624304090734439*^9}, {
   3.624304482871949*^9, 3.624304526932238*^9}, {3.6243056584888372`*^9, 
   3.62430570335483*^9}, 3.6243058598933887`*^9, {3.624306251844326*^9, 
   3.624306258941802*^9}, 3.62430629883864*^9, {3.624306332641201*^9, 
   3.624306389842059*^9}, {3.6243071876723213`*^9, 3.624307204002542*^9}, {
   3.624340070721993*^9, 3.624340104658491*^9}, {3.624340160399*^9, 
   3.624340160625435*^9}, {3.624341285683601*^9, 3.624341285857761*^9}, {
   3.624341567202887*^9, 3.624341569656107*^9}, {3.624341876347229*^9, 
   3.62434205148129*^9}, {3.624342916533228*^9, 3.624342982335129*^9}, {
   3.624343065740284*^9, 3.624343210268524*^9}, {3.624343248999522*^9, 
   3.6243432707243023`*^9}, {3.6243433014432364`*^9, 
   3.6243433718271017`*^9}, {3.6243434581143*^9, 3.624343458965274*^9}, {
   3.624343562620357*^9, 3.6243435976830997`*^9}, {3.624343732188504*^9, 
   3.624344006726016*^9}, {3.624344126581244*^9, 3.624344199386602*^9}, {
   3.6243447499158297`*^9, 3.624344840488538*^9}, {3.6243450132092943`*^9, 
   3.624345431597501*^9}, {3.624345599240451*^9, 3.6243456481965647`*^9}, {
   3.624345934839198*^9, 3.624345936876704*^9}, {3.6243459721177387`*^9, 
   3.6243462106280823`*^9}, {3.624347591537723*^9, 3.624347755722567*^9}, {
   3.624348198007516*^9, 3.6243482179264708`*^9}, {3.6243482525398912`*^9, 
   3.624348266657654*^9}, {3.62434836723208*^9, 3.624348392347834*^9}, {
   3.624350735285244*^9, 3.62435075443115*^9}, {3.6243507946082993`*^9, 
   3.624350885180558*^9}, {3.6243513356039047`*^9, 3.624351340749043*^9}, {
   3.624351668681178*^9, 3.624351669278874*^9}, {3.6243518488718348`*^9, 
   3.624351861366447*^9}, {3.624351935381558*^9, 3.624351980501761*^9}, {
   3.624352011642293*^9, 3.624352133423257*^9}, {3.624352547821821*^9, 
   3.6243525975310593`*^9}, {3.624352636178549*^9, 3.624352666408836*^9}, {
   3.6243528800667057`*^9, 3.6243528816098013`*^9}, {3.624355881047595*^9, 
   3.624356110924863*^9}, {3.624356157840003*^9, 3.624356158111594*^9}, {
   3.624356202494185*^9, 3.624356296354809*^9}, {3.624356389719812*^9, 
   3.624356580759553*^9}, {3.62435661523709*^9, 3.6243568742997627`*^9}, {
   3.624357009391694*^9, 3.624357030093951*^9}, {3.624357067486843*^9, 
   3.624357179330071*^9}, {3.624357272513235*^9, 3.624357531321918*^9}, {
   3.62435785211161*^9, 3.624357886430176*^9}, {3.624357924747765*^9, 
   3.624358034392644*^9}, {3.624358069863727*^9, 3.624358270370534*^9}, {
   3.6243590706496687`*^9, 3.6243590834029627`*^9}, {3.6243591639129877`*^9, 
   3.6243594029082212`*^9}, {3.62435967097499*^9, 3.624359748068956*^9}, {
   3.624359835742345*^9, 3.624359921207162*^9}, {3.6243599832048798`*^9, 
   3.624359984189419*^9}, {3.624360085002398*^9, 3.624360228998149*^9}, {
   3.624360273473156*^9, 3.624360307329399*^9}, {3.6243603964807577`*^9, 
   3.6243604657025347`*^9}, {3.624360542188869*^9, 3.624360563670354*^9}, {
   3.624360606780002*^9, 3.624360610019396*^9}, {3.624360956903163*^9, 
   3.6243610034406*^9}, {3.6243610360502653`*^9, 3.624361049566495*^9}, {
   3.624361132286113*^9, 3.624361159696424*^9}, {3.624361213856702*^9, 
   3.6243613914943857`*^9}, {3.6243614218906603`*^9, 3.624361535525997*^9}, {
   3.624361622770063*^9, 3.624361640850445*^9}, {3.624361758854197*^9, 
   3.624361759194154*^9}, {3.624361792771669*^9, 3.6243618091382236`*^9}, {
   3.6243618498434963`*^9, 3.6243619325824347`*^9}, {3.6243620301821737`*^9, 
   3.624362101384323*^9}, {3.624362131730844*^9, 3.624362239927814*^9}, {
   3.624362344922744*^9, 3.62436235350001*^9}, {3.624362409519112*^9, 
   3.624362409785557*^9}, {3.624369468596389*^9, 3.624369501450274*^9}, {
   3.624371382325472*^9, 3.624371382530396*^9}, {3.6243907297950897`*^9, 
   3.624390736871777*^9}, {3.624430294447956*^9, 3.6244302947885733`*^9}, {
   3.624437790080974*^9, 3.624437801743976*^9}, 3.624443070383594*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Relatedness between pairs of maladapted juveniles", "Subsection",
 CellChangeTimes->{{3.62436327019763*^9, 3.6243632806977797`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rm1m1tab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{
       "M1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
       "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}], ",", "na2"}], 
           "]"}], 
          RowBox[{"r", "[", 
           RowBox[{"A1", ",", "A1", ",", "es", ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]",
          "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"r", "[", 
           RowBox[{
           "M1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
           "]"}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"nm1", "-", "2"}], "nm1"], 
               RowBox[{"r", "[", 
                RowBox[{"M1", ",", "M1", ",", "es", ",", 
                 RowBox[{"na1", "+", "1"}], ",", 
                 RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["2", "nm1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"mfromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", 
                    RowBox[{"nm1", "-", "1"}]], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"nm1", "-", "2"}], 
                    RowBox[{"nm1", "-", "1"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"M1", ",", "M1", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                   ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                ")"}]}]}], ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "death", " ", "adapted", " ", "juvenille", " ", "on", " ", 
             "na1"}], "+", 
            RowBox[{"1", " ", "patch"}]}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"M1", ",", "M1", ",", "es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
            " ", "na1"}], "+", 
           RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"nm1", "-", "2"}], "nm1"], 
             RowBox[{"r", "[", 
              RowBox[{
              "M1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
               "na2"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["2", "nm1"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"mfromlocala1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"mfromlocalm1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox["1", "nm1"], "+", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"nm1", "-", "1"}], "nm1"], 
                   RowBox[{"r", "[", 
                    RowBox[{
                    "M1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", 
                    "na2"}], "]"}]}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"mfromlocala2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "M1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"mfromlocalm2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "M1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], " ",
           "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"M1", ",", "M1", ",", "es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{"replaced", " ", "by", " ", "adapted", " ", "juvenile"}]}],
           " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"M1", ",", "M1", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to", 
           " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"M1", ",", "M1", ",", "es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"nm1", "-", "2"}], "nm1"], 
               RowBox[{"r", "[", 
                RowBox[{"M1", ",", "M1", ",", "es", ",", "na1", ",", 
                 RowBox[{"nm1", "-", "1"}], ",", 
                 RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
              RowBox[{
               FractionBox["2", "nm1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"mfromlocala1", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm1", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", 
                    RowBox[{"nm1", "-", "1"}]], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"nm1", "-", "2"}], 
                    RowBox[{"nm1", "-", "1"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"M1", ",", "M1", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocala2", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "A2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm2", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "M2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"M1", ",", "M1", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], "]"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",",
            " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"nm1", "-", "2"}], "nm1"], 
               RowBox[{"r", "[", 
                RowBox[{"M1", ",", "M1", ",", "es", ",", "na1", ",", 
                 RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["2", "nm1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"mfromlocala1", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "M1", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm1", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", 
                    RowBox[{"nm1", "-", "1"}]], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"nm1", "-", "2"}], 
                    RowBox[{"nm1", "-", "1"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"M1", ",", "M1", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                   ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocala2", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "A2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm2", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "M2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                ")"}]}]}], ")"}]}], ",", "0"}], "]"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}], ",", "na2"}], 
           "]"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",",
            "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}]}], ",", "0"}], "]"}]}], ")"}]}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na1", ",", "0", ",", 
       RowBox[{"n", "-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nm1", ",", "2", ",", 
       RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na2", ",", "0", ",", 
       RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.624302371333778*^9, 3.6243024125426188`*^9}, {
   3.6243028274912653`*^9, 3.6243029055041723`*^9}, {3.6243032547992907`*^9, 
   3.624303296552454*^9}, {3.624303439665804*^9, 3.624303469793705*^9}, {
   3.624303504597529*^9, 3.624303515626656*^9}, {3.624303953275794*^9, 
   3.624303955661152*^9}, {3.62430403571349*^9, 3.624304090734439*^9}, {
   3.624304482871949*^9, 3.624304526932238*^9}, {3.6243056584888372`*^9, 
   3.62430570335483*^9}, 3.6243058598933887`*^9, {3.624306251844326*^9, 
   3.624306258941802*^9}, 3.62430629883864*^9, {3.624306332641201*^9, 
   3.624306389842059*^9}, {3.6243071876723213`*^9, 3.624307204002542*^9}, {
   3.624340070721993*^9, 3.624340104658491*^9}, {3.624340160399*^9, 
   3.624340160625435*^9}, {3.624341285683601*^9, 3.624341285857761*^9}, {
   3.624341567202887*^9, 3.624341569656107*^9}, {3.624341876347229*^9, 
   3.62434205148129*^9}, {3.624342916533228*^9, 3.624342982335129*^9}, {
   3.624343065740284*^9, 3.624343210268524*^9}, {3.624343248999522*^9, 
   3.6243432707243023`*^9}, {3.6243433014432364`*^9, 
   3.6243433718271017`*^9}, {3.6243434581143*^9, 3.624343458965274*^9}, {
   3.624343562620357*^9, 3.6243435976830997`*^9}, {3.624343732188504*^9, 
   3.624344006726016*^9}, {3.624344126581244*^9, 3.624344199386602*^9}, {
   3.6243447499158297`*^9, 3.624344840488538*^9}, {3.6243450132092943`*^9, 
   3.624345431597501*^9}, {3.624345599240451*^9, 3.6243456481965647`*^9}, {
   3.624345934839198*^9, 3.624345936876704*^9}, {3.6243459721177387`*^9, 
   3.6243462106280823`*^9}, {3.624347591537723*^9, 3.624347755722567*^9}, {
   3.624348198007516*^9, 3.6243482179264708`*^9}, {3.6243482525398912`*^9, 
   3.624348266657654*^9}, {3.624356895198255*^9, 3.624356918300398*^9}, {
   3.6243569521886263`*^9, 3.624356985457391*^9}, {3.624362511601883*^9, 
   3.624362524663512*^9}, {3.6243629570932207`*^9, 3.624362965225898*^9}, {
   3.624362999416973*^9, 3.624363055290331*^9}, {3.624363315124364*^9, 
   3.624363402036727*^9}, {3.624363434051179*^9, 3.624363499650799*^9}, {
   3.624363548854782*^9, 3.624363555411622*^9}, {3.6243636047973747`*^9, 
   3.6243637909266777`*^9}, {3.624363821741766*^9, 3.624363941623722*^9}, {
   3.624363992340425*^9, 3.624364027986538*^9}, {3.624364249534594*^9, 
   3.6243643148423223`*^9}, {3.624364357296321*^9, 3.624364631220211*^9}, {
   3.624365338648443*^9, 3.624365353148354*^9}, {3.624365442901268*^9, 
   3.624365455749531*^9}, {3.624369677751553*^9, 3.6243697357682257`*^9}, {
   3.62438860617957*^9, 3.624388632812574*^9}, {3.624389117635973*^9, 
   3.62438913075133*^9}, {3.6244327279129763`*^9, 3.624432727932384*^9}, {
   3.624437808039003*^9, 3.62443781713133*^9}, {3.624438074407484*^9, 
   3.624438096130786*^9}, 3.624440691922516*^9, {3.624442183705776*^9, 
   3.624442185563217*^9}, {3.62444254720861*^9, 3.624442552576552*^9}, {
   3.624442594062111*^9, 3.624442596073538*^9}, {3.6244427806962223`*^9, 
   3.624442780862444*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Relatedness between maladapted juvenile and adapted adult", "Subsection",
 CellChangeTimes->{{3.62436466326877*^9, 3.6243646721393538`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rm1a2tab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{
       "M1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
       "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}], ",", "na2"}], 
           "]"}], 
          RowBox[{"r", "[", 
           RowBox[{"A1", ",", "M2", ",", "es", ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]",
          "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"r", "[", 
           RowBox[{
           "M1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
           "]"}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"nm1", "-", "1"}], "nm1"], 
               RowBox[{"r", "[", 
                RowBox[{"M1", ",", "A2", ",", "es", ",", 
                 RowBox[{"na1", "+", "1"}], ",", 
                 RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "nm1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"mfromlocala1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm1", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocala2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", "na2"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na2", "-", "1"}], "na2"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A2", ",", "A2", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                   ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm2", "[", 
                   RowBox[{"es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                ")"}]}]}], ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "death", " ", "adapted", " ", "juvenille", " ", "on", " ", 
             "na1"}], "+", 
            RowBox[{"1", " ", "patch"}]}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["1", "na2"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M1", ",", "es", ",", 
                 RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
                 RowBox[{"na2", "-", "1"}]}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"na2", "-", "1"}], "na2"], 
               RowBox[{"r", "[", 
                RowBox[{"M1", ",", "A2", ",", "es", ",", 
                 RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
                 RowBox[{"na2", "-", "1"}]}], "]"}]}]}], ")"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
            " ", "na1"}], "+", 
           RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"nm1", "-", "1"}], "nm1"], 
             RowBox[{"r", "[", 
              RowBox[{
              "M1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
               "na2"}], "]"}]}], "+", 
            RowBox[{
             FractionBox["1", "nm1"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"mfromlocala1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "A1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"mfromlocalm1", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "M1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"mfromlocala2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  FractionBox["1", "na2"], "+", 
                  RowBox[{
                   FractionBox[
                    RowBox[{"na2", "-", "1"}], "na2"], 
                   RowBox[{"r", "[", 
                    RowBox[{
                    "A2", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
                    "na2"}], "]"}]}]}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"mfromlocalm2", "[", 
                 RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
                RowBox[{"r", "[", 
                 RowBox[{
                 "M1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", 
                  "na2"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], " ",
           "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"M1", ",", "A2", ",", "es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{"replaced", " ", "by", " ", "adapted", " ", "juvenile"}]}],
           " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"M1", ",", "A2", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to", 
           " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"M1", ",", "A2", ",", "es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"nm1", "-", "1"}], "nm1"], 
               RowBox[{"r", "[", 
                RowBox[{"M1", ",", "A2", ",", "es", ",", "na1", ",", 
                 RowBox[{"nm1", "-", "1"}], ",", 
                 RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "nm1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"mfromlocala1", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm1", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "A2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocala2", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", "na2"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na2", "-", "1"}], "na2"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A2", ",", "A2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm2", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A2", ",", "M2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"M1", ",", "A2", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], "]"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",",
            " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"nm1", "-", "1"}], "nm1"], 
               RowBox[{"r", "[", 
                RowBox[{"M1", ",", "A2", ",", "es", ",", "na1", ",", 
                 RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
              RowBox[{
               FractionBox["1", "nm1"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"mfromlocala1", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A1", ",", "A2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm1", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"M1", ",", "A2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocala2", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox["1", "na2"], "+", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"na2", "-", "1"}], "na2"], 
                    RowBox[{"r", "[", 
                    RowBox[{"A2", ",", "A2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                   ")"}]}], "+", 
                 RowBox[{
                  RowBox[{"mfromlocalm2", "[", 
                   RowBox[{"es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                  RowBox[{"r", "[", 
                   RowBox[{"A2", ",", "M2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                ")"}]}]}], ")"}]}], ",", "0"}], "]"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}], ",", "na2"}], 
           "]"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",",
            "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}]}], ",", "0"}], "]"}]}], ")"}]}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na1", ",", "0", ",", 
       RowBox[{"n", "-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nm1", ",", "1", ",", 
       RowBox[{"n", "-", "na1", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na2", ",", "1", ",", 
       RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.624302371333778*^9, 3.6243024125426188`*^9}, {
   3.6243028274912653`*^9, 3.6243029055041723`*^9}, {3.6243032547992907`*^9, 
   3.624303296552454*^9}, {3.624303439665804*^9, 3.624303469793705*^9}, {
   3.624303504597529*^9, 3.624303515626656*^9}, {3.624303953275794*^9, 
   3.624303955661152*^9}, {3.62430403571349*^9, 3.624304090734439*^9}, {
   3.624304482871949*^9, 3.624304526932238*^9}, {3.6243056584888372`*^9, 
   3.62430570335483*^9}, 3.6243058598933887`*^9, {3.624306251844326*^9, 
   3.624306258941802*^9}, 3.62430629883864*^9, {3.624306332641201*^9, 
   3.624306389842059*^9}, {3.6243071876723213`*^9, 3.624307204002542*^9}, {
   3.624340070721993*^9, 3.624340104658491*^9}, {3.624340160399*^9, 
   3.624340160625435*^9}, {3.624341285683601*^9, 3.624341285857761*^9}, {
   3.624341567202887*^9, 3.624341569656107*^9}, {3.624341876347229*^9, 
   3.62434205148129*^9}, {3.624342916533228*^9, 3.624342982335129*^9}, {
   3.624343065740284*^9, 3.624343210268524*^9}, {3.624343248999522*^9, 
   3.6243432707243023`*^9}, {3.6243433014432364`*^9, 
   3.6243433718271017`*^9}, {3.6243434581143*^9, 3.624343458965274*^9}, {
   3.624343562620357*^9, 3.6243435976830997`*^9}, {3.624343732188504*^9, 
   3.624344006726016*^9}, {3.624344126581244*^9, 3.624344199386602*^9}, {
   3.6243447499158297`*^9, 3.624344840488538*^9}, {3.6243450132092943`*^9, 
   3.624345431597501*^9}, {3.624345599240451*^9, 3.6243456481965647`*^9}, {
   3.624345934839198*^9, 3.624345936876704*^9}, {3.6243459721177387`*^9, 
   3.6243462106280823`*^9}, {3.624347591537723*^9, 3.624347755722567*^9}, {
   3.624348198007516*^9, 3.6243482179264708`*^9}, {3.6243482525398912`*^9, 
   3.624348266657654*^9}, {3.624356895198255*^9, 3.624356918300398*^9}, {
   3.6243569521886263`*^9, 3.624356985457391*^9}, {3.624362511601883*^9, 
   3.624362524663512*^9}, {3.6243629570932207`*^9, 3.624362965225898*^9}, {
   3.624362999416973*^9, 3.624363055290331*^9}, {3.624363315124364*^9, 
   3.624363402036727*^9}, {3.624363434051179*^9, 3.624363499650799*^9}, {
   3.624363548854782*^9, 3.624363555411622*^9}, {3.6243636047973747`*^9, 
   3.6243637909266777`*^9}, {3.624363821741766*^9, 3.624363941623722*^9}, {
   3.624363992340425*^9, 3.624364027986538*^9}, {3.624364249534594*^9, 
   3.6243643148423223`*^9}, {3.624364357296321*^9, 3.6243647366403418`*^9}, {
   3.6243649824426937`*^9, 3.624365023268116*^9}, {3.6243650617884912`*^9, 
   3.62436509662251*^9}, {3.624365149222931*^9, 3.6243652275747147`*^9}, {
   3.624365302977343*^9, 3.624365315159102*^9}, {3.624365416099092*^9, 
   3.6243654319346437`*^9}, {3.6243654690108757`*^9, 3.624365557361085*^9}, {
   3.62436561571834*^9, 3.6243656160523243`*^9}, {3.624365661662487*^9, 
   3.624365883055266*^9}, {3.6243697587510757`*^9, 3.6243698560497713`*^9}, {
   3.624370123119791*^9, 3.6243701233152*^9}, {3.624388642122757*^9, 
   3.6243886510787897`*^9}, {3.62438947856982*^9, 3.6243894828671207`*^9}, {
   3.624432727985917*^9, 3.62443272800699*^9}, {3.624437822352302*^9, 
   3.624437831342184*^9}, {3.6244381060413446`*^9, 3.624438114157452*^9}, 
   3.62444068468431*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Relatedness between maladapted juvenile and maladapted adult\
\>", "Subsection",
 CellChangeTimes->{{3.62436466326877*^9, 3.6243646721393538`*^9}, {
  3.624366032083535*^9, 3.624366032338337*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rm1m2tab", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{
      "M1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}],
      "\[Equal]", 
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"3", "-", "es"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}], ",", "na2"}], 
          "]"}], 
         RowBox[{"r", "[", 
          RowBox[{"A1", ",", "A2", ",", "es", ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"na1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"r", "[", 
          RowBox[{
          "M1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "+", "1"}], ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"nm1", "-", "1"}], "nm1"], 
              RowBox[{"r", "[", 
               RowBox[{"M1", ",", "M2", ",", "es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
             RowBox[{
              FractionBox["1", "nm1"], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"mfromlocala1", "[", 
                  RowBox[{"es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"A1", ",", "M2", ",", "es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm1", "[", 
                  RowBox[{"es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"M1", ",", "M2", ",", "es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocala2", "[", 
                  RowBox[{"es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"A2", ",", "M2", ",", "es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm2", "[", 
                  RowBox[{"es", ",", 
                   RowBox[{"na1", "+", "1"}], ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["1", 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], "+", 
                   RowBox[{
                    FractionBox[
                    RowBox[{
                    "n", "-", "na1", "-", "nm1", "-", "na2", "-", "1"}], 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"M2", ",", "M2", ",", "es", ",", 
                    RowBox[{"na1", "+", "1"}], ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                  ")"}]}]}], ")"}]}]}], ")"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "death", " ", "adapted", " ", "juvenille", " ", "on", " ", "na1"}],
            "+", 
           RowBox[{"1", " ", "patch"}]}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M1", ",", "M2", ",", "es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
           " ", "na1"}], "+", 
          RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"nm1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
          ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"nm1", "-", "1"}], "nm1"], 
            RowBox[{"r", "[", 
             RowBox[{
             "M1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}],
              "]"}]}], "+", 
           RowBox[{
            FractionBox["1", "nm1"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"mfromlocala1", "[", 
                RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
               RowBox[{"r", "[", 
                RowBox[{
                "A1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                 "na2"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"mfromlocalm1", "[", 
                RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
               RowBox[{"r", "[", 
                RowBox[{
                "M1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                 "na2"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"mfromlocala2", "[", 
                RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
               RowBox[{"r", "[", 
                RowBox[{
                "A2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                 "na2"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"mfromlocalm2", "[", 
                RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], 
               RowBox[{"(", 
                RowBox[{
                 FractionBox["1", 
                  RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], "+", 
                 RowBox[{
                  FractionBox[
                   RowBox[{
                   "n", "-", "na1", "-", "nm1", "-", "na2", "-", "1"}], 
                   RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
                  RowBox[{"r", "[", 
                   RowBox[{
                   "M2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", 
                    "na2"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M1", ",", "M2", ",", "es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "juvenile"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"n", "-", "na1", "-", 
             RowBox[{"(", 
              RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
            "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["1", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
              RowBox[{"r", "[", 
               RowBox[{"M1", ",", "M1", ",", "es", ",", "na1", ",", 
                RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "-", "1"}], 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
              RowBox[{"r", "[", 
               RowBox[{"M1", ",", "M2", ",", "es", ",", "na1", ",", 
                RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], ")"}]}], 
          ",", "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to", 
          " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M1", ",", "M2", ",", "es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", "na1", "-", 
                RowBox[{"(", 
                 RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"nm1", "-", "1"}], "nm1"], 
              RowBox[{"r", "[", 
               RowBox[{"M1", ",", "M2", ",", "es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
             RowBox[{
              FractionBox["1", "nm1"], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"mfromlocala1", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"A1", ",", "M2", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm1", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"M1", ",", "M2", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocala2", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"A2", ",", "M2", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm2", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", 
                   RowBox[{"na2", "+", "1"}]}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["1", 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], "+", 
                   RowBox[{
                    FractionBox[
                    RowBox[{
                    "n", "-", "na1", "-", "nm1", "-", "na2", "-", "1"}], 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"M2", ",", "M2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", 
                    RowBox[{"na2", "+", "1"}]}], "]"}]}]}], ")"}]}]}], 
               ")"}]}]}], ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"(", 
              RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
             "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M1", ",", "M2", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], "]"}]}], 
          ",", "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
            ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
              "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"nm1", "-", "1"}], "nm1"], 
              RowBox[{"r", "[", 
               RowBox[{"M1", ",", "M2", ",", "es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
             RowBox[{
              FractionBox["1", "nm1"], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"mfromlocala1", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"A1", ",", "M2", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm1", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"M1", ",", "M2", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocala2", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"r", "[", 
                  RowBox[{"A2", ",", "M2", ",", "es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], "+", 
                RowBox[{
                 RowBox[{"mfromlocalm2", "[", 
                  RowBox[{"es", ",", "na1", ",", 
                   RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox["1", 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], "+", 
                   RowBox[{
                    FractionBox[
                    RowBox[{
                    "n", "-", "na1", "-", "nm1", "-", "na2", "-", "1"}], 
                    RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
                    RowBox[{"r", "[", 
                    RowBox[{"M2", ",", "M2", ",", "es", ",", "na1", ",", 
                    RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}]}], 
                  ")"}]}]}], ")"}]}]}], ")"}]}], ",", "0"}], "]"}]}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
         " ", 
         RowBox[{
         "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"3", "-", "es"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}], ",", "na2"}], 
          "]"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{"na1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "+", "1"}], ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
            ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"nm1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
          ")"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}]}], ",",
           "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"n", "-", "na1", "-", 
             RowBox[{"(", 
              RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
            "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
            "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", "na1", "-", 
                RowBox[{"(", 
                 RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",", 
          "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"(", 
              RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
             "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
            ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
              "]"}]}], ")"}]}], ",", "0"}], "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"na1", ",", "0", ",", 
      RowBox[{"n", "-", "2"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"nm1", ",", "1", ",", 
      RowBox[{"n", "-", "na1", "-", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"na2", ",", "0", ",", 
      RowBox[{"n", "-", "na1", "-", "nm1", "-", "1"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.624302371333778*^9, 3.6243024125426188`*^9}, {
   3.6243028274912653`*^9, 3.6243029055041723`*^9}, {3.6243032547992907`*^9, 
   3.624303296552454*^9}, {3.624303439665804*^9, 3.624303469793705*^9}, {
   3.624303504597529*^9, 3.624303515626656*^9}, {3.624303953275794*^9, 
   3.624303955661152*^9}, {3.62430403571349*^9, 3.624304090734439*^9}, {
   3.624304482871949*^9, 3.624304526932238*^9}, {3.6243056584888372`*^9, 
   3.62430570335483*^9}, 3.6243058598933887`*^9, {3.624306251844326*^9, 
   3.624306258941802*^9}, 3.62430629883864*^9, {3.624306332641201*^9, 
   3.624306389842059*^9}, {3.6243071876723213`*^9, 3.624307204002542*^9}, {
   3.624340070721993*^9, 3.624340104658491*^9}, {3.624340160399*^9, 
   3.624340160625435*^9}, {3.624341285683601*^9, 3.624341285857761*^9}, {
   3.624341567202887*^9, 3.624341569656107*^9}, {3.624341876347229*^9, 
   3.62434205148129*^9}, {3.624342916533228*^9, 3.624342982335129*^9}, {
   3.624343065740284*^9, 3.624343210268524*^9}, {3.624343248999522*^9, 
   3.6243432707243023`*^9}, {3.6243433014432364`*^9, 
   3.6243433718271017`*^9}, {3.6243434581143*^9, 3.624343458965274*^9}, {
   3.624343562620357*^9, 3.6243435976830997`*^9}, {3.624343732188504*^9, 
   3.624344006726016*^9}, {3.624344126581244*^9, 3.624344199386602*^9}, {
   3.6243447499158297`*^9, 3.624344840488538*^9}, {3.6243450132092943`*^9, 
   3.624345431597501*^9}, {3.624345599240451*^9, 3.6243456481965647`*^9}, {
   3.624345934839198*^9, 3.624345936876704*^9}, {3.6243459721177387`*^9, 
   3.6243462106280823`*^9}, {3.624347591537723*^9, 3.624347755722567*^9}, {
   3.624348198007516*^9, 3.6243482179264708`*^9}, {3.6243482525398912`*^9, 
   3.624348266657654*^9}, {3.624356895198255*^9, 3.624356918300398*^9}, {
   3.6243569521886263`*^9, 3.624356985457391*^9}, {3.624362511601883*^9, 
   3.624362524663512*^9}, {3.6243629570932207`*^9, 3.624362965225898*^9}, {
   3.624362999416973*^9, 3.624363055290331*^9}, {3.624363315124364*^9, 
   3.624363402036727*^9}, {3.624363434051179*^9, 3.624363499650799*^9}, {
   3.624363548854782*^9, 3.624363555411622*^9}, {3.6243636047973747`*^9, 
   3.6243637909266777`*^9}, {3.624363821741766*^9, 3.624363941623722*^9}, {
   3.624363992340425*^9, 3.624364027986538*^9}, {3.624364249534594*^9, 
   3.6243643148423223`*^9}, {3.624364357296321*^9, 3.6243647366403418`*^9}, {
   3.6243649824426937`*^9, 3.624365023268116*^9}, {3.6243650617884912`*^9, 
   3.62436509662251*^9}, {3.624365149222931*^9, 3.6243652275747147`*^9}, {
   3.624365302977343*^9, 3.624365315159102*^9}, {3.624365416099092*^9, 
   3.6243654319346437`*^9}, {3.6243654690108757`*^9, 3.624365557361085*^9}, {
   3.62436561571834*^9, 3.6243656160523243`*^9}, {3.624365661662487*^9, 
   3.624365883055266*^9}, {3.624366040363915*^9, 3.624366145705874*^9}, {
   3.6243662187414017`*^9, 3.6243664601487837`*^9}, {3.6243665656635103`*^9, 
   3.624366636837788*^9}, {3.6243666684744577`*^9, 3.6243666816067*^9}, 
   3.624366730589622*^9, {3.624369865672195*^9, 3.624369870367259*^9}, {
   3.624370015816944*^9, 3.624370026261326*^9}, {3.624370138336052*^9, 
   3.6243701976437893`*^9}, {3.624370229827815*^9, 3.624370255559862*^9}, 
   3.624370325212915*^9, {3.624371177024578*^9, 3.6243711841408033`*^9}, {
   3.624432728060793*^9, 3.62443272808348*^9}, {3.624437837711784*^9, 
   3.624437850694643*^9}, {3.624438123905273*^9, 3.624438132163286*^9}, 
   3.624440678265203*^9, 3.624441079828725*^9, {3.624441447260023*^9, 
   3.624441449162359*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   PanelBox[GridBox[{
      {
       StyleBox[
        StyleBox[
         DynamicBox[ToBoxes[
           FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
           StandardForm],
          ImageSizeCache->{515., {3., 12.}}],
         StripOnInput->False,
         DynamicUpdating->True], "Panel",
        StripOnInput->False,
        Background->None]},
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"r", "[", 
                RowBox[{
                "M1", ",", "M2", ",", "1", ",", "0", ",", "1", ",", "0"}], 
                "]"}], "\[Equal]", 
               FractionBox[
                RowBox[{
                 FractionBox[
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", "mt"}], ")"}], " ", 
                   RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                   RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                   RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], " ", 
                   
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "mt"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p21", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Q"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "p21"}], ")"}], " ", "Q"}]}], ")"}]}], 
                    "+", 
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"\[LeftSkeleton]", "2", "\[RightSkeleton]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                    ")"}]}]}], 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "mt"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p21", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Q"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "p21"}], ")"}], " ", "Q"}]}], ")"}]}], 
                    "+", 
                    RowBox[{"\[LeftSkeleton]", "2", "\[RightSkeleton]"}], "+", 
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"\[LeftSkeleton]", "2", "\[RightSkeleton]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                    ")"}]}]}]]}], ")"}]}], 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "c3"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "mt"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p21", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Q"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "p21"}], ")"}], " ", "Q"}]}], ")"}]}], 
                    "+", 
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "k"}], ")"}], " ", "mt", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Q", "+", 
                    RowBox[{"p21", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "Q"}]}], ")"}]}]}], ")"}], " ", 
                    RowBox[{"fx", "[", 
                    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}]}], "+", 
                    RowBox[{"\[LeftSkeleton]", "25", "\[RightSkeleton]"}]}], 
                    ")"}]}]}], ")"}]}]], "+", 
                 RowBox[{"\[LeftSkeleton]", "3", "\[RightSkeleton]"}], "+", 
                 FractionBox[
                  RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                  RowBox[{"1", "-", "c1"}]]}], 
                RowBox[{
                 RowBox[{"s2", " ", 
                  RowBox[{"fx", "[", 
                   RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}]}], "+", 
                 
                 FractionBox[
                  RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                  RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]], "+", 
                 
                 RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                 RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                 RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "+", 
                 RowBox[{
                  RowBox[{"fx", "[", 
                   RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    FractionBox[
                    RowBox[{
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "mt"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p21", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Q"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "p21"}], ")"}], " ", "Q"}]}], ")"}]}], 
                    "+", 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "+", 
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"\[LeftSkeleton]", "2", "\[RightSkeleton]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "Q"}], "+", 
                    RowBox[{"p21", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "Q"}]}], ")"}]}]}], ")"}], " ", 
                    RowBox[{"fx", "[", 
                    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}]}], "+", 
                    RowBox[{"\[LeftSkeleton]", "27", "\[RightSkeleton]"}], 
                    "+", 
                    FractionBox[
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]]}], 
                    ")"}]}]}], 
                    RowBox[{
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "mt"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p21", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Q"}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "p21"}], ")"}], " ", "Q"}]}], ")"}]}], 
                    "+", 
                    RowBox[{"\[LeftSkeleton]", "4", "\[RightSkeleton]"}], "+", 
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "k"}], ")"}], " ", "mt", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "Q", "+", 
                    RowBox[{"p21", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "Q"}]}], ")"}]}]}], ")"}], " ", 
                    RowBox[{"fx", "[", 
                    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}]}], "+", 
                    RowBox[{"\[LeftSkeleton]", "25", "\[RightSkeleton]"}]}], 
                    ")"}]}]}]]}], ")"}]}]}]]}], "}"}], "}"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "}"}], 
             "}"}], "}"}]}], "}"}],
         Short[#, 5]& ],
        Background->GrayLevel[1],
        BaseStyle->{Deployed -> False},
        Frame->True,
        FrameStyle->GrayLevel[0, 0.2],
        StripOnInput->False]},
      {
       RowBox[{
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
             StandardForm],
            ImageSizeCache->{89., {0., 12.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 164, 29593538780523627682, 5/2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
             StandardForm],
            ImageSizeCache->{94., {0., 12.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 164, 29593538780523627682, 5 2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
             StandardForm],
            ImageSizeCache->{151., {3., 12.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 164, 29593538780523627682, Infinity],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
             StandardForm],
            ImageSizeCache->{135., {0., 12.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>FrontEndExecute[{
            FrontEnd`SetOptions[
            FrontEnd`$FrontEnd, 
             FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
            FrontEnd`FrontEndToken["PreferencesDialog"]}],
         Evaluator->None,
         Method->"Preemptive"]}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[1.2]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    DefaultBaseStyle->{},
    FrameMargins->5],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[164]]], "Output",
 CellChangeTimes->{3.6244415029293203`*^9, 3.624442477389536*^9, 
  3.62444282838203*^9, 3.624442891113337*^9, 3.624442929054936*^9, 
  3.624549462502145*^9, 3.62456566326234*^9, 3.6248821227466*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Relatedness between pairs of adapted adults\
\>", "Subsection",
 CellChangeTimes->{{3.624366750377925*^9, 3.624366757417934*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ra2a2tab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{
       "A2", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
       "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}], ",", "na2"}], 
           "]"}], 
          RowBox[{"r", "[", 
           RowBox[{"M2", ",", "M2", ",", "es", ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]",
          "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"r", "[", 
           RowBox[{
           "A2", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
           "]"}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A2", ",", "A2", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "death", " ", "adapted", " ", "juvenille", " ", "on", " ", 
             "na1"}], "+", 
            RowBox[{"1", " ", "patch"}]}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["2", "na2"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "A2", ",", "es", ",", 
                 RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
                 RowBox[{"na2", "-", "1"}]}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"na2", "-", "2"}], "na2"], 
               RowBox[{"r", "[", 
                RowBox[{"A2", ",", "A2", ",", "es", ",", 
                 RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
                 RowBox[{"na2", "-", "1"}]}], "]"}]}]}], ")"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
            " ", "na1"}], "+", 
           RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}], 
          RowBox[{"r", "[", 
           RowBox[{
           "A2", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
           "]"}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], " ",
           "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"A2", ",", "A2", ",", "es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{"replaced", " ", "by", " ", "adapted", " ", "juvenile"}]}],
           " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"A2", ",", "A2", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to", 
           " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"A2", ",", "A2", ",", "es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A2", ",", "A2", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"A2", ",", "A2", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], "]"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",",
            " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A2", ",", "A2", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}], ",", "na2"}], 
           "]"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",",
            "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}]}], ",", "0"}], "]"}]}], ")"}]}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na1", ",", "0", ",", 
       RowBox[{"n", "-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nm1", ",", "0", ",", 
       RowBox[{"n", "-", "na1", "-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na2", ",", "2", ",", 
       RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.624302371333778*^9, 3.6243024125426188`*^9}, {
   3.6243028274912653`*^9, 3.6243029055041723`*^9}, {3.6243032547992907`*^9, 
   3.624303296552454*^9}, {3.624303439665804*^9, 3.624303469793705*^9}, {
   3.624303504597529*^9, 3.624303515626656*^9}, {3.624303953275794*^9, 
   3.624303955661152*^9}, {3.62430403571349*^9, 3.624304090734439*^9}, {
   3.624304482871949*^9, 3.624304526932238*^9}, {3.6243056584888372`*^9, 
   3.62430570335483*^9}, 3.6243058598933887`*^9, {3.624306251844326*^9, 
   3.624306258941802*^9}, 3.62430629883864*^9, {3.624306332641201*^9, 
   3.624306389842059*^9}, {3.6243071876723213`*^9, 3.624307204002542*^9}, {
   3.624340070721993*^9, 3.624340104658491*^9}, {3.624340160399*^9, 
   3.624340160625435*^9}, {3.624341285683601*^9, 3.624341285857761*^9}, {
   3.624341567202887*^9, 3.624341569656107*^9}, {3.624341876347229*^9, 
   3.62434205148129*^9}, {3.624342916533228*^9, 3.624342982335129*^9}, {
   3.624343065740284*^9, 3.624343210268524*^9}, {3.624343248999522*^9, 
   3.6243432707243023`*^9}, {3.6243433014432364`*^9, 
   3.6243433718271017`*^9}, {3.6243434581143*^9, 3.624343458965274*^9}, {
   3.624343562620357*^9, 3.6243435976830997`*^9}, {3.624343732188504*^9, 
   3.624344006726016*^9}, {3.624344126581244*^9, 3.624344199386602*^9}, {
   3.6243447499158297`*^9, 3.624344840488538*^9}, {3.6243450132092943`*^9, 
   3.624345431597501*^9}, {3.624345599240451*^9, 3.6243456481965647`*^9}, {
   3.624345934839198*^9, 3.624345936876704*^9}, {3.6243459721177387`*^9, 
   3.6243462106280823`*^9}, {3.624347591537723*^9, 3.624347755722567*^9}, {
   3.624348198007516*^9, 3.6243482179264708`*^9}, {3.6243482525398912`*^9, 
   3.624348266657654*^9}, {3.624356895198255*^9, 3.624356918300398*^9}, {
   3.6243569521886263`*^9, 3.624356985457391*^9}, {3.624362511601883*^9, 
   3.624362524663512*^9}, {3.6243629570932207`*^9, 3.624362965225898*^9}, {
   3.624362999416973*^9, 3.624363055290331*^9}, {3.624363315124364*^9, 
   3.624363402036727*^9}, {3.624363434051179*^9, 3.624363499650799*^9}, {
   3.624363548854782*^9, 3.624363555411622*^9}, {3.6243636047973747`*^9, 
   3.6243637909266777`*^9}, {3.624363821741766*^9, 3.624363941623722*^9}, {
   3.624363992340425*^9, 3.624364027986538*^9}, {3.624364249534594*^9, 
   3.6243643148423223`*^9}, {3.624364357296321*^9, 3.6243647366403418`*^9}, {
   3.6243649824426937`*^9, 3.624365023268116*^9}, {3.6243650617884912`*^9, 
   3.62436509662251*^9}, {3.624365149222931*^9, 3.6243652275747147`*^9}, {
   3.624365302977343*^9, 3.624365315159102*^9}, {3.624365416099092*^9, 
   3.6243654319346437`*^9}, {3.6243654690108757`*^9, 3.624365557361085*^9}, {
   3.62436561571834*^9, 3.6243656160523243`*^9}, {3.624365661662487*^9, 
   3.624365883055266*^9}, {3.624366040363915*^9, 3.624366145705874*^9}, {
   3.6243662187414017`*^9, 3.6243664601487837`*^9}, {3.6243665656635103`*^9, 
   3.624366636837788*^9}, {3.6243666684744577`*^9, 3.6243666816067*^9}, 
   3.624366730589622*^9, {3.624366806271656*^9, 3.62436682995068*^9}, {
   3.624366860346286*^9, 3.62436686068569*^9}, {3.624366891052558*^9, 
   3.624367016358869*^9}, {3.624367058197258*^9, 3.6243670685455236`*^9}, {
   3.624367319326849*^9, 3.6243674237340403`*^9}, {3.624367468866968*^9, 
   3.624367491357793*^9}, {3.6243698837764683`*^9, 3.62436988661445*^9}, {
   3.624369933887477*^9, 3.624369941090639*^9}, 3.6243699862121353`*^9, {
   3.62437033507699*^9, 3.624370341351859*^9}, {3.624371060006216*^9, 
   3.6243710601681147`*^9}, {3.6243899762662697`*^9, 3.624389978816779*^9}, {
   3.624432728148259*^9, 3.624432728171398*^9}, {3.6244378554516783`*^9, 
   3.62443786944536*^9}, {3.624438142953017*^9, 3.624438149715048*^9}, 
   3.624440658097075*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Relatedness between adapted and maladapted adults", "Subsection",
 CellChangeTimes->{{3.624366750377925*^9, 3.624366757417934*^9}, {
  3.6243675089734163`*^9, 3.624367515533433*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ra2m2tab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{
       "A2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
       "]"}], "\[Equal]", 
      RowBox[{
       RowBox[{"(", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}], ",", "na2"}], 
           "]"}], 
          RowBox[{"r", "[", 
           RowBox[{"A2", ",", "M2", ",", "es", ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]",
          "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"r", "[", 
           RowBox[{
           "A2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
           "]"}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A2", ",", "M2", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
            "death", " ", "adapted", " ", "juvenille", " ", "on", " ", 
             "na1"}], "+", 
            RowBox[{"1", " ", "patch"}]}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["1", "na2"], 
               RowBox[{"r", "[", 
                RowBox[{"A1", ",", "M2", ",", "es", ",", 
                 RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
                 RowBox[{"na2", "-", "1"}]}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"na2", "-", "1"}], "na2"], 
               RowBox[{"r", "[", 
                RowBox[{"A2", ",", "M2", ",", "es", ",", 
                 RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
                 RowBox[{"na2", "-", "1"}]}], "]"}]}]}], ")"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
            " ", "na1"}], "+", 
           RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}], 
          RowBox[{"r", "[", 
           RowBox[{
           "A2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
           "]"}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], " ",
           "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"A2", ",", "M2", ",", "es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
           RowBox[{"replaced", " ", "by", " ", "adapted", " ", "juvenile"}]}],
           " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox["1", "nm1"], 
               RowBox[{"r", "[", 
                RowBox[{"M1", ",", "A2", ",", "es", ",", "na1", ",", 
                 RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"nm1", "-", "1"}], "nm1"], 
               RowBox[{"r", "[", 
                RowBox[{"A2", ",", "M2", ",", "es", ",", "na1", ",", 
                 RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], ")"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to", 
           " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"A2", ",", "M2", ",", "es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A2", ",", "M2", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
           " ", 
           RowBox[{
           "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], 
          " ", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"r", "[", 
             RowBox[{"A2", ",", "M2", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], "]"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",",
            " ", 
           RowBox[{
           "replaced", " ", "by", " ", "adapted", " ", "offspring"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}], 
            RowBox[{"r", "[", 
             RowBox[{"A2", ",", "M2", ",", "es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"3", "-", "es"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{
            RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
            RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}], ",", "na2"}], 
           "]"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"na1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"ap", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
         "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", 
                RowBox[{"na1", "+", "1"}], ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
             ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "-", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", " ", 
         RowBox[{"nm1", " ", 
          RowBox[{"d", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
          RowBox[{"f", "[", 
           RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
           ")"}]}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}]}], 
           ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
             "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nm1", "+", "1"}], ")"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
             "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
          "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"na2", "+", "1"}], ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", 
              RowBox[{"na2", "+", "1"}], ",", 
              RowBox[{"n", "-", "na1", "-", 
               RowBox[{"(", 
                RowBox[{"nm1", "-", "1"}], ")"}], "-", 
               RowBox[{"(", 
                RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", 
                RowBox[{"na2", "+", "1"}], ",", 
                RowBox[{"n", "-", "na1", "-", 
                 RowBox[{"(", 
                  RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                 RowBox[{"(", 
                  RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",",
            "0"}], "]"}], "\[IndentingNewLine]", "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], " ", 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}], 
            RowBox[{"ap", "[", 
             RowBox[{"es", ",", 
              RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
              RowBox[{"n", "-", 
               RowBox[{"(", 
                RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+",
                "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", 
         "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
              ")"}], "\[LessEqual]", "n"}], "&&", 
            RowBox[{
             RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], 
            RowBox[{"d", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
            RowBox[{"f", "[", 
             RowBox[{"es", ",", "na1", ",", 
              RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
              RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
             "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"ap", "[", 
               RowBox[{"es", ",", "na1", ",", 
                RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
                RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}],
                "]"}]}], ")"}]}], ",", "0"}], "]"}]}], ")"}]}]}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na1", ",", "0", ",", 
       RowBox[{"n", "-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nm1", ",", "0", ",", 
       RowBox[{"n", "-", "na1", "-", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na2", ",", "1", ",", 
       RowBox[{"n", "-", "na1", "-", "nm1", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.624302371333778*^9, 3.6243024125426188`*^9}, {
   3.6243028274912653`*^9, 3.6243029055041723`*^9}, {3.6243032547992907`*^9, 
   3.624303296552454*^9}, {3.624303439665804*^9, 3.624303469793705*^9}, {
   3.624303504597529*^9, 3.624303515626656*^9}, {3.624303953275794*^9, 
   3.624303955661152*^9}, {3.62430403571349*^9, 3.624304090734439*^9}, {
   3.624304482871949*^9, 3.624304526932238*^9}, {3.6243056584888372`*^9, 
   3.62430570335483*^9}, 3.6243058598933887`*^9, {3.624306251844326*^9, 
   3.624306258941802*^9}, 3.62430629883864*^9, {3.624306332641201*^9, 
   3.624306389842059*^9}, {3.6243071876723213`*^9, 3.624307204002542*^9}, {
   3.624340070721993*^9, 3.624340104658491*^9}, {3.624340160399*^9, 
   3.624340160625435*^9}, {3.624341285683601*^9, 3.624341285857761*^9}, {
   3.624341567202887*^9, 3.624341569656107*^9}, {3.624341876347229*^9, 
   3.62434205148129*^9}, {3.624342916533228*^9, 3.624342982335129*^9}, {
   3.624343065740284*^9, 3.624343210268524*^9}, {3.624343248999522*^9, 
   3.6243432707243023`*^9}, {3.6243433014432364`*^9, 
   3.6243433718271017`*^9}, {3.6243434581143*^9, 3.624343458965274*^9}, {
   3.624343562620357*^9, 3.6243435976830997`*^9}, {3.624343732188504*^9, 
   3.624344006726016*^9}, {3.624344126581244*^9, 3.624344199386602*^9}, {
   3.6243447499158297`*^9, 3.624344840488538*^9}, {3.6243450132092943`*^9, 
   3.624345431597501*^9}, {3.624345599240451*^9, 3.6243456481965647`*^9}, {
   3.624345934839198*^9, 3.624345936876704*^9}, {3.6243459721177387`*^9, 
   3.6243462106280823`*^9}, {3.624347591537723*^9, 3.624347755722567*^9}, {
   3.624348198007516*^9, 3.6243482179264708`*^9}, {3.6243482525398912`*^9, 
   3.624348266657654*^9}, {3.624356895198255*^9, 3.624356918300398*^9}, {
   3.6243569521886263`*^9, 3.624356985457391*^9}, {3.624362511601883*^9, 
   3.624362524663512*^9}, {3.6243629570932207`*^9, 3.624362965225898*^9}, {
   3.624362999416973*^9, 3.624363055290331*^9}, {3.624363315124364*^9, 
   3.624363402036727*^9}, {3.624363434051179*^9, 3.624363499650799*^9}, {
   3.624363548854782*^9, 3.624363555411622*^9}, {3.6243636047973747`*^9, 
   3.6243637909266777`*^9}, {3.624363821741766*^9, 3.624363941623722*^9}, {
   3.624363992340425*^9, 3.624364027986538*^9}, {3.624364249534594*^9, 
   3.6243643148423223`*^9}, {3.624364357296321*^9, 3.6243647366403418`*^9}, {
   3.6243649824426937`*^9, 3.624365023268116*^9}, {3.6243650617884912`*^9, 
   3.62436509662251*^9}, {3.624365149222931*^9, 3.6243652275747147`*^9}, {
   3.624365302977343*^9, 3.624365315159102*^9}, {3.624365416099092*^9, 
   3.6243654319346437`*^9}, {3.6243654690108757`*^9, 3.624365557361085*^9}, {
   3.62436561571834*^9, 3.6243656160523243`*^9}, {3.624365661662487*^9, 
   3.624365883055266*^9}, {3.624366040363915*^9, 3.624366145705874*^9}, {
   3.6243662187414017`*^9, 3.6243664601487837`*^9}, {3.6243665656635103`*^9, 
   3.624366636837788*^9}, {3.6243666684744577`*^9, 3.6243666816067*^9}, 
   3.624366730589622*^9, {3.624366806271656*^9, 3.62436682995068*^9}, {
   3.624366860346286*^9, 3.62436686068569*^9}, {3.624366891052558*^9, 
   3.624367016358869*^9}, {3.624367058197258*^9, 3.6243670685455236`*^9}, {
   3.624367319326849*^9, 3.6243674237340403`*^9}, {3.624367468866968*^9, 
   3.624367491357793*^9}, {3.62436752239821*^9, 3.624367564740653*^9}, {
   3.62436766491252*^9, 3.62436780891978*^9}, {3.6243680226060762`*^9, 
   3.6243680266060343`*^9}, {3.624369893262966*^9, 3.624369906878747*^9}, 
   3.624369990637166*^9, {3.624370362129159*^9, 3.624370368468684*^9}, {
   3.624370501546947*^9, 3.624370501698689*^9}, {3.624370957233049*^9, 
   3.624370982017206*^9}, {3.624432728229265*^9, 3.6244327282534237`*^9}, {
   3.624437908119981*^9, 3.624437919258357*^9}, {3.624438159288291*^9, 
   3.624438166326436*^9}, 3.624440482842327*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Relatedness between pairs of maladapted adults\
\>", "Subsection",
 CellChangeTimes->{{3.624366750377925*^9, 3.624366757417934*^9}, {
  3.6243675089734163`*^9, 3.624367515533433*^9}, {3.624367832850853*^9, 
  3.624367862634791*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rm2m2tab", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{
      "M2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}],
      "\[Equal]", 
     RowBox[{
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"3", "-", "es"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}], ",", "na2"}], 
          "]"}], 
         RowBox[{"r", "[", 
          RowBox[{"A2", ",", "A2", ",", "es", ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"na1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"r", "[", 
          RowBox[{
          "M2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "adapted", " ", "juvenille"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "+", "1"}], ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
            ")"}], 
           RowBox[{"r", "[", 
            RowBox[{"M2", ",", "M2", ",", 
             RowBox[{"na1", "+", "1"}], ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
           "death", " ", "adapted", " ", "juvenille", " ", "on", " ", "na1"}],
            "+", 
           RowBox[{"1", " ", "patch"}]}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M2", ",", "M2", ",", "es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "ageing", " ", "of", " ", "adapted", " ", "juvenile", " ", "in", 
           " ", "na1"}], "+", 
          RowBox[{"1", " ", "patch", " ", "to", " ", "adulthood"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"nm1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
          ")"}], 
         RowBox[{"r", "[", 
          RowBox[{
          "M2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "juvenile"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M2", ",", "M2", ",", "es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "maladapted", " ", "juvenile"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "juvenile"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"n", "-", "na1", "-", 
             RowBox[{"(", 
              RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
            "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox["2", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
              RowBox[{"r", "[", 
               RowBox[{"M1", ",", "M2", ",", "es", ",", "na1", ",", 
                RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "-", "2"}], 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]], 
              RowBox[{"r", "[", 
               RowBox[{"M2", ",", "M2", ",", "es", ",", "na1", ",", 
                RowBox[{"nm1", "+", "1"}], ",", "na2"}], "]"}]}]}], ")"}]}], 
          ",", "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "ageing", " ", "of", " ", "maladapted", " ", "juvenile", " ", "to", 
          " ", "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M2", ",", "M2", ",", "es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", "na1", "-", 
                RowBox[{"(", 
                 RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}], 
           RowBox[{"r", "[", 
            RowBox[{"M2", ",", "M2", ",", "es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", 
             RowBox[{"na2", "+", "1"}]}], "]"}]}], ",", "0"}], "]"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "adapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"(", 
              RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
             "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"r", "[", 
            RowBox[{"M2", ",", "M2", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2"}], "]"}]}], 
          ",", "0"}], "]"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
          " ", 
          RowBox[{"replaced", " ", "by", " ", "adapted", " ", "offspring"}]}],
          " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
            ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
              "]"}]}], ")"}], 
           RowBox[{"r", "[", 
            RowBox[{"M2", ",", "M2", ",", "es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2"}], "]"}]}], ",", "0"}], 
         "]"}]}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"death", " ", "of", " ", "maladapted", " ", "adult"}], ",", 
         " ", 
         RowBox[{
         "replaced", " ", "by", " ", "maladapted", " ", "offspring"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", 
          RowBox[{"3", "-", "es"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{
           RowBox[{"3", "-", "es"}], ",", "nm1", ",", "na1", ",", 
           RowBox[{"n", "-", "nm1", "-", "na1", "-", "na2"}], ",", "na2"}], 
          "]"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{"na1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"ap", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", 
               RowBox[{"na1", "+", "1"}], ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
            ")"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na2", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "+", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "-", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "+", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "-", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", "+", " ", 
        RowBox[{"nm1", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"f", "[", 
          RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
           RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}]}], 
          ")"}]}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2"}]}], "]"}]}], ",",
           "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"nm1", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"n", "-", "na1", "-", 
             RowBox[{"(", 
              RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}], 
            "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nm1", "+", "1"}], ")"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "+", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "+", "1"}], ")"}], "-", "na2", "-", "1"}]}], 
            "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ",", "0"}], 
         "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"na2", "+", "1"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"na2", "+", "1"}], ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", 
             RowBox[{"na2", "+", "1"}], ",", 
             RowBox[{"n", "-", "na1", "-", 
              RowBox[{"(", 
               RowBox[{"nm1", "-", "1"}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", 
               RowBox[{"na2", "+", "1"}], ",", 
               RowBox[{"n", "-", "na1", "-", 
                RowBox[{"(", 
                 RowBox[{"nm1", "-", "1"}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{"na2", "+", "1"}], ")"}]}]}], "]"}]}], ")"}]}], ",", 
          "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}], ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"na1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", 
             RowBox[{"(", 
              RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
             "1"}], ")"}], " ", 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}], 
           RowBox[{"ap", "[", 
            RowBox[{"es", ",", 
             RowBox[{"na1", "-", "1"}], ",", "nm1", ",", "na2", ",", 
             RowBox[{"n", "-", 
              RowBox[{"(", 
               RowBox[{"na1", "-", "1"}], ")"}], "-", "nm1", "-", "na2", "+", 
              "1"}]}], "]"}]}], ",", "0"}], "]"}], "\[IndentingNewLine]", "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
             ")"}], "\[LessEqual]", "n"}], "&&", 
           RowBox[{
            RowBox[{"nm1", "-", "1"}], "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}], 
            ")"}], 
           RowBox[{"d", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
           RowBox[{"f", "[", 
            RowBox[{"es", ",", "na1", ",", 
             RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
             RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
            "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"ap", "[", 
              RowBox[{"es", ",", "na1", ",", 
               RowBox[{"nm1", "-", "1"}], ",", "na2", ",", 
               RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2", "+", "1"}]}], 
              "]"}]}], ")"}]}], ",", "0"}], "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"na1", ",", "0", ",", 
      RowBox[{"n", "-", "2"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"nm1", ",", "0", ",", 
      RowBox[{"n", "-", "na1", "-", "2"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"na2", ",", "0", ",", 
      RowBox[{"n", "-", "na1", "-", "nm1", "-", "2"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.624302371333778*^9, 3.6243024125426188`*^9}, {
   3.6243028274912653`*^9, 3.6243029055041723`*^9}, {3.6243032547992907`*^9, 
   3.624303296552454*^9}, {3.624303439665804*^9, 3.624303469793705*^9}, {
   3.624303504597529*^9, 3.624303515626656*^9}, {3.624303953275794*^9, 
   3.624303955661152*^9}, {3.62430403571349*^9, 3.624304090734439*^9}, {
   3.624304482871949*^9, 3.624304526932238*^9}, {3.6243056584888372`*^9, 
   3.62430570335483*^9}, 3.6243058598933887`*^9, {3.624306251844326*^9, 
   3.624306258941802*^9}, 3.62430629883864*^9, {3.624306332641201*^9, 
   3.624306389842059*^9}, {3.6243071876723213`*^9, 3.624307204002542*^9}, {
   3.624340070721993*^9, 3.624340104658491*^9}, {3.624340160399*^9, 
   3.624340160625435*^9}, {3.624341285683601*^9, 3.624341285857761*^9}, {
   3.624341567202887*^9, 3.624341569656107*^9}, {3.624341876347229*^9, 
   3.62434205148129*^9}, {3.624342916533228*^9, 3.624342982335129*^9}, {
   3.624343065740284*^9, 3.624343210268524*^9}, {3.624343248999522*^9, 
   3.6243432707243023`*^9}, {3.6243433014432364`*^9, 
   3.6243433718271017`*^9}, {3.6243434581143*^9, 3.624343458965274*^9}, {
   3.624343562620357*^9, 3.6243435976830997`*^9}, {3.624343732188504*^9, 
   3.624344006726016*^9}, {3.624344126581244*^9, 3.624344199386602*^9}, {
   3.6243447499158297`*^9, 3.624344840488538*^9}, {3.6243450132092943`*^9, 
   3.624345431597501*^9}, {3.624345599240451*^9, 3.6243456481965647`*^9}, {
   3.624345934839198*^9, 3.624345936876704*^9}, {3.6243459721177387`*^9, 
   3.6243462106280823`*^9}, {3.624347591537723*^9, 3.624347755722567*^9}, {
   3.624348198007516*^9, 3.6243482179264708`*^9}, {3.6243482525398912`*^9, 
   3.624348266657654*^9}, {3.624356895198255*^9, 3.624356918300398*^9}, {
   3.6243569521886263`*^9, 3.624356985457391*^9}, {3.624362511601883*^9, 
   3.624362524663512*^9}, {3.6243629570932207`*^9, 3.624362965225898*^9}, {
   3.624362999416973*^9, 3.624363055290331*^9}, {3.624363315124364*^9, 
   3.624363402036727*^9}, {3.624363434051179*^9, 3.624363499650799*^9}, {
   3.624363548854782*^9, 3.624363555411622*^9}, {3.6243636047973747`*^9, 
   3.6243637909266777`*^9}, {3.624363821741766*^9, 3.624363941623722*^9}, {
   3.624363992340425*^9, 3.624364027986538*^9}, {3.624364249534594*^9, 
   3.6243643148423223`*^9}, {3.624364357296321*^9, 3.6243647366403418`*^9}, {
   3.6243649824426937`*^9, 3.624365023268116*^9}, {3.6243650617884912`*^9, 
   3.62436509662251*^9}, {3.624365149222931*^9, 3.6243652275747147`*^9}, {
   3.624365302977343*^9, 3.624365315159102*^9}, {3.624365416099092*^9, 
   3.6243654319346437`*^9}, {3.6243654690108757`*^9, 3.624365557361085*^9}, {
   3.62436561571834*^9, 3.6243656160523243`*^9}, {3.624365661662487*^9, 
   3.624365883055266*^9}, {3.624366040363915*^9, 3.624366145705874*^9}, {
   3.6243662187414017`*^9, 3.6243664601487837`*^9}, {3.6243665656635103`*^9, 
   3.624366636837788*^9}, {3.6243666684744577`*^9, 3.6243666816067*^9}, 
   3.624366730589622*^9, {3.624366806271656*^9, 3.62436682995068*^9}, {
   3.624366860346286*^9, 3.62436686068569*^9}, {3.624366891052558*^9, 
   3.624367016358869*^9}, {3.624367058197258*^9, 3.6243670685455236`*^9}, {
   3.624367319326849*^9, 3.6243674237340403`*^9}, {3.624367468866968*^9, 
   3.624367491357793*^9}, {3.62436752239821*^9, 3.624367564740653*^9}, {
   3.62436766491252*^9, 3.62436780891978*^9}, {3.624367844664619*^9, 
   3.624368014320919*^9}, {3.624370380333418*^9, 3.624370416815949*^9}, {
   3.624370493810389*^9, 3.624370495641165*^9}, {3.6243705748748713`*^9, 
   3.6243706202847567`*^9}, {3.624370733617723*^9, 3.624370735766616*^9}, {
   3.624370821605482*^9, 3.624370863566844*^9}, 3.624370905785492*^9, {
   3.624432728312928*^9, 3.624432728337119*^9}, {3.624437946828423*^9, 
   3.6244379579140778`*^9}, {3.624438173173868*^9, 3.624438177613153*^9}, 
   3.624440331622452*^9, 3.6244404258571*^9, {3.624440464134947*^9, 
   3.624440474991559*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"M2", ",", "M2", ",", "1", ",", "0", ",", "0", ",", "0"}], 
        "]"}], "\[Equal]", 
       FractionBox[
        RowBox[{
         RowBox[{"s2", " ", 
          RowBox[{"fx", "[", 
           RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], " ", 
          RowBox[{"r", "[", 
           RowBox[{"A2", ",", "A2", ",", "1", ",", "0", ",", "0", ",", "2"}], 
           "]"}]}], "+", 
         RowBox[{
          RowBox[{"fx", "[", 
           RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], " ", 
          RowBox[{"r", "[", 
           RowBox[{"M1", ",", "M2", ",", "1", ",", "0", ",", "1", ",", "0"}], 
           "]"}]}]}], 
        RowBox[{
         RowBox[{"fx", "[", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], "+", 
         RowBox[{"s2", " ", 
          RowBox[{"fx", "[", 
           RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}]}]}]]}], "}"}], 
     "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"M2", ",", "M2", ",", "2", ",", "0", ",", "0", ",", "0"}], 
        "]"}], "\[Equal]", 
       FractionBox[
        RowBox[{
         RowBox[{"s1", " ", 
          RowBox[{"fx", "[", 
           RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], " ", 
          RowBox[{"r", "[", 
           RowBox[{"A2", ",", "A2", ",", "2", ",", "0", ",", "0", ",", "2"}], 
           "]"}]}], "+", 
         RowBox[{
          RowBox[{"fx", "[", 
           RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], " ", 
          RowBox[{"r", "[", 
           RowBox[{"M1", ",", "M2", ",", "2", ",", "0", ",", "1", ",", "0"}], 
           "]"}]}]}], 
        RowBox[{
         RowBox[{"s1", " ", 
          RowBox[{"fx", "[", 
           RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}]}], "+", 
         RowBox[{"fx", "[", 
          RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}]}]]}], "}"}], 
     "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.624440332231282*^9, 3.624440435152397*^9, {3.6244404667103662`*^9, 
   3.62444047590565*^9}, 3.624440747632844*^9, {3.624441485747401*^9, 
   3.6244415031368933`*^9}, 3.6244424776321783`*^9, 3.624442828594287*^9, 
   3.6244428912737226`*^9, 3.624442929285716*^9, 3.624549462720807*^9, 
   3.624565663458638*^9, 3.624882122928978*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Evaluation of all coefficients", "Subsection",
 CellChangeTimes->{{3.616139737071217*^9, 3.6161397424071302`*^9}, {
  3.6161593499170237`*^9, 3.616159350179462*^9}}],

Cell["\<\
Some auxiliary tables for numerically solving\
\>", "Text",
 CellChangeTimes->{{3.593445646381062*^9, 3.5934456563973103`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"reltab", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
     "ra1a1tab", ",", "ra1m1tab", ",", "ra1a2tab", ",", "ra1m2tab", ",", 
      "rm1m1tab", ",", "rm1a2tab", ",", "rm1m2tab", ",", "ra2a2tab", ",", 
      "ra2m2tab", ",", "rm2m2tab"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reltab0", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "-", 
      RowBox[{"x", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "reltab"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"relvals", "=", 
  RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{
        "A1", ",", "A1", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na1", ",", "2", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nm1", ",", "0", ",", 
         RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na2", ",", "0", ",", 
         RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{
        "A1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na1", ",", "1", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nm1", ",", "1", ",", 
         RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na2", ",", "0", ",", 
         RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{
        "A1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na1", ",", "1", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nm1", ",", "0", ",", 
         RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na2", ",", "1", ",", 
         RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{
        "A1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na1", ",", "1", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nm1", ",", "0", ",", 
         RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na2", ",", "0", ",", 
         RowBox[{"n", "-", "na1", "-", "nm1", "-", "1"}]}], "}"}]}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{
        "M1", ",", "M1", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na1", ",", "0", ",", 
         RowBox[{"n", "-", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nm1", ",", "2", ",", 
         RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na2", ",", "0", ",", 
         RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{
        "M1", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na1", ",", "0", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nm1", ",", "1", ",", 
         RowBox[{"n", "-", "na1", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na2", ",", "1", ",", 
         RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{
        "M1", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na1", ",", "0", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nm1", ",", "1", ",", 
         RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na2", ",", "0", ",", 
         RowBox[{"n", "-", "na1", "-", "nm1", "-", "1"}]}], "}"}]}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{
        "A2", ",", "A2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na1", ",", "0", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nm1", ",", "0", ",", 
         RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na2", ",", "2", ",", 
         RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{
        "A2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na1", ",", "0", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nm1", ",", "0", ",", 
         RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na2", ",", "1", ",", 
         RowBox[{"n", "-", "na1", "-", "nm1", "-", "1"}]}], "}"}]}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{
        "M2", ",", "M2", ",", "es", ",", "na1", ",", "nm1", ",", "na2"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na1", ",", "0", ",", 
         RowBox[{"n", "-", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"nm1", ",", "0", ",", 
         RowBox[{"n", "-", "na1", "-", "2"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"na2", ",", "0", ",", 
         RowBox[{"n", "-", "na1", "-", "nm1", "-", "2"}]}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.501836992729465*^9, 3.501836995095668*^9}, {
   3.501837797482402*^9, 3.501837821375182*^9}, {3.5051971853745937`*^9, 
   3.505197201715537*^9}, {3.505197232487157*^9, 3.505197243327004*^9}, {
   3.505211434509547*^9, 3.505211521752357*^9}, {3.505211556992576*^9, 
   3.505211568382031*^9}, {3.505211620703909*^9, 3.505211623282103*^9}, {
   3.505211706901904*^9, 3.505211718029876*^9}, 3.505302284780422*^9, {
   3.520421215472803*^9, 3.520421228578953*^9}, {3.520421328940182*^9, 
   3.52042133038615*^9}, {3.520421436390558*^9, 3.520421459204155*^9}, {
   3.608650391024482*^9, 3.608650470439294*^9}, {3.608650540812324*^9, 
   3.608650601014215*^9}, 3.6086516365764523`*^9, {3.608723862225259*^9, 
   3.6087238794758673`*^9}, {3.60881987921003*^9, 3.608819879831455*^9}, {
   3.6158926191850643`*^9, 3.6158926373077173`*^9}, {3.6158929418051243`*^9, 
   3.6158929586323643`*^9}, {3.615893014183621*^9, 3.615893034050313*^9}, {
   3.6158931202938833`*^9, 3.6158931522050247`*^9}, {3.615897323144853*^9, 
   3.615897361893403*^9}, {3.615897418735423*^9, 3.615897535239332*^9}, {
   3.6158977659410067`*^9, 3.615897835875355*^9}, {3.6243684348936033`*^9, 
   3.624368511593505*^9}, 3.6243717983451643`*^9, {3.624371846742038*^9, 
   3.624371867036409*^9}, {3.6243797637184763`*^9, 3.624379855412066*^9}, {
   3.624379896845821*^9, 3.624379903578467*^9}, {3.624380056925758*^9, 
   3.624380083785627*^9}, {3.624380117794963*^9, 3.624380121387889*^9}, {
   3.624380153791506*^9, 3.624380168162139*^9}, {3.624380429363399*^9, 
   3.6243804784933434`*^9}, {3.624381301881241*^9, 3.624381312822373*^9}, {
   3.6243816039003468`*^9, 3.624381614296015*^9}, {3.6243878253522377`*^9, 
   3.624387828834114*^9}, {3.62438790136197*^9, 3.624388029074975*^9}, {
   3.624388111084269*^9, 3.624388123791504*^9}, {3.624436772586175*^9, 
   3.6244367795964127`*^9}, {3.6244424695752277`*^9, 3.624442469773919*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "A1", ",", "1", ",", "2", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "A1", ",", "2", ",", "2", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "M1", ",", "1", ",", "1", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "M1", ",", "2", ",", "1", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "A2", ",", "1", ",", "1", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "A2", ",", "2", ",", "1", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "M2", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "M2", ",", "2", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "M1", ",", "1", ",", "0", ",", "2", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "M1", ",", "2", ",", "0", ",", "2", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "A2", ",", "1", ",", "0", ",", "1", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "A2", ",", "2", ",", "0", ",", "1", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "M2", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "M2", ",", "2", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A2", ",", "A2", ",", "1", ",", "0", ",", "0", ",", "2"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A2", ",", "A2", ",", "2", ",", "0", ",", "0", ",", "2"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A2", ",", "M2", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A2", ",", "M2", ",", "2", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M2", ",", "M2", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M2", ",", "M2", ",", "2", ",", "0", ",", "0", ",", "0"}], 
    "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.624442477751951*^9, 3.624442828690686*^9, 
  3.6244428913495293`*^9, 3.624442929358919*^9, 3.624549462989615*^9, 
  3.624565663734779*^9, 3.624882122990947*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"relstartvals", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"xi", ",", ".1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"xi", ",", "relvals"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6087097064519157`*^9, 3.6087097568613787`*^9}, {
  3.61589473079711*^9, 3.615894731065981*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"A1", ",", "A1", ",", "1", ",", "2", ",", "0", ",", "0"}], 
      "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"A1", ",", "A1", ",", "2", ",", "2", ",", "0", ",", "0"}], 
      "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"A1", ",", "M1", ",", "1", ",", "1", ",", "1", ",", "0"}], 
      "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"A1", ",", "M1", ",", "2", ",", "1", ",", "1", ",", "0"}], 
      "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"A1", ",", "A2", ",", "1", ",", "1", ",", "0", ",", "1"}], 
      "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"A1", ",", "A2", ",", "2", ",", "1", ",", "0", ",", "1"}], 
      "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"A1", ",", "M2", ",", "1", ",", "1", ",", "0", ",", "0"}], 
      "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"A1", ",", "M2", ",", "2", ",", "1", ",", "0", ",", "0"}], 
      "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"M1", ",", "M1", ",", "1", ",", "0", ",", "2", ",", "0"}], 
      "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"M1", ",", "M1", ",", "2", ",", "0", ",", "2", ",", "0"}], 
      "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"M1", ",", "A2", ",", "1", ",", "0", ",", "1", ",", "1"}], 
      "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"M1", ",", "A2", ",", "2", ",", "0", ",", "1", ",", "1"}], 
      "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"M1", ",", "M2", ",", "1", ",", "0", ",", "1", ",", "0"}], 
      "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"M1", ",", "M2", ",", "2", ",", "0", ",", "1", ",", "0"}], 
      "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"A2", ",", "A2", ",", "1", ",", "0", ",", "0", ",", "2"}], 
      "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"A2", ",", "A2", ",", "2", ",", "0", ",", "0", ",", "2"}], 
      "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"A2", ",", "M2", ",", "1", ",", "0", ",", "0", ",", "1"}], 
      "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"A2", ",", "M2", ",", "2", ",", "0", ",", "0", ",", "1"}], 
      "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"M2", ",", "M2", ",", "1", ",", "0", ",", "0", ",", "0"}], 
      "]"}], ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "[", 
      RowBox[{"M2", ",", "M2", ",", "2", ",", "0", ",", "0", ",", "0"}], 
      "]"}], ",", "0.1`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6087097481036253`*^9, 3.608723762507711*^9, {3.6087238034402447`*^9, 
   3.608723840025827*^9}, 3.608723884421575*^9, {3.608723967624659*^9, 
   3.60872398231796*^9}, 3.6087240449280357`*^9, 3.60881640765488*^9, 
   3.608816647151969*^9, 3.608817563507653*^9, 3.608817647233808*^9, 
   3.608817709806594*^9, {3.608818028273183*^9, 3.6088180409114532`*^9}, 
   3.6088181539198627`*^9, 3.608818323565962*^9, 3.608818378431678*^9, 
   3.608818468548362*^9, 3.608818550192176*^9, {3.6088196470090647`*^9, 
   3.60881967582472*^9}, 3.608819907861396*^9, 3.608820507814946*^9, {
   3.6088224973400106`*^9, 3.60882251789041*^9}, 3.608822646220479*^9, 
   3.6088227560551558`*^9, 3.608822848597329*^9, 3.60882299830797*^9, 
   3.608823095383321*^9, 3.608823261066386*^9, 3.608824630588497*^9, 
   3.608825211679714*^9, {3.608827119976568*^9, 3.608827164338974*^9}, 
   3.608828133116536*^9, 3.608866505121491*^9, 3.615894749718376*^9, 
   3.615896885650312*^9, 3.6158969961930304`*^9, 3.615897192433629*^9, 
   3.615897546750654*^9, 3.615897720167782*^9, 3.615899335106629*^9, 
   3.615899419785928*^9, 3.61589960110646*^9, 3.6159000627031393`*^9, 
   3.616066694659327*^9, 3.616066890885213*^9, 3.61606744049299*^9, 
   3.616067556352803*^9, 3.616067718080336*^9, 3.6160686478399267`*^9, 
   3.616134352848124*^9, 3.616134675949483*^9, 3.61614196043996*^9, 
   3.616142171349573*^9, 3.6161537915296288`*^9, 3.616160265823889*^9, 
   3.616160862884913*^9, {3.616231963522842*^9, 3.6162319900394917`*^9}, 
   3.616233008186009*^9, 3.617963576424591*^9, 3.617964858113007*^9, 
   3.618562236683125*^9, 3.624346257252244*^9, {3.624388561718546*^9, 
   3.624388580221027*^9}, 3.6243890537138653`*^9, 3.624389140449898*^9, 
   3.624389457896484*^9, 3.624389492399919*^9, 3.6243897890128202`*^9, 
   3.624389994400763*^9, 3.6243907611771717`*^9, 3.624430351483541*^9, 
   3.62443274877794*^9, 3.624436174171966*^9, 3.624436792754807*^9, 
   3.624438006434636*^9, 3.624438184537361*^9, 3.6244407477839527`*^9, {
   3.6244414858373423`*^9, 3.6244415032939587`*^9}, 3.624442477853538*^9, 
   3.624442828931572*^9, 3.6244428914068213`*^9, 3.6244429294104977`*^9, 
   3.624549463062076*^9, 3.624565663825416*^9, 3.624882123032329*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"relsubsvals", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xi", "\[Rule]", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xi", ",", "relvals"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6160675095410223`*^9, 3.616067546555146*^9}, {
  3.624436280861668*^9, 3.624436282515271*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A1", ",", "A1", ",", "1", ",", "2", ",", "0", ",", "0"}], "]"}],
     "\[Rule]", "0.1`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A1", ",", "A1", ",", "2", ",", "2", ",", "0", ",", "0"}], "]"}],
     "\[Rule]", "0.1`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A1", ",", "M1", ",", "1", ",", "1", ",", "1", ",", "0"}], "]"}],
     "\[Rule]", "0.1`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A1", ",", "M1", ",", "2", ",", "1", ",", "1", ",", "0"}], "]"}],
     "\[Rule]", "0.1`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A1", ",", "A2", ",", "1", ",", "1", ",", "0", ",", "1"}], "]"}],
     "\[Rule]", "0.1`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A1", ",", "A2", ",", "2", ",", "1", ",", "0", ",", "1"}], "]"}],
     "\[Rule]", "0.1`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A1", ",", "M2", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}],
     "\[Rule]", "0.1`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A1", ",", "M2", ",", "2", ",", "1", ",", "0", ",", "0"}], "]"}],
     "\[Rule]", "0.1`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"M1", ",", "M1", ",", "1", ",", "0", ",", "2", ",", "0"}], "]"}],
     "\[Rule]", "0.1`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"M1", ",", "M1", ",", "2", ",", "0", ",", "2", ",", "0"}], "]"}],
     "\[Rule]", "0.1`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"M1", ",", "A2", ",", "1", ",", "0", ",", "1", ",", "1"}], "]"}],
     "\[Rule]", "0.1`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"M1", ",", "A2", ",", "2", ",", "0", ",", "1", ",", "1"}], "]"}],
     "\[Rule]", "0.1`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"M1", ",", "M2", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}],
     "\[Rule]", "0.1`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"M1", ",", "M2", ",", "2", ",", "0", ",", "1", ",", "0"}], "]"}],
     "\[Rule]", "0.1`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A2", ",", "A2", ",", "1", ",", "0", ",", "0", ",", "2"}], "]"}],
     "\[Rule]", "0.1`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A2", ",", "A2", ",", "2", ",", "0", ",", "0", ",", "2"}], "]"}],
     "\[Rule]", "0.1`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A2", ",", "M2", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}],
     "\[Rule]", "0.1`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A2", ",", "M2", ",", "2", ",", "0", ",", "0", ",", "1"}], "]"}],
     "\[Rule]", "0.1`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"M2", ",", "M2", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}],
     "\[Rule]", "0.1`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"M2", ",", "M2", ",", "2", ",", "0", ",", "0", ",", "0"}], "]"}],
     "\[Rule]", "0.1`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.616067556434452*^9, 3.6160677181677637`*^9, 3.6160686479862413`*^9, 
   3.6161343529083633`*^9, 3.616134676042843*^9, 3.6161419605156937`*^9, 
   3.616142171402214*^9, 3.6161537915837717`*^9, 3.6161602659852133`*^9, 
   3.616160863134075*^9, {3.616231963620351*^9, 3.616231990158581*^9}, 
   3.616233008295287*^9, 3.617963576593986*^9, 3.617964858304078*^9, 
   3.6185622369187813`*^9, 3.624346257806141*^9, {3.624388562185457*^9, 
   3.624388580476798*^9}, 3.624389054017684*^9, 3.624389140903796*^9, 
   3.624389458232839*^9, 3.6243894927145367`*^9, 3.624389789431052*^9, 
   3.6243899948667097`*^9, 3.6243907614971657`*^9, 3.6244303518154716`*^9, 
   3.6244327492442617`*^9, 3.624436174314404*^9, 3.624436282881776*^9, 
   3.624436792839109*^9, 3.624438006532268*^9, 3.624438184606904*^9, 
   3.624440747856473*^9, {3.624441485895452*^9, 3.624441503418687*^9}, 
   3.624442477860811*^9, 3.624442828939602*^9, 3.624442891589974*^9, 
   3.624442929475346*^9, 3.624549463153841*^9, 3.6245656638330383`*^9, 
   3.624882123074102*^9}]
}, Open  ]],

Cell[TextData[StyleBox["Numerical solving of relatedness equations",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.593445660381074*^9, 3.593445670548917*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans3test", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "m_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p10s_", ",", "p11s_", ",", "p20s_", ",", "p21s_"}], "}"}], ",", 
    "ks_", ",", "Qs_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "ans2out", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ans2out", "=", 
      RowBox[{"ans2", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"s1s", ",", "s2s"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"c1s", ",", "c2s", ",", "c3s", ",", "c4s"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"q1s", ",", "q2s"}], "}"}], ",", 
        RowBox[{"{", "m", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p10s", ",", "p11s", ",", "p20s", ",", "p21s"}], "}"}], ",", 
        "ks", ",", "Qs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "ans2out", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"reltab", "/.", "ans2out"}], "/.", "relsubsvals"}], "/.", 
       RowBox[{"Join", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
          RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
          RowBox[{"k", "\[Rule]", "ks"}], ",", 
          RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
          RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
          RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
          RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
          RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
          RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
          RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
          RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
          RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
          RowBox[{"mt", "\[Rule]", "m"}], ",", 
          RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
          RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
          RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
          RowBox[{"p21", "\[Rule]", "p21s"}]}], "}"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.501837018190094*^9, 3.501837023679632*^9}, {
   3.50183720898388*^9, 3.501837217030787*^9}, {3.505137630604842*^9, 
   3.505137672689906*^9}, {3.505137724298099*^9, 3.505137725093664*^9}, {
   3.50513786911785*^9, 3.505137871782151*^9}, {3.505138291497983*^9, 
   3.505138301863115*^9}, {3.508161120480796*^9, 3.508161127365771*^9}, {
   3.524555086466839*^9, 3.524555095395934*^9}, {3.590832971798708*^9, 
   3.59083297406511*^9}, {3.592544839100576*^9, 3.592544857754291*^9}, {
   3.608716022758548*^9, 3.608716062912607*^9}, {3.608723666448043*^9, 
   3.6087237128692503`*^9}, {3.6087237780983753`*^9, 
   3.6087238362794456`*^9}, {3.608723975350193*^9, 3.608723978954783*^9}, {
   3.608817901186801*^9, 3.6088179046777353`*^9}, {3.608818013721566*^9, 
   3.6088180362235947`*^9}, {3.608819864326297*^9, 3.6088198721744537`*^9}, {
   3.608824618900054*^9, 3.6088246209531727`*^9}, {3.624433653997202*^9, 
   3.624433657703134*^9}, {3.624435347072008*^9, 3.624435402377968*^9}, {
   3.6244354430154657`*^9, 3.62443544546164*^9}, {3.624435482808653*^9, 
   3.6244354837900953`*^9}, {3.624435540337392*^9, 3.624435570483152*^9}, {
   3.6244362028186913`*^9, 3.6244362061163187`*^9}, {3.624436244515724*^9, 
   3.624436249398202*^9}, {3.624436285291255*^9, 3.624436286021308*^9}, 
   3.6244420338086157`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ans3", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "m_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p10s_", ",", "p11s_", ",", "p20s_", ",", "p21s_"}], "}"}], ",", 
    "ks_", ",", "Qs_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "ans2out", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ans2out", "=", 
      RowBox[{"ans2", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"s1s", ",", "s2s"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"c1s", ",", "c2s", ",", "c3s", ",", "c4s"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"q1s", ",", "q2s"}], "}"}], ",", 
        RowBox[{"{", "m", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p10s", ",", "p11s", ",", "p20s", ",", "p21s"}], "}"}], ",", 
        "ks", ",", "Qs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"reltab", "/.", "ans2out"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
            RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
            RowBox[{"k", "\[Rule]", "ks"}], ",", 
            RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
            RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
            RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
            RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
            RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
            RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
            RowBox[{"Q", "\[Rule]", "Qs"}], ",", 
            RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
            RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
            RowBox[{"mt", "\[Rule]", "m"}], ",", 
            RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
            RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
            RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
            RowBox[{"p21", "\[Rule]", "p21s"}]}], "}"}]}], ",", 
         "relstartvals"}], "]"}], ",", "ans2out"}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6244355829668617`*^9, 3.6244356257634277`*^9}, {
  3.6244357353446827`*^9, 3.624435761197988*^9}, {3.624438569493712*^9, 
  3.624438571053225*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ans3", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.8", ",", "0.3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1", ",", "0.5", ",", "0.3", ",", "0.8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1", ",", "0.0"}], "}"}], ",", 
   RowBox[{"{", "0.812412", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3", ",", "0.5", ",", "0.1", ",", "0.1"}], "}"}], ",", "0.1", 
   ",", "0.01"}], "]"}]], "Input",
 CellChangeTimes->{{3.616155620463221*^9, 3.616155638210314*^9}, {
  3.6244385308499517`*^9, 3.624438534334071*^9}, {3.624439347937097*^9, 
  3.624439366391302*^9}, {3.6244408402646103`*^9, 3.6244408641327143`*^9}, {
  3.6244465745077477`*^9, 3.624446575522902*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A1", ",", "A1", ",", "1", ",", "2", ",", "0", ",", "0"}], "]"}],
     "\[Rule]", "0.24676708852955148`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A1", ",", "A1", ",", "2", ",", "2", ",", "0", ",", "0"}], "]"}],
     "\[Rule]", "0.20593551322904702`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A1", ",", "M1", ",", "1", ",", "1", ",", "1", ",", "0"}], "]"}],
     "\[Rule]", "0.10604422187200518`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A1", ",", "M1", ",", "2", ",", "1", ",", "1", ",", "0"}], "]"}],
     "\[Rule]", "0.11894598057418511`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A1", ",", "A2", ",", "1", ",", "1", ",", "0", ",", "1"}], "]"}],
     "\[Rule]", "0.31460903128917495`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A1", ",", "A2", ",", "2", ",", "1", ",", "0", ",", "1"}], "]"}],
     "\[Rule]", "0.1808027105960056`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A1", ",", "M2", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}],
     "\[Rule]", "0.10119944749488907`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A1", ",", "M2", ",", "2", ",", "1", ",", "0", ",", "0"}], "]"}],
     "\[Rule]", "0.09360995264257088`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"M1", ",", "M1", ",", "1", ",", "0", ",", "2", ",", "0"}], "]"}],
     "\[Rule]", "0.13964357675967914`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"M1", ",", "M1", ",", "2", ",", "0", ",", "2", ",", "0"}], "]"}],
     "\[Rule]", "0.22530717606577647`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"M1", ",", "A2", ",", "1", ",", "0", ",", "1", ",", "1"}], "]"}],
     "\[Rule]", "0.09320350360495182`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"M1", ",", "A2", ",", "2", ",", "0", ",", "1", ",", "1"}], "]"}],
     "\[Rule]", "0.12684600291355927`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"M1", ",", "M2", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}],
     "\[Rule]", "0.207458391422861`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"M1", ",", "M2", ",", "2", ",", "0", ",", "1", ",", "0"}], "]"}],
     "\[Rule]", "0.2825905139833184`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A2", ",", "A2", ",", "1", ",", "0", ",", "0", ",", "2"}], "]"}],
     "\[Rule]", "0.3129151553031648`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A2", ",", "A2", ",", "2", ",", "0", ",", "0", ",", "2"}], "]"}],
     "\[Rule]", "0.18704321529262655`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A2", ",", "M2", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}],
     "\[Rule]", "0.10119944749488907`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"A2", ",", "M2", ",", "2", ",", "0", ",", "0", ",", "1"}], "]"}],
     "\[Rule]", "0.09360995264257085`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"M2", ",", "M2", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}],
     "\[Rule]", "0.23954817436051226`"}], ",", 
   RowBox[{
    RowBox[{"r", "[", 
     RowBox[{"M2", ",", "M2", ",", "2", ",", "0", ",", "0", ",", "0"}], "]"}],
     "\[Rule]", "0.24735616058363513`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.04140694432099128`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.008793466604413927`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", 
    "0.0008232076999302717`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.10535164366033115`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.011658029792985199`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "0.06762255054867732`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.014467521915605111`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.0022529657279570115`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.018761562811144484`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.0015893796452367303`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.00017338610615916456`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.007549277761725039`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], "\[Rule]", 
    "0.15359822333098133`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.001127310733495178`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], "\[Rule]", 
    "0.03231313798884196`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], "\[Rule]", 
    "0.0021032308278906525`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.008212538626494655`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], "\[Rule]", 
    "0.32015035820446397`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], "\[Rule]", 
    "0.03422265407208419`"}], ",", 
   RowBox[{
    RowBox[{"fx", "[", 
     RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], "\[Rule]", 
    "0.16782260962059126`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.9933976182337535`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.9986222489453185`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.9859067938523678`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.9927705474641475`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.7951161940248357`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.7940492277795365`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.7870431445187283`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.7886356327948024`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.9029962557038508`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.9076717036583758`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.8958468208046854`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.9021394912737698`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.6969518556008331`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.6927867582842429`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.6891608963801851`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.6883366068886727`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.5377665845308971`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.48372167575822245`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.5116815404888688`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.48317110296973625`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.1390801835817963`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.0684417398345165`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.1110721229941383`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.0677470217287546`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.30523272376600996`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "0.2678241561533134`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "0.2848509731836165`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "0.267460563399276`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.1273553028823726`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
    "\[Rule]", "1.0566898860487663`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
    "\[Rule]", "1.0993294438631036`"}], ",", 
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
    "\[Rule]", "1.056018985813857`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.616155640599015*^9, 3.6161571351024323`*^9, 3.616160267633854*^9, 
   3.616160864800119*^9, {3.616231965241374*^9, 3.616231991907321*^9}, 
   3.616233009877392*^9, 3.617963577356551*^9, 3.6179648591998167`*^9, 
   3.618562238831709*^9, 3.624346258126094*^9, {3.624388563481814*^9, 
   3.6243885818621063`*^9}, 3.624389055272814*^9, 3.624389142462223*^9, 
   3.6243894597512293`*^9, 3.624389493920244*^9, 3.624389790768484*^9, 
   3.624389996305567*^9, 3.624390762898775*^9, 3.624430353312633*^9, 
   3.624432750639303*^9, 3.624436183956225*^9, 3.6244367998323917`*^9, 
   3.624438013409543*^9, 3.6244381913400307`*^9, 3.6244385413607273`*^9, 
   3.624438583244779*^9, {3.62443936005691*^9, 3.62443937450605*^9}, 
   3.624440761229973*^9, {3.624440847496492*^9, 3.624440871579245*^9}, {
   3.6244414926730633`*^9, 3.624441509860736*^9}, 3.624442484923414*^9, 
   3.624442836135276*^9, 3.624442898978828*^9, 3.6244429369722633`*^9, 
   3.624446583569776*^9, 3.624549470087399*^9, 3.6245656704967003`*^9, 
   3.624882129529377*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Selection differentials for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "ij"], TraditionalForm]]],
 ": the proportion of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "1"], TraditionalForm]]],
 "-offspring produced by parents having phenotype i and of age j."
}], "Section",
 CellChangeTimes->{{3.593494268186329*^9, 3.5934943131688232`*^9}, {
  3.59377825225355*^9, 3.593778254989624*^9}, {3.6161394928332644`*^9, 
  3.616139503089116*^9}, {3.616139553057475*^9, 3.61613955433675*^9}, {
  3.624446656566513*^9, 3.624446674615963*^9}}],

Cell[CellGroupData[{

Cell["Auxiliary functions", "Subsection",
 CellChangeTimes->{{3.624447464519895*^9, 3.624447467733796*^9}}],

Cell[TextData[StyleBox["- Adapted/Maladapted individuals produced by nonfocal \
individual on the patch",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.5001397535132713`*^9, 3.5001397607796917`*^9}, {
  3.500139829018998*^9, 3.5001398481950006`*^9}, {3.5018732640362577`*^9, 
  3.501873267079073*^9}, {3.5934440338407097`*^9, 3.593444049487831*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"state", "[", 
   RowBox[{"aself_", ",", "ageself_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"aself", "\[Equal]", "1"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ageself", "\[Equal]", "0"}], ",", "A1", ",", "A2"}], "]"}], 
    ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ageself", "\[Equal]", "0"}], ",", "M1", ",", "M2"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.624470468466176*^9, 3.624470480502994*^9}, {
  3.624470932130567*^9, 3.624470969737265*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"localadotherdp", "[", 
   RowBox[{
   "es_", ",", "aself_", ",", "ageself_", ",", "a1other_", ",", "m1other_", 
    ",", "a2other_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a1total", ",", "a2total", ",", "m1total"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a1total", "=", 
      RowBox[{"a1other", "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"aself", "\[Equal]", "1"}], "&&", 
          RowBox[{"ageself", "\[Equal]", "0"}]}], ",", "1", ",", "0"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m1total", "=", 
      RowBox[{"m1other", "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"aself", "\[Equal]", "0"}], "&&", 
          RowBox[{"ageself", "\[Equal]", "0"}]}], ",", "1", ",", "0"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a2total", "=", 
      RowBox[{"a2other", "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"aself", "\[Equal]", "1"}], "&&", 
          RowBox[{"ageself", "\[Equal]", "1"}]}], ",", "1", ",", "0"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       FractionBox["a1other", "n"], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], "+", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", 
              RowBox[{"state", "[", 
               RowBox[{"aself", ",", "ageself"}], "]"}], ",", "es", ",", 
              "a1total", ",", "m1total", ",", "a2total"}], "]"}], 
            RowBox[{"dp", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}]}]}], ")"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["m1other", "n"], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], "+", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"M1", ",", 
            RowBox[{"state", "[", 
             RowBox[{"aself", ",", "ageself"}], "]"}], ",", "es", ",", 
            "a1total", ",", "m1total", ",", "a2total"}], "]"}], 
          RowBox[{"dp", "[", 
           RowBox[{"es", ",", "0", ",", "0"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{
       FractionBox["a2other", "n"], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], "+", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{
              RowBox[{"state", "[", 
               RowBox[{"aself", ",", "ageself"}], "]"}], ",", "A2", ",", "es",
               ",", "a1total", ",", "m1total", ",", "a2total"}], "]"}], 
            RowBox[{"dp", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{
       FractionBox[
        RowBox[{
        "n", "-", "1", "-", "a1other", "-", "m1other", "-", "a2other"}], "n"], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], "+", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{
            RowBox[{"state", "[", 
             RowBox[{"aself", ",", "ageself"}], "]"}], ",", "M2", ",", "es", 
            ",", "a1total", ",", "m1total", ",", "a2total"}], "]"}], 
          RowBox[{"dp", "[", 
           RowBox[{"es", ",", "0", ",", "1"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}]}]}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.59254363092905*^9, {3.6242016785281067`*^9, 3.624201707337722*^9}, {
   3.624202331530916*^9, 3.624202337928005*^9}, {3.624202384234132*^9, 
   3.624202419163906*^9}, {3.624202581312338*^9, 3.624202645379182*^9}, {
   3.6244478993588676`*^9, 3.624447939843565*^9}, {3.624448135069339*^9, 
   3.624448140218811*^9}, {3.624448176356419*^9, 3.624448219257268*^9}, {
   3.6244704359110737`*^9, 3.624470464832362*^9}, {3.624471174033204*^9, 
   3.6244712452717533`*^9}, {3.624471801238364*^9, 3.624471832788331*^9}, {
   3.624472491950687*^9, 3.624472525167705*^9}, {3.62447267261489*^9, 
   3.624472704193371*^9}, {3.6244727390770063`*^9, 3.6244727722562017`*^9}, {
   3.624472866759441*^9, 3.624472885191456*^9}, {3.624477209562134*^9, 
   3.624477243972971*^9}, {3.624477397608165*^9, 3.62447739818055*^9}, {
   3.6244775429000187`*^9, 3.624477555122077*^9}, {3.624482125538372*^9, 
   3.6244821262176456`*^9}, {3.624482332347114*^9, 3.624482338878045*^9}, {
   3.624536534528625*^9, 3.624536534974296*^9}, 3.624536591228861*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"localmadotherdp", "[", 
   RowBox[{
   "es_", ",", "aself_", ",", "ageself_", ",", "a1other_", ",", "m1other_", 
    ",", "a2other_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a1total", ",", "a2total", ",", "m1total"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a1total", "=", 
      RowBox[{"a1other", "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"aself", "\[Equal]", "1"}], "&&", 
          RowBox[{"ageself", "\[Equal]", "0"}]}], ",", "1", ",", "0"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m1total", "=", 
      RowBox[{"m1other", "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"aself", "\[Equal]", "0"}], "&&", 
          RowBox[{"ageself", "\[Equal]", "0"}]}], ",", "1", ",", "0"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a2total", "=", 
      RowBox[{"a2other", "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"aself", "\[Equal]", "1"}], "&&", 
          RowBox[{"ageself", "\[Equal]", "1"}]}], ",", "1", ",", "0"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a2total", "\[IndentingNewLine]", 
       FractionBox["a1other", "n"], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], "+", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"A1", ",", 
            RowBox[{"state", "[", 
             RowBox[{"aself", ",", "ageself"}], "]"}], ",", "es", ",", 
            "a1total", ",", "m1total", ",", "a2total"}], "]"}], 
          RowBox[{"dp", "[", 
           RowBox[{"es", ",", "1", ",", "0"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["m1other", "n"], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], "+", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"M1", ",", 
              RowBox[{"state", "[", 
               RowBox[{"aself", ",", "ageself"}], "]"}], ",", "es", ",", 
              "a1total", ",", "m1total", ",", "a2total"}], "]"}], 
            RowBox[{"dp", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}]}]}], ")"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{
       FractionBox["a2other", "n"], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], "+", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{
            RowBox[{"state", "[", 
             RowBox[{"aself", ",", "ageself"}], "]"}], ",", "A2", ",", "es", 
            ",", "a1total", ",", "m1total", ",", "a2total"}], "]"}], 
          RowBox[{"dp", "[", 
           RowBox[{"es", ",", "1", ",", "1"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{
       FractionBox[
        RowBox[{
        "n", "-", "1", "-", "a1other", "-", "m1other", "-", "a2other"}], "n"], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], "+", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{
              RowBox[{"state", "[", 
               RowBox[{"aself", ",", "ageself"}], "]"}], ",", "M2", ",", "es",
               ",", "a1total", ",", "m1total", ",", "a2total"}], "]"}], 
            RowBox[{"dp", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}]}]}], ")"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}]}]}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.624477393082223*^9, {3.624477497280675*^9, 3.6244775747227*^9}, {
   3.62447771797274*^9, 3.624477730694891*^9}, {3.624478121007935*^9, 
   3.624478156210947*^9}, {3.624481941930005*^9, 3.6244819714103394`*^9}, {
   3.6244821148710737`*^9, 3.624482115835548*^9}, {3.624482334676054*^9, 
   3.624482334735718*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Selection differential in juveniles\
\>", "Subsection",
 CellChangeTimes->{{3.624194703418602*^9, 3.624194704634268*^9}, {
  3.624194744419376*^9, 3.6241947751070137`*^9}, {3.624517922260405*^9, 
  3.624517926642351*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdpJuv", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m2other", "=", 
         RowBox[{
         "n", "-", "1", "-", "a1other", "-", "m1other", "-", "a2other"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", "es", "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{
             RowBox[{"3", "-", "es"}], ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "m1other", ",", "a1other", ",",
              "m2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"a", ".", " ", "focal"}], " ", "juvenile", " ", "breeder", 
           " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "own", " ", "offspring", " ", "of", " ",
            "a", " ", "different", " ", "type"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", "n"}], ")"}], 
             RowBox[{"g", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
            RowBox[{"localcomptotal", "[", 
             RowBox[{"es", ",", 
              RowBox[{"a1other", "+", "aself"}], ",", 
              RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
             "]"}]]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"b", ".", " ", "focal"}], " ", "juvenile", " ", "breeder", 
           " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "other", " ", "offspring"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{
           "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}], "-", 
          RowBox[{"v", "[", 
           RowBox[{
           "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]}], ")"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"1", 
          RowBox[{"c", ".", " ", "focal"}], " ", "juvenile", " ", "adapted", 
          " ", "breeder", " ", "matures", " ", "to", " ", "the", " ", "next", 
          " ", "stage"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
               RowBox[{"dp", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"v", "[", 
             RowBox[{"es", ",", "0", ",", "aself", ",", 
              RowBox[{"a1other", "-", "1", "+", "aself"}], ",", 
              RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
             "]"}]}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"a", ".", " ", "adapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", 
           "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", 
             RowBox[{"a1other", "-", "1", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", "a2other"}], "]"}], "-", 
           
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"b", ".", " ", "adapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", "a",
            " ", "different", " ", "type", " ", "as", " ", "focal"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadotherdp", "[", 
             RowBox[{
             "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1"}], ",", 
             RowBox[{"m1other", "+", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"c", ".", " ", "adapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "nonfocal", " ", "offspring", " ", 
           "that", " ", "is", " ", "maladapted"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "+", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"2", 
          RowBox[{"d", ".", " ", "adapted"}], " ", "nonfocal", " ", 
          "juvenile", " ", "matures", " ", "to", " ", "adult", " ", 
          "breedership"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
               RowBox[{"dp", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"v", "[", 
             RowBox[{"es", ",", "0", ",", "aself", ",", 
              RowBox[{"a1other", "+", "aself"}], ",", 
              RowBox[{"m1other", "-", "1", "+", "1", "-", "aself"}], ",", 
              "a2other"}], "]"}]}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"a", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", 
           "the", " ", "same", " ", "phenotype", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "-", "1", "+", "1", "-", "aself"}], ",", 
             "a2other"}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "-", "1", "+", "aself"}], ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"b", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", "a",
            " ", "different", " ", "phenotype", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadotherdp", "[", 
             RowBox[{
             "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", 
             RowBox[{"m1other", "-", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"c", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "nonfocal", " ", "offspring", " ", 
           "that", " ", "is", " ", "adapted"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "-", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"3", 
          RowBox[{"d", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
          "juvenile", " ", "breeder", " ", "survives", " ", "to", " ", 
          "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"a", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "a", " ", "different", " ", "type", " ", "than", " ", 
           "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
               RowBox[{"dp", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"v", "[", 
             RowBox[{"es", ",", "0", ",", "aself", ",", 
              RowBox[{"a1other", "+", "aself"}], ",", 
              RowBox[{"m1other", "+", "1", "-", "aself"}], ",", 
              RowBox[{"a2other", "-", "1"}]}], "]"}]}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"b", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadotherdp", "[", 
             RowBox[{
             "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"c", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "nonfocal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadotherdp", "[", 
             RowBox[{
             "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "+", "1"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"d", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "nonfocal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", "a2other"}], "]"}], "+", 
           
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"a", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "a", " ", "different", " ", "type", " ", "than", " ", 
           "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
               RowBox[{"dp", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", 
            RowBox[{"a1other", "+", "aself"}], ",", 
            RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
           "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"v", "[", 
             RowBox[{"es", ",", "0", ",", "aself", ",", 
              RowBox[{"a1other", "+", "aself"}], ",", 
              RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
             "]"}]}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"b", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadotherdp", "[", 
             RowBox[{
             "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", "m1other", ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"c", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadotherdp", "[", 
             RowBox[{
             "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "+", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"d", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "n"}], ")"}], 
         RowBox[{"g", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", "k"}], ")"}], 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"zm2", "=", 
               RowBox[{"n", "-", "za1", "-", "zm1", "-", "za2"}]}], "}"}], 
             ",", 
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{
               "zes", ",", "za1", ",", "zm1", ",", "za2", ",", "zm2"}], "]"}], 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"za1", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "1", ",", "0"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}], 
                    ")"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", 
                    RowBox[{"za1", "-", "1"}], ",", "zm1", ",", "za2"}], 
                    "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    RowBox[{"za1", "-", "1"}], ",", "zm1", ",", "za2"}], 
                    "]"}]}]}], "\[IndentingNewLine]", ")"}]}], 
                "\[IndentingNewLine]", "+", 
                RowBox[{"zm1", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "0", ",", "0"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}], 
                    ")"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    RowBox[{"zm1", "-", "1"}], ",", "za2"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", 
                    RowBox[{"zm1", "-", "1"}], ",", "za2"}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "+", 
                
                RowBox[{"za2", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "1", ",", "1"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}], 
                    ")"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    "zm1", ",", 
                    RowBox[{"za2", "-", "1"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", "zm1", ",", 
                    RowBox[{"za2", "-", "1"}]}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "+", 
                
                RowBox[{"zm2", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "0", ",", "1"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}], 
                    ")"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    "zm1", ",", "za2"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", "zm1", ",", "za2"}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", 
               ")"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"zes", ",", "1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"za1", ",", "0", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zm1", ",", "0", ",", 
             RowBox[{"n", "-", "za1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"za2", ",", "0", ",", 
             RowBox[{"n", "-", "za1", "-", "zm1"}]}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a1other", ",", "0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m1other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other", "-", "m1other"}]}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.624105393315069*^9, 3.624105424785666*^9}, {
   3.624105542758597*^9, 3.624105550700832*^9}, {3.624105634651022*^9, 
   3.6241056558512907`*^9}, {3.624106910657282*^9, 3.624106951717827*^9}, {
   3.62410723426145*^9, 3.6241072952709713`*^9}, {3.6241073313493013`*^9, 
   3.6241074057358103`*^9}, {3.6241074645950747`*^9, 3.624107630937098*^9}, {
   3.624107672161605*^9, 3.624107696256287*^9}, {3.624107728743771*^9, 
   3.624107907116013*^9}, {3.624108519063383*^9, 3.624108589425164*^9}, {
   3.624108641315518*^9, 3.624108644553985*^9}, {3.624108833022855*^9, 
   3.624108864366914*^9}, {3.624108999412953*^9, 3.624109037338584*^9}, {
   3.624109757301538*^9, 3.624109816130487*^9}, {3.624110628383292*^9, 
   3.624110833628664*^9}, {3.624110908970429*^9, 3.624110929575144*^9}, {
   3.624110974936181*^9, 3.624111011867834*^9}, {3.624111075130018*^9, 
   3.624111098126931*^9}, {3.624111172158141*^9, 3.6241111756160097`*^9}, {
   3.624111247687255*^9, 3.624111290220771*^9}, {3.624111337718417*^9, 
   3.6241113929905357`*^9}, 3.624111459721759*^9, {3.624111503087812*^9, 
   3.624111567750102*^9}, {3.624111644629919*^9, 3.624111655607366*^9}, {
   3.624112058631222*^9, 3.624112177756599*^9}, 3.624112296789069*^9, {
   3.6241123277544823`*^9, 3.624112356208357*^9}, {3.624112476305134*^9, 
   3.624112495511964*^9}, {3.624112544110755*^9, 3.6241125623089447`*^9}, {
   3.624112634463889*^9, 3.6241126670311213`*^9}, {3.624112699002626*^9, 
   3.624112757417794*^9}, {3.624112800664715*^9, 3.624112811731379*^9}, {
   3.624114458578978*^9, 3.6241145110967503`*^9}, {3.6241156278447027`*^9, 
   3.624115676439664*^9}, {3.624115710006269*^9, 3.624115720724999*^9}, {
   3.624116126772534*^9, 3.624116143875856*^9}, {3.624117054944509*^9, 
   3.624117122909733*^9}, {3.624117232977274*^9, 3.624117233371319*^9}, {
   3.624117347738717*^9, 3.624117358275321*^9}, {3.624117388353952*^9, 
   3.6241173962020197`*^9}, {3.624117435590787*^9, 3.624117491493388*^9}, {
   3.6241179082263193`*^9, 3.624117919533782*^9}, 3.624121236873742*^9, {
   3.624121576678515*^9, 3.624121768038467*^9}, {3.624121818408928*^9, 
   3.62412184063608*^9}, {3.624122066672517*^9, 3.624122085633874*^9}, {
   3.624122146422144*^9, 3.624122210443741*^9}, {3.62412825762978*^9, 
   3.624128279184132*^9}, {3.6241349066411533`*^9, 3.624134935983481*^9}, {
   3.624134973365363*^9, 3.624135067662483*^9}, {3.624135275875266*^9, 
   3.624135304590047*^9}, {3.624135424804736*^9, 3.6241354794836073`*^9}, {
   3.624135537150897*^9, 3.624135551681814*^9}, {3.624136317804256*^9, 
   3.624136592868403*^9}, {3.624136623531128*^9, 3.624136666441414*^9}, {
   3.624136752200927*^9, 3.6241367920838137`*^9}, {3.6241368256210117`*^9, 
   3.624136916638122*^9}, {3.62418830554675*^9, 3.6241883064004908`*^9}, {
   3.6241886156711493`*^9, 3.624188616434956*^9}, {3.624197138929085*^9, 
   3.624197141443653*^9}, {3.624199077465385*^9, 3.6241990776535378`*^9}, {
   3.624201194317346*^9, 3.624201231631407*^9}, {3.624201533263768*^9, 
   3.624201560299189*^9}, {3.6242029666179333`*^9, 3.624203130670968*^9}, {
   3.624204116478397*^9, 3.624204116652637*^9}, {3.6244471985774927`*^9, 
   3.624447241501472*^9}, {3.6244473721100397`*^9, 3.6244473722510443`*^9}, {
   3.624482542607731*^9, 3.624482567125607*^9}, {3.624482668655793*^9, 
   3.6244827153412943`*^9}, {3.624482760534123*^9, 3.62448276068636*^9}, {
   3.624482975939604*^9, 3.624483023403013*^9}, {3.624515914329667*^9, 
   3.624515979403558*^9}, {3.624518591929398*^9, 3.624518594951417*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Selection differential in adults\
\>", "Subsection",
 CellChangeTimes->{{3.624194765851487*^9, 3.624194770611102*^9}, {
  3.624517953843247*^9, 3.6245179576183987`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdpAd", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m2other", "=", 
         RowBox[{
         "n", "-", "1", "-", "a1other", "-", "m1other", "-", "a2other"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", "es", "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{
             RowBox[{"3", "-", "es"}], ",", "1", ",", 
             RowBox[{"1", "-", "aself"}], ",", "m1other", ",", "a1other", ",",
              "m2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", 
             RowBox[{"a1other", "-", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", "a2other"}], "]"}], "-", 
           
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"a", ".", " ", "adapted"}], " ", "juvenile", " ", 
           "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "own", " ", "offspring", " ", "of", " ",
            "a", " ", "different", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
               RowBox[{"dp", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"b", ".", " ", "adapted"}], " ", "juvenile", " ", 
           "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "own", " ", "offspring", " ", "of", " ",
            "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadotherdp", "[", 
             RowBox[{
             "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1"}], ",", 
             RowBox[{"m1other", "+", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"c", ".", " ", "adapted"}], " ", "juvenile", " ", 
           "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "nonfocal", " ", "maladapted", " ", 
           "juvenile", " ", "offspring"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "+", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"1", 
          RowBox[{"d", ".", " ", "focal"}], " ", "juvenile", " ", "adapted", 
          " ", "breeder", " ", "matures", " ", "to", " ", "the", " ", "next", 
          " ", "stage"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
               RowBox[{"dp", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "-", "1"}], ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "-", "1", "+", "1", "-", "aself"}], ",", 
             "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"a", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", 
           "the", " ", "same", " ", "phenotype", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "a1other", ",", 
             RowBox[{"m1other", "-", "1"}], ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "-", "1", "+", "aself"}], ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"b", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", "a",
            " ", "different", " ", "phenotype", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadotherdp", "[", 
             RowBox[{
             "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", 
             RowBox[{"m1other", "-", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"c", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "nonfocal", " ", "offspring", " ", 
           "that", " ", "is", " ", "adapted"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "-", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"2", 
          RowBox[{"d", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
          "juvenile", " ", "breeder", " ", "survives", " ", "to", " ", 
          "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"a", ".", " ", "focal"}], " ", "adult", " ", "breeder", 
           " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "a", " ", "different", " ", "type", " ", "as", " ", 
           "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
               RowBox[{"dp", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"b", ".", " ", "focal"}], " ", "adult", " ", "breeder", 
           " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", "n"}], ")"}], 
             RowBox[{"g", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
            RowBox[{"localcomptotal", "[", 
             RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
              RowBox[{"a2other", "+", "aself"}]}], "]"}]]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"c", ".", " ", "focal"}], " ", "adult", " ", "breeder", 
           " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "nonfocal", " ", "offspring"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself", "-", "1"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"a", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "a", " ", "different", " ", "type", " ", "than", " ", 
           "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
               RowBox[{"dp", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself", "-", "1"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"b", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadotherdp", "[", 
             RowBox[{
             "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"c", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "nonfocal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadotherdp", "[", 
             RowBox[{
             "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "+", "1"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"d", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "nonfocal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
               RowBox[{"dp", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"a", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"m", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
             RowBox[{"dp", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotal", "[", 
           RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
            RowBox[{"a2other", "+", "aself"}]}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", "a2other"}], "]"}], "-", 
           
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"b", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadotherdp", "[", 
             RowBox[{
             "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", "m1other", ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"c", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadotherdp", "[", 
             RowBox[{
             "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotal", "[", 
            RowBox[{"es", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "+", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"d", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "n"}], ")"}], 
         RowBox[{"g", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", "k"}], ")"}], 
         RowBox[{"m", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"zm2", "=", 
               RowBox[{"n", "-", "za1", "-", "zm1", "-", "za2"}]}], "}"}], 
             ",", 
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{
               "zes", ",", "za1", ",", "zm1", ",", "za2", ",", "zm2"}], "]"}], 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"za1", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "1", ",", "0"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}], 
                    ")"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", 
                    RowBox[{"za1", "-", "1"}], ",", "zm1", ",", "za2"}], 
                    "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    RowBox[{"za1", "-", "1"}], ",", "zm1", ",", "za2"}], 
                    "]"}]}]}], "\[IndentingNewLine]", ")"}]}], 
                "\[IndentingNewLine]", "+", 
                RowBox[{"zm1", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "0", ",", "0"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}], 
                    ")"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    RowBox[{"zm1", "-", "1"}], ",", "za2"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", 
                    RowBox[{"zm1", "-", "1"}], ",", "za2"}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "+", 
                
                RowBox[{"za2", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "1", ",", "1"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}], 
                    ")"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    "zm1", ",", 
                    RowBox[{"za2", "-", "1"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", "zm1", ",", 
                    RowBox[{"za2", "-", "1"}]}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "+", 
                
                RowBox[{"zm2", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "0", ",", "1"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}], 
                    ")"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    "zm1", ",", "za2"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
                    RowBox[{"dp", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", "zm1", ",", "za2"}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", 
               ")"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"zes", ",", "1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"za1", ",", "0", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zm1", ",", "0", ",", 
             RowBox[{"n", "-", "za1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"za2", ",", "0", ",", 
             RowBox[{"n", "-", "za1", "-", "zm1"}]}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a1other", ",", "0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m1other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other", "-", "m1other"}]}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.624105393315069*^9, 3.624105424785666*^9}, {
   3.624105542758597*^9, 3.624105550700832*^9}, {3.624105634651022*^9, 
   3.6241056558512907`*^9}, {3.624106910657282*^9, 3.624106951717827*^9}, {
   3.62410723426145*^9, 3.6241072952709713`*^9}, {3.6241073313493013`*^9, 
   3.6241074057358103`*^9}, {3.6241074645950747`*^9, 3.624107630937098*^9}, {
   3.624107672161605*^9, 3.624107696256287*^9}, {3.624107728743771*^9, 
   3.624107907116013*^9}, {3.624108519063383*^9, 3.624108589425164*^9}, {
   3.624108641315518*^9, 3.624108644553985*^9}, {3.624108833022855*^9, 
   3.624108864366914*^9}, {3.624108999412953*^9, 3.624109037338584*^9}, {
   3.624109757301538*^9, 3.624109816130487*^9}, {3.624110628383292*^9, 
   3.624110833628664*^9}, {3.624110908970429*^9, 3.624110929575144*^9}, {
   3.624110974936181*^9, 3.624111011867834*^9}, {3.624111075130018*^9, 
   3.624111098126931*^9}, {3.624111172158141*^9, 3.6241111756160097`*^9}, {
   3.624111247687255*^9, 3.624111290220771*^9}, {3.624111337718417*^9, 
   3.6241113929905357`*^9}, 3.624111459721759*^9, {3.624111503087812*^9, 
   3.624111567750102*^9}, {3.624111644629919*^9, 3.624111655607366*^9}, {
   3.624112058631222*^9, 3.624112177756599*^9}, 3.624112296789069*^9, {
   3.6241123277544823`*^9, 3.624112356208357*^9}, {3.624112476305134*^9, 
   3.624112495511964*^9}, {3.624112544110755*^9, 3.6241125623089447`*^9}, {
   3.624112634463889*^9, 3.6241126670311213`*^9}, {3.624112699002626*^9, 
   3.624112757417794*^9}, {3.624112800664715*^9, 3.624112811731379*^9}, {
   3.624114458578978*^9, 3.6241145110967503`*^9}, {3.6241156278447027`*^9, 
   3.624115676439664*^9}, {3.624115710006269*^9, 3.624115720724999*^9}, {
   3.624116126772534*^9, 3.624116143875856*^9}, {3.624117054944509*^9, 
   3.624117122909733*^9}, {3.624117232977274*^9, 3.624117233371319*^9}, {
   3.624117347738717*^9, 3.624117358275321*^9}, {3.624117388353952*^9, 
   3.6241173962020197`*^9}, {3.624117435590787*^9, 3.624117491493388*^9}, {
   3.6241179082263193`*^9, 3.624117919533782*^9}, 3.624121236873742*^9, {
   3.624121576678515*^9, 3.624121768038467*^9}, {3.624121818408928*^9, 
   3.62412184063608*^9}, {3.624122066672517*^9, 3.624122085633874*^9}, {
   3.624122146422144*^9, 3.624122210443741*^9}, {3.62412825762978*^9, 
   3.624128279184132*^9}, {3.6241349066411533`*^9, 3.624134935983481*^9}, {
   3.624134973365363*^9, 3.624135067662483*^9}, {3.624135275875266*^9, 
   3.624135304590047*^9}, {3.624135424804736*^9, 3.6241354794836073`*^9}, {
   3.624135537150897*^9, 3.624135551681814*^9}, {3.624136317804256*^9, 
   3.624136592868403*^9}, {3.624136623531128*^9, 3.624136666441414*^9}, {
   3.624136752200927*^9, 3.6241367920838137`*^9}, {3.6241368256210117`*^9, 
   3.624136916638122*^9}, {3.6241371119526377`*^9, 3.624137123015327*^9}, {
   3.6241374691646013`*^9, 3.624137482972671*^9}, {3.62413752011064*^9, 
   3.624137593860952*^9}, {3.624137635384986*^9, 3.624137709797246*^9}, 
   3.624188325910187*^9, {3.624195595519504*^9, 3.624195754485969*^9}, {
   3.624196895973914*^9, 3.624196947786957*^9}, {3.62419700975912*^9, 
   3.624197118941063*^9}, {3.624197187438719*^9, 3.624197221520343*^9}, {
   3.6241972550854397`*^9, 3.624197332028689*^9}, {3.6241973719157763`*^9, 
   3.624197420877294*^9}, {3.62419828534858*^9, 3.624198288802609*^9}, {
   3.624198319938748*^9, 3.6241983445530663`*^9}, {3.624198810897176*^9, 
   3.6241988875524607`*^9}, {3.6241989556213207`*^9, 
   3.6241990234801693`*^9}, {3.62419905426888*^9, 3.624199054363193*^9}, {
   3.62419911295243*^9, 3.624199113125098*^9}, {3.624199146457932*^9, 
   3.624199149804529*^9}, {3.624199184101955*^9, 3.624199204727675*^9}, {
   3.6241992966541157`*^9, 3.624199346002799*^9}, {3.624199431265285*^9, 
   3.624199444946371*^9}, {3.624199495212886*^9, 3.6241995219215612`*^9}, {
   3.624199566362286*^9, 3.624199684797461*^9}, {3.624199739365447*^9, 
   3.624199793268449*^9}, {3.624200115688655*^9, 3.624200116575446*^9}, {
   3.624200156439021*^9, 3.624200161419701*^9}, {3.624200195640967*^9, 
   3.624200293813195*^9}, {3.624200524231401*^9, 3.6242005507180767`*^9}, {
   3.624201033128936*^9, 3.6242010491402683`*^9}, {3.6242011314151993`*^9, 
   3.624201157681975*^9}, {3.6242013117409353`*^9, 3.624201401595797*^9}, {
   3.624203185613224*^9, 3.62420324017876*^9}, {3.62420331045933*^9, 
   3.624203338476714*^9}, {3.624203379360961*^9, 3.624203379451083*^9}, {
   3.624203414346799*^9, 3.624203450906179*^9}, {3.624203677437587*^9, 
   3.6242036997938766`*^9}, {3.624204133116194*^9, 3.6242041333410673`*^9}, {
   3.624280719591448*^9, 3.624280719701469*^9}, {3.624517964914661*^9, 
   3.6245180575028954`*^9}, {3.624518232612445*^9, 3.6245182847666817`*^9}, {
   3.62451860212917*^9, 3.6245186039160757`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Evaluation of both selection differentials\
\>", "Subsection",
 CellChangeTimes->{3.616139686679941*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"dvdpAd", "[", 
     RowBox[{"[", 
      RowBox[{"es", ",", 
       RowBox[{"1", "+", "aself"}], ",", 
       RowBox[{"1", "+", "a1other"}], ",", 
       RowBox[{"1", "+", "m1other"}], ",", 
       RowBox[{"1", "+", "a2other"}]}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a1other", ",", "0", ",", 
      RowBox[{"n", "-", "1"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m1other", ",", "0", ",", 
      RowBox[{"n", "-", "1", "-", "a1other"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a2other", ",", "0", ",", 
      RowBox[{"n", "-", "1", "-", "a1other", "-", "m1other"}]}], "}"}]}], 
   "]"}], "//", "Variables"}]], "Input",
 CellChangeTimes->{{3.624537033200474*^9, 3.624537065340622*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "c1", ",", "c2", ",", "c3", ",", "c4", ",", "dp10", ",", "dp11", ",", 
   "dp20", ",", "dp21", ",", "k", ",", "mt", ",", "p10", ",", "p11", ",", 
   "p20", ",", "p21", ",", "Q", ",", "q1", ",", "q2", ",", "s1", ",", "s2", 
   ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "A2", ",", "1", ",", "1", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "A2", ",", "2", ",", "1", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A2", ",", "A2", ",", "1", ",", "0", ",", "0", ",", "2"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A2", ",", "A2", ",", "2", ",", "0", ",", "0", ",", "2"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A2", ",", "M2", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A2", ",", "M2", ",", "2", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "A2", ",", "1", ",", "0", ",", "1", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "A2", ",", "2", ",", "0", ",", "1", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "M2", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "M2", ",", "2", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M2", ",", "A2", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M2", ",", "A2", ",", "2", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M2", ",", "M2", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M2", ",", "M2", ",", "2", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.624537046793429*^9, 3.624537066190093*^9}, 
   3.624538199099638*^9, 3.6245494802501717`*^9, 3.624558602186338*^9, 
   3.624559030064611*^9, 3.624559344418804*^9, 3.624559464114646*^9, 
   3.624565680953581*^9, 3.624882139230904*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dveqdptJuv", "[", "dpval_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"dvdpJuv", "[", 
         RowBox[{"[", 
          RowBox[{"es", ",", 
           RowBox[{"1", "+", "aself"}], ",", 
           RowBox[{"1", "+", "a1other"}], ",", 
           RowBox[{"1", "+", "m1other"}], ",", 
           RowBox[{"1", "+", "a2other"}]}], "]"}], "]"}], ",", "dpval"}], 
       "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dp11", "\[Rule]", "0"}], ",", 
        RowBox[{"dp21", "\[Rule]", "0"}], ",", 
        RowBox[{"dp10", "\[Rule]", "0"}], ",", 
        RowBox[{"dp20", "\[Rule]", "0"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a1other", ",", "0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m1other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other", "-", "m1other"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dveqdptAd", "[", "dpval_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"dvdpAd", "[", 
         RowBox[{"[", 
          RowBox[{"es", ",", 
           RowBox[{"1", "+", "aself"}], ",", 
           RowBox[{"1", "+", "a1other"}], ",", 
           RowBox[{"1", "+", "m1other"}], ",", 
           RowBox[{"1", "+", "a2other"}]}], "]"}], "]"}], ",", "dpval"}], 
       "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dp11", "\[Rule]", "0"}], ",", 
        RowBox[{"dp21", "\[Rule]", "0"}], ",", 
        RowBox[{"dp10", "\[Rule]", "0"}], ",", 
        RowBox[{"dp20", "\[Rule]", "0"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a1other", ",", "0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m1other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other", "-", "m1other"}]}], "}"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.501843432551832*^9, 3.50184343360995*^9}, {
   3.501843944380341*^9, 3.501843964281032*^9}, 3.501844040723341*^9, {
   3.505138889414682*^9, 3.50513890024374*^9}, {3.505140339692244*^9, 
   3.505140380980634*^9}, {3.505155691794249*^9, 3.505155696978383*^9}, {
   3.616055864194425*^9, 3.616055877835294*^9}, {3.616063327990137*^9, 
   3.616063364094*^9}, 3.616063435500227*^9, {3.6160671442790537`*^9, 
   3.616067144632298*^9}, {3.6245186102590113`*^9, 3.624518613947728*^9}, {
   3.624519087319708*^9, 3.624519114167334*^9}, {3.624519317598583*^9, 
   3.624519333792856*^9}, {3.6245194691578197`*^9, 3.6245195270373287`*^9}, {
   3.624519598061749*^9, 3.6245196135427856`*^9}, {3.624538131481344*^9, 
   3.624538131853119*^9}}],

Cell["\<\
Make final selection gradient. Also substitute for relatedness coefficients \
r_ij ->r_ji.\
\>", "Text",
 CellChangeTimes->{{3.624559278662603*^9, 3.624559304227027*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dveqdp", "[", "dpval_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", 
        RowBox[{"n", "-", "a1", "-", "m1", "-", "a2"}]}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a1", ">", "0"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a1", "/", "n"}], ")"}], 
           RowBox[{
            RowBox[{"dveqdptJuv", "[", "dpval", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"es", ",", 
              RowBox[{"1", "+", "1"}], ",", 
              RowBox[{"1", "+", "a1", "-", "1"}], ",", 
              RowBox[{"1", "+", "m1"}], ",", 
              RowBox[{"1", "+", "a2"}]}], "]"}], "]"}]}], ",", "0"}], "]"}], 
        "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           FractionBox["m1", "n"], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"dveqdptJuv", "[", "dpval", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"es", ",", 
             RowBox[{"1", "+", "0"}], ",", 
             RowBox[{"1", "+", "a1"}], ",", 
             RowBox[{"1", "+", "m1", "-", "1"}], ",", 
             RowBox[{"1", "+", "a2"}]}], "]"}], "]"}], ",", "0"}], "]"}], "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           FractionBox["a2", "n"], ">", "0"}], ",", 
          RowBox[{
           RowBox[{"dveqdptAd", "[", "dpval", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"es", ",", 
             RowBox[{"1", "+", "1"}], ",", 
             RowBox[{"1", "+", "a1"}], ",", 
             RowBox[{"1", "+", "m1"}], ",", 
             RowBox[{"1", "+", "a2", "-", "1"}]}], "]"}], "]"}], ",", "0"}], 
         "]"}], "+", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"n", "-", "a1", "-", "m1", "-", "a2"}], "n"], ">", "0"}], 
          ",", 
          RowBox[{
           RowBox[{"dveqdptAd", "[", "dpval", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"es", ",", 
             RowBox[{"1", "+", "0"}], ",", 
             RowBox[{"1", "+", "a1"}], ",", 
             RowBox[{"1", "+", "m1"}], ",", 
             RowBox[{"1", "+", "a2"}]}], "]"}], "]"}], ",", "0"}], "]"}]}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a1", ",", "0", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m1", ",", "0", ",", 
       RowBox[{"n", "-", "a1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2", ",", "0", ",", 
       RowBox[{"n", "-", "a1", "-", "m1"}]}], "}"}]}], "]"}], "/.", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"A2", ",", "A1", ",", "1", ",", "1", ",", "0", ",", "1"}], 
       "]"}], "->", 
      RowBox[{"r", "[", 
       RowBox[{"A1", ",", "A2", ",", "1", ",", "1", ",", "0", ",", "1"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"A2", ",", "A1", ",", "2", ",", "1", ",", "0", ",", "1"}], 
       "]"}], "->", 
      RowBox[{"r", "[", 
       RowBox[{"A1", ",", "A2", ",", "2", ",", "1", ",", "0", ",", "1"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"A2", ",", "M1", ",", "1", ",", "0", ",", "1", ",", "1"}], 
       "]"}], "->", 
      RowBox[{"r", "[", 
       RowBox[{"M1", ",", "A2", ",", "1", ",", "0", ",", "1", ",", "1"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"A2", ",", "M1", ",", "2", ",", "0", ",", "1", ",", "1"}], 
       "]"}], "->", 
      RowBox[{"r", "[", 
       RowBox[{"M1", ",", "A2", ",", "2", ",", "0", ",", "1", ",", "1"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"M2", ",", "A1", ",", "1", ",", "1", ",", "0", ",", "0"}], 
       "]"}], "->", 
      RowBox[{"r", "[", 
       RowBox[{"A1", ",", "M2", ",", "1", ",", "1", ",", "0", ",", "0"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"M2", ",", "A1", ",", "2", ",", "1", ",", "0", ",", "0"}], 
       "]"}], "->", 
      RowBox[{"r", "[", 
       RowBox[{"A1", ",", "M2", ",", "2", ",", "1", ",", "0", ",", "0"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"M2", ",", "A2", ",", "1", ",", "0", ",", "0", ",", "1"}], 
       "]"}], "->", 
      RowBox[{"r", "[", 
       RowBox[{"A2", ",", "M2", ",", "1", ",", "0", ",", "0", ",", "1"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"M2", ",", "A2", ",", "2", ",", "0", ",", "0", ",", "1"}], 
       "]"}], "->", 
      RowBox[{"r", "[", 
       RowBox[{"A2", ",", "M2", ",", "2", ",", "0", ",", "0", ",", "1"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"M2", ",", "M1", ",", "1", ",", "0", ",", "1", ",", "0"}], 
       "]"}], "->", 
      RowBox[{"r", "[", 
       RowBox[{"M1", ",", "M2", ",", "1", ",", "0", ",", "1", ",", "0"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"M2", ",", "M1", ",", "2", ",", "0", ",", "1", ",", "0"}], 
       "]"}], "->", 
      RowBox[{"r", "[", 
       RowBox[{"M1", ",", "M2", ",", "2", ",", "0", ",", "1", ",", "0"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"M1", ",", "A1", ",", "1", ",", "1", ",", "1", ",", "0"}], 
       "]"}], "->", 
      RowBox[{"r", "[", 
       RowBox[{"A1", ",", "M1", ",", "1", ",", "1", ",", "1", ",", "0"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"M1", ",", "A1", ",", "2", ",", "1", ",", "1", ",", "0"}], 
       "]"}], "->", 
      RowBox[{"r", "[", 
       RowBox[{"A1", ",", "M1", ",", "2", ",", "1", ",", "1", ",", "0"}], 
       "]"}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwlzE0ogwEAxvGZFBbJRwyjMUZb0Vx8zPQOpbaZFqYlmaEs2VKUCzlY1JSV
mlCoWWwHC4eVk6+2pGnFHCwla4d3B1kZ2xjvM4en3+n5s0d0ijE6jUZjUYOR
yyyXsJAkekyaG8h22/oNLJKYrFcrYWllwQTc89X9W85TJ5pJIlfu1MD1845A
agtJxOwDSefdXGnRO0nYpTwV3DUMDkFPTD8MrWWbY1Ch2RiHqs+2FWh0Zhhh
F+fMBPNoWjPcPmrYgtXFsm2oD7nCyW7jUgRW+W2vTMqvVzkJjxmtwyJKH6NC
DTnGeLQxJUSw1iwJKLheYDRRak9rs2Ha/lAnjPFFEhiYy7yF/HBO0iv/4x0M
OoJeuJhv9Sd/3sMgnJZ/k3ByOe8Nzl7IPqDbbEnAdtdqOkGZbZ7JgA5+yj28
eqE/QIuuJl9MObp7woSqEmFYQjklJ6PQ0x7/gcHqnV94oHziSyn1XKMAih3R
Xtj73N0H/wDrx9uF
  "]],

Cell["Numerical value of the selection gradient", "Text",
 CellChangeTimes->{{3.593494549744481*^9, 3.5934945648160954`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"selgradP", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "m_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p10s_", ",", "p11s_", ",", "p20s_", ",", "p21s_"}], "}"}], ",", 
    "ks_", ",", "Qs_", ",", "theP_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Return", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"dveqdp", "[", "theP", "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
         RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
         RowBox[{"k", "\[Rule]", "ks"}], ",", 
         RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
         RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
         RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
         RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
         RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
         RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
         RowBox[{"mt", "\[Rule]", "m"}], ",", 
         RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
         RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
         RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
         RowBox[{"p21", "\[Rule]", "p21s"}], ",", 
         RowBox[{"Q", "\[Rule]", "Qs"}]}], "}"}]}], "/.", 
      RowBox[{"ans3", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"s1s", ",", "s2s"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"c1s", ",", "c2s", ",", "c3s", ",", "c4s"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"q1s", ",", "q2s"}], "}"}], ",", 
        RowBox[{"{", "m", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p10s", ",", "p11s", ",", "p20s", ",", "p21s"}], "}"}], ",", 
        "ks", ",", "Qs"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"selgradP", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.1", ",", "0.8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1", ",", "0.5", ",", "0.8", ",", "0.4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.85", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3", ",", "0.6", ",", "0.5", ",", "0.1"}], "}"}], ",", "0.1", 
   ",", "0.005", ",", "dp11"}], "]"}]}], "Input",
 CellChangeTimes->{{3.505140560825174*^9, 3.50514064385368*^9}, {
   3.505140714222675*^9, 3.505140746631989*^9}, 3.505141681810299*^9, {
   3.505141739370999*^9, 3.505141741390123*^9}, {3.5051417786037*^9, 
   3.505141823518378*^9}, {3.505162181348971*^9, 3.50516229325249*^9}, {
   3.5051623715172*^9, 3.505162376920246*^9}, {3.505162433552815*^9, 
   3.505162434058462*^9}, {3.505657684657195*^9, 3.505657708798037*^9}, {
   3.505815579213955*^9, 3.505815579839667*^9}, {3.505815706057299*^9, 
   3.505815706748337*^9}, {3.505836524337347*^9, 3.50583653604466*^9}, {
   3.505900621331135*^9, 3.50590062168389*^9}, {3.505900681816407*^9, 
   3.505900681925982*^9}, {3.505903100412446*^9, 3.505903105178415*^9}, {
   3.505903306382735*^9, 3.505903306450782*^9}, {3.505903337466215*^9, 
   3.505903337554181*^9}, {3.505903376116904*^9, 3.505903414205284*^9}, {
   3.507215441586883*^9, 3.507215441864266*^9}, {3.507217233968476*^9, 
   3.507217235012242*^9}, {3.507219035704643*^9, 3.507219036006999*^9}, 
   3.5072271240964108`*^9, {3.507445896704231*^9, 3.507445928564635*^9}, 
   3.507883896637253*^9, {3.507883963552722*^9, 3.507883964325812*^9}, {
   3.507884602887243*^9, 3.507884668140694*^9}, {3.508160912305312*^9, 
   3.508160916273239*^9}, {3.508161178047368*^9, 3.508161178663356*^9}, {
   3.520242444905705*^9, 3.520242462811362*^9}, {3.520242515256281*^9, 
   3.520242515537557*^9}, {3.520421764721227*^9, 3.520421771770569*^9}, {
   3.520421841855568*^9, 3.520421849321148*^9}, {3.520421888600866*^9, 
   3.520421892326528*^9}, {3.520422109210228*^9, 3.520422167950575*^9}, {
   3.520422201023795*^9, 3.520422205047305*^9}, {3.520422337344874*^9, 
   3.520422421071539*^9}, {3.520590680092812*^9, 3.520590711893722*^9}, {
   3.520590781521338*^9, 3.520590795966717*^9}, {3.520591226195406*^9, 
   3.520591240038307*^9}, {3.520601881307502*^9, 3.520601882092852*^9}, {
   3.524044511624154*^9, 3.52404451492298*^9}, {3.524044547404213*^9, 
   3.524044549627349*^9}, {3.524044778104684*^9, 3.524044795280702*^9}, 
   3.524555244523746*^9, {3.524555288584175*^9, 3.524555315808396*^9}, {
   3.524555363910387*^9, 3.524555377781718*^9}, {3.524555784594505*^9, 
   3.524555809327095*^9}, {3.52455601312634*^9, 3.52455602076801*^9}, {
   3.53177023662048*^9, 3.531770242557644*^9}, {3.59254503518889*^9, 
   3.59254507172961*^9}, {3.592545222393182*^9, 3.592545256670334*^9}, {
   3.616067762699471*^9, 3.6160677765635633`*^9}, {3.616067892099621*^9, 
   3.616067923768708*^9}, {3.624535652287249*^9, 3.6245356676559343`*^9}, {
   3.624535904966694*^9, 3.624535950165605*^9}, {3.624535985021688*^9, 
   3.624536027614222*^9}, {3.62453606121801*^9, 3.624536113754325*^9}}],

Cell[BoxData["0.24573856209955927`"], "Output",
 CellChangeTimes->{
  3.616067955683441*^9, 3.6160686513224154`*^9, 3.616134356078285*^9, 
   3.6161346790854483`*^9, 3.616141964171479*^9, 3.616142174389387*^9, 
   3.6161537949431887`*^9, 3.616160269333968*^9, 3.616160866599716*^9, {
   3.616231967039793*^9, 3.61623199391387*^9}, 3.61623301164435*^9, 
   3.618562244293478*^9, 3.62453605564952*^9, {3.624536087279592*^9, 
   3.624536150184835*^9}, 3.624536557767316*^9, 3.62453820819011*^9, 
   3.624538329437045*^9, 3.624549489351531*^9, 3.624558611367839*^9, 
   3.6245590393076887`*^9, 3.6245593536051292`*^9, 3.624559473306353*^9, 
   3.624565690247101*^9, 3.6248821483916388`*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Selection differentials for the migration rate, ",
 StyleBox["m",
  FontSlant->"Italic"]
}], "Section",
 CellChangeTimes->{{3.501844825699147*^9, 3.5018448260221663`*^9}, {
  3.593777661084167*^9, 3.593777663884243*^9}, {3.6245426000130863`*^9, 
  3.6245426020350323`*^9}}],

Cell[CellGroupData[{

Cell["Auxiliary functions", "Subsection",
 CellChangeTimes->{{3.616133815385255*^9, 3.616133826153467*^9}, {
  3.616134356955174*^9, 3.6161343572912273`*^9}, {3.624536270178116*^9, 
  3.624536272525186*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"localadotherdm", "[", 
   RowBox[{
   "es_", ",", "aself_", ",", "ageself_", ",", "a1other_", ",", "m1other_", 
    ",", "a2other_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a1total", ",", "a2total", ",", "m1total"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a1total", "=", 
      RowBox[{"a1other", "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"aself", "\[Equal]", "1"}], "&&", 
          RowBox[{"ageself", "\[Equal]", "0"}]}], ",", "1", ",", "0"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m1total", "=", 
      RowBox[{"m1other", "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"aself", "\[Equal]", "0"}], "&&", 
          RowBox[{"ageself", "\[Equal]", "0"}]}], ",", "1", ",", "0"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a2total", "=", 
      RowBox[{"a2other", "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"aself", "\[Equal]", "1"}], "&&", 
          RowBox[{"ageself", "\[Equal]", "1"}]}], ",", "1", ",", "0"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       FractionBox["a1other", "n"], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], "+", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", 
              RowBox[{"state", "[", 
               RowBox[{"aself", ",", "ageself"}], "]"}], ",", "es", ",", 
              "a1total", ",", "m1total", ",", "a2total"}], "]"}], 
            RowBox[{"dm", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}]}]}], ")"}]}], ")"}]}], 
      "+", 
      RowBox[{
       FractionBox["m1other", "n"], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
       RowBox[{"p", "[", 
        RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], "+", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"M1", ",", 
              RowBox[{"state", "[", 
               RowBox[{"aself", ",", "ageself"}], "]"}], ",", "es", ",", 
              "a1total", ",", "m1total", ",", "a2total"}], "]"}], 
            RowBox[{"dm", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}]}]}], ")"}]}], ")"}]}], 
      "+", "\[IndentingNewLine]", 
      RowBox[{
       FractionBox["a2other", "n"], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], "+", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"A2", ",", 
              RowBox[{"state", "[", 
               RowBox[{"aself", ",", "ageself"}], "]"}], ",", "es", ",", 
              "a1total", ",", "m1total", ",", "a2total"}], "]"}], 
            RowBox[{"dm", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}], ")"}]}], 
      "+", "\[IndentingNewLine]", 
      RowBox[{
       FractionBox[
        RowBox[{
        "n", "-", "1", "-", "a1other", "-", "m1other", "-", "a2other"}], "n"], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"p", "[", 
         RowBox[{"es", ",", "0", ",", "1"}], "]"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], "+", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"M2", ",", 
              RowBox[{"state", "[", 
               RowBox[{"aself", ",", "ageself"}], "]"}], ",", "es", ",", 
              "a1total", ",", "m1total", ",", "a2total"}], "]"}], 
            RowBox[{"dm", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}]}]}], ")"}]}], 
        ")"}]}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.59254363092905*^9, {3.6242016785281067`*^9, 3.624201707337722*^9}, {
   3.624202331530916*^9, 3.624202337928005*^9}, {3.624202384234132*^9, 
   3.624202419163906*^9}, {3.624202581312338*^9, 3.624202645379182*^9}, {
   3.6244478993588676`*^9, 3.624447939843565*^9}, {3.624448135069339*^9, 
   3.624448140218811*^9}, {3.624448176356419*^9, 3.624448219257268*^9}, {
   3.6244704359110737`*^9, 3.624470464832362*^9}, {3.624471174033204*^9, 
   3.6244712452717533`*^9}, {3.624471801238364*^9, 3.624471832788331*^9}, {
   3.624472491950687*^9, 3.624472525167705*^9}, {3.62447267261489*^9, 
   3.624472704193371*^9}, {3.6244727390770063`*^9, 3.6244727722562017`*^9}, {
   3.624472866759441*^9, 3.624472885191456*^9}, {3.624477209562134*^9, 
   3.624477243972971*^9}, {3.624477397608165*^9, 3.62447739818055*^9}, {
   3.6244775429000187`*^9, 3.624477555122077*^9}, {3.624482125538372*^9, 
   3.6244821262176456`*^9}, {3.624482332347114*^9, 3.624482338878045*^9}, {
   3.624536294018659*^9, 3.6245363263154163`*^9}, {3.624536365842608*^9, 
   3.624536438591325*^9}, {3.624538402375456*^9, 3.62453843176703*^9}, {
   3.624559441951569*^9, 3.62455944358567*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"localmadotherdm", "[", 
   RowBox[{
   "es_", ",", "aself_", ",", "ageself_", ",", "a1other_", ",", "m1other_", 
    ",", "a2other_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a1total", ",", "a2total", ",", "m1total"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"a1total", "=", 
      RowBox[{"a1other", "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"aself", "\[Equal]", "1"}], "&&", 
          RowBox[{"ageself", "\[Equal]", "0"}]}], ",", "1", ",", "0"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"m1total", "=", 
      RowBox[{"m1other", "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"aself", "\[Equal]", "0"}], "&&", 
          RowBox[{"ageself", "\[Equal]", "0"}]}], ",", "1", ",", "0"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"a2total", "=", 
      RowBox[{"a2other", "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"aself", "\[Equal]", "1"}], "&&", 
          RowBox[{"ageself", "\[Equal]", "1"}]}], ",", "1", ",", "0"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       FractionBox["a1other", "n"], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
       RowBox[{"p", "[", 
        RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "1", ",", "0"}], "]"}], "+", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"A1", ",", 
              RowBox[{"state", "[", 
               RowBox[{"aself", ",", "ageself"}], "]"}], ",", "es", ",", 
              "a1total", ",", "m1total", ",", "a2total"}], "]"}], 
            RowBox[{"dm", "[", 
             RowBox[{"es", ",", "1", ",", "0"}], "]"}]}]}], ")"}]}], ")"}]}], 
      "+", 
      RowBox[{
       FractionBox["m1other", "n"], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "0", ",", "0"}], "]"}], "+", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"M1", ",", 
              RowBox[{"state", "[", 
               RowBox[{"aself", ",", "ageself"}], "]"}], ",", "es", ",", 
              "a1total", ",", "m1total", ",", "a2total"}], "]"}], 
            RowBox[{"dm", "[", 
             RowBox[{"es", ",", "0", ",", "0"}], "]"}]}]}], ")"}]}], ")"}]}], 
      "+", "\[IndentingNewLine]", 
      RowBox[{
       FractionBox["a2other", "n"], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
       RowBox[{"p", "[", 
        RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "1", ",", "1"}], "]"}], "+", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"A2", ",", 
              RowBox[{"state", "[", 
               RowBox[{"aself", ",", "ageself"}], "]"}], ",", "es", ",", 
              "a1total", ",", "m1total", ",", "a2total"}], "]"}], 
            RowBox[{"dm", "[", 
             RowBox[{"es", ",", "1", ",", "1"}], "]"}]}]}], ")"}]}], ")"}]}], 
      "+", "\[IndentingNewLine]", 
      RowBox[{
       FractionBox[
        RowBox[{
        "n", "-", "1", "-", "a1other", "-", "m1other", "-", "a2other"}], "n"], 
       RowBox[{"g", "[", 
        RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"p", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "0", ",", "1"}], "]"}], "+", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"M2", ",", 
              RowBox[{"state", "[", 
               RowBox[{"aself", ",", "ageself"}], "]"}], ",", "es", ",", 
              "a1total", ",", "m1total", ",", "a2total"}], "]"}], 
            RowBox[{"dm", "[", 
             RowBox[{"es", ",", "0", ",", "1"}], "]"}]}]}], ")"}]}], 
        ")"}]}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.59254363092905*^9, {3.6242016785281067`*^9, 3.624201707337722*^9}, {
   3.624202331530916*^9, 3.624202337928005*^9}, {3.624202384234132*^9, 
   3.624202419163906*^9}, {3.624202581312338*^9, 3.624202645379182*^9}, {
   3.6244478993588676`*^9, 3.624447939843565*^9}, {3.624448135069339*^9, 
   3.624448140218811*^9}, {3.624448176356419*^9, 3.624448219257268*^9}, {
   3.6244704359110737`*^9, 3.624470464832362*^9}, {3.624471174033204*^9, 
   3.6244712452717533`*^9}, {3.624471801238364*^9, 3.624471832788331*^9}, {
   3.624472491950687*^9, 3.624472525167705*^9}, {3.62447267261489*^9, 
   3.624472704193371*^9}, {3.6244727390770063`*^9, 3.6244727722562017`*^9}, {
   3.624472866759441*^9, 3.624472885191456*^9}, {3.624477209562134*^9, 
   3.624477243972971*^9}, {3.624477397608165*^9, 3.62447739818055*^9}, {
   3.6244775429000187`*^9, 3.624477555122077*^9}, {3.624482125538372*^9, 
   3.6244821262176456`*^9}, {3.624482332347114*^9, 3.624482338878045*^9}, {
   3.624536294018659*^9, 3.6245363263154163`*^9}, {3.624536365842608*^9, 
   3.624536438591325*^9}, {3.624538402375456*^9, 3.62453843176703*^9}, {
   3.62453849694529*^9, 3.624538514360641*^9}, {3.624559438265205*^9, 
   3.624559440222224*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"localcomptotaldm", "[", 
   RowBox[{
   "es_", ",", "aself_", ",", "ageself_", ",", "a1other_", ",", "m1other_", 
    ",", "a2other_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"localadotherdm", "[", 
    RowBox[{
    "es", ",", "aself", ",", "ageself", ",", "a1other", ",", "m1other", ",", 
     "a2other"}], "]"}], "+", 
   RowBox[{"localmadotherdm", "[", 
    RowBox[{
    "es", ",", "aself", ",", "ageself", ",", "a1other", ",", "m1other", ",", 
     "a2other"}], "]"}], "+", 
   RowBox[{"dispad", "[", "es", "]"}], "+", 
   RowBox[{"dispmad", "[", "es", "]"}], "+", 
   RowBox[{
    FractionBox["1", "n"], 
    RowBox[{"g", "[", 
     RowBox[{"es", ",", "aself", ",", "ageself"}], "]"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"m", "[", 
         RowBox[{"es", ",", "aself", ",", "ageself"}], "]"}], "+", 
        RowBox[{"dm", "[", 
         RowBox[{"es", ",", "aself", ",", "ageself"}], "]"}]}], ")"}]}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.624539144658958*^9, 3.6245392165936327`*^9}, {
  3.624539255344078*^9, 3.624539310233467*^9}, {3.624559433411487*^9, 
  3.624559435861115*^9}}],

Cell["Selection differential of migration rate in juveniles", "Subsection",
 CellChangeTimes->{{3.624194703418602*^9, 3.624194704634268*^9}, {
  3.624194744419376*^9, 3.6241947751070137`*^9}, {3.624517922260405*^9, 
  3.624517926642351*^9}, {3.624538574661915*^9, 3.624538578214037*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdmJuv", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m2other", "=", 
         RowBox[{
         "n", "-", "1", "-", "a1other", "-", "m1other", "-", "a2other"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", "es", "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{
             RowBox[{"3", "-", "es"}], ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "m1other", ",", "a1other", ",",
              "m2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotaldm", "[", 
           RowBox[{
           "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"a", ".", " ", "focal"}], " ", "juvenile", " ", "breeder", 
           " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "own", " ", "offspring", " ", "of", " ",
            "a", " ", "different", " ", "type"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"m", "[", 
                  RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
                 RowBox[{"dm", "[", 
                  RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}], 
              ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", "n"}], ")"}], 
             RowBox[{"g", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
            RowBox[{"localcomptotaldm", "[", 
             RowBox[{
             "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}]]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"b", ".", " ", "focal"}], " ", "juvenile", " ", "breeder", 
           " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", "other", " ", "offspring"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{
           "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}], "-", 
          RowBox[{"v", "[", 
           RowBox[{
           "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]}], ")"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"1", 
          RowBox[{"c", ".", " ", "focal"}], " ", "juvenile", " ", "adapted", 
          " ", "breeder", " ", "matures", " ", "to", " ", "the", " ", "next", 
          " ", "stage"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotaldm", "[", 
           RowBox[{
           "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"v", "[", 
             RowBox[{"es", ",", "0", ",", "aself", ",", 
              RowBox[{"a1other", "-", "1", "+", "aself"}], ",", 
              RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
             "]"}]}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"a", ".", " ", "adapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", 
           "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotaldm", "[", 
           RowBox[{
           "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", 
             RowBox[{"a1other", "-", "1", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", "a2other"}], "]"}], "-", 
           
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"b", ".", " ", "adapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", "a",
            " ", "different", " ", "type", " ", "as", " ", "focal"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadotherdm", "[", 
             RowBox[{
             "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotaldm", "[", 
            RowBox[{
            "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1"}], ",", 
             RowBox[{"m1other", "+", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"c", ".", " ", "adapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "nonfocal", " ", "offspring", " ", 
           "that", " ", "is", " ", "maladapted"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "+", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"2", 
          RowBox[{"d", ".", " ", "adapted"}], " ", "nonfocal", " ", 
          "juvenile", " ", "matures", " ", "to", " ", "adult", " ", 
          "breedership"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotaldm", "[", 
           RowBox[{
           "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"v", "[", 
             RowBox[{"es", ",", "0", ",", "aself", ",", 
              RowBox[{"a1other", "+", "aself"}], ",", 
              RowBox[{"m1other", "-", "1", "+", "1", "-", "aself"}], ",", 
              "a2other"}], "]"}]}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"a", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", 
           "the", " ", "same", " ", "phenotype", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotaldm", "[", 
           RowBox[{
           "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "-", "1", "+", "1", "-", "aself"}], ",", 
             "a2other"}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "-", "1", "+", "aself"}], ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"b", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", "a",
            " ", "different", " ", "phenotype", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadotherdm", "[", 
             RowBox[{
             "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotaldm", "[", 
            RowBox[{
            "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", 
             RowBox[{"m1other", "-", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"c", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "nonfocal", " ", "offspring", " ", 
           "that", " ", "is", " ", "adapted"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "-", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"3", 
          RowBox[{"d", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
          "juvenile", " ", "breeder", " ", "survives", " ", "to", " ", 
          "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}], ")"}
            ], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotaldm", "[", 
           RowBox[{
           "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"a", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "a", " ", "different", " ", "type", " ", "than", " ", 
           "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotaldm", "[", 
           RowBox[{
           "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"v", "[", 
             RowBox[{"es", ",", "0", ",", "aself", ",", 
              RowBox[{"a1other", "+", "aself"}], ",", 
              RowBox[{"m1other", "+", "1", "-", "aself"}], ",", 
              RowBox[{"a2other", "-", "1"}]}], "]"}]}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"b", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadotherdm", "[", 
             RowBox[{
             "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotaldm", "[", 
            RowBox[{
            "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"c", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "nonfocal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadotherdm", "[", 
             RowBox[{
             "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotaldm", "[", 
            RowBox[{
            "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "+", "1"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"d", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "nonfocal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotaldm", "[", 
           RowBox[{
           "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", "a2other"}], "]"}], "+", 
           
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"a", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "a", " ", "different", " ", "type", " ", "than", " ", 
           "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], 
          RowBox[{"localcomptotaldm", "[", 
           RowBox[{
           "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"v", "[", 
             RowBox[{"es", ",", "0", ",", "aself", ",", 
              RowBox[{"a1other", "+", "aself"}], ",", 
              RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
             "]"}]}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"b", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadotherdm", "[", 
             RowBox[{
             "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotaldm", "[", 
            RowBox[{
            "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", "m1other", ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"c", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadotherdm", "[", 
             RowBox[{
             "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotaldm", "[", 
            RowBox[{
            "es", ",", "aself", ",", "0", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "+", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"d", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "n"}], ")"}], 
         RowBox[{"g", "[", 
          RowBox[{"es", ",", "aself", ",", "0"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", "k"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "+", 
           RowBox[{"dm", "[", 
            RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"zm2", "=", 
               RowBox[{"n", "-", "za1", "-", "zm1", "-", "za2"}]}], "}"}], 
             ",", 
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{
               "zes", ",", "za1", ",", "zm1", ",", "za2", ",", "zm2"}], "]"}], 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"za1", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "1", ",", "0"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", 
                    RowBox[{"za1", "-", "1"}], ",", "zm1", ",", "za2"}], 
                    "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    RowBox[{"za1", "-", "1"}], ",", "zm1", ",", "za2"}], 
                    "]"}]}]}], "\[IndentingNewLine]", ")"}]}], 
                "\[IndentingNewLine]", "+", 
                RowBox[{"zm1", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "0", ",", "0"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    RowBox[{"zm1", "-", "1"}], ",", "za2"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", 
                    RowBox[{"zm1", "-", "1"}], ",", "za2"}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "+", 
                
                RowBox[{"za2", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "1", ",", "1"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    "zm1", ",", 
                    RowBox[{"za2", "-", "1"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", "zm1", ",", 
                    RowBox[{"za2", "-", "1"}]}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "+", 
                
                RowBox[{"zm2", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "0", ",", "1"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    "zm1", ",", "za2"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "0"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", "zm1", ",", "za2"}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", 
               ")"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"zes", ",", "1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"za1", ",", "0", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zm1", ",", "0", ",", 
             RowBox[{"n", "-", "za1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"za2", ",", "0", ",", 
             RowBox[{"n", "-", "za1", "-", "zm1"}]}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a1other", ",", "0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m1other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other", "-", "m1other"}]}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.624105393315069*^9, 3.624105424785666*^9}, {
   3.624105542758597*^9, 3.624105550700832*^9}, {3.624105634651022*^9, 
   3.6241056558512907`*^9}, {3.624106910657282*^9, 3.624106951717827*^9}, {
   3.62410723426145*^9, 3.6241072952709713`*^9}, {3.6241073313493013`*^9, 
   3.6241074057358103`*^9}, {3.6241074645950747`*^9, 3.624107630937098*^9}, {
   3.624107672161605*^9, 3.624107696256287*^9}, {3.624107728743771*^9, 
   3.624107907116013*^9}, {3.624108519063383*^9, 3.624108589425164*^9}, {
   3.624108641315518*^9, 3.624108644553985*^9}, {3.624108833022855*^9, 
   3.624108864366914*^9}, {3.624108999412953*^9, 3.624109037338584*^9}, {
   3.624109757301538*^9, 3.624109816130487*^9}, {3.624110628383292*^9, 
   3.624110833628664*^9}, {3.624110908970429*^9, 3.624110929575144*^9}, {
   3.624110974936181*^9, 3.624111011867834*^9}, {3.624111075130018*^9, 
   3.624111098126931*^9}, {3.624111172158141*^9, 3.6241111756160097`*^9}, {
   3.624111247687255*^9, 3.624111290220771*^9}, {3.624111337718417*^9, 
   3.6241113929905357`*^9}, 3.624111459721759*^9, {3.624111503087812*^9, 
   3.624111567750102*^9}, {3.624111644629919*^9, 3.624111655607366*^9}, {
   3.624112058631222*^9, 3.624112177756599*^9}, 3.624112296789069*^9, {
   3.6241123277544823`*^9, 3.624112356208357*^9}, {3.624112476305134*^9, 
   3.624112495511964*^9}, {3.624112544110755*^9, 3.6241125623089447`*^9}, {
   3.624112634463889*^9, 3.6241126670311213`*^9}, {3.624112699002626*^9, 
   3.624112757417794*^9}, {3.624112800664715*^9, 3.624112811731379*^9}, {
   3.624114458578978*^9, 3.6241145110967503`*^9}, {3.6241156278447027`*^9, 
   3.624115676439664*^9}, {3.624115710006269*^9, 3.624115720724999*^9}, {
   3.624116126772534*^9, 3.624116143875856*^9}, {3.624117054944509*^9, 
   3.624117122909733*^9}, {3.624117232977274*^9, 3.624117233371319*^9}, {
   3.624117347738717*^9, 3.624117358275321*^9}, {3.624117388353952*^9, 
   3.6241173962020197`*^9}, {3.624117435590787*^9, 3.624117491493388*^9}, {
   3.6241179082263193`*^9, 3.624117919533782*^9}, 3.624121236873742*^9, {
   3.624121576678515*^9, 3.624121768038467*^9}, {3.624121818408928*^9, 
   3.62412184063608*^9}, {3.624122066672517*^9, 3.624122085633874*^9}, {
   3.624122146422144*^9, 3.624122210443741*^9}, {3.62412825762978*^9, 
   3.624128279184132*^9}, {3.6241349066411533`*^9, 3.624134935983481*^9}, {
   3.624134973365363*^9, 3.624135067662483*^9}, {3.624135275875266*^9, 
   3.624135304590047*^9}, {3.624135424804736*^9, 3.6241354794836073`*^9}, {
   3.624135537150897*^9, 3.624135551681814*^9}, {3.624136317804256*^9, 
   3.624136592868403*^9}, {3.624136623531128*^9, 3.624136666441414*^9}, {
   3.624136752200927*^9, 3.6241367920838137`*^9}, {3.6241368256210117`*^9, 
   3.624136916638122*^9}, {3.62418830554675*^9, 3.6241883064004908`*^9}, {
   3.6241886156711493`*^9, 3.624188616434956*^9}, {3.624197138929085*^9, 
   3.624197141443653*^9}, {3.624199077465385*^9, 3.6241990776535378`*^9}, {
   3.624201194317346*^9, 3.624201231631407*^9}, {3.624201533263768*^9, 
   3.624201560299189*^9}, {3.6242029666179333`*^9, 3.624203130670968*^9}, {
   3.624204116478397*^9, 3.624204116652637*^9}, {3.6245386478581533`*^9, 
   3.624538651446231*^9}, {3.6245390511278963`*^9, 3.624539077587016*^9}, {
   3.624539263421858*^9, 3.624539263534259*^9}, {3.624539459804575*^9, 
   3.624539477279045*^9}, {3.624539513045376*^9, 3.6245397537489643`*^9}, {
   3.6245397848309393`*^9, 3.624539828751441*^9}, {3.6245586371391773`*^9, 
   3.624558655854876*^9}, {3.624559428364912*^9, 3.624559432384923*^9}}],

Cell["Selection differential of migration rate in adults", "Subsection",
 CellChangeTimes->{{3.624194765851487*^9, 3.624194770611102*^9}, {
  3.624517953843247*^9, 3.6245179576183987`*^9}, {3.624538580053361*^9, 
  3.624538583171118*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dvdmAd", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m2other", "=", 
         RowBox[{
         "n", "-", "1", "-", "a1other", "-", "m1other", "-", "a2other"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"s", "[", "es", "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{
             RowBox[{"3", "-", "es"}], ",", "1", ",", 
             RowBox[{"1", "-", "aself"}], ",", "m1other", ",", "a1other", ",",
              "m2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"envt", " ", "change"}], " ", "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotaldm", "[", 
           RowBox[{
           "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", 
             RowBox[{"a1other", "-", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", "a2other"}], "]"}], "-", 
           
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"a", ".", " ", "adapted"}], " ", "juvenile", " ", 
           "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "own", " ", "offspring", " ", "of", " ",
            "a", " ", "different", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotaldm", "[", 
           RowBox[{
           "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"b", ".", " ", "adapted"}], " ", "juvenile", " ", 
           "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "own", " ", "offspring", " ", "of", " ",
            "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], " ",
          "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "0"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadotherdm", "[", 
             RowBox[{
             "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotaldm", "[", 
            RowBox[{
            "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1"}], ",", 
             RowBox[{"m1other", "+", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"1", 
           RowBox[{"c", ".", " ", "adapted"}], " ", "juvenile", " ", 
           "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "nonfocal", " ", "maladapted", " ", 
           "juvenile", " ", "offspring"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"a1other", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "-", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "+", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"1", 
          RowBox[{"d", ".", " ", "focal"}], " ", "juvenile", " ", "adapted", 
          " ", "breeder", " ", "matures", " ", "to", " ", "the", " ", "next", 
          " ", "stage"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotaldm", "[", 
           RowBox[{
           "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "-", "1"}], ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "-", "1", "+", "1", "-", "aself"}], ",", 
             "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"a", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", 
           "the", " ", "same", " ", "phenotype", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotaldm", "[", 
           RowBox[{
           "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "a1other", ",", 
             RowBox[{"m1other", "-", "1"}], ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "-", "1", "+", "aself"}], ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"b", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{"replaced", " ", "by", " ", 
           RowBox[{"focal", "'"}], "s", " ", "offspring", " ", "of", " ", "a",
            " ", "different", " ", "phenotype", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "0"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadotherdm", "[", 
             RowBox[{
             "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotaldm", "[", 
            RowBox[{
            "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", 
             RowBox[{"m1other", "-", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"c", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
           "juvenile", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "nonfocal", " ", "offspring", " ", 
           "that", " ", "is", " ", "adapted"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", "+", 
        RowBox[{"m1other", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "-", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"2", 
          RowBox[{"d", ".", " ", "maladapted"}], " ", "nonfocal", " ", 
          "juvenile", " ", "breeder", " ", "survives", " ", "to", " ", 
          "adulthood"}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotaldm", "[", 
           RowBox[{
           "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"a", ".", " ", "focal"}], " ", "adult", " ", "breeder", 
           " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "a", " ", "different", " ", "type", " ", "as", " ", 
           "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotaldm", "[", 
           RowBox[{
           "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"b", ".", " ", "focal"}], " ", "adult", " ", "breeder", 
           " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"m", "[", 
                  RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
                 RowBox[{"dm", "[", 
                  RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}], 
              ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", "n"}], ")"}], 
             RowBox[{"g", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
            RowBox[{"localcomptotaldm", "[", 
             RowBox[{
             "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}]]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"3", 
           RowBox[{"c", ".", " ", "focal"}], " ", "adult", " ", "breeder", 
           " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "nonfocal", " ", "offspring"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotaldm", "[", 
           RowBox[{
           "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "a1other", ",", "m1other", ",",
              
             RowBox[{"a2other", "+", "aself", "-", "1"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"a", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "a", " ", "different", " ", "type", " ", "than", " ", 
           "focal"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotaldm", "[", 
           RowBox[{
           "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself", "-", "1"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"b", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadotherdm", "[", 
             RowBox[{
             "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotaldm", "[", 
            RowBox[{
            "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", "m1other", ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"c", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "nonfocal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"a2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "1", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadotherdm", "[", 
             RowBox[{
             "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotaldm", "[", 
            RowBox[{
            "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "+", "1"}], ",", 
             RowBox[{"a2other", "-", "1"}]}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"4", 
           RowBox[{"d", ".", " ", "adapted"}], " ", "adult", " ", "nonfocal", 
           " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "maladapted", " ", "nonfocal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"p", "[", 
              RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotaldm", "[", 
           RowBox[{
           "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "0", ",", "aself", ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "aself"}], ",", 
             RowBox[{"m1other", "+", "1", "-", "aself"}], ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"a", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
               RowBox[{"dm", "[", 
                RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}]}], 
            ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", "n"}], ")"}], 
           RowBox[{"p", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
           RowBox[{"g", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], 
          RowBox[{"localcomptotaldm", "[", 
           RowBox[{
           "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", ",", 
            "a2other"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "0", ",", 
             RowBox[{"1", "-", "aself"}], ",", "a1other", ",", "m1other", ",", 
             RowBox[{"a2other", "+", "aself"}]}], "]"}], "+", 
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1", "-", "aself"}], ",", 
             RowBox[{"m1other", "+", "aself"}], ",", "a2other"}], "]"}], "-", 
           
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"b", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "focal", " ", "offspring", " ", "of", 
           " ", "the", " ", "same", " ", "type", " ", "as", " ", "focal"}]}], 
         " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localadotherdm", "[", 
             RowBox[{
             "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotaldm", "[", 
            RowBox[{
            "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", 
             RowBox[{"a1other", "+", "1"}], ",", "m1other", ",", "a2other"}], 
            "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"c", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"m2other", " ", 
         RowBox[{"d", "[", 
          RowBox[{"es", ",", "0", ",", "1"}], "]"}], 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"localmadotherdm", "[", 
             RowBox[{
             "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", 
              ",", "a2other"}], "]"}], "+", 
            RowBox[{"dispmad", "[", "es", "]"}]}], 
           RowBox[{"localcomptotaldm", "[", 
            RowBox[{
            "es", ",", "aself", ",", "1", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"es", ",", "1", ",", "aself", ",", "a1other", ",", 
             RowBox[{"m1other", "+", "1"}], ",", "a2other"}], "]"}], "-", 
           RowBox[{"v", "[", 
            RowBox[{
            "es", ",", "1", ",", "aself", ",", "a1other", ",", "m1other", ",",
              "a2other"}], "]"}]}], ")"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"5", 
           RowBox[{"d", ".", " ", "maladapted"}], " ", "adult", " ", 
           "nonfocal", " ", "breeder", " ", "dies"}], ",", " ", 
          RowBox[{
          "replaced", " ", "by", " ", "adapted", " ", "focal", " ", 
           "offspring"}]}], " ", "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "n"}], ")"}], 
         RowBox[{"g", "[", 
          RowBox[{"es", ",", "aself", ",", "1"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", "k"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "+", 
           RowBox[{"dm", "[", 
            RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"zm2", "=", 
               RowBox[{"n", "-", "za1", "-", "zm1", "-", "za2"}]}], "}"}], 
             ",", 
             RowBox[{
              RowBox[{"f", "[", 
               RowBox[{
               "zes", ",", "za1", ",", "zm1", ",", "za2", ",", "zm2"}], "]"}], 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"za1", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "1", ",", "0"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", 
                    RowBox[{"za1", "-", "1"}], ",", "zm1", ",", "za2"}], 
                    "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], ")"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    RowBox[{"za1", "-", "1"}], ",", "zm1", ",", "za2"}], 
                    "]"}]}]}], "\[IndentingNewLine]", ")"}]}], 
                "\[IndentingNewLine]", "+", 
                RowBox[{"zm1", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "0", ",", "0"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    RowBox[{"zm1", "-", "1"}], ",", "za2"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], ")"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", 
                    RowBox[{"zm1", "-", "1"}], ",", "za2"}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "+", 
                
                RowBox[{"za2", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "1", ",", "1"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    "zm1", ",", 
                    RowBox[{"za2", "-", "1"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", "zm1", ",", 
                    RowBox[{"za2", "-", "1"}]}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", "+", 
                
                RowBox[{"zm2", " ", 
                 RowBox[{"d", "[", 
                  RowBox[{"zes", ",", "0", ",", "1"}], "]"}], 
                 RowBox[{"(", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}]}], ")"}], 
                    "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", "aself", ",", 
                    RowBox[{"1", "-", "aself"}]}], "]"}], ",", "za1", ",", 
                    "zm1", ",", "za2"}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"es", ",", "aself", ",", "1"}], "]"}], "/", 
                    RowBox[{"localcomptotal", "[", 
                    RowBox[{"zes", ",", "za1", ",", "zm1", ",", "za2"}], 
                    "]"}]}], 
                    RowBox[{"v", "[", 
                    RowBox[{"zes", ",", "0", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"zes", "\[Equal]", "es"}], ",", 
                    RowBox[{"1", "-", "aself"}], ",", "aself"}], "]"}], ",", 
                    "za1", ",", "zm1", ",", "za2"}], "]"}]}]}], 
                  "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", 
               ")"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"zes", ",", "1", ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"za1", ",", "0", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zm1", ",", "0", ",", 
             RowBox[{"n", "-", "za1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"za2", ",", "0", ",", 
             RowBox[{"n", "-", "za1", "-", "zm1"}]}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a1other", ",", "0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m1other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other", "-", "m1other"}]}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.624105393315069*^9, 3.624105424785666*^9}, {
   3.624105542758597*^9, 3.624105550700832*^9}, {3.624105634651022*^9, 
   3.6241056558512907`*^9}, {3.624106910657282*^9, 3.624106951717827*^9}, {
   3.62410723426145*^9, 3.6241072952709713`*^9}, {3.6241073313493013`*^9, 
   3.6241074057358103`*^9}, {3.6241074645950747`*^9, 3.624107630937098*^9}, {
   3.624107672161605*^9, 3.624107696256287*^9}, {3.624107728743771*^9, 
   3.624107907116013*^9}, {3.624108519063383*^9, 3.624108589425164*^9}, {
   3.624108641315518*^9, 3.624108644553985*^9}, {3.624108833022855*^9, 
   3.624108864366914*^9}, {3.624108999412953*^9, 3.624109037338584*^9}, {
   3.624109757301538*^9, 3.624109816130487*^9}, {3.624110628383292*^9, 
   3.624110833628664*^9}, {3.624110908970429*^9, 3.624110929575144*^9}, {
   3.624110974936181*^9, 3.624111011867834*^9}, {3.624111075130018*^9, 
   3.624111098126931*^9}, {3.624111172158141*^9, 3.6241111756160097`*^9}, {
   3.624111247687255*^9, 3.624111290220771*^9}, {3.624111337718417*^9, 
   3.6241113929905357`*^9}, 3.624111459721759*^9, {3.624111503087812*^9, 
   3.624111567750102*^9}, {3.624111644629919*^9, 3.624111655607366*^9}, {
   3.624112058631222*^9, 3.624112177756599*^9}, 3.624112296789069*^9, {
   3.6241123277544823`*^9, 3.624112356208357*^9}, {3.624112476305134*^9, 
   3.624112495511964*^9}, {3.624112544110755*^9, 3.6241125623089447`*^9}, {
   3.624112634463889*^9, 3.6241126670311213`*^9}, {3.624112699002626*^9, 
   3.624112757417794*^9}, {3.624112800664715*^9, 3.624112811731379*^9}, {
   3.624114458578978*^9, 3.6241145110967503`*^9}, {3.6241156278447027`*^9, 
   3.624115676439664*^9}, {3.624115710006269*^9, 3.624115720724999*^9}, {
   3.624116126772534*^9, 3.624116143875856*^9}, {3.624117054944509*^9, 
   3.624117122909733*^9}, {3.624117232977274*^9, 3.624117233371319*^9}, {
   3.624117347738717*^9, 3.624117358275321*^9}, {3.624117388353952*^9, 
   3.6241173962020197`*^9}, {3.624117435590787*^9, 3.624117491493388*^9}, {
   3.6241179082263193`*^9, 3.624117919533782*^9}, 3.624121236873742*^9, {
   3.624121576678515*^9, 3.624121768038467*^9}, {3.624121818408928*^9, 
   3.62412184063608*^9}, {3.624122066672517*^9, 3.624122085633874*^9}, {
   3.624122146422144*^9, 3.624122210443741*^9}, {3.62412825762978*^9, 
   3.624128279184132*^9}, {3.6241349066411533`*^9, 3.624134935983481*^9}, {
   3.624134973365363*^9, 3.624135067662483*^9}, {3.624135275875266*^9, 
   3.624135304590047*^9}, {3.624135424804736*^9, 3.6241354794836073`*^9}, {
   3.624135537150897*^9, 3.624135551681814*^9}, {3.624136317804256*^9, 
   3.624136592868403*^9}, {3.624136623531128*^9, 3.624136666441414*^9}, {
   3.624136752200927*^9, 3.6241367920838137`*^9}, {3.6241368256210117`*^9, 
   3.624136916638122*^9}, {3.6241371119526377`*^9, 3.624137123015327*^9}, {
   3.6241374691646013`*^9, 3.624137482972671*^9}, {3.62413752011064*^9, 
   3.624137593860952*^9}, {3.624137635384986*^9, 3.624137709797246*^9}, 
   3.624188325910187*^9, {3.624195595519504*^9, 3.624195754485969*^9}, {
   3.624196895973914*^9, 3.624196947786957*^9}, {3.62419700975912*^9, 
   3.624197118941063*^9}, {3.624197187438719*^9, 3.624197221520343*^9}, {
   3.6241972550854397`*^9, 3.624197332028689*^9}, {3.6241973719157763`*^9, 
   3.624197420877294*^9}, {3.62419828534858*^9, 3.624198288802609*^9}, {
   3.624198319938748*^9, 3.6241983445530663`*^9}, {3.624198810897176*^9, 
   3.6241988875524607`*^9}, {3.6241989556213207`*^9, 
   3.6241990234801693`*^9}, {3.62419905426888*^9, 3.624199054363193*^9}, {
   3.62419911295243*^9, 3.624199113125098*^9}, {3.624199146457932*^9, 
   3.624199149804529*^9}, {3.624199184101955*^9, 3.624199204727675*^9}, {
   3.6241992966541157`*^9, 3.624199346002799*^9}, {3.624199431265285*^9, 
   3.624199444946371*^9}, {3.624199495212886*^9, 3.6241995219215612`*^9}, {
   3.624199566362286*^9, 3.624199684797461*^9}, {3.624199739365447*^9, 
   3.624199793268449*^9}, {3.624200115688655*^9, 3.624200116575446*^9}, {
   3.624200156439021*^9, 3.624200161419701*^9}, {3.624200195640967*^9, 
   3.624200293813195*^9}, {3.624200524231401*^9, 3.6242005507180767`*^9}, {
   3.624201033128936*^9, 3.6242010491402683`*^9}, {3.6242011314151993`*^9, 
   3.624201157681975*^9}, {3.6242013117409353`*^9, 3.624201401595797*^9}, {
   3.624203185613224*^9, 3.62420324017876*^9}, {3.62420331045933*^9, 
   3.624203338476714*^9}, {3.624203379360961*^9, 3.624203379451083*^9}, {
   3.624203414346799*^9, 3.624203450906179*^9}, {3.624203677437587*^9, 
   3.6242036997938766`*^9}, {3.624204133116194*^9, 3.6242041333410673`*^9}, {
   3.624280719591448*^9, 3.624280719701469*^9}, {3.624517964914661*^9, 
   3.6245180575028954`*^9}, {3.624518232612445*^9, 3.6245182847666817`*^9}, {
   3.62451860212917*^9, 3.6245186039160757`*^9}, {3.624539947975587*^9, 
   3.624540156036602*^9}, {3.62454020366968*^9, 3.6245403617577877`*^9}, {
   3.624540393346467*^9, 3.624540442149116*^9}, {3.624540495405452*^9, 
   3.624540495563533*^9}, {3.624559422306901*^9, 3.624559426211309*^9}}],

Cell[CellGroupData[{

Cell["Numerical evaluation of both selection differentials", "Subsection",
 CellChangeTimes->{
  3.616139686679941*^9, {3.624540559253138*^9, 3.624540563749569*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dveqdmtJuv", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"dvdmJuv", "[", 
         RowBox[{"[", 
          RowBox[{"es", ",", 
           RowBox[{"1", "+", "aself"}], ",", 
           RowBox[{"1", "+", "a1other"}], ",", 
           RowBox[{"1", "+", "m1other"}], ",", 
           RowBox[{"1", "+", "a2other"}]}], "]"}], "]"}], ",", "dmt"}], "]"}],
       "/.", 
      RowBox[{"{", 
       RowBox[{"dmt", "\[Rule]", "0"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a1other", ",", "0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m1other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other", "-", "m1other"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dveqdmtAd", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"dvdmAd", "[", 
         RowBox[{"[", 
          RowBox[{"es", ",", 
           RowBox[{"1", "+", "aself"}], ",", 
           RowBox[{"1", "+", "a1other"}], ",", 
           RowBox[{"1", "+", "m1other"}], ",", 
           RowBox[{"1", "+", "a2other"}]}], "]"}], "]"}], ",", "dmt"}], "]"}],
       "/.", 
      RowBox[{"{", 
       RowBox[{"dmt", "\[Rule]", "0"}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"aself", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a1other", ",", "0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m1other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2other", ",", "0", ",", 
       RowBox[{"n", "-", "1", "-", "a1other", "-", "m1other"}]}], "}"}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.501843432551832*^9, 3.50184343360995*^9}, {
   3.501843944380341*^9, 3.501843964281032*^9}, 3.501844040723341*^9, {
   3.505138889414682*^9, 3.50513890024374*^9}, {3.505140339692244*^9, 
   3.505140380980634*^9}, {3.505155691794249*^9, 3.505155696978383*^9}, {
   3.616055864194425*^9, 3.616055877835294*^9}, {3.616063327990137*^9, 
   3.616063364094*^9}, 3.616063435500227*^9, {3.6160671442790537`*^9, 
   3.616067144632298*^9}, {3.6245186102590113`*^9, 3.624518613947728*^9}, {
   3.624519087319708*^9, 3.624519114167334*^9}, {3.624519317598583*^9, 
   3.624519333792856*^9}, {3.6245194691578197`*^9, 3.6245195270373287`*^9}, {
   3.624519598061749*^9, 3.6245196135427856`*^9}, {3.624538131481344*^9, 
   3.624538131853119*^9}, {3.624540607833696*^9, 3.624540690904634*^9}, {
   3.6245594170312843`*^9, 3.624559420003991*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dveqdmt", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"es", ",", "a1", ",", "m1", ",", "a2", ",", 
         RowBox[{"n", "-", "a1", "-", "m1", "-", "a2"}]}], "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"a1", ">", "0"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a1", "/", "n"}], ")"}], 
            RowBox[{"dveqdmtJuv", "[", 
             RowBox[{"[", 
              RowBox[{"es", ",", 
               RowBox[{"1", "+", "1"}], ",", 
               RowBox[{"1", "+", "a1", "-", "1"}], ",", 
               RowBox[{"1", "+", "m1"}], ",", 
               RowBox[{"1", "+", "a2"}]}], "]"}], "]"}]}], ",", "0"}], "]"}], 
         "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            FractionBox["m1", "n"], ">", "0"}], ",", 
           RowBox[{"dveqdmtJuv", "[", 
            RowBox[{"[", 
             RowBox[{"es", ",", 
              RowBox[{"1", "+", "0"}], ",", 
              RowBox[{"1", "+", "a1"}], ",", 
              RowBox[{"1", "+", "m1", "-", "1"}], ",", 
              RowBox[{"1", "+", "a2"}]}], "]"}], "]"}], ",", "0"}], "]"}], 
         "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            FractionBox["a2", "n"], ">", "0"}], ",", 
           RowBox[{"dveqdmtAd", "[", 
            RowBox[{"[", 
             RowBox[{"es", ",", 
              RowBox[{"1", "+", "1"}], ",", 
              RowBox[{"1", "+", "a1"}], ",", 
              RowBox[{"1", "+", "m1"}], ",", 
              RowBox[{"1", "+", "a2", "-", "1"}]}], "]"}], "]"}], ",", "0"}], 
          "]"}], "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            FractionBox[
             RowBox[{"n", "-", "a1", "-", "m1", "-", "a2"}], "n"], ">", "0"}],
            ",", 
           RowBox[{"dveqdmtAd", "[", 
            RowBox[{"[", 
             RowBox[{"es", ",", 
              RowBox[{"1", "+", "0"}], ",", 
              RowBox[{"1", "+", "a1"}], ",", 
              RowBox[{"1", "+", "m1"}], ",", 
              RowBox[{"1", "+", "a2"}]}], "]"}], "]"}], ",", "0"}], "]"}]}], 
        ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"a1", ",", "0", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"m1", ",", "0", ",", 
        RowBox[{"n", "-", "a1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"a2", ",", "0", ",", 
        RowBox[{"n", "-", "a1", "-", "m1"}]}], "}"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"A2", ",", "A1", ",", "1", ",", "1", ",", "0", ",", "1"}], 
        "]"}], "->", 
       RowBox[{"r", "[", 
        RowBox[{"A1", ",", "A2", ",", "1", ",", "1", ",", "0", ",", "1"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"A2", ",", "A1", ",", "2", ",", "1", ",", "0", ",", "1"}], 
        "]"}], "->", 
       RowBox[{"r", "[", 
        RowBox[{"A1", ",", "A2", ",", "2", ",", "1", ",", "0", ",", "1"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"A2", ",", "M1", ",", "1", ",", "0", ",", "1", ",", "1"}], 
        "]"}], "->", 
       RowBox[{"r", "[", 
        RowBox[{"M1", ",", "A2", ",", "1", ",", "0", ",", "1", ",", "1"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"A2", ",", "M1", ",", "2", ",", "0", ",", "1", ",", "1"}], 
        "]"}], "->", 
       RowBox[{"r", "[", 
        RowBox[{"M1", ",", "A2", ",", "2", ",", "0", ",", "1", ",", "1"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"M2", ",", "A1", ",", "1", ",", "1", ",", "0", ",", "0"}], 
        "]"}], "->", 
       RowBox[{"r", "[", 
        RowBox[{"A1", ",", "M2", ",", "1", ",", "1", ",", "0", ",", "0"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"M2", ",", "A1", ",", "2", ",", "1", ",", "0", ",", "0"}], 
        "]"}], "->", 
       RowBox[{"r", "[", 
        RowBox[{"A1", ",", "M2", ",", "2", ",", "1", ",", "0", ",", "0"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"M2", ",", "A2", ",", "1", ",", "0", ",", "0", ",", "1"}], 
        "]"}], "->", 
       RowBox[{"r", "[", 
        RowBox[{"A2", ",", "M2", ",", "1", ",", "0", ",", "0", ",", "1"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"M2", ",", "A2", ",", "2", ",", "0", ",", "0", ",", "1"}], 
        "]"}], "->", 
       RowBox[{"r", "[", 
        RowBox[{"A2", ",", "M2", ",", "2", ",", "0", ",", "0", ",", "1"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"M2", ",", "M1", ",", "1", ",", "0", ",", "1", ",", "0"}], 
        "]"}], "->", 
       RowBox[{"r", "[", 
        RowBox[{"M1", ",", "M2", ",", "1", ",", "0", ",", "1", ",", "0"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"M2", ",", "M1", ",", "2", ",", "0", ",", "1", ",", "0"}], 
        "]"}], "->", 
       RowBox[{"r", "[", 
        RowBox[{"M1", ",", "M2", ",", "2", ",", "0", ",", "1", ",", "0"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"M1", ",", "A1", ",", "1", ",", "1", ",", "1", ",", "0"}], 
        "]"}], "->", 
       RowBox[{"r", "[", 
        RowBox[{"A1", ",", "M1", ",", "1", ",", "1", ",", "1", ",", "0"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "[", 
        RowBox[{"M1", ",", "A1", ",", "2", ",", "1", ",", "1", ",", "0"}], 
        "]"}], "->", 
       RowBox[{"r", "[", 
        RowBox[{"A1", ",", "M1", ",", "2", ",", "1", ",", "1", ",", "0"}], 
        "]"}]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.501844024430171*^9, 3.5018440511114883`*^9}, {
   3.50514040533693*^9, 3.505140411037161*^9}, {3.505140552660536*^9, 
   3.50514055349495*^9}, {3.520590601347611*^9, 3.520590621759652*^9}, {
   3.52060189014863*^9, 3.520601890770993*^9}, {3.616064097243224*^9, 
   3.616064209353109*^9}, {3.6160642428914337`*^9, 3.616064259530616*^9}, {
   3.6160643008162413`*^9, 3.616064308762124*^9}, {3.6160645859989443`*^9, 
   3.6160646083037777`*^9}, {3.616064653848179*^9, 3.616064699312509*^9}, {
   3.6160647296151867`*^9, 3.616064738409442*^9}, {3.61606543024749*^9, 
   3.616065460163162*^9}, {3.616067357339373*^9, 3.616067410496578*^9}, {
   3.6161420819076777`*^9, 3.616142089063945*^9}, {3.624519631860857*^9, 
   3.624519669142592*^9}, {3.6245197719928217`*^9, 3.624519793303273*^9}, {
   3.624520234957644*^9, 3.6245202819429903`*^9}, {3.624521312327379*^9, 
   3.624521312529562*^9}, {3.624521342745699*^9, 3.624521359209094*^9}, {
   3.624521445190003*^9, 3.624521525306765*^9}, {3.624521559884698*^9, 
   3.624521592610403*^9}, {3.624521642429988*^9, 3.624521717143528*^9}, {
   3.624536132430574*^9, 3.6245361396746893`*^9}, {3.624537760036705*^9, 
   3.6245377680900593`*^9}, {3.624538273263628*^9, 3.624538317613329*^9}, {
   3.62454074592387*^9, 3.624540780950677*^9}, {3.624540814044794*^9, 
   3.6245408366678762`*^9}, 3.624558612032132*^9, 3.6245590107311773`*^9, {
   3.6245590876114187`*^9, 3.6245592330181503`*^9}, {3.624559414016447*^9, 
   3.624559415644359*^9}}],

Cell["Numerical value of the selection gradient", "Text",
 CellChangeTimes->{{3.593494549744481*^9, 3.5934945648160954`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"selgradM", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1s_", ",", "s2s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c1s_", ",", "c2s_", ",", "c3s_", ",", "c4s_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q1s_", ",", "q2s_"}], "}"}], ",", 
    RowBox[{"{", "m_", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"p10s_", ",", "p11s_", ",", "p20s_", ",", "p21s_"}], "}"}], ",", 
    "ks_", ",", "Qs_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Return", "[", 
     RowBox[{
      RowBox[{"dveqdmt", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"s1", "\[Rule]", "s1s"}], ",", 
         RowBox[{"s2", "\[Rule]", "s2s"}], ",", 
         RowBox[{"k", "\[Rule]", "ks"}], ",", 
         RowBox[{"q1", "\[Rule]", "q1s"}], ",", 
         RowBox[{"q2", "\[Rule]", "q2s"}], ",", 
         RowBox[{"c1", "\[Rule]", "c1s"}], ",", 
         RowBox[{"c2", "\[Rule]", "c2s"}], ",", 
         RowBox[{"c3", "\[Rule]", "c3s"}], ",", 
         RowBox[{"c4", "\[Rule]", "c4s"}], ",", 
         RowBox[{"mt", "\[Rule]", "m"}], ",", 
         RowBox[{"p10", "\[Rule]", "p10s"}], ",", 
         RowBox[{"p11", "\[Rule]", "p11s"}], ",", 
         RowBox[{"p20", "\[Rule]", "p20s"}], ",", 
         RowBox[{"p21", "\[Rule]", "p21s"}], ",", 
         RowBox[{"Q", "\[Rule]", "Qs"}]}], "}"}]}], "/.", 
      RowBox[{"ans3", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"s1s", ",", "s2s"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"c1s", ",", "c2s", ",", "c3s", ",", "c4s"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"q1s", ",", "q2s"}], "}"}], ",", 
        RowBox[{"{", "m", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"p10s", ",", "p11s", ",", "p20s", ",", "p21s"}], "}"}], ",", 
        "ks", ",", "Qs"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"selgradM", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.1", ",", "0.8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.1", ",", "0.5", ",", "0.8", ",", "0.4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", "0.85", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3", ",", "0.6", ",", "0.5", ",", "0.1"}], "}"}], ",", "0.1", 
   ",", "0.005"}], "]"}]}], "Input",
 CellChangeTimes->{{3.505140560825174*^9, 3.50514064385368*^9}, {
   3.505140714222675*^9, 3.505140746631989*^9}, 3.505141681810299*^9, {
   3.505141739370999*^9, 3.505141741390123*^9}, {3.5051417786037*^9, 
   3.505141823518378*^9}, {3.505162181348971*^9, 3.50516229325249*^9}, {
   3.5051623715172*^9, 3.505162376920246*^9}, {3.505162433552815*^9, 
   3.505162434058462*^9}, {3.505657684657195*^9, 3.505657708798037*^9}, {
   3.505815579213955*^9, 3.505815579839667*^9}, {3.505815706057299*^9, 
   3.505815706748337*^9}, {3.505836524337347*^9, 3.50583653604466*^9}, {
   3.505900621331135*^9, 3.50590062168389*^9}, {3.505900681816407*^9, 
   3.505900681925982*^9}, {3.505903100412446*^9, 3.505903105178415*^9}, {
   3.505903306382735*^9, 3.505903306450782*^9}, {3.505903337466215*^9, 
   3.505903337554181*^9}, {3.505903376116904*^9, 3.505903414205284*^9}, {
   3.507215441586883*^9, 3.507215441864266*^9}, {3.507217233968476*^9, 
   3.507217235012242*^9}, {3.507219035704643*^9, 3.507219036006999*^9}, 
   3.5072271240964108`*^9, {3.507445896704231*^9, 3.507445928564635*^9}, 
   3.507883896637253*^9, {3.507883963552722*^9, 3.507883964325812*^9}, {
   3.507884602887243*^9, 3.507884668140694*^9}, {3.508160912305312*^9, 
   3.508160916273239*^9}, {3.508161178047368*^9, 3.508161178663356*^9}, {
   3.520242444905705*^9, 3.520242462811362*^9}, {3.520242515256281*^9, 
   3.520242515537557*^9}, {3.520421764721227*^9, 3.520421771770569*^9}, {
   3.520421841855568*^9, 3.520421849321148*^9}, {3.520421888600866*^9, 
   3.520421892326528*^9}, {3.520422109210228*^9, 3.520422167950575*^9}, {
   3.520422201023795*^9, 3.520422205047305*^9}, {3.520422337344874*^9, 
   3.520422421071539*^9}, {3.520590680092812*^9, 3.520590711893722*^9}, {
   3.520590781521338*^9, 3.520590795966717*^9}, {3.520591226195406*^9, 
   3.520591240038307*^9}, {3.520601881307502*^9, 3.520601882092852*^9}, {
   3.524044511624154*^9, 3.52404451492298*^9}, {3.524044547404213*^9, 
   3.524044549627349*^9}, {3.524044778104684*^9, 3.524044795280702*^9}, 
   3.524555244523746*^9, {3.524555288584175*^9, 3.524555315808396*^9}, {
   3.524555363910387*^9, 3.524555377781718*^9}, {3.524555784594505*^9, 
   3.524555809327095*^9}, {3.52455601312634*^9, 3.52455602076801*^9}, {
   3.53177023662048*^9, 3.531770242557644*^9}, {3.59254503518889*^9, 
   3.59254507172961*^9}, {3.592545222393182*^9, 3.592545256670334*^9}, {
   3.616067762699471*^9, 3.6160677765635633`*^9}, {3.616067892099621*^9, 
   3.616067923768708*^9}, {3.624535652287249*^9, 3.6245356676559343`*^9}, {
   3.624535904966694*^9, 3.624535950165605*^9}, {3.624535985021688*^9, 
   3.624536027614222*^9}, {3.62453606121801*^9, 3.624536113754325*^9}, {
   3.6245408428815613`*^9, 3.6245408702588587`*^9}, {3.6245594057350607`*^9, 
   3.624559407026927*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.06820704292487582`"}]], "Output",
 CellChangeTimes->{
  3.616067955683441*^9, 3.6160686513224154`*^9, 3.616134356078285*^9, 
   3.6161346790854483`*^9, 3.616141964171479*^9, 3.616142174389387*^9, 
   3.6161537949431887`*^9, 3.616160269333968*^9, 3.616160866599716*^9, {
   3.616231967039793*^9, 3.61623199391387*^9}, 3.61623301164435*^9, 
   3.618562244293478*^9, 3.62453605564952*^9, {3.624536087279592*^9, 
   3.624536150184835*^9}, 3.624536557767316*^9, 3.62453820819011*^9, 
   3.624538329437045*^9, {3.624540864508973*^9, 3.624540878000095*^9}, 
   3.6245495035297213`*^9, 3.624558630191215*^9, 3.624558701916349*^9, 
   3.62455906043909*^9, 3.624559136429775*^9, 3.624559201121594*^9, 
   3.624559247603633*^9, 3.624559372657618*^9, 3.6245594924073057`*^9, 
   3.624565709807838*^9, 3.624882168974119*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"selgradM", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0.1", ",", "0.8"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0.1", ",", "0.5", ",", "0.8", ",", "0.4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", "0.85", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0.3", ",", "0.6", ",", "0.5", ",", "0.1"}], "}"}], ",", "0.1", 
    ",", "0.005"}], "]"}], "*)"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"selgradM", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.5", ",", "0.8", ",", "0.4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", "mx", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.3", ",", "0.6", ",", "0.5", ",", "0.1"}], "}"}], ",", "0.1", 
     ",", "0.005"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"mx", ",", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.5", ",", "0.9"}], "}"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6161347833178883`*^9, 3.616134808038447*^9}, {
   3.6161348417806587`*^9, 3.6161348505885143`*^9}, {3.6161349839942617`*^9, 
   3.616134994241521*^9}, 3.616139130925342*^9, {3.616142030812484*^9, 
   3.6161420321005*^9}, {3.624540927888836*^9, 3.624540934727578*^9}, {
   3.624541032096343*^9, 3.624541032336306*^9}, {3.6245410960069036`*^9, 
   3.6245410999278927`*^9}, {3.624549530362165*^9, 3.624549532281433*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.5225358233201027`", ",", "0.511875815965202`", ",", 
   RowBox[{"-", "0.13642637904438704`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.624565734190165*^9, 3.624882195725803*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Iterations in C", "Section",
 CellChangeTimes->{{3.593777767922825*^9, 3.593777769731084*^9}}],

Cell[TextData[{
 StyleBox["Iterations using C\n",
  FontWeight->"Bold"],
 "We export the above expressions for the patch frequencies, reproductive \
values and relatedness coefficients to as well as the selection gradients for \
",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["p", "1"], ",", 
    SubscriptBox["p", "2"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 StyleBox["m ",
  FontSlant->"Italic"],
 "to C, to allow computation on a computer cluster.\nDuring each timestep, we \
iterate the values of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["p", "1"], ",", " ", 
    SubscriptBox["p", "2"]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 StyleBox["m. ",
  FontSlant->"Italic"],
 "During each successive iteration, we solve for the novel values of the \
patch frequencies, reproductive values and relatedness coefficients. \n\
Iteration continues until the selection gradients vanish.\nC Code can be \
requested from the authors: a.kuijper@ucl.ac.uk"
}], "Text",
 CellChangeTimes->{{3.593777694387035*^9, 3.593777754699216*^9}, {
  3.593777831330688*^9, 3.593777924969914*^9}, {3.593778037024809*^9, 
  3.5937781875823383`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.593777706521871*^9, 3.59377770733974*^9}}],

Cell[CellGroupData[{

Cell["Export to C: functions", "Subsection",
 CellChangeTimes->{{3.616144378570518*^9, 3.61614438147453*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"exportDiffRecur", "[", 
   RowBox[{
   "file_", ",", "sys_", ",", "lhs1_", ",", "lhs2_", ",", "step_", ",", 
    "Tend_", ",", "delta_", ",", "boundfunc_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mainstr", ",", "iter"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mainstr", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"initialize", " ", "the", " ", "xtplus1", " ", "lhs"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "<=", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", "\"\<double \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\< = 0;\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "now", " ", "print", " ", "the", " ", "for", " ", "loop", " ", "to", 
       " ", "iterate", " ", "the", " ", "system"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"mainstr", "=", 
      RowBox[{
      "mainstr", "<>", "\"\<\\n\\n for (int rtime = 0; rtime < \>\"", "<>", 
       RowBox[{"ToString", "[", "Tend", "]"}], "<>", 
       "\"\<; ++rtime)\\n{\\n\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "<=", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\< = \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<+\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", "step", "]"}], "]"}], "<>", "\"\<*(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"sys", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "now", " ", "print", " ", "the", " ", "delta", " ", "checking"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mainstr", "=", 
      RowBox[{"mainstr", "<>", "\"\<\\nif(\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", "\"\<fabs(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<-\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<)<\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", "delta", "]"}], "]"}], "<>", 
          "\"\<\\n\\t\\t&& \>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"erase", " ", "last"}], " ", "&&", " ", 
       RowBox[{"and", " ", "close", " ", "if", " ", "parentheses"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mainstr", "=", 
      RowBox[{
       RowBox[{"StringTake", "[", 
        RowBox[{"mainstr", ",", 
         RowBox[{
          RowBox[{"StringLength", "[", "mainstr", "]"}], "-", "3"}]}], "]"}], 
       "<>", "\"\<)\\n{\\n\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "put", " ", "values", " ", "from", " ", "tplus1", " ", "to", " ", "t"}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<=\>\"", "<>", 
          RowBox[{"ToString", "[", "boundfunc", "]"}], "<>", "\"\<(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"end", " ", "if", " ", "statement"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"mainstr", "=", 
      RowBox[{"mainstr", "<>", "\"\<\\n\\t break;\\n}\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "put", " ", "values", " ", "from", " ", "tplus1", " ", "to", " ", "t"}],
       " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<=\>\"", "<>", 
          RowBox[{"ToString", "[", "boundfunc", "]"}], "<>", "\"\<(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"end", " ", "for", " ", "loop"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"mainstr", "=", 
      RowBox[{"mainstr", "<>", "\"\<\\n}\\n\\n\>\""}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", "\"\<gsl_vector_set(f,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"iter", "-", "1"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"file", ",", "mainstr"}], "]"}], ";"}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.590824494031481*^9, 3.5908244987542067`*^9}, {
   3.590824688049684*^9, 3.590824689177642*^9}, {3.590824726077338*^9, 
   3.590824819049809*^9}, {3.5908248739935303`*^9, 3.590824925754787*^9}, {
   3.590825036561387*^9, 3.590825126234809*^9}, {3.5908251802423697`*^9, 
   3.590825320995825*^9}, {3.5908253647951612`*^9, 3.5908256308482227`*^9}, 
   3.590825724885985*^9, {3.5908296671027403`*^9, 3.590829904284482*^9}, {
   3.590829936121765*^9, 3.590829970644486*^9}, {3.590830008219141*^9, 
   3.59083026925244*^9}, {3.5908308454160967`*^9, 3.5908309406084223`*^9}, {
   3.590831297981771*^9, 3.590831310679865*^9}, {3.5908313621671124`*^9, 
   3.590831374759654*^9}, {3.590831405453176*^9, 3.59083140577787*^9}, {
   3.590831442824209*^9, 3.5908314475484037`*^9}, {3.590831495257579*^9, 
   3.590831590063092*^9}, {3.590831621644826*^9, 3.590831704009104*^9}, 
   3.590835167612055*^9, {3.590835215286303*^9, 3.590835229648106*^9}, {
   3.59083564362383*^9, 3.5908356616050367`*^9}, {3.5908408172483*^9, 
   3.590840819363501*^9}, {3.590899281419011*^9, 3.590899286902195*^9}, {
   3.590899344670518*^9, 3.5908993451548643`*^9}, {3.618551711710661*^9, 
   3.618551744661623*^9}, {3.618562173863214*^9, 3.61856218450172*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"export", " ", "all", " ", "the", " ", "variables", " ", "used"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"exportvarStruct", "[", 
     RowBox[{"file_", ",", "vars_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"str", ",", "iter"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"str", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"iter", "=", "1"}], ",", 
         RowBox[{"iter", "\[LessEqual]", 
          RowBox[{"Length", "[", "vars", "]"}]}], ",", 
         RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"str", "=", 
           RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"CForm", "[", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
            "\"\<;\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"file", ",", 
         RowBox[{"str", "<>", "\"\<\\n\\n\>\""}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "export", " ", "those", " ", "variables", " ", "that", " ", "are", " ", 
     "also", " ", "parameters"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"exportParamStruct", "[", 
     RowBox[{"file_", ",", "vars_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"str", ",", "iter"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"str", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"iter", "=", "1"}], ",", 
         RowBox[{"iter", "\[LessEqual]", 
          RowBox[{"Length", "[", "vars", "]"}]}], ",", 
         RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"str", "=", 
           RowBox[{"str", "<>", "\"\<double \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"CForm", "[", 
              RowBox[{"vars", "[", 
               RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
            "\"\<;\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"file", ",", 
         RowBox[{"str", "<>", "\"\<\\n\\n\>\""}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export patch frequency recursions", "Subsection",
 CellChangeTimes->{{3.61614647174916*^9, 3.616146478678782*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"lhs1patch", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ftplus1", "[", 
      RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na1", ",", "0", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nm1", ",", "0", ",", 
       RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na2", ",", "0", ",", 
       RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}], "//", 
   "Flatten"}]}], "\[IndentingNewLine]", 
 RowBox[{"lhs2patch", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"es", ",", "na1", ",", "nm1", ",", "na2", ",", 
       RowBox[{"n", "-", "na1", "-", "nm1", "-", "na2"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na1", ",", "0", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nm1", ",", "0", ",", 
       RowBox[{"n", "-", "na1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"na2", ",", "0", ",", 
       RowBox[{"n", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]}], "Input",
 CellChangeTimes->{{3.590830995553282*^9, 3.590831019103163*^9}, {
  3.6161446655805807`*^9, 3.616144722214224*^9}, {3.61614707137897*^9, 
  3.616147076003533*^9}, {3.616149076674119*^9, 3.616149079831545*^9}, {
  3.624542278174024*^9, 3.624542323270267*^9}, {3.624557091553998*^9, 
  3.6245570955136213`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"ftplus1", "[", 
    RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.590831013239851*^9, 3.590831021033671*^9}, 
   3.5908315007820053`*^9, 3.590831629980961*^9, 3.590831678076036*^9, 
   3.5908353068794823`*^9, 3.590837291922063*^9, 3.5908408308911467`*^9, 
   3.590841046106442*^9, 3.590899363949039*^9, 3.590906448500978*^9, 
   3.5912549927166357`*^9, 3.591255384520417*^9, 3.5912555097576313`*^9, 
   3.592647997300377*^9, {3.616144718748001*^9, 3.616144722813964*^9}, 
   3.616144816699142*^9, 3.616147119545724*^9, 3.616149081280114*^9, 
   3.616149114890017*^9, 3.616151109799511*^9, 3.616153350042171*^9, 
   3.616153825934106*^9, 3.616156352759272*^9, 3.616160914612722*^9, 
   3.616232042695236*^9, 3.616233057594314*^9, 3.616233379762006*^9, 
   3.618562353737617*^9, 3.62454232605916*^9, 3.624542420293412*^9, 
   3.624549540477507*^9, 3.6245496807661858`*^9, 3.624549750184957*^9, 
   3.624557096324532*^9, 3.624558020482264*^9, 3.624558710480978*^9, 
   3.624559381618507*^9, 3.6245595015123577`*^9, 3.624565734414708*^9, 
   3.624882265847822*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.590831013239851*^9, 3.590831021033671*^9}, 
   3.5908315007820053`*^9, 3.590831629980961*^9, 3.590831678076036*^9, 
   3.5908353068794823`*^9, 3.590837291922063*^9, 3.5908408308911467`*^9, 
   3.590841046106442*^9, 3.590899363949039*^9, 3.590906448500978*^9, 
   3.5912549927166357`*^9, 3.591255384520417*^9, 3.5912555097576313`*^9, 
   3.592647997300377*^9, {3.616144718748001*^9, 3.616144722813964*^9}, 
   3.616144816699142*^9, 3.616147119545724*^9, 3.616149081280114*^9, 
   3.616149114890017*^9, 3.616151109799511*^9, 3.616153350042171*^9, 
   3.616153825934106*^9, 3.616156352759272*^9, 3.616160914612722*^9, 
   3.616232042695236*^9, 3.616233057594314*^9, 3.616233379762006*^9, 
   3.618562353737617*^9, 3.62454232605916*^9, 3.624542420293412*^9, 
   3.624549540477507*^9, 3.6245496807661858`*^9, 3.624549750184957*^9, 
   3.624557096324532*^9, 3.624558020482264*^9, 3.624558710480978*^9, 
   3.624559381618507*^9, 3.6245595015123577`*^9, 3.624565734414708*^9, 
   3.62488226585009*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"exportDiffRecur", "[", 
  RowBox[{
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/maternal_age/src/numerical/patchrecurs.txt\>\""}], ",", 
   RowBox[{"Flatten", "[", "tablerecPlain", "]"}], ",", "lhs1patch", ",", 
   "lhs2patch", ",", "0.01", ",", "1000000", ",", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{"-", "7"}], ")"}]}], ",", "bound01"}], "]"}]], "Input",
 CellChangeTimes->{{3.5908309445698223`*^9, 3.590830987989614*^9}, {
   3.590831024917672*^9, 3.590831027357374*^9}, {3.590831061334312*^9, 
   3.590831088158276*^9}, {3.590831209437612*^9, 3.590831264862075*^9}, {
   3.590831313478467*^9, 3.5908313146115007`*^9}, {3.59083509430632*^9, 
   3.590835102985559*^9}, {3.616144605589267*^9, 3.616144655791149*^9}, {
   3.616144692479392*^9, 3.616144693115016*^9}, {3.616144730622141*^9, 
   3.616144731284387*^9}, {3.6161447763167143`*^9, 3.616144796734088*^9}, 
   3.6161448341091843`*^9, 3.6161448958686*^9, {3.616147078850782*^9, 
   3.616147082721192*^9}, {3.6245423845062304`*^9, 3.6245423934832487`*^9}, 
   3.624565628561906*^9, {3.624565807354608*^9, 3.624565810768981*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Export reproductive value recursions\
\>", "Subsection",
 CellChangeTimes->{{3.616146491918007*^9, 3.6161464986308193`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vvecJuvlhs1", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"vtplus1", "[", 
       RowBox[{
       "es", ",", "0", ",", "state", ",", "na1", ",", "nm1", ",", "na2"}], 
       "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"state", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"na1", ",", "0", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"nm1", ",", "0", ",", 
        RowBox[{"n", "-", "1", "-", "na1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"na2", ",", "0", ",", 
        RowBox[{"n", "-", "1", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}], "//",
     "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vvecAdlhs1", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"vtplus1", "[", 
       RowBox[{
       "es", ",", "1", ",", "state", ",", "na1", ",", "nm1", ",", "na2"}], 
       "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"es", ",", "1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"state", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"na1", ",", "0", ",", 
        RowBox[{"n", "-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"nm1", ",", "0", ",", 
        RowBox[{"n", "-", "1", "-", "na1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"na2", ",", "0", ",", 
        RowBox[{"n", "-", "1", "-", "na1", "-", "nm1"}]}], "}"}]}], "]"}], "//",
     "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"vveclhs1", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"vvecJuvlhs1", ",", "vvecAdlhs1"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5018622698079367`*^9, 3.501862289606407*^9}, {
   3.5018623307386227`*^9, 3.501862365664167*^9}, {3.5018624304785347`*^9, 
   3.501862533405551*^9}, {3.520429173721002*^9, 3.520429174705935*^9}, {
   3.607780712660212*^9, 3.607780797907065*^9}, {3.607780853756072*^9, 
   3.60778090351499*^9}, {3.607781329896625*^9, 3.607781331232204*^9}, 
   3.608525677009054*^9, {3.616145929973526*^9, 3.616145948376938*^9}, {
   3.624542459740093*^9, 3.624542552277817*^9}, {3.624542659573769*^9, 
   3.624542664133947*^9}, {3.624542737531155*^9, 3.624542758077211*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6161460674787817`*^9, 3.616148458847658*^9, 3.616149114978701*^9, 
   3.616151109872408*^9, 3.616153350118532*^9, 3.616153825989588*^9, 
   3.6161563528971148`*^9, 3.616160914683053*^9, 3.6162320427991657`*^9, 
   3.616233057666757*^9, 3.616233379828315*^9, 3.6185623538823442`*^9, {
   3.6245427532707253`*^9, 3.624542759093883*^9}, 3.6245495406371393`*^9, 
   3.624549680951481*^9, 3.624549750341672*^9, 3.624558020727103*^9, 
   3.624558710738968*^9, 3.624559381766471*^9, 3.6245595016285057`*^9, 
   3.624565734566515*^9, 3.624882266014101*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"exportDiffRecur", "[", 
  RowBox[{
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/maternal_age/src/numerical/rvalrecurs.txt\>\""}], ",", 
   RowBox[{"Flatten", "[", "veqtabPlain1", "]"}], ",", "vveclhs1", ",", 
   "rvals", ",", "0.01", ",", "1000000", ",", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{"-", "7"}], ")"}]}], ",", "bound0"}], "]"}]], "Input",
 CellChangeTimes->{{3.5908309445698223`*^9, 3.590830987989614*^9}, {
   3.590831024917672*^9, 3.590831027357374*^9}, {3.590831061334312*^9, 
   3.590831088158276*^9}, {3.590831209437612*^9, 3.590831264862075*^9}, {
   3.590831313478467*^9, 3.5908313146115007`*^9}, {3.5908327135275373`*^9, 
   3.590832716378105*^9}, {3.590832814910838*^9, 3.5908328204897003`*^9}, {
   3.5908328629264383`*^9, 3.590832875870335*^9}, {3.5908351115946827`*^9, 
   3.590835117824935*^9}, {3.590841018849063*^9, 3.590841021297264*^9}, {
   3.616146075849708*^9, 3.6161460953045187`*^9}, 3.6161463633446093`*^9, 
   3.6161535749796047`*^9, 3.616153782123399*^9, {3.62454293747926*^9, 
   3.624542952439186*^9}, {3.624543161292467*^9, 3.624543162252474*^9}, 
   3.624888193505846*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["vveclhs1"], "Input",
 CellChangeTimes->{{3.624893042366083*^9, 3.6248930447994127`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"vtplus1", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.62489304621026*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["rvals"], "Input",
 CellChangeTimes->{{3.6248930557376432`*^9, 3.62489305615802*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.624893056564247*^9}]
}, Open  ]],

Cell["Export relatedness recursions", "Subsection",
 CellChangeTimes->{{3.616146515038537*^9, 3.616146529997208*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs2relatedness", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"x", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "reltab"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.616146668675852*^9, 3.616146689608177*^9}, 
   3.616146730586933*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "A1", ",", "1", ",", "2", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "A1", ",", "2", ",", "2", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "M1", ",", "1", ",", "1", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "M1", ",", "2", ",", "1", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "A2", ",", "1", ",", "1", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "A2", ",", "2", ",", "1", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "M2", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "M2", ",", "2", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "M1", ",", "1", ",", "0", ",", "2", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "M1", ",", "2", ",", "0", ",", "2", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "A2", ",", "1", ",", "0", ",", "1", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "A2", ",", "2", ",", "0", ",", "1", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "M2", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "M2", ",", "2", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A2", ",", "A2", ",", "1", ",", "0", ",", "0", ",", "2"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A2", ",", "A2", ",", "2", ",", "0", ",", "0", ",", "2"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A2", ",", "M2", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A2", ",", "M2", ",", "2", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M2", ",", "M2", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M2", ",", "M2", ",", "2", ",", "0", ",", "0", ",", "0"}], 
    "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6161466901741*^9, 3.616146731820459*^9, 
  3.616149115152246*^9, 3.616151110088896*^9, 3.616153350329299*^9, 
  3.61615382618569*^9, 3.6161563530884027`*^9, 3.616160914915352*^9, 
  3.616232043021791*^9, 3.6162330578622837`*^9, 3.616233380023488*^9, 
  3.618562354514427*^9, 3.624549543241488*^9, 3.624549683470923*^9, 
  3.6245497528470097`*^9, 3.624558023241335*^9, 3.624558714036603*^9, 
  3.6245593841784763`*^9, 3.624559504160575*^9, 3.624565737362317*^9, 
  3.624882268445346*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"lhs1relatedness", "=", 
  RowBox[{"lhs2relatedness", "/.", 
   RowBox[{"{", 
    RowBox[{"r", "\[Rule]", "rtplus1"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.61614675329016*^9, 3.616146772785482*^9}, 
   3.624549180146595*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"rtplus1", "[", 
    RowBox[{"A1", ",", "A1", ",", "1", ",", "2", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"A1", ",", "A1", ",", "2", ",", "2", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"A1", ",", "M1", ",", "1", ",", "1", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"A1", ",", "M1", ",", "2", ",", "1", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"A1", ",", "A2", ",", "1", ",", "1", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"A1", ",", "A2", ",", "2", ",", "1", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"A1", ",", "M2", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"A1", ",", "M2", ",", "2", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"M1", ",", "M1", ",", "1", ",", "0", ",", "2", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"M1", ",", "M1", ",", "2", ",", "0", ",", "2", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"M1", ",", "A2", ",", "1", ",", "0", ",", "1", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"M1", ",", "A2", ",", "2", ",", "0", ",", "1", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"M1", ",", "M2", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"M1", ",", "M2", ",", "2", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"A2", ",", "A2", ",", "1", ",", "0", ",", "0", ",", "2"}], "]"}], 
   ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"A2", ",", "A2", ",", "2", ",", "0", ",", "0", ",", "2"}], "]"}], 
   ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"A2", ",", "M2", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"A2", ",", "M2", ",", "2", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"M2", ",", "M2", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"rtplus1", "[", 
    RowBox[{"M2", ",", "M2", ",", "2", ",", "0", ",", "0", ",", "0"}], 
    "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.616146773307131*^9, 3.616149115204747*^9, 
  3.616151110132444*^9, 3.6161533503346043`*^9, 3.6161538261915607`*^9, 
  3.616156353146809*^9, 3.61616091496098*^9, 3.616232043071595*^9, 
  3.616233057869644*^9, 3.616233380055859*^9, 3.6185623545776567`*^9, 
  3.624549543247966*^9, 3.624549683547184*^9, 3.6245497528553333`*^9, 
  3.624558023249379*^9, 3.624558714040738*^9, 3.6245593842330217`*^9, 
  3.624559504225322*^9, 3.624565737370178*^9, 3.6248822684508743`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"exportDiffRecur", "[", 
  RowBox[{
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/maternal_age/src/numerical/relvalrecurs.txt\>\""}], ",", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "-", 
      RowBox[{"x", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "reltab"}], "}"}]}], "]"}], ",", "lhs1relatedness", 
   ",", "lhs2relatedness", ",", "0.01", ",", "1000000", ",", 
   RowBox[{"10", "^", 
    RowBox[{"(", 
     RowBox[{"-", "7"}], ")"}]}], ",", "bound01"}], "]"}]], "Input",
 CellChangeTimes->{{3.5908309445698223`*^9, 3.590830987989614*^9}, {
   3.590831024917672*^9, 3.590831027357374*^9}, {3.590831061334312*^9, 
   3.590831088158276*^9}, {3.590831209437612*^9, 3.590831264862075*^9}, {
   3.590831313478467*^9, 3.5908313146115007`*^9}, {3.5908327135275373`*^9, 
   3.590832716378105*^9}, {3.590832814910838*^9, 3.5908328204897003`*^9}, {
   3.5908328629264383`*^9, 3.590832875870335*^9}, {3.5908332487393913`*^9, 
   3.5908332656018467`*^9}, {3.590835124242126*^9, 3.590835130286148*^9}, 
   3.616146413440015*^9, {3.616146816090658*^9, 3.6161468570101633`*^9}, {
   3.616151104417499*^9, 3.616151105032502*^9}, 3.616156118688468*^9, {
   3.616156345540195*^9, 3.616156347621196*^9}, 3.616156495283565*^9, {
   3.624549189935339*^9, 3.624549193278185*^9}, 3.624549414768379*^9, {
   3.6245497476085567`*^9, 3.6245497477198677`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mainrecursion", "[", 
   RowBox[{
   "file_", ",", "lhs1_", ",", "lhs2_", ",", "sys_", ",", "step_", ",", 
    "boundfunc_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mainstr", ",", "iter"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mainstr", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", "\"\<double \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<;\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "<=", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\< = \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", "boundfunc", "]"}], "]"}], "<>", "\"\<(\>\"",
           "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs2", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<+\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", "step", "]"}], "]"}], "<>", "\"\<*(\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"sys", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<));\\n\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iter", "=", "1"}], ",", 
       RowBox[{"iter", "\[LessEqual]", 
        RowBox[{"Length", "[", "sys", "]"}]}], ",", 
       RowBox[{"iter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mainstr", "=", 
         RowBox[{"mainstr", "<>", "\"\<gsl_vector_set(f,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"iter", "-", "1"}], "]"}], "<>", "\"\<,\>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"CForm", "[", 
            RowBox[{"lhs1", "[", 
             RowBox[{"[", "iter", "]"}], "]"}], "]"}], "]"}], "<>", 
          "\"\<);\\n\>\""}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"file", ",", "mainstr"}], "]"}], ";"}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.590834528268754*^9, 3.5908345406910887`*^9}, {
  3.5908345731626368`*^9, 3.590834675056554*^9}, {3.59083471597438*^9, 
  3.590834821120158*^9}, {3.590834853928339*^9, 3.5908348608410273`*^9}, {
  3.590835771695839*^9, 3.59083578825672*^9}, {3.5908359289600773`*^9, 
  3.590835932990438*^9}, {3.590840618567021*^9, 3.590840672227709*^9}, {
  3.590840711466693*^9, 3.590840786098345*^9}, {3.590840866972934*^9, 
  3.5908408676441708`*^9}, {3.590906715159862*^9, 3.590906758199222*^9}}],

Cell[BoxData[
 RowBox[{"mainrecursion", "[", 
  RowBox[{
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/maternal_age/src/numerical/selgrad.txt\>\""}], ",", 
   RowBox[{"{", 
    RowBox[{
    "p10tplus1", ",", "p20tplus1", ",", "p11tplus1", ",", "p21tplus1", ",", 
     "mtplus1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p10", ",", "p20", ",", "p11", ",", "p21", ",", "mt"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dveqdp", "[", "dp10", "]"}], ",", 
     RowBox[{"dveqdp", "[", "dp20", "]"}], ",", 
     RowBox[{"dveqdp", "[", "dp11", "]"}], ",", 
     RowBox[{"dveqdp", "[", "dp21", "]"}], ",", "dveqdmt"}], "}"}], ",", 
   "eul", ",", "bound01"}], "]"}]], "Input",
 CellChangeTimes->{{3.590834863067157*^9, 3.5908348659045677`*^9}, {
   3.5908350208710938`*^9, 3.590835056118764*^9}, {3.590835395027761*^9, 
   3.5908354700620193`*^9}, {3.590835813388159*^9, 3.5908358193860083`*^9}, {
   3.590835893242031*^9, 3.590835938161178*^9}, {3.59083721166047*^9, 
   3.590837216588141*^9}, {3.5908372506434507`*^9, 3.590837278979712*^9}, 
   3.5908408426915493`*^9, {3.591255327965082*^9, 3.591255373916926*^9}, 
   3.616146922897832*^9, {3.6161469595074797`*^9, 3.616146960530655*^9}, {
   3.618562198797748*^9, 3.618562218757862*^9}, {3.624549202741404*^9, 
   3.624549205890473*^9}, {3.624549593177706*^9, 3.624549648584642*^9}, {
   3.624549780889476*^9, 3.6245497948646717`*^9}, {3.6245584359127007`*^9, 
   3.624558436035976*^9}, {3.6245587837065687`*^9, 3.624558783834928*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "export", " ", "all", " ", "the", " ", "variables", " ", "including", " ", 
   "the", " ", "parameters"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.5908246701104927`*^9, 3.5908246765370817`*^9}}],

Cell[BoxData[
 RowBox[{"exportvarStruct", "[", 
  RowBox[{
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/maternal_age/src/numerical/variables.txt\>\""}], ",", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "c1", ",", "c2", ",", "c3", ",", "c4", ",", "q1", ",", "q2", ",", "k", 
       ",", "mt", ",", "p10", ",", "p20", ",", "p11", ",", "p21", ",", "s1", 
       ",", "s2", ",", "i", ",", "t", ",", "Q", ",", "eul"}], "}"}], ",", 
     "rvals", ",", "lhs2patch", ",", "lhs2relatedness"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.590824508033992*^9, 3.590824510035123*^9}, {
   3.590836149589223*^9, 3.59083615739601*^9}, {3.5908363596734037`*^9, 
   3.5908363664583187`*^9}, {3.590837303024035*^9, 3.590837303763467*^9}, {
   3.590837354515375*^9, 3.590837425506982*^9}, {3.590837476699024*^9, 
   3.5908375182256727`*^9}, 3.5908405283010883`*^9, {3.591254984752503*^9, 
   3.591254986592825*^9}, {3.616147024812277*^9, 3.6161470275681047`*^9}, {
   3.616147105767652*^9, 3.616147149281129*^9}, {3.616148985745578*^9, 
   3.6161489872816753`*^9}, {3.6185622102946167`*^9, 3.618562222422887*^9}, {
   3.6245492105090523`*^9, 3.6245492136042337`*^9}, {3.624549660494688*^9, 
   3.624549669214472*^9}, {3.624557047478739*^9, 3.62455704818086*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Join", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "c1", ",", "c2", ",", "c3", ",", "c4", ",", "q1", ",", "q2", ",", "k", 
     ",", "mt", ",", "p10", ",", "p20", ",", "p11", ",", "p21", ",", "s1", 
     ",", "s2", ",", "i", ",", "t", ",", "Q", ",", "eul"}], "}"}], ",", 
   "rvals", ",", "lhs2patch", ",", "lhs2relatedness"}], "]"}]], "Input",
 CellChangeTimes->{{3.6245570299812098`*^9, 3.624557052286051*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "c1", ",", "c2", ",", "c3", ",", "c4", ",", "q1", ",", "q2", ",", "k", ",", 
   "mt", ",", "p10", ",", "p20", ",", "p11", ",", "p21", ",", "s1", ",", "s2",
    ",", "i", ",", "t", ",", "Q", ",", "eul", ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"v", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "0", ",", "2"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"1", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "0", ",", "2"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "1", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "0", ",", "2", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "0", ",", "1"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "1", ",", "1", ",", "0"}], "]"}], ",", 
   RowBox[{"fx", "[", 
    RowBox[{"2", ",", "2", ",", "0", ",", "0"}], "]"}], ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "A1", ",", "1", ",", "2", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "A1", ",", "2", ",", "2", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "M1", ",", "1", ",", "1", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "M1", ",", "2", ",", "1", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "A2", ",", "1", ",", "1", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "A2", ",", "2", ",", "1", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "M2", ",", "1", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A1", ",", "M2", ",", "2", ",", "1", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "M1", ",", "1", ",", "0", ",", "2", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "M1", ",", "2", ",", "0", ",", "2", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "A2", ",", "1", ",", "0", ",", "1", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "A2", ",", "2", ",", "0", ",", "1", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "M2", ",", "1", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M1", ",", "M2", ",", "2", ",", "0", ",", "1", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A2", ",", "A2", ",", "1", ",", "0", ",", "0", ",", "2"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A2", ",", "A2", ",", "2", ",", "0", ",", "0", ",", "2"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A2", ",", "M2", ",", "1", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"A2", ",", "M2", ",", "2", ",", "0", ",", "0", ",", "1"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M2", ",", "M2", ",", "1", ",", "0", ",", "0", ",", "0"}], "]"}], 
   ",", 
   RowBox[{"r", "[", 
    RowBox[{"M2", ",", "M2", ",", "2", ",", "0", ",", "0", ",", "0"}], 
    "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.624557030490087*^9, 3.624557052679839*^9}, 
   3.624558035972576*^9, 3.6245587146412897`*^9, 3.624559398366304*^9, 
   3.624559518252954*^9, 3.624565751326974*^9, 3.624882282110855*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"exportParamStruct", "[", 
  RowBox[{
   RowBox[{
   "$HomeDirectory", "<>", 
    "\"\</Projects/maternal_age/src/numerical/params.txt\>\""}], ",", 
   RowBox[{"{", 
    RowBox[{
    "c1", ",", "c2", ",", "c3", ",", "c4", ",", "q1", ",", "q2", ",", "k", 
     ",", "s1", ",", "s2", ",", "i", ",", "t", ",", "Q", ",", "eul"}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.590824508033992*^9, 3.590824510035123*^9}, {
   3.590836149589223*^9, 3.59083615739601*^9}, {3.5908363596734037`*^9, 
   3.5908363664583187`*^9}, {3.590837303024035*^9, 3.590837303763467*^9}, {
   3.590837354515375*^9, 3.590837470002576*^9}, 3.616147043513319*^9, 
   3.6161472084803543`*^9, {3.6161489797128077`*^9, 3.616148981712535*^9}, {
   3.618562214140094*^9, 3.618562224756199*^9}, {3.624549220355929*^9, 
   3.624549222859909*^9}, {3.624549674201274*^9, 3.624549675662209*^9}}]
}, Open  ]]
},
CellGrouping->Manual,
WindowSize->{2487, 1573},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
DockedCells->(FrontEndExecute[{
   FrontEnd`NotebookApply[
    FrontEnd`InputNotebook[], #, Placeholder]}]& ),
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> True}},
Magnification->1.5,
FrontEndVersion->"9.0 for Linux x86 (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 68, 1, 44, "Input"],
Cell[628, 23, 301, 4, 108, "Title"],
Cell[932, 29, 152, 2, 52, "Text"],
Cell[CellGroupData[{
Cell[1109, 35, 116, 1, 110, "Section"],
Cell[1228, 38, 94, 1, 45, "Text"],
Cell[1325, 41, 384, 6, 44, "Input"],
Cell[1712, 49, 1259, 41, 162, "Text"],
Cell[2974, 92, 477, 9, 44, "Input"],
Cell[3454, 103, 669, 21, 113, "Text"],
Cell[4126, 126, 322, 9, 73, "Input"],
Cell[4451, 137, 133, 3, 45, "Text"],
Cell[4587, 142, 460, 9, 103, "Text"],
Cell[5050, 153, 3844, 93, 213, "Input"],
Cell[8897, 248, 2068, 54, 246, "Text"],
Cell[10968, 304, 7049, 185, 689, "Input"],
Cell[18020, 491, 496, 14, 103, "Text"],
Cell[18519, 507, 1543, 41, 110, "Input"],
Cell[20065, 550, 642, 16, 75, "Text"],
Cell[20710, 568, 2055, 49, 113, "Input"],
Cell[22768, 619, 155, 2, 46, "Text"],
Cell[CellGroupData[{
Cell[22948, 625, 166, 3, 44, "Input"],
Cell[23117, 630, 493, 7, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[23659, 643, 67, 0, 63, "Section"],
Cell[23729, 645, 5761, 135, 279, "Input"],
Cell[29493, 782, 482, 10, 75, "Text"],
Cell[29978, 794, 11494, 270, 1178, "Input"],
Cell[41475, 1066, 238, 3, 46, "Text"],
Cell[41716, 1071, 543, 12, 44, "Input"],
Cell[42262, 1085, 385, 11, 45, "Text"],
Cell[42650, 1098, 1053, 19, 83, "Input"],
Cell[43706, 1119, 450, 9, 75, "Text"],
Cell[44159, 1130, 17275, 404, 885, "Input"],
Cell[61437, 1536, 124, 1, 45, "Text"],
Cell[61564, 1539, 92, 1, 44, "Input"],
Cell[61659, 1542, 481, 13, 44, "Input"],
Cell[CellGroupData[{
Cell[62165, 1559, 152, 3, 44, "Input"],
Cell[62320, 1564, 1021, 24, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63378, 1593, 892, 25, 44, "Input"],
Cell[64273, 1620, 2292, 51, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66602, 1676, 153, 3, 44, "Input"],
Cell[66758, 1681, 564, 12, 70, "Message"],
Cell[67325, 1695, 244, 4, 70, "Output"]
}, Open  ]],
Cell[67584, 1702, 856, 21, 73, "Input"],
Cell[68443, 1725, 555, 13, 44, "Input"],
Cell[CellGroupData[{
Cell[69023, 1742, 556, 13, 44, "Input"],
Cell[69582, 1757, 3825, 110, 70, "Output"]
}, Open  ]],
Cell[73422, 1870, 231, 4, 46, "Text"],
Cell[73656, 1876, 3074, 57, 73, "Input"],
Cell[76733, 1935, 3185, 60, 73, "Input"],
Cell[79921, 1997, 3191, 60, 73, "Input"],
Cell[CellGroupData[{
Cell[83137, 2061, 694, 16, 44, "Input"],
Cell[83834, 2079, 3496, 92, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87367, 2176, 1169, 23, 44, "Input"],
Cell[88539, 2201, 3631, 93, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[92219, 2300, 38, 0, 63, "Section"],
Cell[CellGroupData[{
Cell[92282, 2304, 107, 1, 59, "Subsection"],
Cell[92392, 2307, 356, 5, 231, "Text"],
Cell[92751, 2314, 3532, 107, 1431, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[96320, 2426, 169, 2, 45, "Subsection"],
Cell[96492, 2430, 42464, 948, 2726, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138993, 3383, 115, 1, 59, "Subsection"],
Cell[139111, 3386, 44321, 967, 14167, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[183469, 4358, 148, 2, 45, "Subsection"],
Cell[183620, 4362, 1920, 40, 108, "Input"],
Cell[CellGroupData[{
Cell[185565, 4406, 1049, 24, 44, "Input"],
Cell[186617, 4432, 7877, 237, 342, "Output"]
}, Open  ]]
}, Open  ]],
Cell[194521, 4673, 8853, 237, 443, "Input"],
Cell[CellGroupData[{
Cell[203399, 4914, 141, 3, 59, "Subsection"],
Cell[203543, 4919, 165, 3, 45, "Text"],
Cell[203711, 4924, 253, 7, 44, "Input"],
Cell[203967, 4933, 100, 1, 45, "Text"],
Cell[204070, 4936, 990, 22, 73, "Input"],
Cell[CellGroupData[{
Cell[205085, 4962, 134, 2, 44, "Input"],
Cell[205222, 4966, 375, 6, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[205634, 4977, 2796, 58, 101, "Input"],
Cell[208433, 5037, 3980, 105, 151, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212450, 5147, 97, 1, 44, "Input"],
Cell[212550, 5150, 3949, 105, 151, "Output"]
}, Open  ]],
Cell[216514, 5258, 92, 1, 44, "Input"],
Cell[216609, 5261, 110, 2, 45, "Text"],
Cell[CellGroupData[{
Cell[216744, 5267, 685, 15, 73, "Input"],
Cell[217432, 5284, 5797, 169, 179, "Output"],
Cell[223232, 5455, 9059, 269, 316, "Output"]
}, Open  ]],
Cell[232306, 5727, 361, 11, 44, "Input"],
Cell[CellGroupData[{
Cell[232692, 5742, 103, 1, 44, "Input"],
Cell[232798, 5745, 5023, 136, 151, "Output"]
}, Open  ]],
Cell[237836, 5884, 457, 13, 44, "Input"],
Cell[CellGroupData[{
Cell[238318, 5901, 100, 1, 44, "Input"],
Cell[238421, 5904, 2955, 88, 123, "Output"]
}, Open  ]],
Cell[241391, 5995, 180, 3, 46, "Text"],
Cell[241574, 6000, 1503, 36, 73, "Input"],
Cell[243080, 6038, 1587, 39, 101, "Input"],
Cell[244670, 6079, 2395, 50, 101, "Input"],
Cell[CellGroupData[{
Cell[247090, 6133, 2164, 37, 44, "Input"],
Cell[249257, 6172, 8481, 218, 291, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[257775, 6395, 2182, 37, 44, "Input"],
Cell[259960, 6434, 8459, 218, 291, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[268468, 6658, 499, 13, 44, "Input"],
Cell[268970, 6673, 8027, 211, 291, "Output"]
}, Open  ]]
}, Open  ]],
Cell[277024, 6888, 5306, 123, 353, "Input"],
Cell[CellGroupData[{
Cell[282355, 7015, 502, 13, 44, "Input"],
Cell[282860, 7030, 10789, 229, 487, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[293686, 7264, 1330, 36, 73, "Input"],
Cell[295019, 7302, 1247, 35, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[296303, 7342, 183, 4, 44, "Input"],
Cell[296489, 7348, 94, 1, 66, "Output"]
}, Open  ]],
Cell[296598, 7352, 93, 1, 44, "Input"],
Cell[296694, 7355, 145, 3, 44, "Input"],
Cell[296842, 7360, 92, 1, 44, "Input"],
Cell[CellGroupData[{
Cell[296959, 7365, 474, 12, 44, "Input"],
Cell[CellGroupData[{
Cell[297458, 7381, 230, 4, 44, "Input"],
Cell[297691, 7387, 165, 4, 66, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[297893, 7396, 196, 5, 44, "Input"],
Cell[298092, 7403, 145, 3, 66, "Output"]
}, Open  ]],
Cell[298252, 7409, 241, 7, 44, "Input"],
Cell[CellGroupData[{
Cell[298518, 7420, 258, 6, 44, "Input"],
Cell[298779, 7428, 326, 8, 66, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[299154, 7442, 96, 1, 110, "Section"],
Cell[CellGroupData[{
Cell[299275, 7447, 107, 1, 198, "Subsection"],
Cell[299385, 7450, 478, 8, 225, "Text"],
Cell[299866, 7460, 1265, 30, 222, "Input"],
Cell[301134, 7492, 1211, 28, 222, "Input"],
Cell[302348, 7522, 1365, 32, 222, "Input"],
Cell[303716, 7556, 1346, 32, 222, "Input"],
Cell[305065, 7590, 1312, 30, 222, "Input"],
Cell[306380, 7622, 1366, 32, 222, "Input"],
Cell[307749, 7656, 1412, 31, 222, "Input"],
Cell[309164, 7689, 1453, 35, 222, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[310654, 7729, 185, 2, 150, "Subsection"],
Cell[310842, 7733, 38179, 877, 8878, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[349058, 8615, 140, 1, 150, "Subsection"],
Cell[349201, 8618, 47445, 1071, 12372, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[396683, 9694, 141, 1, 150, "Subsection"],
Cell[396827, 9697, 36176, 848, 9510, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[433040, 10550, 147, 1, 150, "Subsection"],
Cell[433190, 10553, 41073, 916, 10153, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[474300, 11474, 138, 1, 150, "Subsection"],
Cell[474441, 11477, 38796, 881, 9612, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[513274, 12363, 146, 1, 150, "Subsection"],
Cell[513423, 12366, 39175, 888, 9652, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[552635, 13259, 206, 4, 150, "Subsection"],
Cell[CellGroupData[{
Cell[552866, 13267, 39486, 899, 10153, "Input"],
Cell[592355, 14168, 12879, 316, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[605283, 14490, 139, 3, 150, "Subsection"],
Cell[605425, 14495, 30992, 703, 6318, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[636454, 15203, 188, 2, 150, "Subsection"],
Cell[636645, 15207, 31507, 714, 6513, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[668189, 15926, 242, 5, 150, "Subsection"],
Cell[CellGroupData[{
Cell[668456, 15935, 30618, 702, 6534, "Input"],
Cell[699077, 16639, 2455, 64, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[701581, 16709, 171, 2, 150, "Subsection"],
Cell[701755, 16713, 137, 3, 150, "Text"],
Cell[CellGroupData[{
Cell[701917, 16720, 9116, 226, 1567, "Input"],
Cell[711036, 16948, 2436, 65, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[713509, 17018, 345, 9, 148, "Input"],
Cell[713857, 17029, 5673, 134, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[719567, 17168, 390, 10, 148, "Input"],
Cell[719960, 17180, 4030, 98, 70, "Output"]
}, Open  ]],
Cell[724005, 17281, 165, 2, 154, "Text"],
Cell[724173, 17285, 3628, 75, 717, "Input"],
Cell[727804, 17362, 2505, 60, 717, "Input"],
Cell[CellGroupData[{
Cell[730334, 17426, 697, 16, 148, "Input"],
Cell[731034, 17444, 12268, 306, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[743363, 17757, 563, 14, 67, "Section"],
Cell[CellGroupData[{
Cell[743951, 17775, 107, 1, 88, "Subsection"],
Cell[744061, 17778, 356, 5, 69, "Text"],
Cell[744420, 17785, 559, 16, 66, "Input"],
Cell[744982, 17803, 5621, 140, 616, "Input"],
Cell[750606, 17945, 4942, 131, 658, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[755585, 18081, 231, 5, 88, "Subsection"],
Cell[755819, 18088, 46177, 1035, 4131, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[802033, 19128, 179, 4, 88, "Subsection"],
Cell[802215, 19134, 47970, 1056, 4198, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[850222, 20195, 114, 3, 88, "Subsection"],
Cell[CellGroupData[{
Cell[850361, 20202, 934, 25, 109, "Input"],
Cell[851298, 20229, 7238, 188, 70, "Output"]
}, Open  ]],
Cell[858551, 20420, 3338, 83, 193, "Input"],
Cell[861892, 20505, 180, 4, 67, "Text"],
Cell[862075, 20511, 6729, 174, 900, "Input"],
Cell[868807, 20687, 125, 1, 67, "Text"],
Cell[CellGroupData[{
Cell[868957, 20692, 5105, 99, 235, "Input"],
Cell[874065, 20793, 686, 10, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[874812, 20810, 291, 7, 63, "Section"],
Cell[CellGroupData[{
Cell[875128, 20821, 207, 3, 88, "Subsection"],
Cell[875338, 20826, 5827, 144, 616, "Input"],
Cell[881168, 20972, 5848, 144, 616, "Input"]
}, Open  ]],
Cell[887031, 21119, 1216, 32, 204, "Input"],
Cell[888250, 21153, 287, 3, 88, "Subsection"],
Cell[888540, 21158, 44334, 997, 4114, "Input"],
Cell[932877, 22157, 238, 3, 88, "Subsection"],
Cell[933118, 22162, 47437, 1057, 4182, "Input"],
Cell[CellGroupData[{
Cell[980580, 23223, 165, 2, 88, "Subsection"],
Cell[980748, 23227, 3032, 74, 193, "Input"],
Cell[983783, 23303, 7643, 180, 772, "Input"],
Cell[991429, 23485, 125, 1, 67, "Text"],
Cell[991557, 23488, 5149, 100, 235, "Input"],
Cell[996709, 23590, 842, 13, 70, "Output"],
Cell[997554, 23605, 463, 13, 66, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[998054, 23623, 1065, 25, 66, "Input"],
Cell[999122, 23650, 220, 4, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[999391, 23660, 100, 1, 63, "Section"],
Cell[999494, 23663, 1202, 33, 160, "Text"],
Cell[1000699, 23698, 91, 1, 44, "Input"],
Cell[CellGroupData[{
Cell[1000815, 23703, 109, 1, 59, "Subsection"],
Cell[1000927, 23706, 9193, 207, 1025, "Input"],
Cell[1010123, 23915, 2663, 65, 465, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1012823, 23985, 120, 1, 59, "Subsection"],
Cell[CellGroupData[{
Cell[1012968, 23990, 1574, 40, 73, "Input"],
Cell[1014545, 24032, 2870, 57, 123, "Output"],
Cell[1017418, 24091, 2769, 57, 95, "Output"]
}, Open  ]],
Cell[1020202, 24151, 1139, 20, 44, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1021378, 24176, 134, 3, 59, "Subsection"],
Cell[CellGroupData[{
Cell[1021537, 24183, 2324, 57, 101, "Input"],
Cell[1023864, 24242, 4273, 107, 179, "Output"]
}, Open  ]],
Cell[1028152, 24352, 1165, 21, 44, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1029354, 24378, 102, 1, 44, "Input"],
Cell[1029459, 24381, 3741, 99, 179, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1033237, 24485, 98, 1, 44, "Input"],
Cell[1033338, 24488, 3550, 99, 151, "Output"]
}, Open  ]],
Cell[1036903, 24590, 117, 1, 59, "Subsection"],
Cell[CellGroupData[{
Cell[1037045, 24595, 323, 9, 33, "Input"],
Cell[1037371, 24606, 2762, 70, 123, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1040170, 24681, 253, 6, 44, "Input"],
Cell[1040426, 24689, 2863, 69, 123, "Output"]
}, Open  ]],
Cell[1043304, 24761, 1500, 30, 73, "Input"],
Cell[1044807, 24793, 3638, 83, 409, "Input"],
Cell[1048448, 24878, 1517, 30, 73, "Input"],
Cell[1049968, 24910, 247, 5, 44, "Input"],
Cell[1050218, 24917, 1300, 24, 73, "Input"],
Cell[CellGroupData[{
Cell[1051543, 24945, 443, 9, 44, "Input"],
Cell[1051989, 24956, 7828, 204, 263, "Output"]
}, Open  ]],
Cell[1059832, 25163, 888, 17, 44, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
